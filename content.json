{"meta":{"title":"Reria's BLOG","subtitle":"","description":"","author":"reria","url":"http://example.com","root":"/"},"pages":[{"title":"","date":"2021-09-22T12:12:27.438Z","updated":"2021-09-22T12:12:27.438Z","comments":false,"path":"notice.html","permalink":"http://example.com/notice.html","excerpt":"","text":"æœ¬ç«™é»˜è®¤æ›¿æ¢äº†å³é”®èœå•ï¼Œå¦‚éœ€å”¤é†’åŸç³»ç»Ÿèœå•è¯·ä½¿ç”¨ï¼š ctrl + å³é”®"},{"title":"404 Not Found","date":"2021-07-23T06:13:25.410Z","updated":"2021-07-23T06:13:25.410Z","comments":true,"path":"404.html","permalink":"http://example.com/404.html","excerpt":"","text":"404 å¾ˆæŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ å¯èƒ½æ˜¯è¾“å…¥åœ°å€æœ‰è¯¯æˆ–è¯¥åœ°å€å·²è¢«åˆ é™¤"},{"title":"ã€ã€‘","date":"2021-09-22T12:12:40.562Z","updated":"2021-09-20T03:38:29.350Z","comments":true,"path":"æ¨¡æ¿.html","permalink":"http://example.com/%E6%A8%A1%E6%9D%BF.html","excerpt":"","text":""},{"title":"å…³äº","date":"2021-07-29T03:29:26.295Z","updated":"2021-07-29T03:29:26.295Z","comments":false,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":"æ­£åœ¨ç»´æŠ¤(å…¶å®æ˜¯æ‡’å¾—å†™ä»‹ç»ğŸ¤­"},{"title":"","date":"2021-07-27T01:43:04.243Z","updated":"2021-07-27T01:43:04.243Z","comments":true,"path":"bangumis/index.html","permalink":"http://example.com/bangumis/index.html","excerpt":"","text":""},{"title":"","date":"2021-07-29T03:28:37.138Z","updated":"2021-07-29T03:28:37.138Z","comments":true,"path":"bb/index.html","permalink":"http://example.com/bb/index.html","excerpt":"","text":""},{"title":"","date":"2021-07-26T05:59:04.234Z","updated":"2021-07-26T05:59:04.234Z","comments":false,"path":"artitalk/index.html","permalink":"http://example.com/artitalk/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2021-07-29T09:43:44.508Z","updated":"2021-07-29T09:43:44.508Z","comments":false,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"","date":"2021-07-27T01:43:04.243Z","updated":"2021-07-27T01:43:04.243Z","comments":true,"path":"cinema/index.html","permalink":"http://example.com/cinema/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„æœ‹å‹ä»¬","date":"2021-08-24T08:21:05.250Z","updated":"2021-08-24T08:21:05.250Z","comments":true,"path":"friends/index.html","permalink":"http://example.com/friends/index.html","excerpt":"","text":"ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2021-07-29T09:43:17.916Z","updated":"2021-07-29T09:43:17.916Z","comments":false,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜7","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜7","date":"2021-11-21T03:00:19.310Z","updated":"2021-11-24T10:56:34.628Z","comments":true,"path":"2021/11/21/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-7/","link":"","permalink":"http://example.com/2021/11/21/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-7/","excerpt":"","text":"æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥å¤„ç†ã€åº”ç”¨è§£è€¦ã€æµé‡å‰Šå³° æ¶ˆæ¯ä¸­é—´ä»¶ å¤§å¤šåº”ç”¨ä¸­ï¼Œå¯é€šè¿‡æ¶ˆæ¯æœåŠ¡ä¸­é—´ä»¶æ¥æå‡ç³»ç»Ÿå¼‚æ­¥é€šä¿¡ã€æ‰©å±•è§£è€¦èƒ½åŠ› æ¶ˆæ¯æœåŠ¡ä¸­ä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼š æ¶ˆæ¯ä»£ç†ï¼ˆmessage brokerï¼‰å’Œç›®çš„åœ°ï¼ˆdestinationï¼‰ å½“æ¶ˆæ¯å‘é€è€…å‘é€æ¶ˆæ¯ä»¥åï¼Œå°†ç”±æ¶ˆæ¯ä»£ç†ï¼ˆå®‰è£…äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„æœåŠ¡å™¨ï¼‰æ¥ç®¡ï¼Œæ¶ˆæ¯ä»£ç†ä¿è¯æ¶ˆæ¯ä¼ é€’åˆ°æŒ‡å®šç›®çš„åœ°ã€‚ æ¶ˆæ¯é˜Ÿåˆ—ä¸»è¦æœ‰ä¸¤ç§å½¢å¼çš„ç›®çš„åœ° é˜Ÿåˆ—ï¼ˆqueueï¼‰ï¼šç‚¹å¯¹ç‚¹æ¶ˆæ¯é€šä¿¡ï¼ˆpoint-to-pointï¼‰ ä¸»é¢˜ï¼ˆtopicï¼‰ï¼šå‘å¸ƒï¼ˆpublishï¼‰/è®¢é˜…ï¼ˆsubscribeï¼‰æ¶ˆæ¯é€šä¿¡ ç‚¹å¯¹ç‚¹å¼ ï¼š æ¶ˆæ¯å‘é€è€…å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä»£ç†å°†å…¶æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œæ¶ˆæ¯æ¥æ”¶è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å†…å®¹ï¼Œæ¶ˆæ¯è¯»å–åè¢«ç§»å‡ºé˜Ÿåˆ— æ¶ˆæ¯åªæœ‰å”¯ä¸€çš„å‘é€è€…å’Œæ¥å—è€…ï¼Œä½†å¹¶ä¸æ˜¯è¯´åªèƒ½æœ‰ä¸€ä¸ªæ¥æ”¶è€… å‘å¸ƒè®¢é˜…å¼ï¼š å‘é€è€…ï¼ˆå‘å¸ƒè€…ï¼‰å‘é€æ¶ˆæ¯åˆ°ä¸»é¢˜ï¼Œå¤šä¸ªæ¥æ”¶è€…ï¼ˆè®¢é˜…è€…ï¼‰ç›‘å¬ï¼ˆè®¢é˜…ï¼‰è¿™ä¸ªä¸»é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨æ¶ˆæ¯åˆ°è¾¾æ—¶åŒæ—¶æ”¶åˆ°æ¶ˆæ¯ JMSï¼ˆJava Message Serviceï¼‰JAVAæ¶ˆæ¯æœåŠ¡ï¼š åŸºäºJVMæ¶ˆæ¯ä»£ç†çš„è§„èŒƒã€‚ActiveMQã€HornetMQæ˜¯JMSå®ç° AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰ é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ¶ˆæ¯ä»£ç†çš„è§„èŒƒï¼Œå…¼å®¹JMS RabbitMQæ˜¯AMQPçš„å®ç° RabbitMQ RabbitMQæ˜¯ä¸€ä¸ªç”±erlangå¼€å‘çš„AMQP(Advanved Message Queue Protocol)çš„å¼€æºå®ç° Message æ¶ˆæ¯ï¼Œæ¶ˆæ¯æ˜¯ä¸å…·åçš„ï¼Œå®ƒç”±æ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ç»„æˆã€‚æ¶ˆæ¯ä½“æ˜¯ä¸é€æ˜çš„ï¼Œè€Œæ¶ˆæ¯å¤´åˆ™ç”±ä¸€ç³»åˆ—çš„å¯é€‰å±æ€§ç»„æˆï¼Œè¿™äº›å±æ€§åŒ…æ‹¬routing-keyï¼ˆè·¯ç”±é”®ï¼‰ã€priorityï¼ˆç›¸å¯¹äºå…¶ä»–æ¶ˆæ¯çš„ä¼˜å…ˆæƒï¼‰ã€delivery-modeï¼ˆæŒ‡å‡ºè¯¥æ¶ˆæ¯å¯èƒ½éœ€è¦æŒä¹…æ€§å­˜å‚¨ï¼‰ç­‰ã€‚ Publisheræ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå‘äº¤æ¢å™¨å‘å¸ƒæ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº Exchange äº¤æ¢å™¨ï¼Œç”¨æ¥æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯å¹¶å°†è¿™äº›æ¶ˆæ¯è·¯ç”±ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—ã€‚Exchangeæœ‰4ç§ç±»å‹ï¼šdirect(é»˜è®¤)ï¼Œfanout, topic, å’Œheadersï¼Œä¸åŒç±»å‹çš„Exchangeè½¬å‘æ¶ˆæ¯çš„ç­–ç•¥æœ‰æ‰€åŒºåˆ« Queue æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨æ¥ä¿å­˜æ¶ˆæ¯ç›´åˆ°å‘é€ç»™æ¶ˆè´¹è€…ã€‚å®ƒæ˜¯æ¶ˆæ¯çš„å®¹å™¨ï¼Œä¹Ÿæ˜¯æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚ä¸€ä¸ªæ¶ˆæ¯å¯æŠ•å…¥ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚æ¶ˆæ¯ä¸€ç›´åœ¨é˜Ÿåˆ—é‡Œé¢ï¼Œç­‰å¾…æ¶ˆè´¹è€…è¿æ¥åˆ°è¿™ä¸ªé˜Ÿåˆ—å°†å…¶å–èµ° Binding ç»‘å®šï¼Œç”¨äºæ¶ˆæ¯é˜Ÿåˆ—å’Œäº¤æ¢å™¨ä¹‹é—´çš„å…³è”ã€‚ä¸€ä¸ªç»‘å®šå°±æ˜¯åŸºäºè·¯ç”±é”®å°†äº¤æ¢å™¨å’Œæ¶ˆæ¯é˜Ÿåˆ—è¿æ¥èµ·æ¥çš„è·¯ç”±è§„åˆ™ï¼Œæ‰€ä»¥å¯ä»¥å°†äº¤æ¢å™¨ç†è§£æˆä¸€ä¸ªç”±ç»‘å®šæ„æˆçš„è·¯ç”±è¡¨ã€‚Exchange å’ŒQueueçš„ç»‘å®šå¯ä»¥æ˜¯å¤šå¯¹å¤šçš„å…³ç³» Connectionç½‘ç»œè¿æ¥ï¼Œæ¯”å¦‚ä¸€ä¸ªTCPè¿æ¥ã€‚ Channelä¿¡é“ï¼Œå¤šè·¯å¤ç”¨è¿æ¥ä¸­çš„ä¸€æ¡ç‹¬ç«‹çš„åŒå‘æ•°æ®æµé€šé“ã€‚ä¿¡é“æ˜¯å»ºç«‹åœ¨çœŸå®çš„TCPè¿æ¥å†…çš„è™šæ‹Ÿè¿æ¥ï¼ŒAMQP å‘½ä»¤éƒ½æ˜¯é€šè¿‡ä¿¡é“å‘å‡ºå»çš„ï¼Œä¸ç®¡æ˜¯å‘å¸ƒæ¶ˆæ¯ã€è®¢é˜…é˜Ÿåˆ—è¿˜æ˜¯æ¥æ”¶æ¶ˆæ¯ï¼Œè¿™äº›åŠ¨ä½œéƒ½æ˜¯é€šè¿‡ä¿¡é“å®Œæˆã€‚å› ä¸ºå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´å»ºç«‹å’Œé”€æ¯ TCP éƒ½æ˜¯éå¸¸æ˜‚è´µçš„å¼€é”€ï¼Œæ‰€ä»¥å¼•å…¥äº†ä¿¡é“çš„æ¦‚å¿µï¼Œä»¥å¤ç”¨ä¸€æ¡ TCP è¿æ¥ã€‚ Consumeræ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œè¡¨ç¤ºä¸€ä¸ªä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å¾—æ¶ˆæ¯çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚ Virtual Hostè™šæ‹Ÿä¸»æœºï¼Œè¡¨ç¤ºä¸€æ‰¹äº¤æ¢å™¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œç›¸å…³å¯¹è±¡ã€‚è™šæ‹Ÿä¸»æœºæ˜¯å…±äº«ç›¸åŒçš„èº«ä»½è®¤è¯å’ŒåŠ å¯†ç¯å¢ƒçš„ç‹¬ç«‹æœåŠ¡å™¨åŸŸã€‚æ¯ä¸ª vhost æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª mini ç‰ˆçš„ RabbitMQ æœåŠ¡å™¨ï¼Œæ‹¥æœ‰è‡ªå·±çš„é˜Ÿåˆ—ã€äº¤æ¢å™¨ã€ç»‘å®šå’Œæƒé™æœºåˆ¶ã€‚vhost æ˜¯ AMQP æ¦‚å¿µçš„åŸºç¡€ï¼Œå¿…é¡»åœ¨è¿æ¥æ—¶æŒ‡å®šï¼ŒRabbitMQ é»˜è®¤çš„ vhost æ˜¯ / ã€‚ Broker è¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å®ä½“ å®‰è£… https://www.rabbitmq.com/networking.html docker run -d â€“name rabbitmq -p 5671:5671 -p 5672:5672 -p 4369:4369 -p 25672:25672 -p 15671:15671 -p 15672:15672 rabbitmq:management docker update rabbitmq â€“restart=always 4369, 25672 (Erlangå‘ç°&amp;é›†ç¾¤ç«¯å£)5672, 5671 (AMQPç«¯å£)15672 (webç®¡ç†åå°ç«¯å£)61613, 61614 (STOMPåè®®ç«¯å£)1883, 8883 (MQTTåè®®ç«¯å£) Exchangeç±»å‹ Exchangeåˆ†å‘æ¶ˆæ¯æ—¶æ ¹æ®ç±»å‹çš„ä¸åŒåˆ†å‘ç­–ç•¥æœ‰åŒºåˆ«ï¼Œç›®å‰å…±å››ç§ç±»å‹ï¼šdirectã€fanoutã€topicã€headers ã€‚headers åŒ¹é… AMQP æ¶ˆæ¯çš„ header è€Œä¸æ˜¯è·¯ç”±é”®ï¼Œheaders äº¤æ¢å™¨å’Œ direct äº¤æ¢å™¨å®Œå…¨ä¸€è‡´ï¼Œä½†æ€§èƒ½å·®å¾ˆå¤šï¼Œç›®å‰å‡ ä¹ç”¨ä¸åˆ°äº† æ¶ˆæ¯ä¸­çš„è·¯ç”±é”®ï¼ˆrouting keyï¼‰å¦‚æœå’ŒBinding ä¸­çš„ binding key ä¸€è‡´ï¼Œ äº¤æ¢å™¨å°±å°†æ¶ˆæ¯å‘åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚è·¯ç”±é”®ä¸é˜Ÿåˆ—åå®Œå…¨åŒ¹é…ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºè¦æ±‚è·¯ç”±é”®ä¸ºâ€œdogâ€ï¼Œåˆ™åªè½¬å‘ routingkey æ ‡è®°ä¸ºâ€œdogâ€çš„æ¶ˆæ¯ï¼Œä¸ä¼šè½¬å‘â€œdog.puppyâ€ï¼Œä¹Ÿä¸ä¼šè½¬å‘â€œdog.guardâ€ç­‰ç­‰ã€‚å®ƒæ˜¯å®Œå…¨åŒ¹é…ã€å•æ’­çš„æ¨¡å¼ã€‚ æ¯ä¸ªå‘åˆ° fanout ç±»å‹äº¤æ¢å™¨çš„æ¶ˆæ¯éƒ½ä¼šåˆ†åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—ä¸Šå»ã€‚fanout äº¤æ¢å™¨ä¸å¤„ç†è·¯ç”±é”®ï¼Œåªæ˜¯ç®€å•çš„å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢å™¨ä¸Šï¼Œæ¯ä¸ªå‘é€åˆ°äº¤æ¢å™¨çš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢å™¨ç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Šã€‚å¾ˆåƒå­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ã€‚fanout ç±»å‹è½¬å‘æ¶ˆæ¯æ˜¯æœ€å¿«çš„ã€‚ topic äº¤æ¢å™¨é€šè¿‡æ¨¡å¼åŒ¹é…åˆ†é…æ¶ˆæ¯çš„è·¯ç”±é”®å±æ€§ï¼Œå°†è·¯ç”±é”®å’ŒæŸä¸ªæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œæ­¤æ—¶é˜Ÿåˆ—éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªæ¨¡å¼ä¸Šã€‚å®ƒå°†è·¯ç”±é”®å’Œç»‘å®šé”®çš„å­—ç¬¦ä¸²åˆ‡åˆ†æˆå•è¯ï¼Œè¿™äº›å•è¯ä¹‹é—´ç”¨ç‚¹éš”å¼€ã€‚å®ƒåŒæ ·ä¹Ÿä¼šè¯†åˆ«ä¸¤ä¸ªé€šé…ç¬¦ï¼šç¬¦å·â€œ#â€å’Œç¬¦å·â€œâ€ã€‚#åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå•è¯ï¼ŒåŒ¹é…ä¸€ä¸ªå•è¯ã€‚ springæ•´åˆä¾èµ–ã€é…ç½®12345&lt;!-- rabbitMQ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;&lt;/dependency&gt; 1@EnableRabbit // å¼€å¯rabbit 123456spring: rabbitmq: host: 192.168.128.129 port: 5672 virtual-host: / # å…¶ä»– AmqpAdmin123456789101112131415161718192021222324252627282930@Slf4j@RunWith(SpringRunner.class)@SpringBootTestpublic class GulimallOrderApplicationTests &#123; @Autowired AmqpAdmin amqpAdmin; @Test public void createExchange() &#123; DirectExchange directExchange = new DirectExchange(&quot;test-direct&quot;, true, false); amqpAdmin.declareExchange(directExchange); log.debug(&quot;Exchange[&#123;&#125;]åˆ›å»ºæˆåŠŸ&quot;, directExchange.getName()); &#125; @Test public void createQueue() &#123; Queue queue = new Queue(&quot;test-hello&quot;); amqpAdmin.declareQueue(queue); log.debug(&quot;Queue[&#123;&#125;]åˆ›å»ºæˆåŠŸ&quot;, queue.getName()); &#125; @Test public void binding() &#123; Binding binding = new Binding(&quot;test-hello&quot;, Binding.DestinationType.QUEUE, &quot;test-direct&quot;, &quot;test-hello&quot;, new HashMap&lt;&gt;()); amqpAdmin.declareBinding(binding); log.debug(&quot;Bindingåˆ›å»ºæˆåŠŸ,ç›®çš„åœ°[&#123;&#125;]&quot;, binding.getDestination()); &#125;&#125; RabbitTemplate123456789101112@AutowiredRabbitTemplate rabbitTemplate;@Testpublic void sendMsg() &#123; OrderEntity orderEntity = new OrderEntity(); orderEntity.setCouponId(1L); // å¦‚æœæ¶ˆæ¯å†…å®¹æ˜¯å¯¹è±¡ï¼Œé»˜è®¤åºåˆ—åŒ–è½¬æ¢ï¼Œæ‰€ä»¥å¯¹è±¡ç±»è¦æ±‚å®ç°åºåˆ—åŒ– // ä¹Ÿå¯ä»¥é…ç½®é»˜è®¤è½¬ä¸ºJSON rabbitTemplate.convertAndSend(&quot;test-direct&quot;, &quot;test-hello&quot;, orderEntity); log.debug(&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;);&#125; 12345678@Configurationpublic class OrderRabbitConfig &#123; // é…ç½®é»˜è®¤MessageConverterä¸ºJackson2JsonMessageConverterï¼ˆè½¬ä¸ºJSONï¼‰ @Bean public MessageConverter messageConverter() &#123; return new Jackson2JsonMessageConverter(); &#125;&#125; RabbitListenerã€RabbitHandler12345678// ç›‘å¬é˜Ÿåˆ—@RabbitListener(queues = &#123;&quot;test-hello&quot;&#125;)public void testListener(Message msg, OrderEntity content, Channel channel) &#123; // msg åŒ…æ‹¬å¤´+ä½“ // content å¯ä»¥ä½¿ç”¨å…·ä½“ç±»å‹æ¥æ”¶å†…å®¹ // channel ä¼ è¾“æ•°æ®é€šé“ log.debug(&quot;ç›‘å¬åˆ°äº†æ¶ˆæ¯:&quot; + msg + &quot;; å†…å®¹ä¸º:&quot; + content);&#125; è®¢å•æœåŠ¡å¯åŠ¨å¤šä¸ªçš„è¯ï¼ŒåŒä¸€ä¸ªæ¶ˆæ¯åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥æ”¶åˆ° åªæœ‰ä¸€ä¸ªæ¶ˆæ¯å®Œå…¨å¤„ç†å®Œä¹‹åï¼Œæ‰èƒ½æ¥æ”¶ä¸‹ä¸€ä¸ªæ¶ˆæ¯ RabbitListeneræ³¨è§£å¯ä»¥æ ‡åœ¨ç±»ã€æ–¹æ³•ä¸Šï¼ˆä¸€èˆ¬ç±»ä¸Šï¼‰ RabbitHandleræ³¨è§£å¯ä»¥æ ‡åœ¨æ–¹æ³•ä¸Šï¼Œå¯ä»¥è‡ªåŠ¨åˆ¤æ–­æ–¹æ³•å‚æ•°çš„å†…å®¹ç±»å‹ï¼ˆé‡è½½ï¼Œä¸è¿‡æ–¹æ³•åä¸éœ€è¦ä¸€æ ·ï¼‰ å¯é æŠ•é€’ ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œå¯é æŠµè¾¾ï¼Œå¯ä»¥ä½¿ç”¨äº‹åŠ¡æ¶ˆæ¯ï¼Œä½†æ˜¯æ€§èƒ½ä¼šä¸‹é™ï¼Œä¸ºæ­¤å¼•å…¥ç¡®è®¤æœºåˆ¶ ConfirmCallback ReturnCallback Ackæ¶ˆæ¯ç¡®è®¤æœºåˆ¶ è®¢å•æœåŠ¡ ç¯å¢ƒæ­å»º è€ç”Ÿå¸¸è°ˆ è®¢å•ç™»å½•æ‹¦æˆªOrderWebConfig123456789101112131415@Configurationpublic class OrderWebConfig implements WebMvcConfigurer &#123; @Autowired OrderLoginUserInterceptor loginInterceptor; /* * æ·»åŠ æ‹¦æˆªå™¨ * é…ç½®æ‹¦æˆªåœ°å€ */ @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(loginInterceptor).addPathPatterns(&quot;/**&quot;); &#125;&#125; OrderLoginUserInterceptor12345678910111213141516171819202122232425/* * ç™»å½•æ‹¦æˆª */@Componentpublic class OrderLoginUserInterceptor implements HandlerInterceptor &#123; public static ThreadLocal&lt;MemberEntityVo&gt; loginUser = new ThreadLocal&lt;&gt;(); /* * åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‹¦æˆª */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; MemberEntityVo attribute = (MemberEntityVo) request.getSession().getAttribute(AuthServerConstant.LOGIN_USER); if (attribute != null) &#123; // å·²ç™»å½• loginUser.set(attribute); return true; &#125; else &#123; request.getSession().setAttribute(&quot;msg&quot;, &quot;è¯·å…ˆç™»å½•&quot;); response.sendRedirect(&quot;http://auth.gulimall.com/login.html&quot;); return false; &#125; &#125;&#125; DEBUG OrderLoginUserInterceptoréœ€å†™æˆå¦‚ä¸‹ï¼ŒåŠ å…¥loginUseråˆ¤æ–­ï¼Œå¦åˆ™ä¼šæœ‰cannot get sessionçš„é—®é¢˜ debugçš„æ—¶å€™ä¼šè¿›å…¥ä¸¤æ¬¡interceptorï¼Œç„¶åç¬¬äºŒæ¬¡æ‹¿ä¸åˆ°sessionæ‰€ä»¥å°±ä¼šæŠ¥é”™ 1234567891011121314151617181920212223242526272829303132333435363738394041/* * ç™»å½•æ‹¦æˆª */@Componentpublic class OrderLoginUserInterceptor implements HandlerInterceptor &#123; public static ThreadLocal&lt;MemberEntityVo&gt; loginUser = new ThreadLocal&lt;&gt;(); /* * åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‹¦æˆª */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; // /order/order/status/2948294820984028420 String uri = request.getRequestURI(); AntPathMatcher antPathMatcher = new AntPathMatcher(); boolean match = antPathMatcher.match(&quot;/order/order/status/**&quot;, uri); boolean match1 = antPathMatcher.match(&quot;/payed/notify&quot;, uri); if (match || match1) &#123; return true; &#125; if (loginUser.get() != null) &#123; return true; &#125; else &#123; MemberEntityVo attribute = (MemberEntityVo) request.getSession().getAttribute(AuthServerConstant.LOGIN_USER); if (attribute != null) &#123; loginUser.set(attribute); return true; &#125; else &#123; //æ²¡ç™»å½•å°±å»ç™»å½• request.getSession().setAttribute(&quot;msg&quot;, &quot;è¯·å…ˆè¿›è¡Œç™»å½•&quot;); response.sendRedirect(&quot;http://auth.gulimall.com/login.html&quot;); return false; &#125; &#125; &#125;&#125; è®¢å•æœåŠ¡ - ç¡®è®¤é¡µFeignè¿œç¨‹è°ƒç”¨ä¸¢å¤±è¯·æ±‚å¤´ä¸¢å¤±è¯·æ±‚å¤´ MyFeignConfig é¢˜å¤–è¯ï¼Œè·Ÿç€é›·ç¥å­¦æˆ‘ç°åœ¨ä¹Ÿä¹ æƒ¯ç‚¹è¿›æºç çœ‹ä¸€çœ‹ï¼Œè€Œä¸”ä¸ä¼šå•¥ä¹Ÿçœ‹ä¸æ‡‚äº†ï¼ŒçœŸä¸æˆ³ 12345678910111213141516171819202122/* * é…ç½®feign */@Configurationpublic class MyFeignConfig &#123; // é…ç½®è¯·æ±‚æ‹¦æˆªå™¨ï¼Œé˜²æ­¢å¤´ä¸¢å¤± // é»˜è®¤requestæ‹¦æˆªå™¨æ˜¯ç©º,å­˜å…¥ä¸€ä¸ªå³å¯ @Bean(&quot;requestInterceptor&quot;) public RequestInterceptor requestInterceptor() &#123; return new RequestInterceptor() &#123; @Override public void apply(RequestTemplate requestTemplate) &#123; // RequestContextHolderåˆ©ç”¨äº†ThreadLocalï¼Œå­˜æ”¾äº†è¯·æ±‚å†…å®¹ ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes(); // è·å¾—request ï¼ˆåŸè¯·æ±‚ï¼‰ HttpServletRequest request = requestAttributes.getRequest(); // è·å¾—cookie å¹¶å­˜å…¥æ–°è¯·æ±‚ requestTemplate.header(&quot;Cookie&quot;, request.getHeader(&quot;Cookie&quot;)); &#125; &#125;; &#125;&#125; å¼‚æ­¥æƒ…å†µä¸‹ä¸¢å¤±ä¸Šä¸‹æ–‡ 12345RequestAttributes requestAttributes = RequestContextHolder.getRequestAttributes(); CompletableFuture&lt;Void&gt; addressFuture = CompletableFuture.runAsync(() -&gt; &#123; // åœ¨å¼‚æ­¥è¯·æ±‚ä¸­å…±äº«ä¹‹å‰çš„è¯·æ±‚æ•°æ® RequestContextHolder.setRequestAttributes(requestAttributes);&#125;, executor); Orderæ¨¡å—OrderConfirmVo1234567891011121314151617181920212223242526/** * è®¢å•ç¡®è®¤é¡µæ¨¡å‹ */@Datapublic class OrderConfirmVo &#123; // è®¢å•é˜²é‡å¤ä»¤ç‰Œ private String orderToken; // æ”¶è´§åœ°å€è¡¨ private List&lt;MemberAddressVo&gt; address; // è®¢å•å•†å“ private List&lt;OrderItemVo&gt; items; // å‘ç¥¨ // ä¼˜æƒ  private Integer integration; private BigDecimal total; private BigDecimal payPrice; public BigDecimal getPayPrice() &#123; return total.subtract(new BigDecimal(integration)); &#125; public BigDecimal getTotal() &#123; for (OrderItemVo item : items) &#123; total = total.add(item.getTotalPrice()); &#125; return total; &#125;&#125; OrderItemVo1234567891011121314@Datapublic class OrderItemVo &#123; private Long skuId; private String title; private String image; private List&lt;String&gt; skuAttr; private BigDecimal price; private Integer count; private BigDecimal totalPrice; public BigDecimal getTotalPrice() &#123; return this.price.multiply(new BigDecimal(this.count)); &#125;&#125; OrderWebController123456789/* * å‰å¾€è®¢å•ç¡®è®¤é¡µ */@GetMapping(&quot;/toTrade&quot;)public String toConfirmPage(Model model) &#123; OrderConfirmVo orderConfirmVo = orderService.confirmOrder(); model.addAttribute(&quot;orderConfirmData&quot;, orderConfirmVo); return &quot;confirm&quot;;&#125; OrderServiceImpl feignè¿œç¨‹è°ƒç”¨å’Œé¡µé¢è¿›å…¥ä¸åŒï¼Œåè€…ä¼šå¸¦cookieï¼Œå‰è€…æ²¡æœ‰å¸¦headeræ‰€æœ‰æ²¡æœ‰cookie 1234567891011121314151617181920212223242526272829303132333435 /* * ç¡®è®¤è®¢å•çš„ä¿¡æ¯ */@Overridepublic OrderConfirmVo confirmOrder() throws ExecutionException, InterruptedException &#123; OrderConfirmVo orderConfirmVo = new OrderConfirmVo(); // TODO è®¾ç½®é˜²é‡å¤ä»¤ç‰Œ // orderConfirmVo.setOrderToken(); // è®¾ç½®æ”¶è´§åœ°å€ (ç”¨æˆ·idå¯ä»¥ä»æ‹¦æˆªå™¨ä¸­çš„ThreadLocalçš„loginUserä¸­æŸ¥æ‰¾) CompletableFuture&lt;Void&gt; addressFuture = CompletableFuture.runAsync(() -&gt; &#123; R r = memberFeignService.getAddressListByMemberId(OrderLoginUserInterceptor.loginUser.get().getId()); if (r.getCode() == 0) &#123; List&lt;MemberAddressVo&gt; memberAddressVoList = r.getData(&quot;data&quot;, new TypeReference&lt;List&lt;MemberAddressVo&gt;&gt;() &#123; &#125;); orderConfirmVo.setAddress(memberAddressVoList); &#125; else &#123; log.error(&quot;memberè¿œç¨‹è°ƒç”¨å¤±è´¥&quot;); &#125; &#125;, executor); // è®¾ç½®è´­ç‰©é¡¹ ï¼ˆä»redisä¸­è·å–ï¼‰ CompletableFuture&lt;Void&gt; itemFuture = CompletableFuture.runAsync(() -&gt; &#123; List&lt;OrderItemVo&gt; checkedCartItems = cartFeignService.getCheckedCartItems(); orderConfirmVo.setItems(checkedCartItems); &#125;, executor); // è®¾ç½®æ€»ä»·æ ¼ (getæ–¹æ³•å·²ç»å†™å¥½äº†) // è®¾ç½®ä¼˜æƒ ä»· orderConfirmVo.setIntegration(OrderLoginUserInterceptor.loginUser.get().getIntegration()); // è®¾ç½®æ”¯ä»˜ä»· (getæ–¹æ³•å·²ç»å†™å¥½äº†) CompletableFuture.allOf(itemFuture, addressFuture).get(); return orderConfirmVo;&#125; MemberFeignService12345678@FeignClient(&quot;gulimall-member&quot;)public interface MemberFeignService &#123; /** * è·å–å¯¹åº”ä¼šå‘˜çš„æ‰€æœ‰æ”¶è´§åœ°å€ */ @GetMapping(&quot;/member/memberreceiveaddress/&#123;memberId&#125;/list&quot;) R getAddressListByMemberId(@PathVariable(&quot;memberId&quot;) Long memberId);&#125; CartFeignService12345678@FeignClient(&quot;gulimall-cart&quot;)public interface CartFeignService &#123; /* * è·å¾—è´­ç‰©è½¦å•†å“ */ @GetMapping(&quot;/checkItems&quot;) List&lt;OrderItemVo&gt; getCheckedCartItems();&#125; Memberæ¨¡å—MemberReceiveAddressController12345678/** * è·å–å¯¹åº”ä¼šå‘˜çš„æ‰€æœ‰æ”¶è´§åœ°å€ */@GetMapping(&quot;/&#123;memberId&#125;/list&quot;)public R getAddressListByMemberId(@PathVariable(&quot;memberId&quot;) Long memberId) &#123; List&lt;MemberReceiveAddressEntity&gt; addressList = memberReceiveAddressService.list(new QueryWrapper&lt;MemberReceiveAddressEntity&gt;().eq(&quot;member_id&quot;, memberId)); return R.ok().put(&quot;data&quot;, addressList);&#125; Cartæ¨¡å—CartServiceImpl1234567891011121314151617/* * è·å–ç”¨æˆ·é€‰ä¸­çš„æ‰€æœ‰å•†å“ */@Overridepublic List&lt;CartItemEntity&gt; getCheckedCartItems() &#123; // ä»redisä¸­æ ¹æ®userIdè·å¾—cartItem UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); // å°è£…list List&lt;CartItemEntity&gt; cartItem = getCartItem(CartConstant.CART_PREFIX + userInfoTo.getUserId()); return cartItem.stream().filter(CartItemEntity::getCheck).map((item) -&gt; &#123; // å­˜æ”¾åœ¨redisä¸­çš„è´­ç‰©é¡¹çš„ä»·æ ¼å¯èƒ½ä¼šå˜ï¼ˆå†—ä½™å­—æ®µï¼Œç”¨idå»æŸ¥ï¼‰ // æˆ‘è¿™é‡Œå°±ä¸å†™äº† // item.setPrice(); return item; &#125;) .collect(Collectors.toList());&#125; CartController123456789/* * è·å¾—è´­ç‰©è½¦å•†å“ */@ResponseBody@GetMapping(&quot;/checkItems&quot;)public List&lt;CartItemEntity&gt; getCheckedCartItems() &#123; List&lt;CartItemEntity&gt; cartItemEntityList = cartService.getCheckedCartItems(); return cartItemEntityList;&#125; TODO æ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰ä¸æ˜¯å¾ˆæƒ³å†™ç½‘é¡µå‰å°äº†ï¼Œç°åœ¨å†™ç»™ç”¨æˆ·çš„è¿˜æ˜¯å°ç¨‹åº appè¿™ç§æµè¡Œï¼Œç½‘é¡µåŸºæœ¬å°±æ˜¯åå°ç®¡ç†äº†ï¼Œå†åŠ ä¸Šthymeleafå®åœ¨æ˜¯è®©äººéš¾å—ï¼Œå°±è¿™æ ·å§ï¼Œä¸å†™äº†ï¼Œæˆ‘æŠŠé‡è¦çš„ä¸šåŠ¡é€»è¾‘è®°å½•ä¸€ä¸‹å°±è¡Œã€‚ å”‰é˜»ç¢æˆ‘çš„å¦ä¸€ä¸ªåŸå› æ˜¯èº«ä½“çŠ¶å†µï¼Œçªç„¶ç†è§£äº†è®²åº§çš„é‚£ä½å­¦é•¿è¯´çš„è¯ï¼Œå¤šé”»ç‚¼èº«ä½“ï¼Œæœ‰ä½“åŠ›æ‰èƒ½ç»§ç»­å•Šã€‚ æ¥å£å¹‚ç­‰æ€§ æ¥å£å¹‚ç­‰æ€§å°±æ˜¯ç”¨æˆ·å¯¹äºåŒä¸€æ“ä½œå‘èµ·çš„ä¸€æ¬¡è¯·æ±‚æˆ–è€…å¤šæ¬¡è¯·æ±‚çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œ ä¸ä¼šå› ä¸ºå¤šæ¬¡ç‚¹å‡»è€Œäº§ç”Ÿäº†å‰¯ä½œç”¨ï¼› æ¯”å¦‚è¯´æ”¯ä»˜åœºæ™¯ï¼Œ ç”¨æˆ·è´­ä¹°äº†å•†å“æ”¯ä»˜æ‰£æ¬¾æˆåŠŸï¼Œ ä½†æ˜¯è¿”å›ç»“æœçš„æ—¶å€™ç½‘ç»œå¼‚å¸¸ï¼Œ æ­¤æ—¶é’±å·²ç»æ‰£äº†ï¼Œ ç”¨æˆ·å†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œ æ­¤æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡æ‰£æ¬¾ï¼Œ è¿”å›ç»“æœæˆåŠŸï¼Œ ç”¨æˆ·æŸ¥è¯¢ä½™é¢è¿”å‘ç°å¤šæ‰£é’±äº†ï¼Œ æµæ°´è®°å½•ä¹Ÿå˜æˆäº†ä¸¤æ¡ï¼ ï¼ ï¼ ,è¿™å°±æ²¡æœ‰ä¿è¯æ¥å£çš„å¹‚ç­‰æ€§ã€‚ å“ªäº›æƒ…å†µéœ€è¦é˜²æ­¢ ç”¨æˆ·å¤šæ¬¡ç‚¹å‡»æŒ‰é’® ç”¨æˆ·é¡µé¢å›é€€å†æ¬¡æäº¤ å¾®æœåŠ¡äº’ç›¸è°ƒç”¨ï¼Œ ç”±äºç½‘ç»œé—®é¢˜ï¼Œ å¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚ feign è§¦å‘é‡è¯•æœºåˆ¶ å…¶ä»–ä¸šåŠ¡æƒ…å†µ ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¹‚ç­‰ ä»¥ SQL ä¸ºä¾‹ï¼Œ æœ‰äº›æ“ä½œæ˜¯å¤©ç„¶å¹‚ç­‰çš„ã€‚ SELECT * FROM table WHER id=?ï¼Œ æ— è®ºæ‰§è¡Œå¤šå°‘æ¬¡éƒ½ä¸ä¼šæ”¹å˜çŠ¶æ€ï¼Œ æ˜¯å¤©ç„¶çš„å¹‚ç­‰ã€‚UPDATE tab1 SET col1=1 WHERE col2=2ï¼Œ æ— è®ºæ‰§è¡ŒæˆåŠŸå¤šå°‘æ¬¡çŠ¶æ€éƒ½æ˜¯ä¸€è‡´çš„ï¼Œ ä¹Ÿæ˜¯å¹‚ç­‰æ“ä½œã€‚delete from user where userid=1ï¼Œ å¤šæ¬¡æ“ä½œï¼Œ ç»“æœä¸€æ ·ï¼Œ å…·å¤‡å¹‚ç­‰æ€§insert into user(userid,name) values(1,â€™aâ€™) å¦‚ userid ä¸ºå”¯ä¸€ä¸»é”®ï¼Œ å³é‡å¤æ“ä½œä¸Šé¢çš„ä¸šåŠ¡ï¼Œ åªä¼šæ’å…¥ä¸€æ¡ç”¨æˆ·æ•°æ®ï¼Œ å…·å¤‡å¹‚ç­‰æ€§ã€‚ UPDATE tab1 SET col1=col1+1 WHERE col2=2ï¼Œ æ¯æ¬¡æ‰§è¡Œçš„ç»“æœéƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œ ä¸æ˜¯å¹‚ç­‰çš„ã€‚insert into user(userid,name) values(1,â€™aâ€™) å¦‚ userid ä¸æ˜¯ä¸»é”®ï¼Œ å¯ä»¥é‡å¤ï¼Œ é‚£ä¸Šé¢ä¸šåŠ¡å¤šæ¬¡æ“ä½œï¼Œ æ•°æ®éƒ½ä¼šæ–°å¢å¤šæ¡ï¼Œ ä¸å…·å¤‡å¹‚ç­‰æ€§ã€‚ token æœºåˆ¶ 1ã€ æœåŠ¡ç«¯æä¾›äº†å‘é€ token çš„æ¥å£ã€‚ æˆ‘ä»¬åœ¨åˆ†æä¸šåŠ¡çš„æ—¶å€™ï¼Œ å“ªäº›ä¸šåŠ¡æ˜¯å­˜åœ¨å¹‚ç­‰é—®é¢˜çš„ï¼Œå°±å¿…é¡»åœ¨æ‰§è¡Œä¸šåŠ¡å‰ï¼Œ å…ˆå»è·å– tokenï¼Œ æœåŠ¡å™¨ä¼šæŠŠ token ä¿å­˜åˆ° redis ä¸­ã€‚2ã€ç„¶åè°ƒç”¨ä¸šåŠ¡æ¥å£è¯·æ±‚æ—¶ï¼Œ æŠŠ token æºå¸¦è¿‡å»ï¼Œ ä¸€èˆ¬æ”¾åœ¨è¯·æ±‚å¤´éƒ¨ã€‚3ã€ æœåŠ¡å™¨åˆ¤æ–­ token æ˜¯å¦å­˜åœ¨ redis ä¸­ï¼Œ å­˜åœ¨è¡¨ç¤ºç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œ ç„¶ååˆ é™¤ token,ç»§ç»­æ‰§è¡Œä¸šåŠ¡ã€‚4ã€ å¦‚æœåˆ¤æ–­ token ä¸å­˜åœ¨ redis ä¸­ï¼Œ å°±è¡¨ç¤ºæ˜¯é‡å¤æ“ä½œï¼Œ ç›´æ¥è¿”å›é‡å¤æ ‡è®°ç»™ clientï¼Œ è¿™æ ·å°±ä¿è¯äº†ä¸šåŠ¡ä»£ç ï¼Œ ä¸è¢«é‡å¤æ‰§è¡Œã€‚ å±é™©æ€§ï¼š1ã€ å…ˆåˆ é™¤ token è¿˜æ˜¯ååˆ é™¤ tokenï¼› (1) å…ˆåˆ é™¤å¯èƒ½å¯¼è‡´ï¼Œ ä¸šåŠ¡ç¡®å®æ²¡æœ‰æ‰§è¡Œï¼Œ é‡è¯•è¿˜å¸¦ä¸Šä¹‹å‰ tokenï¼Œ ç”±äºé˜²é‡è®¾è®¡å¯¼è‡´ï¼Œè¯·æ±‚è¿˜æ˜¯ä¸èƒ½æ‰§è¡Œã€‚ (2) ååˆ é™¤å¯èƒ½å¯¼è‡´ï¼Œ ä¸šåŠ¡å¤„ç†æˆåŠŸï¼Œ ä½†æ˜¯æœåŠ¡é—ªæ–­ï¼Œ å‡ºç°è¶…æ—¶ï¼Œ æ²¡æœ‰åˆ é™¤ tokenï¼Œ åˆ«äººç»§ç»­é‡è¯•ï¼Œ å¯¼è‡´ä¸šåŠ¡è¢«æ‰§è¡Œä¸¤è¾¹ (3) æˆ‘ä»¬æœ€å¥½è®¾è®¡ä¸ºå…ˆåˆ é™¤ tokenï¼Œ å¦‚æœä¸šåŠ¡è°ƒç”¨å¤±è´¥ï¼Œ å°±é‡æ–°è·å– token å†æ¬¡è¯·æ±‚ã€‚2ã€ Token è·å–ã€ æ¯”è¾ƒå’Œåˆ é™¤å¿…é¡»æ˜¯åŸå­æ€§ (1) redis.get(token) ã€ token.equalsã€ redis.del(token)å¦‚æœè¿™ä¸¤ä¸ªæ“ä½œä¸æ˜¯åŸå­ï¼Œ å¯èƒ½å¯¼è‡´ï¼Œ é«˜å¹¶å‘ä¸‹ï¼Œ éƒ½ get åˆ°åŒæ ·çš„æ•°æ®ï¼Œ åˆ¤æ–­éƒ½æˆåŠŸï¼Œ ç»§ç»­ä¸šåŠ¡å¹¶å‘æ‰§è¡Œ (2) å¯ä»¥åœ¨ redis ä½¿ç”¨ lua è„šæœ¬å®Œæˆè¿™ä¸ªæ“ä½œ if redis.call(â€˜getâ€™, KEYS[1]) == ARGV[1] then return redis.call(â€˜delâ€™, KEYS[1]) else return 0 end å„ç§é”æœºåˆ¶æ•°æ®åº“æ‚²è§‚é” select * from xxxx where id = 1 for update;æ‚²è§‚é”ä½¿ç”¨æ—¶ä¸€èˆ¬ä¼´éšäº‹åŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œ æ•°æ®é”å®šæ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿ï¼Œ éœ€è¦æ ¹æ®å®é™…æƒ…å†µé€‰ç”¨ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œ id å­—æ®µä¸€å®šæ˜¯ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•ï¼Œ ä¸ç„¶å¯èƒ½é€ æˆé”è¡¨çš„ç»“æœï¼Œ å¤„ç†èµ·æ¥ä¼šéå¸¸éº»çƒ¦ã€‚ æ•°æ®åº“ä¹è§‚é” è¿™ç§æ–¹æ³•é€‚åˆåœ¨æ›´æ–°çš„åœºæ™¯ä¸­ï¼Œupdate t_goods set count = count -1 , version = version + 1 where good_id=2 and version = 1æ ¹æ® version ç‰ˆæœ¬ï¼Œ ä¹Ÿå°±æ˜¯åœ¨æ“ä½œåº“å­˜å‰å…ˆè·å–å½“å‰å•†å“çš„ version ç‰ˆæœ¬å·ï¼Œ ç„¶åæ“ä½œçš„æ—¶å€™å¸¦ä¸Šæ­¤ version å·ã€‚ æˆ‘ä»¬æ¢³ç†ä¸‹ï¼Œ æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ“ä½œåº“å­˜æ—¶ï¼Œ å¾—åˆ° version ä¸º 1ï¼Œ è°ƒç”¨åº“å­˜æœåŠ¡version å˜æˆäº† 2ï¼› ä½†è¿”å›ç»™è®¢å•æœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œ è®¢å•æœåŠ¡åˆä¸€æ¬¡å‘èµ·è°ƒç”¨åº“å­˜æœåŠ¡ï¼Œ å½“è®¢å•æœåŠ¡ä¼ å¦‚çš„ version è¿˜æ˜¯ 1ï¼Œ å†æ‰§è¡Œä¸Šé¢çš„ sql è¯­å¥æ—¶ï¼Œ å°±ä¸ä¼šæ‰§è¡Œï¼› å› ä¸º version å·²ç»å˜ä¸º 2 äº†ï¼Œ where æ¡ä»¶å°±ä¸æˆç«‹ã€‚ è¿™æ ·å°±ä¿è¯äº†ä¸ç®¡è°ƒç”¨å‡ æ¬¡ï¼Œ åªä¼šçœŸæ­£çš„å¤„ç†ä¸€æ¬¡ã€‚ä¹è§‚é”ä¸»è¦ä½¿ç”¨äºå¤„ç†è¯»å¤šå†™å°‘çš„é—®é¢˜ ä¸šåŠ¡å±‚åˆ†å¸ƒå¼é” å¦‚æœå¤šä¸ªæœºå™¨å¯èƒ½åœ¨åŒä¸€æ—¶é—´åŒæ—¶å¤„ç†ç›¸åŒçš„æ•°æ®ï¼Œ æ¯”å¦‚å¤šå°æœºå™¨å®šæ—¶ä»»åŠ¡éƒ½æ‹¿åˆ°äº†ç›¸åŒæ•°æ®å¤„ç†ï¼Œ æˆ‘ä»¬å°±å¯ä»¥åŠ åˆ†å¸ƒå¼é”ï¼Œ é”å®šæ­¤æ•°æ®ï¼Œ å¤„ç†å®Œæˆåé‡Šæ”¾é”ã€‚ è·å–åˆ°é”çš„å¿…é¡»å…ˆåˆ¤æ–­è¿™ä¸ªæ•°æ®æ˜¯å¦è¢«å¤„ç†è¿‡ã€‚ å„ç§å”¯ä¸€çº¦æŸæ•°æ®åº“å”¯ä¸€çº¦æŸ æ’å…¥æ•°æ®ï¼Œ åº”è¯¥æŒ‰ç…§å”¯ä¸€ç´¢å¼•è¿›è¡Œæ’å…¥ï¼Œ æ¯”å¦‚è®¢å•å·ï¼Œ ç›¸åŒçš„è®¢å•å°±ä¸å¯èƒ½æœ‰ä¸¤æ¡è®°å½•æ’å…¥ã€‚æˆ‘ä»¬åœ¨æ•°æ®åº“å±‚é¢é˜²æ­¢é‡å¤ã€‚è¿™ä¸ªæœºåˆ¶æ˜¯åˆ©ç”¨äº†æ•°æ®åº“çš„ä¸»é”®å”¯ä¸€çº¦æŸçš„ç‰¹æ€§ï¼Œ è§£å†³äº†åœ¨ insert åœºæ™¯æ—¶å¹‚ç­‰é—®é¢˜ã€‚ ä½†ä¸»é”®çš„è¦æ±‚ä¸æ˜¯è‡ªå¢çš„ä¸»é”®ï¼Œ è¿™æ ·å°±éœ€è¦ä¸šåŠ¡ç”Ÿæˆå…¨å±€å”¯ä¸€çš„ä¸»é”®ã€‚å¦‚æœæ˜¯åˆ†åº“åˆ†è¡¨åœºæ™¯ä¸‹ï¼Œ è·¯ç”±è§„åˆ™è¦ä¿è¯ç›¸åŒè¯·æ±‚ä¸‹ï¼Œ è½åœ°åœ¨åŒä¸€ä¸ªæ•°æ®åº“å’ŒåŒä¸€è¡¨ä¸­ï¼Œ è¦ä¸ç„¶æ•°æ®åº“ä¸»é”®çº¦æŸå°±ä¸èµ·æ•ˆæœäº†ï¼Œ å› ä¸ºæ˜¯ä¸åŒçš„æ•°æ®åº“å’Œè¡¨ä¸»é”®ä¸ç›¸å…³ã€‚ redis set é˜²é‡ å¾ˆå¤šæ•°æ®éœ€è¦å¤„ç†ï¼Œ åªèƒ½è¢«å¤„ç†ä¸€æ¬¡ï¼Œ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è®¡ç®—æ•°æ®çš„ MD5 å°†å…¶æ”¾å…¥ redis çš„ setï¼Œæ¯æ¬¡å¤„ç†æ•°æ®ï¼Œ å…ˆçœ‹è¿™ä¸ª MD5 æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œ å­˜åœ¨å°±ä¸å¤„ç† é˜²é‡è¡¨ ä½¿ç”¨è®¢å•å· orderNo åšä¸ºå»é‡è¡¨çš„å”¯ä¸€ç´¢å¼•ï¼Œ æŠŠå”¯ä¸€ç´¢å¼•æ’å…¥å»é‡è¡¨ï¼Œ å†è¿›è¡Œä¸šåŠ¡æ“ä½œï¼Œ ä¸”ä»–ä»¬åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚ è¿™ä¸ªä¿è¯äº†é‡å¤è¯·æ±‚æ—¶ï¼Œ å› ä¸ºå»é‡è¡¨æœ‰å”¯ä¸€çº¦æŸï¼Œ å¯¼è‡´è¯·æ±‚å¤±è´¥ï¼Œ é¿å…äº†å¹‚ç­‰é—®é¢˜ã€‚ è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œ å»é‡è¡¨å’Œä¸šåŠ¡è¡¨åº”è¯¥åœ¨åŒä¸€åº“ä¸­ï¼Œ è¿™æ ·å°±ä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡ï¼Œ å³ä½¿ä¸šåŠ¡æ“ä½œå¤±è´¥äº†ï¼Œ ä¹Ÿä¼šæŠŠå»é‡è¡¨çš„æ•°æ®å›æ»šã€‚ è¿™ä¸ªå¾ˆå¥½çš„ä¿è¯äº†æ•°æ®ä¸€è‡´æ€§ã€‚ä¹‹å‰è¯´çš„ redis é˜²é‡ä¹Ÿç®— å…¨å±€è¯·æ±‚å”¯ä¸€ id è°ƒç”¨æ¥å£æ—¶ï¼Œ ç”Ÿæˆä¸€ä¸ªå”¯ä¸€ idï¼Œ redis å°†æ•°æ®ä¿å­˜åˆ°é›†åˆä¸­ï¼ˆå»é‡ï¼‰ ï¼Œ å­˜åœ¨å³å¤„ç†è¿‡ã€‚å¯ä»¥ä½¿ç”¨ nginx è®¾ç½®æ¯ä¸€ä¸ªè¯·æ±‚çš„å”¯ä¸€ idï¼›proxy_set_header X-Request-Id $request_id; è®¢å•æäº¤ tokenæ·»åŠ token123String token = UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;&quot;);redisTemplate.opsForValue().set(AuthServerConstant.USER_ORDER_TOKEN_PREFIX + memberRespVo.getId(), token, 30, TimeUnit.MINUTES);confirmVo.setOrderToken(token); åŸå­éªŒè¯token12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970@Transaction // æœ¬ç¬¬äº‹åŠ¡ï¼Œåªèƒ½æ§åˆ¶è‡ªå·±æœåŠ¡çš„äº‹åŠ¡@Override public SubmitOrderResponseVo submitOrder(OrderSubmitVo vo) &#123; confirmVoThreadLocal.set(vo); SubmitOrderResponseVo response = new SubmitOrderResponseVo(); MemberRespVo memberRespVo = LoginUserInterceptor.loginUser.get(); response.setCode(0); //1ã€éªŒè¯ä»¤ç‰Œã€ä»¤ç‰Œçš„å¯¹æ¯”å’Œåˆ é™¤å¿…é¡»ä¿è¯åŸå­æ€§ã€‘ //0ä»¤ç‰Œå¤±è´¥ - 1åˆ é™¤æˆåŠŸ String script = &quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] then return redis.call(&#x27;del&#x27;, KEYS[1]) else return 0 end&quot;; String orderToken = vo.getOrderToken(); //åŸå­éªŒè¯ä»¤ç‰Œå’Œåˆ é™¤ä»¤ç‰Œ Long result = redisTemplate.execute(new DefaultRedisScript&lt;Long&gt;(script, Long.class), Arrays.asList(OrderConstant.USER_ORDER_TOKEN_PREFIX + memberRespVo.getId()), orderToken); if (result == 0L) &#123; //ä»¤ç‰ŒéªŒè¯å¤±è´¥ response.setCode(1); return response; &#125; else &#123; //ä»¤ç‰ŒéªŒè¯æˆåŠŸ //ä¸‹å•ï¼šå»åˆ›å»ºè®¢å•ï¼ŒéªŒä»¤ç‰Œï¼ŒéªŒä»·æ ¼ï¼Œé”åº“å­˜... //1ã€åˆ›å»ºè®¢å•ï¼Œè®¢å•é¡¹ç­‰ä¿¡æ¯ OrderCreateTo order = createOrder(); //2ã€éªŒä»· BigDecimal payAmount = order.getOrder().getPayAmount(); BigDecimal payPrice = vo.getPayPrice(); if (Math.abs(payAmount.subtract(payPrice).doubleValue()) &lt; 0.01) &#123; //é‡‘é¢å¯¹æ¯” //.... //TODO 3ã€ä¿å­˜è®¢å• saveOrder(order); //4ã€åº“å­˜é”å®šã€‚åªè¦æœ‰å¼‚å¸¸å›æ»šè®¢å•æ•°æ®ã€‚ // è®¢å•å·ï¼Œæ‰€æœ‰è®¢å•é¡¹ï¼ˆskuIdï¼ŒskuNameï¼Œnumï¼‰ WareSkuLockVo lockVo = new WareSkuLockVo(); lockVo.setOrderSn(order.getOrder().getOrderSn()); List&lt;OrderItemVo&gt; locks = order.getOrderItems().stream().map(item -&gt; &#123; OrderItemVo itemVo = new OrderItemVo(); itemVo.setSkuId(item.getSkuId()); itemVo.setCount(item.getSkuQuantity()); itemVo.setTitle(item.getSkuName()); return itemVo; &#125;).collect(Collectors.toList()); lockVo.setLocks(locks); //4ã€è¿œç¨‹é”åº“å­˜ //åº“å­˜æˆåŠŸäº†ï¼Œä½†æ˜¯ç½‘ç»œåŸå› è¶…æ—¶äº†ï¼Œè®¢å•å›æ»šï¼Œåº“å­˜ä¸æ»šã€‚ //ä¸ºäº†ä¿è¯é«˜å¹¶å‘ã€‚åº“å­˜æœåŠ¡è‡ªå·±å›æ»šã€‚å¯ä»¥å‘æ¶ˆæ¯ç»™åº“å­˜æœåŠ¡ï¼› //åº“å­˜æœåŠ¡æœ¬èº«ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ¨è§£é”æ¨¡å¼ æ¶ˆæ¯ R r = wmsFeignService.orderLockStock(lockVo); if (r.getCode() == 0) &#123; //é”æˆåŠŸäº† response.setOrder(order.getOrder()); //TODO 5ã€è¿œç¨‹æ‰£å‡ç§¯åˆ† å‡ºå¼‚å¸¸// int i = 10/0; //è®¢å•å›æ»šï¼Œåº“å­˜ä¸æ»š //è®¢å•åˆ›å»ºæˆåŠŸå‘é€æ¶ˆæ¯ç»™MQ rabbitTemplate.convertAndSend(&quot;order-event-exchange&quot;, &quot;order.create.order&quot;, order.getOrder()); //TODO 6ã€æ¸…é™¤è´­ç‰©è½¦å·²ç»ä¸‹å•çš„å•†å“ return response; &#125; else &#123; //é”å®šå¤±è´¥ String msg = (String) r.get(&quot;msg&quot;); throw new NoStockException(msg); &#125; &#125; else &#123; response.setCode(2); return response; &#125; &#125; åˆ†å¸ƒå¼äº‹åŠ¡æœ¬åœ°äº‹åŠ¡ è¯¦è§æ–‡æ¡£ äº‹åŠ¡çš„éš”ç¦»çº§åˆ« READ UNCOMMITTEDï¼ˆè¯»æœªæäº¤ï¼‰è¯¥éš”ç¦»çº§åˆ«çš„äº‹åŠ¡ä¼šè¯»åˆ°å…¶å®ƒæœªæäº¤äº‹åŠ¡çš„æ•°æ®ï¼Œ æ­¤ç°è±¡ä¹Ÿç§°ä¹‹ä¸ºè„è¯»ã€‚ READ COMMITTEDï¼ˆ è¯»æäº¤ï¼‰ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å¦ä¸€ä¸ªå·²æäº¤çš„äº‹åŠ¡ï¼Œ å¤šæ¬¡è¯»å–ä¼šé€ æˆä¸ä¸€æ ·çš„ç»“æœï¼Œ æ­¤ç°è±¡ç§°ä¸ºä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œ Oracle å’Œ SQL Server çš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚ REPEATABLE READï¼ˆ å¯é‡å¤è¯»ï¼‰è¯¥éš”ç¦»çº§åˆ«æ˜¯ MySQL é»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œ åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œ select çš„ç»“æœæ˜¯äº‹åŠ¡å¼€å§‹æ—¶æ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œ å› æ­¤ï¼Œ åŒæ ·çš„ select æ“ä½œè¯»åˆ°çš„ç»“æœä¼šæ˜¯ä¸€è‡´çš„ï¼Œ ä½†æ˜¯ï¼Œ ä¼šæœ‰å¹»è¯»ç°è±¡ã€‚ MySQLçš„ InnoDB å¼•æ“å¯ä»¥é€šè¿‡ next-key locks æœºåˆ¶ï¼ˆ å‚è€ƒä¸‹æ–‡â€è¡Œé”çš„ç®—æ³•â€ä¸€èŠ‚ï¼‰ æ¥é¿å…å¹»è¯»ã€‚ SERIALIZABLEï¼ˆ åºåˆ—åŒ–ï¼‰åœ¨è¯¥éš”ç¦»çº§åˆ«ä¸‹äº‹åŠ¡éƒ½æ˜¯ä¸²è¡Œé¡ºåºæ‰§è¡Œçš„ï¼Œ MySQL æ•°æ®åº“çš„ InnoDB å¼•æ“ä¼šç»™è¯»æ“ä½œéšå¼åŠ ä¸€æŠŠè¯»å…±äº«é”ï¼Œ ä»è€Œé¿å…äº†è„è¯»ã€ ä¸å¯é‡è¯»å¤è¯»å’Œå¹»è¯»é—®é¢˜ã€‚ äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º 1ã€ PROPAGATION_REQUIREDï¼š å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œ å°±åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œ å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œ è¯¥è®¾ç½®æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ã€‚2ã€ PROPAGATION_SUPPORTSï¼š æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œ å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œ å°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œ å¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œ å°±ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚3ã€ PROPAGATION_MANDATORYï¼š æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œ å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œ å°±åŠ å…¥è¯¥äº‹åŠ¡ï¼Œ å¦‚æœå½“å‰ä¸å­˜åœ¨äº‹åŠ¡ï¼Œ å°±æŠ›å‡ºå¼‚å¸¸ã€‚4ã€ PROPAGATION_REQUIRES_NEWï¼š åˆ›å»ºæ–°äº‹åŠ¡ï¼Œ æ— è®ºå½“å‰å­˜ä¸å­˜åœ¨äº‹åŠ¡ï¼Œ éƒ½åˆ›å»ºæ–°äº‹åŠ¡ã€‚5ã€ PROPAGATION_NOT_SUPPORTEDï¼š ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œ å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œ å°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚6ã€ PROPAGATION_NEVERï¼š ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œ å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œ åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚7ã€ PROPAGATION_NESTEDï¼š å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œ åˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚ å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ‰§è¡Œä¸ PROPAGATION_REQUIRED ç±»ä¼¼çš„æ“ä½œ","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜6","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜6","date":"2021-11-17T04:50:09.771Z","updated":"2021-11-20T09:34:26.432Z","comments":true,"path":"2021/11/17/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-6/","link":"","permalink":"http://example.com/2021/11/17/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-6/","excerpt":"","text":"è®¤è¯æœåŠ¡ - çŸ­ä¿¡éªŒè¯ç åŸºç¡€ç¯å¢ƒæ­å»ºé…ç½® å¼€å¯nacosï¼Œfeign 123456789101112131415161718192021# springspring: # nacos æ³¨å†Œä¸­å¿ƒ cloud: nacos: discovery: # nacosåœ°å€ server-addr: 127.0.0.1:8848 # æœåŠ¡å application: name: gulimall-auto-server jackson: # æ—¶é—´æˆ³æ ¼å¼åŒ– date-format: yyyy-MM-dd HH:mm:ss time-zone: GMT+8 thymeleaf: # thymeleafç¼“å­˜ cache: false#æœåŠ¡å™¨server: port: 20000 èµ„æº æ”¾å…¥ç™»å½•æ³¨å†Œé¡µé¢æ–‡ä»¶ï¼Œé™æ€èµ„æºæ”¾åˆ°nacosä¸­ é…ç½® host gateway viewController templatesä¸‹ä¸ä¸ºindexåçš„htmlé¡µé¢éƒ½éœ€è¦é€šè¿‡controlleræ˜ å°„åè·³è½¬ å¦‚æœåªæ˜¯è·³è½¬ä¸å†™ä»»ä½•å…¶ä»–æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨viewController 1234567891011@Configurationpublic class MyWebConfig implements WebMvcConfigurer &#123; /* * é‡å†™ï¼Œå¯ä»¥æ·»åŠ urlPathå’Œè§†å›¾åçš„å¯¹åº”æ˜ å°„ */ @Override public void addViewControllers(ViewControllerRegistry registry) &#123; registry.addViewController(&quot;/login.html&quot;).setViewName(&quot;login&quot;); registry.addViewController(&quot;/reg.html&quot;).setViewName(&quot;reg&quot;); &#125;&#125; å‘é€éªŒè¯ç å€’è®¡æ—¶ ä½¿ç”¨å®šæ—¶å™¨ 12345678910&lt;!-- éªŒè¯ç  --&gt;&lt;div class=&quot;register-box&quot;&gt; &lt;label class=&quot;other_label&quot;&gt;éªŒ è¯ ç  &lt;input name=&quot;code&quot; maxlength=&quot;20&quot; type=&quot;text&quot; placeholder=&quot;è¯·è¾“å…¥éªŒè¯ç &quot; class=&quot;caa&quot;&gt; &lt;/label&gt; &lt;a id=&quot;sendCode&quot;&gt; å‘é€éªŒè¯ç  &lt;/a&gt; &lt;div class=&quot;tips&quot; style=&quot;color:red&quot; th:text=&quot;$&#123;errors!=null?(#maps.containsKey(errors, &#x27;code&#x27;)?errors.code:&#x27;&#x27;):&#x27;&#x27;&#125;&quot;&gt; &lt;/div&gt;&lt;/div&gt; 12345678910111213141516171819202122232425262728293031$(function () &#123; $(&quot;#sendCode&quot;).click(function () &#123; //2ã€å€’è®¡æ—¶ if ($(this).hasClass(&quot;disabled&quot;)) &#123; //æ­£åœ¨å€’è®¡æ—¶ã€‚ &#125; else &#123; //1ã€ç»™æŒ‡å®šæ‰‹æœºå·å‘é€éªŒè¯ç  $.get(&quot;/sms/sendcode?phone=&quot; + $(&quot;#phoneNum&quot;).val(), function (data) &#123; if (data.code != 0) &#123; alert(data.msg); &#125; &#125;); timeoutChangeStyle(); &#125; &#125;);&#125;)var num = 60;function timeoutChangeStyle() &#123; $(&quot;#sendCode&quot;).attr(&quot;class&quot;, &quot;disabled&quot;); if (num == 0) &#123; $(&quot;#sendCode&quot;).text(&quot;å‘é€éªŒè¯ç &quot;); num = 60; $(&quot;#sendCode&quot;).attr(&quot;class&quot;, &quot;&quot;); &#125; else &#123; var str = num + &quot;s åå†æ¬¡å‘é€&quot;; $(&quot;#sendCode&quot;).text(str); setTimeout(&quot;timeoutChangeStyle()&quot;, 1000); &#125; num--;&#125; çŸ­ä¿¡éªŒè¯ç  å†™åœ¨ç¬¬ä¸‰æ–¹å·¥å…·çš„æ¨¡å—ä¸­ HttpClient123456789/** * é‡è¦æç¤ºå¦‚ä¸‹: * HttpUtilsè¯·ä» * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/src/main/java/com/aliyun/api/gateway/demo/util/HttpUtils.java * ä¸‹è½½ * * ç›¸åº”çš„ä¾èµ–è¯·å‚ç…§ * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/pom.xml */ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318package com.atguigu.gulimall.thirdparty.utils;import org.apache.commons.lang.StringUtils;import org.apache.http.HttpResponse;import org.apache.http.NameValuePair;import org.apache.http.client.HttpClient;import org.apache.http.client.entity.UrlEncodedFormEntity;import org.apache.http.client.methods.HttpDelete;import org.apache.http.client.methods.HttpGet;import org.apache.http.client.methods.HttpPost;import org.apache.http.client.methods.HttpPut;import org.apache.http.conn.ClientConnectionManager;import org.apache.http.conn.scheme.Scheme;import org.apache.http.conn.scheme.SchemeRegistry;import org.apache.http.conn.ssl.SSLSocketFactory;import org.apache.http.entity.ByteArrayEntity;import org.apache.http.entity.StringEntity;import org.apache.http.impl.client.DefaultHttpClient;import org.apache.http.message.BasicNameValuePair;import javax.net.ssl.SSLContext;import javax.net.ssl.TrustManager;import javax.net.ssl.X509TrustManager;import java.io.UnsupportedEncodingException;import java.net.URLEncoder;import java.security.KeyManagementException;import java.security.NoSuchAlgorithmException;import java.security.cert.X509Certificate;import java.util.ArrayList;import java.util.List;import java.util.Map;public class HttpUtils &#123; /** * get * * @param host * @param path * @param method * @param headers * @param querys * @return * @throws Exception */ public static HttpResponse doGet(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpGet request = new HttpGet(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; return httpClient.execute(request); &#125; /** * post form * * @param host * @param path * @param method * @param headers * @param querys * @param bodys * @return * @throws Exception */ public static HttpResponse doPost(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys, Map&lt;String, String&gt; bodys) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpPost request = new HttpPost(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; if (bodys != null) &#123; List&lt;NameValuePair&gt; nameValuePairList = new ArrayList&lt;NameValuePair&gt;(); for (String key : bodys.keySet()) &#123; nameValuePairList.add(new BasicNameValuePair(key, bodys.get(key))); &#125; UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(nameValuePairList, &quot;utf-8&quot;); formEntity.setContentType(&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;); request.setEntity(formEntity); &#125; return httpClient.execute(request); &#125; /** * Post String * * @param host * @param path * @param method * @param headers * @param querys * @param body * @return * @throws Exception */ public static HttpResponse doPost(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys, String body) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpPost request = new HttpPost(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; if (StringUtils.isNotBlank(body)) &#123; request.setEntity(new StringEntity(body, &quot;utf-8&quot;)); &#125; return httpClient.execute(request); &#125; /** * Post stream * * @param host * @param path * @param method * @param headers * @param querys * @param body * @return * @throws Exception */ public static HttpResponse doPost(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys, byte[] body) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpPost request = new HttpPost(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; if (body != null) &#123; request.setEntity(new ByteArrayEntity(body)); &#125; return httpClient.execute(request); &#125; /** * Put String * * @param host * @param path * @param method * @param headers * @param querys * @param body * @return * @throws Exception */ public static HttpResponse doPut(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys, String body) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpPut request = new HttpPut(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; if (StringUtils.isNotBlank(body)) &#123; request.setEntity(new StringEntity(body, &quot;utf-8&quot;)); &#125; return httpClient.execute(request); &#125; /** * Put stream * * @param host * @param path * @param method * @param headers * @param querys * @param body * @return * @throws Exception */ public static HttpResponse doPut(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys, byte[] body) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpPut request = new HttpPut(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; if (body != null) &#123; request.setEntity(new ByteArrayEntity(body)); &#125; return httpClient.execute(request); &#125; /** * Delete * * @param host * @param path * @param method * @param headers * @param querys * @return * @throws Exception */ public static HttpResponse doDelete(String host, String path, String method, Map&lt;String, String&gt; headers, Map&lt;String, String&gt; querys) throws Exception &#123; HttpClient httpClient = wrapClient(host); HttpDelete request = new HttpDelete(buildUrl(host, path, querys)); for (Map.Entry&lt;String, String&gt; e : headers.entrySet()) &#123; request.addHeader(e.getKey(), e.getValue()); &#125; return httpClient.execute(request); &#125; private static String buildUrl(String host, String path, Map&lt;String, String&gt; querys) throws UnsupportedEncodingException &#123; StringBuilder sbUrl = new StringBuilder(); sbUrl.append(host); if (!StringUtils.isBlank(path)) &#123; sbUrl.append(path); &#125; if (null != querys) &#123; StringBuilder sbQuery = new StringBuilder(); for (Map.Entry&lt;String, String&gt; query : querys.entrySet()) &#123; if (0 &lt; sbQuery.length()) &#123; sbQuery.append(&quot;&amp;&quot;); &#125; if (StringUtils.isBlank(query.getKey()) &amp;&amp; !StringUtils.isBlank(query.getValue())) &#123; sbQuery.append(query.getValue()); &#125; if (!StringUtils.isBlank(query.getKey())) &#123; sbQuery.append(query.getKey()); if (!StringUtils.isBlank(query.getValue())) &#123; sbQuery.append(&quot;=&quot;); sbQuery.append(URLEncoder.encode(query.getValue(), &quot;utf-8&quot;)); &#125; &#125; &#125; if (0 &lt; sbQuery.length()) &#123; sbUrl.append(&quot;?&quot;).append(sbQuery); &#125; &#125; return sbUrl.toString(); &#125; private static HttpClient wrapClient(String host) &#123; HttpClient httpClient = new DefaultHttpClient(); if (host.startsWith(&quot;https://&quot;)) &#123; sslClient(httpClient); &#125; return httpClient; &#125; private static void sslClient(HttpClient httpClient) &#123; try &#123; SSLContext ctx = SSLContext.getInstance(&quot;TLS&quot;); X509TrustManager tm = new X509TrustManager() &#123; @Override public X509Certificate[] getAcceptedIssuers() &#123; return null; &#125; @Override public void checkClientTrusted(X509Certificate[] xcs, String str) &#123; &#125; @Override public void checkServerTrusted(X509Certificate[] xcs, String str) &#123; &#125; &#125;; ctx.init(null, new TrustManager[]&#123;tm&#125;, null); SSLSocketFactory ssf = new SSLSocketFactory(ctx); ssf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER); ClientConnectionManager ccm = httpClient.getConnectionManager(); SchemeRegistry registry = ccm.getSchemeRegistry(); registry.register(new Scheme(&quot;https&quot;, 443, ssf)); &#125; catch (KeyManagementException ex) &#123; throw new RuntimeException(ex); &#125; catch (NoSuchAlgorithmException ex) &#123; throw new RuntimeException(ex); &#125; &#125;&#125; HttpClientæ˜¯é˜¿é‡Œäº‘å·²ç»å°è£…å¥½çš„ é˜¿é‡Œäº‘æœçŸ­ä¿¡ï¼Œç„¶åæ‰¾åˆ°ä¸‹é¢çš„ç¬¬ä¸‰æ–¹æä¾›çš„æœåŠ¡ï¼Œä¸è¿‡æ¨¡æ¿è¦è”ç³»å®¢æœï¼Ÿæˆ‘ä¸ç†è§£ è¿™å—ä¸è®°å½•äº†ï¼ŒçŸ­ä¿¡è¿˜æ˜¯ç”¨ä¸äº† SmsComponent1234567891011121314151617181920212223242526272829303132333435363738@ConfigurationProperties(prefix = &quot;gulimall.alicloud.sms&quot;) // å¤–éƒ¨åŒ–é…ç½®@Component@Datapublic class SmsComponent &#123; private String host; private String path; private String appcode; // å‘é€çŸ­ä¿¡éªŒè¯ç  public void sendCode(String phone, String code) &#123; String method = &quot;POST&quot;; Map&lt;String, String&gt; headers = new HashMap&lt;String, String&gt;(); //æœ€ååœ¨headerä¸­çš„æ ¼å¼(ä¸­é—´æ˜¯è‹±æ–‡ç©ºæ ¼)ä¸ºAuthorization:APPCODE 83359fd73fe94948385f570e3c139105 headers.put(&quot;Authorization&quot;, &quot;APPCODE &quot; + appcode); Map&lt;String, String&gt; querys = new HashMap&lt;String, String&gt;(); querys.put(&quot;content&quot;, &quot;ã€gulimallã€‘ä½ çš„éªŒè¯ç æ˜¯ï¼š&quot; + code + &quot;ï¼Œ3åˆ†é’Ÿå†…æœ‰æ•ˆï¼&quot;); querys.put(&quot;mobile&quot;, phone); Map&lt;String, String&gt; bodys = new HashMap&lt;String, String&gt;(); try &#123; /** * é‡è¦æç¤ºå¦‚ä¸‹: * HttpUtilsè¯·ä» * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/src/main/java/com/aliyun/api/gateway/demo/util/HttpUtils.java * ä¸‹è½½ * * ç›¸åº”çš„ä¾èµ–è¯·å‚ç…§ * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/pom.xml */ HttpResponse response = HttpUtils.doPost(host, path, method, headers, querys, bodys); System.out.println(response.toString()); //è·å–responseçš„body //System.out.println(EntityUtils.toString(response.getEntity())); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; 1234567# è‡ªå®šä¹‰ çŸ­ä¿¡æœåŠ¡é…ç½®gulimall: alicloud: sms: host: https://cxwg.market.alicloudapi.com path: /sendSms appcode: ä½ è‡ªå·±çš„AppCode SmsSendController1234567891011121314151617@RestController@RequestMapping(&quot;/sms&quot;)public class SmsSendController &#123; @Autowired SmsComponent smsComponent; /* * æä¾›è°ƒç”¨æ¥å£ */ @GetMapping(&quot;/sms/sendCode&quot;) public R sendCode(@RequestParam(&quot;phone&quot;) String phone, @RequestParam(&quot;code&quot;) String code) &#123; smsComponent.sendCode(phone, code); return R.ok(); &#125;&#125; è¿œç¨‹è°ƒç”¨å‘é€çŸ­ä¿¡éªŒè¯ç æœåŠ¡ authæ¨¡å—è°ƒç”¨third-partæ¨¡å—çš„çŸ­ä¿¡æœåŠ¡ ThirdPartFeignService12345678910111213141516package com.atguigu.gulimall.auth.feign;import com.atguigu.common.utils.R;import org.springframework.cloud.openfeign.FeignClient;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestParam;/* * ç¬¬ä¸‰æ–¹æœåŠ¡çš„è¿œç¨‹æ¥å£ */@FeignClientpublic interface ThirdPartFeignService &#123; // è¿œç¨‹è°ƒç”¨å‘é€çŸ­ä¿¡éªŒè¯ç æœåŠ¡ @GetMapping(&quot;/sms/sendCode&quot;) R sendCode(@RequestParam(&quot;phone&quot;) String phone, @RequestParam(&quot;code&quot;) String code);&#125; LoginController12345678910111213@RestControllerpublic class LoginController &#123; @Autowired ThirdPartFeignService thirdPartFeignService; @ResponseBody @GetMapping(&quot;/sms/sendcode&quot;) public R sendCode(@RequestParam(&quot;phone&quot;) String phone) &#123; // éšæœºç”ŸæˆéªŒè¯ç  String code = UUID.randomUUID().toString().substring(0, 5); thirdPartFeignService.sendCode(phone, code); return R.ok(); &#125;&#125; éªŒè¯ç é˜²åˆ·éªŒè¯ é˜²åˆ·+æ ¡éªŒæ—¶é—´ ä½¿ç”¨rediså¹¶é…ç½®å¥½åœ°å€ 12345678910111213141516171819202122232425262728293031@RestControllerpublic class LoginController &#123; @Autowired ThirdPartFeignService thirdPartFeignService; @Autowired StringRedisTemplate redisTemplate; @ResponseBody @GetMapping(&quot;/sms/sendcode&quot;) public R sendCode(@RequestParam(&quot;phone&quot;) String phone) &#123; // åˆ¤æ–­redisä¸­æ˜¯å¦æœ‰è¯¥æ‰‹æœºå·çš„éªŒè¯ç ï¼Œå¹¶ä¸”åœ¨è¿‡æœŸæ—¶é—´å†… String existCode = redisTemplate.opsForValue().get(AuthServerConstant.SMS_CODE_CACHE_PREDIX + phone); if (!StringUtils.isEmpty(existCode)) &#123; long preTime = Long.parseLong(existCode.split(&quot;_&quot;)[1]); if ((System.currentTimeMillis() - preTime) &lt; 60000) &#123; // å­˜åœ¨å°äºå…­åç§’ï¼Œä¸èƒ½å†å‘éªŒè¯ç  return R.error(BizCodeEnum.SMS_CODE_EXCEPTION.getCode(), BizCodeEnum.SMS_CODE_EXCEPTION.getMsg()); &#125; &#125; // éšæœºç”ŸæˆéªŒè¯ç +ç³»ç»Ÿæ—¶é—´ï¼Œé˜²åˆ· String code = UUID.randomUUID().toString().substring(0, 5); // å­˜å…¥redis(key:value == prefix+phone:code)ï¼Œå¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ redisTemplate.opsForValue().set(AuthServerConstant.SMS_CODE_CACHE_PREDIX + phone, code + &quot;_&quot; + System.currentTimeMillis(), 10, TimeUnit.MINUTES); // å‘é€çŸ­ä¿¡ thirdPartFeignService.sendCode(phone, code); return R.ok(); &#125;&#125; è®¤è¯æœåŠ¡ - æ³¨å†Œ ä½¿ç”¨JSR303æ ¡éªŒ Authæ¨¡å—UserRegistVo123456789101112131415161718@Datapublic class UserRegistVo &#123; // JSR303æ ¡éªŒ @NotEmpty(message = &quot;ç”¨æˆ·åå¿…é¡»æäº¤&quot;) @Length(min = 6, max = 18, message = &quot;ç”¨æˆ·åå¿…é¡»æ˜¯6-18ä½å­—ç¬¦&quot;) private String userName; @NotEmpty(message = &quot;å¯†ç å¿…é¡»å¡«å†™&quot;) @Length(min = 6, max = 18, message = &quot;å¯†ç å¿…é¡»æ˜¯6-18ä½å­—ç¬¦&quot;) private String password; @NotEmpty(message = &quot;æ‰‹æœºå·å¿…é¡»å¡«å†™&quot;) @Pattern(regexp = &quot;^[1]([3-9])[0-9]&#123;9&#125;$&quot;, message = &quot;æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®&quot;) private String phone; @NotEmpty(message = &quot;éªŒè¯ç å¿…é¡»å¡«å†™&quot;) private String code;&#125; MemberFeignService12345678@FeignClient(&quot;gulimall-member&quot;)public interface MemberFeignService &#123; /** * æ³¨å†Œä¼šå‘˜ */ @PostMapping(&quot;/member/member/regist&quot;) R regist(@RequestBody UserRegistVo registVo);&#125; LoginController1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@PostMapping(&quot;/regist&quot;)public String register(@Valid UserRegistVo vo, BindingResult bindingResult, RedirectAttributes attributes) &#123; if (bindingResult.hasErrors()) &#123; Map&lt;String, String&gt; errors = bindingResult.getFieldErrors().stream().collect(Collectors.toMap(FieldError::getField, FieldError::getDefaultMessage)); // æ ¡éªŒæœ‰é”™è¯¯ // RedirectAttributes ç”¨äºé‡å®šå‘å¸¦æ•°æ® attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/reg.html&quot;; &#125; // è¿œç¨‹æ³¨å†ŒæœåŠ¡ // 1 æ ¡éªŒéªŒè¯ç  String inputCode = vo.getCode(); String existCode = redisTemplate.opsForValue().get(AuthServerConstant.SMS_CODE_CACHE_PREDIX + vo.getPhone()); if (!StringUtils.isEmpty(existCode)) &#123; if (inputCode.equals(existCode.split(&quot;_&quot;)[0])) &#123; // éªŒè¯ç æ­£ç¡® // åˆ é™¤éªŒè¯ç  redisTemplate.delete(AuthServerConstant.SMS_CODE_CACHE_PREDIX + vo.getPhone()); // è¿œç¨‹è°ƒç”¨ä¼šå‘˜æœåŠ¡ R r = memberFeignService.regist(vo); if (r.getCode() == 0) &#123; // æ³¨å†ŒæˆåŠŸ return &quot;redirect:http://auth.gulimall.com/login.html&quot;; &#125; else &#123; // è¿œç¨‹æœåŠ¡å¼‚å¸¸ Map&lt;String, String&gt; errors = new HashMap&lt;String, String&gt;(); errors.put(&quot;msg&quot;, r.getMsg()); attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/reg.html&quot;; &#125; &#125; else &#123; // éªŒè¯ç é”™è¯¯ Map&lt;String, String&gt; errors = new HashMap&lt;String, String&gt;(); errors.put(&quot;code&quot;, &quot;éªŒè¯ç é”™è¯¯&quot;); attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/reg.html&quot;; &#125; &#125; else &#123; // ä¸å­˜åœ¨éªŒè¯ç  Map&lt;String, String&gt; errors = new HashMap&lt;String, String&gt;(); errors.put(&quot;code&quot;, &quot;éªŒè¯ç é”™è¯¯&quot;); attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/reg.html&quot;; &#125;&#125; Memberæ¨¡å—MemberController123456789101112131415161718192021@RestController@RequestMapping(&quot;member/member&quot;)public class MemberController &#123; @Autowired private MemberService memberService; /** * æ³¨å†Œä¼šå‘˜ */ @PostMapping(&quot;/regist&quot;) public R regist(@RequestBody UserRegistVo registVo) &#123; try &#123; // å¯èƒ½ä¼šæŠ›å·²å­˜åœ¨çš„å¼‚å¸¸ memberService.regist(registVo); &#125; catch (PhoneExistException e) &#123; return R.error(BizCodeEnum.PHONE_EXIST_EXCEPTION.getCode(), BizCodeEnum.PHONE_EXIST_EXCEPTION.getMsg()); &#125; catch (UsernameExistException e) &#123; return R.error(BizCodeEnum.USERNAME_EXIST_EXCEPTION.getCode(), BizCodeEnum.USERNAME_EXIST_EXCEPTION.getMsg()); &#125; return R.ok(); &#125; MemberServiceImpl123456789101112131415161718192021222324252627282930313233343536373839404142@Service(&quot;memberService&quot;)public class MemberServiceImpl extends ServiceImpl&lt;MemberDao, MemberEntity&gt; implements MemberService &#123; @Autowired MemberLevelService levelService; @Override public void regist(UserRegistVo registVo) &#123; // æ£€æŸ¥ç”¨æˆ·åå’Œæ‰‹æœºå·çš„å”¯ä¸€æ€§ MemberEntity member = new MemberEntity(); member.setUsername(registVo.getUserName()); member.setMobile(registVo.getPhone()); member.setLevelId(levelService.getDefaultLevel().getId()); // åˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨ checkPhoneUnique(registVo.getPhone()); checkUsernameUnique(registVo.getUserName()); // åŠ å¯† BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder(); member.setPassword(passwordEncoder.encode(registVo.getPassword())); baseMapper.insert(member); &#125; @Override public void checkPhoneUnique(String phone) throws PhoneExistException &#123; Integer mobile = baseMapper.selectCount(new QueryWrapper&lt;MemberEntity&gt;().eq(&quot;mobile&quot;, phone)); if (mobile &gt; 0) &#123; throw new PhoneExistException(); &#125; &#125; @Override public void checkUsernameUnique(String username) throws UsernameExistException &#123; Integer existUsername = baseMapper.selectCount(new QueryWrapper&lt;MemberEntity&gt;().eq(&quot;username&quot;, username)); if (existUsername &gt; 0) &#123; throw new UsernameExistException(); &#125; &#125;&#125; å¼‚å¸¸æœºåˆ¶å¼‚å¸¸ç±»UsernameExistException12345public class UsernameExistException extends RuntimeException &#123; public UsernameExistException() &#123; super(&quot;ç”¨æˆ·åå·²å­˜åœ¨&quot;); &#125;&#125; å¼‚å¸¸ç±»PhoneExistException12345public class PhoneExistException extends RuntimeException &#123; public PhoneExistException() &#123; super(&quot;æ‰‹æœºå·å·²å­˜åœ¨&quot;); &#125;&#125; MD5ç›å€¼åŠ å¯† MD5å¯ä»¥ä½¿ç”¨å½©è™¹è¡¨æš´åŠ›ç ´è§£ï¼Œæ‰€ä»¥éœ€è¦åŠ ç› è®¤è¯æœåŠ¡ - è´¦å·ç™»å½•Authæ¨¡å—UserLoginVo12345@Datapublic class UserLoginVo &#123; private String loginacct; private String password;&#125; MemberFeignService1234567891011121314@FeignClient(&quot;gulimall-member&quot;)public interface MemberFeignService &#123; /** * æ³¨å†Œä¼šå‘˜ */ @PostMapping(&quot;/member/member/regist&quot;) R regist(@RequestBody UserRegistVo registVo); /** * ä¼šå‘˜ç™»å½• */ @PostMapping(&quot;/member/member/login&quot;) R login(@RequestBody UserLoginVo loginVo);&#125; LoginController1234567891011121314151617181920@PostMapping(&quot;/login&quot;)public String login(UserLoginVo vo, RedirectAttributes attributes) &#123; R r = memberFeignService.login(vo); if (r.getCode() == 0) &#123; // ç™»å½•æˆåŠŸ // rå–å‡ºæ¥çš„å€¼ä¸ºmapç±»å‹ï¼Œmap -&gt; json -&gt; bean String memberJSON = JSONObject.toJSONString(r.get(&quot;member&quot;)); MemberEntityVo memberEntityVo = JSON.parseObject(memberJSON, MemberEntityVo.class); log.info(&quot;ç™»é™†æˆåŠŸï¼Œç”¨æˆ·ï¼š&#123;&#125;&quot;, memberJSON); // ä¿å­˜ç”¨æˆ·ä¿¡æ¯è‡³session,æ³¨æ„è¿™é‡Œå¯¹è±¡çš„ç±»å¿…é¡»å®ç°åºåˆ—åŒ–ï¼Œæ‰èƒ½ä¿å­˜åˆ°redisä¸­ session.setAttribute(AuthServerConstant.LOGIN_USER, memberEntityVo); return &quot;redirect:http://gulimall.com&quot;; &#125; else &#123; // è´¦å·æˆ–å¯†ç é”™è¯¯ Map&lt;String, String&gt; errors = new HashMap&lt;String, String&gt;(); errors.put(&quot;msg&quot;, r.getMsg()); attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/login.html&quot;; &#125;&#125; Memberæ¨¡å—MemberController1234567891011/** * ä¼šå‘˜ç™»å½• */@PostMapping(&quot;/login&quot;)public R login(@RequestBody UserLoginVo loginVo) &#123; MemberEntity member = memberService.login(loginVo); if (member == null) &#123; return R.error(BizCodeEnum.LOGIN_FAILED_EXCEPTION.getCode(), BizCodeEnum.LOGIN_FAILED_EXCEPTION.getMsg()); &#125; return R.ok().put(&quot;member&quot;, member);&#125; MemberServiceImpl123456789101112131415@Overridepublic MemberEntity login(UserLoginVo loginVo) &#123; String loginacct = loginVo.getLoginacct(); String password = loginVo.getPassword(); MemberEntity member = baseMapper.selectOne(new QueryWrapper&lt;MemberEntity&gt;().eq(&quot;username&quot;, loginacct).or().eq(&quot;mobile&quot;, loginacct)); if (member != null) &#123; // åˆ¤æ–­å¯†ç æ˜¯å¦åŒ¹é… BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder(); boolean matches = passwordEncoder.matches(password, member.getPassword()); return matches ? member : null; &#125; else &#123; // è¯¥è´¦å·ä¸å­˜åœ¨ return null; &#125;&#125; è®¤è¯æœåŠ¡ - ç¤¾äº¤ç™»å½•OAuth2 OAuthï¼š OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰ æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œ å…è®¸ç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®ä»–ä»¬å­˜å‚¨åœ¨å¦å¤–çš„æœåŠ¡æä¾›è€…ä¸Šçš„ä¿¡æ¯ï¼Œ è€Œä¸éœ€è¦å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹ç½‘ç«™æˆ–åˆ†äº«ä»–ä»¬æ•°æ®çš„æ‰€æœ‰å†…å®¹ã€‚ OAuth2.0ï¼š å¯¹äºç”¨æˆ·ç›¸å…³çš„ OpenAPIï¼ˆä¾‹å¦‚è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œ åŠ¨æ€åŒæ­¥ï¼Œ ç…§ç‰‡ï¼Œ æ—¥å¿—ï¼Œ åˆ†äº«ç­‰ï¼‰ ï¼Œ ä¸ºäº†ä¿æŠ¤ç”¨æˆ·æ•°æ®çš„å®‰å…¨å’Œéšç§ï¼Œ ç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®ç”¨æˆ·æ•°æ®å‰éƒ½éœ€è¦æ˜¾å¼çš„å‘ç”¨æˆ·å¾æ±‚æˆæƒ giteeæˆæƒç™»å½•æ¥å£æµ‹è¯• giteeè¿›å…¥ä¿®æ”¹èµ„æ–™ -&gt; ç¬¬ä¸‰æ–¹åº”ç”¨ -&gt; åˆ›å»ºåº”ç”¨ï¼Œç„¶åæ ¹æ®æ–‡æ¡£æ“ä½œå³å¯ã€‚ Gitee OAuth æ–‡æ¡£ GiteeUserVo12345678910@Datapublic class GiteeUserVo &#123; private String access_token; private String token_type; private long expires_in; private String refresh_token; private String scope; private long created_at; private String uid;&#125; MemberServiceImpl12345678910111213141516171819202122@Overridepublic MemberEntity giteeLogin(GiteeUserVo loginVo, JSONObject userInfoJson) &#123; // åˆ¤æ–­å½“å‰ç¤¾äº¤ç”¨æˆ·æ˜¯å¦æ›¾æ³¨å†Œè¿‡ï¼ˆæ ¹æ®uidåˆ¤æ–­ï¼‰ MemberEntity selectMember = baseMapper.selectOne(new QueryWrapper&lt;MemberEntity&gt;().eq(&quot;gitee_uid&quot;, loginVo.getGitee_uid())); if (selectMember != null) &#123; // è¯¥ç”¨æˆ·å·²æ³¨å†Œï¼Œæ›´æ¢ä»¤ç‰Œå’Œè¿‡æœŸæ—¶é—´ selectMember.setAccessToken(selectMember.getAccessToken()); selectMember.setExpiresIn(selectMember.getExpiresIn()); baseMapper.updateById(selectMember); return selectMember; &#125; else &#123; // è·å–æˆæƒç”¨æˆ·çš„ä¿¡æ¯å­˜å…¥è‡ªå·±çš„æ•°æ®åº“ MemberEntity registMember = new MemberEntity(); registMember.setUsername((String) userInfoJson.get(&quot;name&quot;)); registMember.setLevelId(levelService.getDefaultLevel().getId()); registMember.setGiteeUid(userInfoJson.getString(&quot;id&quot;)); registMember.setAccessToken(loginVo.getAccess_token()); registMember.setExpiresIn(loginVo.getExpires_in()); baseMapper.insert(registMember); return registMember; &#125;&#125; MemberController1234567891011/** * giteeä¼šå‘˜ç™»å½• */@PostMapping(&quot;/giteelogin&quot;)public R loginOAuth(@RequestBody GiteeUserVo loginVo, JSONObject userInfoJson) &#123; MemberEntity member = memberService.giteeLogin(loginVo, userInfoJson); if (member == null) &#123; return R.error(BizCodeEnum.LOGIN_FAILED_EXCEPTION.getCode(), BizCodeEnum.LOGIN_FAILED_EXCEPTION.getMsg()); &#125; return R.ok().put(&quot;member&quot;, member);&#125; MemberFeignService12345678@FeignClient(&quot;gulimall-member&quot;)public interface MemberFeignService &#123; /** * giteeä¼šå‘˜ç™»å½• */ @PostMapping(&quot;/member/member/giteelogin&quot;) R loginOAuth(@RequestBody GiteeUserVo loginVo, JSONObject userInfoJson);&#125; OAuth2Controller12345678910111213141516171819202122232425262728293031323334@GetMapping(&quot;/oauth2/gitee/success&quot;)public String gitee(@RequestParam(&quot;code&quot;) String code, RedirectAttributes attributes) throws Exception &#123; // æ ¹æ®codeæˆæƒç è·å–token Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); map.put(&quot;grant_type&quot;, &quot;authorization_code&quot;); map.put(&quot;code&quot;, code); map.put(&quot;client_id&quot;, &quot;&quot;); map.put(&quot;redirect_uri&quot;, &quot;http://auth.gulimall.com/oauth2/gitee/success&quot;); map.put(&quot;client_secret&quot;, &quot;&quot;); HttpResponse response = HttpUtils.doPost(&quot;https://gitee.com&quot;, &quot;/oauth/token&quot;, &quot;post&quot;, new HashMap&lt;&gt;(), new HashMap&lt;&gt;(), map); // æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯ if (response.getStatusLine().getStatusCode() == 200) &#123; // è·å–æˆåŠŸ String json = EntityUtils.toString(response.getEntity()); GiteeUserVo giteeUserVo = JSON.parseObject(json, GiteeUserVo.class); // å¦‚æœè¯¥ç”¨æˆ·ç¬¬ä¸€æ¬¡è¿›å…¥ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆè´¦å·ï¼Œå¦åˆ™ç™»å½• HttpResponse userInfoResponse = HttpUtils.doPost(&quot;https://gitee.com&quot;, &quot;/api/v5/user&quot;, &quot;get&quot;, new HashMap&lt;&gt;(), new HashMap&lt;&gt;(), new HashMap&lt;String, String&gt;().put(&quot;access_token&quot;, giteeUserVo.getAccess_token())); if (userInfoResponse.getStatusLine().getStatusCode() == 200) &#123; JSONObject userInfoJson = JSON.parseObject(EntityUtils.toString(userInfoResponse.getEntity())); R r = memberFeignService.loginOAuth(giteeUserVo, userInfoJson); if (r.getCode() == 0) &#123; // è·å¾—ç™»å½•åçš„memberå¯¹è±¡ MemberEntityVo member = (MemberEntityVo) r.get(&quot;member&quot;); log.info(&quot;ç™»é™†æˆåŠŸï¼Œç”¨æˆ·ï¼š&#123;&#125;&quot;, member.toString()); return &quot;redirect:http://gulimall.com&quot;; &#125; &#125; &#125; Map&lt;String, String&gt; errors = new HashMap&lt;String, String&gt;(); errors.put(&quot;msg&quot;, &quot;æˆæƒç™»å½•å¤±è´¥&quot;); attributes.addFlashAttribute(&quot;errors&quot;, errors); return &quot;redirect:http://auth.gulimall.com/login.html&quot;;&#125; TODO giteeæ ¹æ®tokenè·å–userInfoè¢«æ‹’ç»äº†ï¼Œ405not allowedï¼Œä¸æ¸…æ¥šä¸ºå•¥ï¼Œä½†æ˜¯postmanå°±èƒ½è¡Œï¼Œå¯èƒ½å’ŒhttpClientæœ‰å…³ TODO postè¯·æ±‚ä¸èƒ½å¤šä¸ªrequestbodyï¼Œæ‰€ä»¥æˆ‘æŠŠè·å–userinfoæ”¾åˆ°äº†memberserviceä¸­ï¼Œåªéœ€è¦ä¼ ä¸€ä¸ªgiteeUserVoå³å¯ è®¤è¯æœåŠ¡ - ç™»å½•åˆ¤æ–­ ä½¿ç”¨sessionï¼Œå¦‚æœä¸ç”¨sessionçš„è¯å‚è€ƒä¸Šä¸€ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨jwt token åˆ†å¸ƒå¼ä¸‹çš„sessionåˆ†å¸ƒå¼ä¸‹sessioné—®é¢˜ åˆ†å¸ƒå¼ä¸‹sessionè§£å†³æ–¹æ³• sessionå¤åˆ¶ å®¢æˆ·ç«¯å­˜å‚¨ hashä¸€è‡´æ€§ ç»Ÿä¸€å­˜å‚¨ ä¸åŒæœåŠ¡ï¼Œå­åŸŸsessionå…±äº« SpringSession Spring Session - Spring Boot :: Spring Session ä¾èµ– é…ç½®1234567&lt;dependencies&gt;&lt;!-- spring session --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.session&lt;/groupId&gt; &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 1234spring.session.store-type=redis # Session store type.spring.redis.host=localhost # Redis server host.spring.redis.password= # Login password of the redis server.spring.redis.port=6379 # Redis server port. 12@EnableRedisHttpSession // å¼€å¯spring sessionpublic class GulimallAuthServerApplication &#123; ç®€å•ä½¿ç”¨123456// rå–å‡ºæ¥çš„å€¼ä¸ºmapç±»å‹ï¼Œmap -&gt; json -&gt; beanString memberJSON = JSONObject.toJSONString(r.get(&quot;member&quot;));MemberEntityVo memberEntityVo = JSON.parseObject(memberJSON, MemberEntityVo.class);log.info(&quot;ç™»é™†æˆåŠŸï¼Œç”¨æˆ·ï¼š&#123;&#125;&quot;, memberJSON);// ä¿å­˜ç”¨æˆ·ä¿¡æ¯è‡³session,æ³¨æ„è¿™é‡Œå¯¹è±¡çš„ç±»å¿…é¡»å®ç°åºåˆ—åŒ–ï¼Œæ‰èƒ½ä¿å­˜åˆ°redisä¸­session.setAttribute(&quot;loginUser&quot;, memberEntityVo); Cannot deserialize; nested exception is org.springframework.core.serializer.support.SerializationFailedException: æ¸…ç©ºredis è‡ªå®šä¹‰SpringSessioné…ç½® ç”¨äºæ”¾å¤§ä½œç”¨åŸŸï¼Œä½¿å¾—è·¨åŸŸçš„æ—¶å€™è¿˜èƒ½ä½¿ç”¨sessionä¸­çš„å†…å®¹ æ”¾åˆ°commoné‡Œ 12345678910111213141516171819202122@Configuration@EnableRedisHttpSession // å¼€å¯spring sessionpublic class MySessionConfig &#123; /* * é…ç½®cookieçš„ç›¸å…³ä¿¡æ¯ï¼šä½œç”¨åŸŸå’Œåå­— */ @Bean public CookieSerializer cookieSerializer() &#123; DefaultCookieSerializer cookieSerializer = new DefaultCookieSerializer(); cookieSerializer.setDomainName(&quot;gulimall.com&quot;); cookieSerializer.setCookieName(&quot;GULIMALL_SESSION&quot;); return cookieSerializer; &#125; @Bean public RedisSerializer&lt;Object&gt; redisSerializer() &#123; GenericJackson2JsonRedisSerializer redisSerializer = new GenericJackson2JsonRedisSerializer(); return redisSerializer; &#125;&#125; åŸç† @EnableRedisHttpSessionå¯¼å…¥RedisHttpSessionConfigurationé…ç½® ç»™å®¹å™¨ä¸­æ·»åŠ äº†ä¸€ä¸ªç»„ä»¶SessionRepository ==&gt; RedisOperationsSessionRepository ==&gt; redisæ“ä½œsessionã€‚sessionçš„å¢åˆ æ”¹æŸ¥å°è£…ç±» SessionRepositoryFilter ==&gt; Filterï¼š sessionâ€™å­˜å‚¨è¿‡æ»¤å™¨ï¼›æ¯ä¸ªè¯·æ±‚è¿‡æ¥éƒ½å¿…é¡»ç»è¿‡filter åœ¨requestä¸­å­˜å…¥SessionRepository requestï¼Œresponseéƒ½è¢«åŒ…è£…ã€‚SessionRepositoryRequestWrapperï¼ŒSessionRepositoryResponseWrapper (è£…é¥°è€…æ¨¡å¼) æ”¾è¡Œfilteræ”¾çš„æ˜¯åŒ…è£…è¿‡çš„è¯·æ±‚å“åº” è·å–sessionä½¿ç”¨request.getSession() //å³åŒ…è£…åçš„SessionRepositoryRequestWrapper wrappedRequest.getSession(); ==&gt; æ˜¯é‡å†™çš„æ–¹æ³•ï¼Œå…ˆè·å–SessionRepository ï¼Œä»SessionRepository ä¸­è·å–ä¹‹å‰å­˜å…¥çš„sessionå†…å®¹ã€‚ ç™»å½•åˆ¤æ–­ è®°å¾—æŠŠwebConfigä¸­çš„æ˜ å°„å…³äº† 123456789/* * å‰å¾€ç™»å½•é¡µå‰åˆ¤æ–­æ˜¯å¦å·²ç»ç™»å½• */@GetMapping(&quot;/login.html&quot;)public String loginPage(HttpSession session) &#123; // å¦‚æœç™»é™†è¿‡äº†å°±è·³è¿‡ Object attribute = session.getAttribute(AuthServerConstant.LOGIN_USER); return attribute == null ? &quot;login&quot; : &quot;redirect:http://gulimall.com&quot;;&#125; TODO è¿™é‡Œè¦å»åˆ«çš„æ¨¡å—é‡å¤spring sessionçš„æ“ä½œï¼ˆæ‰€ä»¥thymeleafä¸è¡Œï¼Œè¿™äº›éƒ½æ˜¯æŠ½å–å‡ºæ¥å¥½ï¼‰ å•ç‚¹ç™»å½• å¤šç³»ç»Ÿä¸‹åªéœ€ä¸€æ¬¡ç™»å½• å¼€æºæ¡†æ¶ xxl-sso xxl-sso: ä¸€ä¸ªåˆ†å¸ƒå¼å•ç‚¹ç™»å½•æ¡†æ¶ã€‚åªéœ€è¦ç™»å½•ä¸€æ¬¡å°±å¯ä»¥è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚ æ‹¥æœ‰â€è½»é‡çº§ã€åˆ†å¸ƒå¼ã€è·¨åŸŸã€Cookie+Tokenå‡æ”¯æŒã€Web+APPå‡æ”¯æŒâ€ç­‰ç‰¹æ€§ï¼›ã€‚ç°å·²å¼€æ”¾æºä»£ç ï¼Œå¼€ç®±å³ç”¨ã€‚ (gitee.com) é…ç½® æ‰“åŒ…ï¼šxxl-sso-master&gt;mvn clean package -Dmaven.skip.test=true æ¸…æ¥šåŒ…ï¼šxxl-sso-master&gt;mvn clean package -Dmaven.skip.test=true å¯åŠ¨æœåŠ¡ï¼šxxl-sso-master\\xxl-sso-server\\target&gt;java -jar xxl-sso-server-1.1.1-SNAPSHOT.jar è´­ç‰©è½¦ç¯å¢ƒæ­å»º æ¨¡å— host templateã€é™æ€èµ„æº ç½‘å…³ ç«¯å£ã€æ³¨å†Œä¸­å¿ƒ æ•°æ®æ¨¡å‹åˆ†æ ç™»å½•ã€æœªç™»å½•è´­ç‰©è½¦ï¼ˆduckä¸å¿…ï¼‰ ç™»å½•åä¼šå°†ä¸´æ—¶è´­ç‰©è½¦çš„æ•°æ®åˆå¹¶åˆ°ç™»å½•åçš„è´¦å·ä¸­ ä¸´æ—¶è´­ç‰©è½¦çš„æ•°æ®åœ¨æµè§ˆå™¨é‡å¯åä»å­˜åœ¨ é‡‡ç”¨redis CartItemVo123456789101112131415@Datapublic class CartItemVo &#123; private Long skuId; private Boolean check = true; private String title; private String image; private List&lt;String&gt; skuAttr; private BigDecimal price; private Integer count; private BigDecimal totalPrice; public BigDecimal getTotalPrice() &#123; return this.price.multiply(new BigDecimal(this.count)); &#125;&#125; CartVo1234567891011121314151617181920212223242526272829303132333435@Datapublic class CartVo &#123; private List&lt;CartItemVo&gt; items; private Integer countNum; // å•†å“æ€»æ•° private Integer countType; // å•†å“ç±»å‹æ•° private BigDecimal totalPrice; // æ€»åŸä»·æ ¼ä»·-ä¼˜æƒ ä»· private BigDecimal reduce = new BigDecimal(0); // ä¼˜æƒ ä»· public Integer getCountNum() &#123; int count = 0; if (items != null &amp;&amp; items.size() &gt; 0) &#123; for (CartItemVo item : items) &#123; count += item.getCount(); &#125; &#125; return count; &#125; public Integer getCountType() &#123; return items.size(); &#125; public BigDecimal getTotalPrice() &#123; BigDecimal price = new BigDecimal(0); if (items != null &amp;&amp; items.size() &gt; 0) &#123; for (CartItemVo item : items) &#123; if (item.getCheck()) &#123; price = price.add(item.getTotalPrice()); &#125; &#125; &#125; price = price.subtract(getReduce()); return price; &#125;&#125; ThreadLocalç”¨æˆ·èº«ä»½é‰´åˆ« åŒä¸€ä¸ªçº¿ç¨‹å…±äº«æ•°æ® CartWebConfig1234567891011@Configurationpublic class CartWebConfig implements WebMvcConfigurer &#123; /* * æ·»åŠ æ‹¦æˆªå™¨ * é…ç½®æ‹¦æˆªåœ°å€ */ @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new CartInterceptor()).addPathPatterns(&quot;/**&quot;); &#125;&#125; CartInterceptor12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/* * åˆ¤æ–­ç™»å½•çŠ¶æ€ï¼Œå¹¶å°è£…ä¼ é€’ç»™controller */@Componentpublic class CartInterceptor implements HandlerInterceptor &#123; public static ThreadLocal&lt;UserInfoTo&gt; threadLocal = new ThreadLocal&lt;&gt;(); /* * åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‹¦æˆª */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; UserInfoTo userInfoTo = new UserInfoTo(); // å­˜å…¥user-key Cookie[] cookies = request.getCookies(); if (cookies != null &amp;&amp; cookies.length &gt; 0) &#123; for (Cookie cookie : cookies) &#123; // åˆ¤æ–­å½“å‰cookieæ˜¯å¦ä¸ºuser-keyï¼Œæ˜¯åˆ™å­˜å…¥ThreadLocal if (cookie.getName().equals(AuthServerConstant.TEMP_USER_COOKIE_NAME)) &#123; userInfoTo.setUserKey(cookie.getValue()); // å½“å‰cookieå­˜åœ¨user-key userInfoTo.setAlreadySet(true); break; &#125; &#125; &#125; // å¦‚æœæ²¡æœ‰user-keyï¼Œä¿å­˜ä¸€ä¸ªä¸´æ—¶ç”¨æˆ· if (StringUtils.isEmpty(userInfoTo.getUserKey())) &#123; String uuid = UUID.randomUUID().toString(); userInfoTo.setUserKey(uuid); &#125; // å¦‚æœç™»é™†äº†å­˜å…¥userId MemberEntityVo loginUser = (MemberEntityVo) request.getSession().getAttribute(AuthServerConstant.LOGIN_USER); if (loginUser != null) &#123; // å·²ç™»å½• userInfoTo.setUserId(loginUser.getId()); &#125; // å°†ä¿¡æ¯å­˜å…¥threadLocal threadLocal.set(userInfoTo); return true; &#125; /* * ä¸šåŠ¡æ‰§è¡Œä¹‹å */ @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; // åªå­˜ä¸€æ¬¡cookieå³å¯ if (!threadLocal.get().isAlreadySet()) &#123; // ä¿å­˜ä¸€ä¸ªcookieï¼Œå­˜å‚¨user-keyï¼Œæ—¶é—´ä¸€ä¸ªæœˆ Cookie cookie = new Cookie(AuthServerConstant.TEMP_USER_COOKIE_NAME, threadLocal.get().getUserKey()); cookie.setDomain(ServerConstant.COOKIE_SERVER_DOMAIN); cookie.setMaxAge(ServerConstant.COOKIE_MAX_AGE); response.addCookie(cookie); &#125; &#125;&#125; æ·»åŠ å•†å“SkuInfoFeignService12345678@FeignClient(&quot;gulimall-product&quot;)public interface SkuInfoFeignService &#123; @RequestMapping(&quot;/product/skuinfo/info/&#123;skuId&#125;&quot;) R info(@PathVariable(&quot;skuId&quot;) Long skuId); @RequestMapping(&quot;/product/skusaleattrvalue/list/&#123;skuId&#125;&quot;) List&lt;String&gt; getSkuSaleAttrList(@PathVariable(&quot;skuId&quot;) String skuId);&#125; SkuSaleAttrValueDao12345&lt;select id=&quot;getSkuSaleAttrList&quot; resultType=&quot;java.lang.String&quot;&gt; select concat(attr_name, &quot;:&quot;, attr_value) from gulimall_pms.pms_sku_sale_attr_value where sku_id = #&#123;skuId&#125;;&lt;/select&gt; CartController123456789101112131415@Controllerpublic class CartController &#123; @Autowired CartService cartService; /* * æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ */ @GetMapping(&quot;/addToCart&quot;) public String addToCart(@RequestParam(&quot;skuId&quot;) Long skuId, @RequestParam(&quot;num&quot;) Integer num, Model model) &#123; CartItemVo cartItemVo = cartService.addToCart(skuId, num); model.addAttribute(&quot;item&quot;, cartItemVo); return &quot;success&quot;; &#125; CartServiceImpl1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@Service@Slf4jpublic class CartServiceImpl implements CartService &#123; @Autowired StringRedisTemplate redisTemplate; @Autowired SkuInfoFeignService skuInfoFeignService; @Autowired ThreadPoolExecutor executor; /* * æ·»åŠ å•†å“ */ @Override public CartItemVo addToCart(Long skuId, Integer num) throws ExecutionException, InterruptedException &#123; BoundHashOperations&lt;String, Object, Object&gt; cartOptions = getCartOptions(); String existSku = (String) cartOptions.get(skuId.toString()); if (StringUtils.isEmpty(existSku)) &#123; CartItemVo cartItemVo = new CartItemVo(); // å½“å‰è´­ç‰©åŸä¸­æ²¡æœ‰è¯¥å•†å“ç§ç±» CompletableFuture&lt;Void&gt; getSkuInfoTask = CompletableFuture.runAsync(() -&gt; &#123; // è¿œç¨‹è°ƒç”¨æŸ¥è¯¢å½“å‰skuä¿¡æ¯ R r = skuInfoFeignService.getSkuInfo(skuId); if (r.getCode() == 0) &#123; SkuInfoTo skuInfo = r.getData(&quot;skuInfo&quot;, new TypeReference&lt;SkuInfoTo&gt;() &#123; &#125;); // å°†å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦ cartItemVo.setCount(num); cartItemVo.setImage(skuInfo.getSkuDefaultImg()); cartItemVo.setTitle(skuInfo.getSkuTitle()); cartItemVo.setPrice(skuInfo.getPrice()); cartItemVo.setSkuId(skuInfo.getSkuId()); &#125; else &#123; log.info(&quot;è¿œç¨‹è°ƒç”¨å¤±è´¥&quot;); &#125; &#125;, executor); CompletableFuture&lt;Void&gt; getAttrTask = CompletableFuture.runAsync(() -&gt; &#123; // è·å–å½“å‰skuçš„ç»„åˆä¿¡æ¯? è¿™ä¸ªéš¾é“ä¸æ˜¯å‰ç«¯ä¼ å—ï¼Œç¦»è°± cartItemVo.setSkuAttr(skuInfoFeignService.getSkuSaleAttrList(skuId)); &#125;, executor); CompletableFuture.allOf(getAttrTask, getSkuInfoTask).get(); cartOptions.put(skuId.toString(), JSON.toJSONString(cartItemVo)); return cartItemVo; &#125; else &#123; // å·²ç»æœ‰è¯¥å•†å“ CartItemVo cartItemVo = JSON.parseObject(existSku, CartItemVo.class); cartItemVo.setCount(cartItemVo.getCount() + num); cartOptions.put(skuId.toString(), JSON.toJSONString(cartItemVo)); return cartItemVo; &#125; &#125; /* * ä»redisä¸­è·å–è¯¥è´­ç‰©è½¦ */ private BoundHashOperations&lt;String, Object, Object&gt; getCartOptions() &#123; String cartKey = &quot;&quot;; // redisä¸­çš„è´­ç‰©è½¦çš„key UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); // åˆ¤æ–­æ˜¯å¦ç™»å½• if (userInfoTo.getUserId() != null) &#123; // å·²ç™»å½• cartKey = CartConstant.CART_PREFIX + userInfoTo.getUserId(); &#125; else &#123; // æœªç™»å½• cartKey = CartConstant.CART_PREFIX + userInfoTo.getUserKey(); &#125; return redisTemplate.boundHashOps(cartKey); &#125;&#125; æ·»åŠ å•†å“åˆ·æ–°é˜²æ­¢å¤šæ¬¡æ·»åŠ CartController123456789101112131415161718192021/* * æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ */@GetMapping(&quot;/addToCart&quot;)public String addToCart(@RequestParam(&quot;skuId&quot;) Long skuId, @RequestParam(&quot;num&quot;) Integer num, RedirectAttributes attributes) throws ExecutionException, InterruptedException &#123; CartItemVo cartItemVo = cartService.addToCart(skuId, num); // ä½¿ç”¨RedirectAttributesï¼Œé˜²æ­¢ä½¿ç”¨modelï¼ˆmodelæ˜¯requeståŸŸï¼‰åé‡å®šå‘æ•°æ®ä¸¢å¤± // addAttributeèƒ½å¤Ÿå–å¤šæ¬¡ï¼ŒaddFlashAttributeåªèƒ½å–ä¸€æ¬¡ attributes.addAttribute(&quot;skuId&quot;, skuId); // é˜²æ­¢é¡µé¢åˆ·æ–°ï¼Œæ‰€ä»¥åˆ°successé¡µé¢åº”è¯¥æ˜¯æŸ¥æ“ä½œï¼Œå†è¿‡ä¸€ä¸ªè¯·æ±‚å³å¯ return &quot;redirect:http://cart.gulimall.com/addToCartSuccess.html&quot;;&#125;// è·³è½¬åˆ°æˆåŠŸé¡µé¢@GetMapping(&quot;/addToCartSuccess.html&quot;)public String addToCartSuccessPage(@RequestParam(&quot;skuId&quot;) Long skuId, Model model) &#123; // æŸ¥è¯¢è´­ç‰©è½¦ä¸­çš„skuIdå¯¹åº”ä¿¡æ¯ CartItemVo cartItemVo = cartService.getCatItem(skuId); model.addAttribute(&quot;item&quot;, cartItemVo); return &quot;success&quot;;&#125; CartServiceImpl12345678910/* * è·å–è´­ç‰©è½¦å•†å“ä¿¡æ¯ */@Overridepublic CartItemVo getCatItem(Long skuId) &#123; BoundHashOperations&lt;String, Object, Object&gt; cartOptions = getCartOptions(); String cartItemJSON = (String) cartOptions.get(skuId.toString()); CartItemVo cartItemVo = JSON.parseObject(cartItemJSON, CartItemVo.class); return cartItemVo;&#125; è·å–ã€åˆå¹¶è´­ç‰©è½¦cartListPage12345678@RequestMapping(&quot;/cart.html&quot;)public String cartListPage(Model model) throws ExecutionException, InterruptedException &#123; // é€šè¿‡threadLocalè·å¾—å½“å‰ç”¨æˆ·ä¿¡æ¯ // UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); CartEntity cart = cartService.getCart(); model.addAttribute(&quot;cart&quot;, cart); return &quot;cartList&quot;;&#125; CartServiceImpl123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960/* * è·å¾—è´­ç‰©è½¦ä¿¡æ¯ */@Overridepublic CartEntity getCart() throws ExecutionException, InterruptedException &#123; CartEntity cart = new CartEntity(); BoundHashOperations&lt;String, Object, Object&gt; cartFromRedis = getCartFromRedis(); // åˆ¤æ–­æ˜¯å¦ç™»å½• UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); List&lt;CartItemEntity&gt; cartItemByUserKey = getCartItem(CartConstant.CART_PREFIX + userInfoTo.getUserKey()); if (userInfoTo.getUserId() != null) &#123; // å·²ç™»å½• // åˆå¹¶è´­ç‰©è½¦ï¼ˆä½¿ç”¨addToCartå¸¦æœ‰åŒå•†å“çš„åˆ¤æ–­ï¼‰ for (CartItemEntity cartItem : cartItemByUserKey) &#123; addToCart(cartItem.getSkuId(), cartItem.getCount()); &#125; List&lt;CartItemEntity&gt; cartItemByUserId = getCartItem(CartConstant.CART_PREFIX + userInfoTo.getUserId()); // redisä¸­æ¸…ç©ºä¸´æ—¶è´­ç‰©è½¦ä¿¡æ¯ redisTemplate.delete(CartConstant.CART_PREFIX + userInfoTo.getUserKey()); // è¿”å›è´­ç‰©è½¦çš„ä¿¡æ¯ cart.setItems(cartItemByUserId); &#125; else &#123; // æœªç™»å½• // è¿”å›ä¸´æ—¶è´­ç‰©è½¦çš„ä¿¡æ¯ cart.setItems(cartItemByUserKey); &#125; return cart;&#125;/* * æ ¹æ®xxxè·å–è´­ç‰©è½¦å•†å“list */private List&lt;CartItemEntity&gt; getCartItem(String cartKey) &#123; // ä»redisä¸­æ ¹æ®userIdè·å¾—cartItem UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); BoundHashOperations&lt;String, Object, Object&gt; cartMap = redisTemplate.boundHashOps(cartKey); // å°è£…list List&lt;CartItemEntity&gt; cartItemList = cartMap.values().stream().map((cartItemObj) -&gt; &#123; return JSON.parseObject(cartItemObj.toString(), CartItemEntity.class); &#125;).collect(Collectors.toList()); return cartItemList;&#125;/* * ä»redisä¸­è·å–è¯¥è´­ç‰©è½¦ */private BoundHashOperations&lt;String, Object, Object&gt; getCartFromRedis() &#123; String cartKey = &quot;&quot;; // redisä¸­çš„è´­ç‰©è½¦çš„key UserInfoTo userInfoTo = CartInterceptor.threadLocal.get(); // åˆ¤æ–­æ˜¯å¦ç™»å½• if (userInfoTo.getUserId() != null) &#123; // å·²ç™»å½• cartKey = CartConstant.CART_PREFIX + userInfoTo.getUserId(); &#125; else &#123; // æœªç™»å½• cartKey = CartConstant.CART_PREFIX + userInfoTo.getUserKey(); &#125; return redisTemplate.boundHashOps(cartKey);&#125; é€‰ä¸­ã€æ”¹å˜æ•°é‡ã€åˆ é™¤ è¿™é‡Œæœ€å¥½ç”¨ä¸€ä¸ªå®Œæ•´çš„VO+ajax CartController123456789101112131415161718192021222324/* * æ›´æ”¹è´­ç‰©è½¦é€‰ä¸­çŠ¶æ€ */@PostMapping(&quot;/checkItem&quot;)public String checkItem(@RequestParam(&quot;skuId&quot;) Long skuId, @RequestParam(&quot;check&quot;) Integer check) &#123; cartService.checkItem(skuId, check); return &quot;redirect:http://cart.gulimall.com/cart.html&quot;;&#125;/* * æ›´æ”¹è´­ç‰©è½¦å•†å“æ•° */@GetMapping(&quot;/countItem&quot;)public String countItem(@RequestParam(&quot;skuId&quot;) Long skuId, @RequestParam(&quot;num&quot;) Integer num) &#123; cartService.countItem(skuId, num); return &quot;redirect:http://cart.gulimall.com/cart.html&quot;;&#125;/* * æ›´æ”¹è´­ç‰©è½¦å•†å“æ•° */@GetMapping(&quot;/deleteItem&quot;)public String deleteItem(@RequestParam(&quot;skuId&quot;) Long skuId) &#123; cartService.deleteItem(skuId); return &quot;redirect:http://cart.gulimall.com/cart.html&quot;;&#125; CartServiceImpl1234567891011121314151617181920212223242526272829303132333435/* * ä¿®æ”¹å•†å“check */@Overridepublic void checkItem(Long skuId, Integer check) &#123; CartItemEntity cartOneItem = getCartOneItem(skuId); cartOneItem.setCheck(check == 1); updateCartOneItem(cartOneItem);&#125;/* * ä¿®æ”¹å•†å“count */@Overridepublic void countItem(Long skuId, Integer num) &#123; CartItemEntity cartOneItem = getCartOneItem(skuId); cartOneItem.setCount(num); updateCartOneItem(cartOneItem);&#125;/* * redisåˆ é™¤å•†å“ */@Overridepublic void deleteItem(Long skuId) &#123; BoundHashOperations&lt;String, Object, Object&gt; cartOptions = getCartFromRedis(); cartOptions.delete(skuId.toString());&#125;/* * ä¿®æ”¹rediså•ä¸ªè´­ç‰©è½¦å•†å“ä¿¡æ¯ */@Overridepublic void updateCartOneItem(CartItemEntity cartItemEntity) &#123; BoundHashOperations&lt;String, Object, Object&gt; cartOptions = getCartFromRedis(); String json = JSON.toJSONString(cartItemEntity); cartOptions.put(cartItemEntity.getSkuId().toString(), json);&#125;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜5","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜5","date":"2021-11-13T05:53:21.523Z","updated":"2021-11-15T06:58:28.592Z","comments":true,"path":"2021/11/13/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-5/","link":"","permalink":"http://example.com/2021/11/13/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-5/","excerpt":"","text":"Typora typora11.16æœ‰æ¯’ï¼Œä¸¤å¤©æ²¡äº†ä¸‰æ¬¡å†…å®¹ï¼Œå·²ç»å†™åˆ°äº†å‰ç«¯ï¼Œä¸è¿‡å‰ç«¯ä¹Ÿä¸æƒ³å¬äº†ï¼Œåæ­£cvå°±å®Œäº‹äº† æ£€ç´¢æœåŠ¡-é¡µé¢æ¸²æŸ“ åäº†ï¼ŒCV è¿™ä¸€å—çœŸçš„æ˜¯è´¥ç¬” é¢åŒ…å±‘å¯¼èˆª12345678910111213141516171819202122232425262728293031323334353637383940// 6 é¢åŒ…å±‘å¯¼èˆªä¿¡æ¯if (param.getAttrs() != null &amp;&amp; param.getAttrs().size() &gt; 0) &#123; List&lt;SearchResultVo.NavVo&gt; navVoList = param.getAttrs().stream().map(attr -&gt; &#123; // åˆ†ææ¯ä¸€ä¸ªattr SearchResultVo.NavVo navVo = new SearchResultVo.NavVo(); String[] s = attr.split(&quot;_&quot;); // è¿œç¨‹è°ƒç”¨producté‡Œçš„æ–¹æ³•è·å¾—attrName(duckä¸å¿…) AttrResponseTo attrResponseTo = productFeignService.attrResponseInfoFeign(Long.valueOf(s[0])); if (attrResponseTo != null) &#123; navVo.setNavName(attrResponseTo.getAttrName()); &#125; else &#123; navVo.setNavName(s[0]); &#125; navVo.setNavValue(s[1]); // å¤„ç†è¿æ¥ï¼Œå¦‚æœæ˜¯å½“å‰çš„æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ™å»æ‰ String encode = null; try &#123; // å±æ€§å†…å®¹å¸¦ç©ºæ ¼çš„ä¼šè¢«ç¼–ç æˆ+å·ï¼Œéœ€è¦æ¢å› encode = URLEncoder.encode(attr, &quot;UTF-8&quot;).replace(&quot;+&quot;, &quot;%20&quot;); &#125; catch (UnsupportedEncodingException ex) &#123; ex.printStackTrace(); &#125; String replace = param.get_queryString().replace(&quot;&amp;attrs=&quot; + encode, &quot;&quot;); navVo.setLink(&quot;http://search.gulimall.com/list.html?&quot; + replace); return navVo; &#125;).collect(Collectors.toList()); resultVo.setNavs(navVoList);&#125; // 6 å“ç‰Œé¢åŒ…å±‘å¯¼èˆªä¿¡æ¯ if (param.getBrandId() != null &amp;&amp; param.getBrandId().size() &gt; 0) &#123; List&lt;SearchResultVo.NavVo&gt; navs = resultVo.getNavs(); SearchResultVo.NavVo navVo = new SearchResultVo.NavVo(); // è¿™é‡Œè€å¸ˆç”¨è¿œç¨‹è°ƒç”¨ï¼Œduckä¸å¿…ï¼Œresulté‡Œéƒ½å°è£…å¥½äº† navVo.setNavName(&quot;å“ç‰Œ&quot;); StringBuilder builder = new StringBuilder(); for (SearchResultVo.BrandVo brand : resultVo.getBrands()) &#123; builder.append(brand.getBrandName()).append(&quot;;&quot;); &#125; navVo.setNavValue(String.valueOf(builder)); &#125; å¼‚æ­¥åˆå§‹åŒ–çº¿ç¨‹çš„ 4 ç§æ–¹å¼ ç»§æ‰¿ Thread å®ç° Runnable æ¥å£ å®ç° Callable æ¥å£ + FutureTask ï¼ˆå¯ä»¥æ‹¿åˆ°è¿”å›ç»“æœï¼Œ å¯ä»¥å¤„ç†å¼‚å¸¸ï¼‰ çº¿ç¨‹æ±  æ–¹å¼ 1 å’Œæ–¹å¼ 2ï¼š ä¸»è¿›ç¨‹æ— æ³•è·å–çº¿ç¨‹çš„è¿ç®—ç»“æœã€‚ ä¸é€‚åˆå½“å‰åœºæ™¯ã€‚æ–¹å¼ 3ï¼š ä¸»è¿›ç¨‹å¯ä»¥è·å–çº¿ç¨‹çš„è¿ç®—ç»“æœï¼Œ ä½†æ˜¯ä¸åˆ©äºæ§åˆ¶æœåŠ¡å™¨ä¸­çš„çº¿ç¨‹èµ„æºã€‚ å¯ä»¥å¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½ã€‚æ–¹å¼ 4ï¼š é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ–¹å¼åˆå§‹åŒ–çº¿ç¨‹æ± Executors.newFiexedThreadPool(3); æˆ–è€…new ThreadPoolExecutor(corePoolSize, maximumPoolSize, keepAliveTime, TimeUnit unit, workQueue, threadFactory, handler); é€šè¿‡çº¿ç¨‹æ± æ€§èƒ½ç¨³å®šï¼Œ ä¹Ÿå¯ä»¥è·å–æ‰§è¡Œç»“æœï¼Œ å¹¶æ•è·å¼‚å¸¸ã€‚ ä½†æ˜¯ï¼Œ åœ¨ä¸šåŠ¡å¤æ‚æƒ…å†µä¸‹ï¼Œ ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å¯èƒ½ä¼šä¾èµ–äºå¦ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨çš„æ‰§è¡Œç»“æœã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162public class ThreadTest &#123; // å•ä¾‹æ¨¡å¼ï¼Œçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ª public static ExecutorService service = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); /* * 1. ç»§æ‰¿ Thread * 2. å®ç° Runnable æ¥å£ * 3. å®ç° Callable æ¥å£ + FutureTask ï¼ˆå¯ä»¥æ‹¿åˆ°è¿”å›ç»“æœï¼Œ å¯ä»¥å¤„ç†å¼‚å¸¸ï¼‰ * 4. çº¿ç¨‹æ±  */ // Thread1 thread1 = new Thread1(); // thread1.start(); // å¯åŠ¨çº¿ç¨‹ // Runnable1 runnable1 = new Runnable1(); // new Thread(runnable1).start(); // Callable1 callable1 = new Callable1(); // FutureTask&lt;Integer&gt; integerFutureTask = new FutureTask&lt;&gt;(callable1); // new Thread(integerFutureTask).start(); // // é˜»å¡ç­‰å¾…ï¼Œåªæœ‰taskæ‰§è¡Œå®Œä¹‹åæ‰èƒ½æ‰§è¡Œä¸‹é¢çš„è¯­å¥ // System.out.println(integerFutureTask.get()); // å°†æ‰€æœ‰çš„å¤šçº¿ç¨‹å¼‚æ­¥ä»»åŠ¡éƒ½äº¤ç»™çº¿ç¨‹æ± æ‰§è¡Œ,æ—¢èƒ½æ§åˆ¶èµ„æºï¼Œä¹Ÿç¨³å®š service.submit(new Runnable1()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125; public static class Thread1 extends Thread &#123; @Override public void run() &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); &#125; &#125; public static class Runnable1 implements Runnable &#123; @Override public void run() &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); &#125; &#125; public static class Callable1 implements Callable&lt;Integer&gt; &#123; @Override public Integer call() throws Exception &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125; &#125;&#125; çº¿ç¨‹æ± çº¿ç¨‹æ± ç§ç±» newCachedThreadPool åˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œ å¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œ å¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œ è‹¥æ— å¯å›æ”¶ï¼Œ åˆ™æ–°å»ºçº¿ç¨‹ã€‚ coreä¸º0ï¼Œæ‰€æœ‰çº¿ç¨‹å¯å›æ”¶ newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œ å¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œ è¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰ core = maxï¼Œmax-coreçº¿ç¨‹å¯å›æ”¶ newScheduledThreadPoolåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œ æ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚ newSingleThreadExecutoråˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œ å®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œ ä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ ç¤ºä¾‹12345678910111213141516171819202122232425262728293031public class ThreadTest &#123; // å•ä¾‹æ¨¡å¼ï¼Œçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ª public static ExecutorService service = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; /* * ä¸ƒå¤§å‚æ•°ï¼š * corePoolSize æ ¸å¿ƒçº¿ç¨‹æ•°ï¼šçº¿ç¨‹æ± åˆ›å»ºå¥½ä»¥åå°±å‡†å¤‡å°±ç»ªçš„çº¿ç¨‹æ•°,ä¸€ç›´å­˜åœ¨é™¤éallowCoreThreadTimeOut * maximumPoolSize æœ€å¤§çº¿ç¨‹æ•°ï¼šæ§åˆ¶èµ„æº * keepAliveTime å­˜æ´»æ—¶é—´ï¼šçº¿ç¨‹ç©ºé—²æ—¶é—´å¤§äºæŒ‡å®šæ—¶é—´ï¼Œé‡Šæ”¾ç©ºé—²çº¿ç¨‹ï¼ˆé‡Šæ”¾çš„çº¿ç¨‹æ˜¯å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ï¼‰ * unit æ—¶é—´å•ä½ * BlockingQueue&lt;Runnable&gt; é˜»å¡é˜Ÿåˆ—ï¼šå¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¤šä½™ä»»åŠ¡å°†æ”¾åœ¨é˜Ÿåˆ—å½“ä¸­ï¼Œåªè¦æœ‰ç©ºé—²çº¿ç¨‹ï¼Œå°±ä¼šä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œ * threadFactory çº¿ç¨‹å·¥å‚ * RejectedExecutionHandler æ‹’ç»ç­–ç•¥ï¼šå¤„ç†é˜Ÿåˆ—æ»¡äº†ä¹‹åçš„æ“ä½œ * * å·¥ä½œé¡ºåºï¼š * 1ã€ çº¿ç¨‹æ± åˆ›å»ºï¼Œ å‡†å¤‡å¥½ core æ•°é‡çš„æ ¸å¿ƒçº¿ç¨‹ï¼Œ å‡†å¤‡æ¥å—ä»»åŠ¡ * 2ã€ æ–°çš„ä»»åŠ¡è¿›æ¥ï¼Œ ç”¨ core å‡†å¤‡å¥½çš„ç©ºé—²çº¿ç¨‹æ‰§è¡Œã€‚ * (1) ã€ core æ»¡äº†ï¼Œ å°±å°†å†è¿›æ¥çš„ä»»åŠ¡æ”¾å…¥é˜»å¡é˜Ÿåˆ—ä¸­ã€‚ ç©ºé—²çš„ core å°±ä¼šè‡ªå·±å»é˜»å¡é˜Ÿåˆ—è·å–ä»»åŠ¡æ‰§è¡Œ * (2) ã€ é˜»å¡é˜Ÿåˆ—æ»¡äº†ï¼Œ å°±ç›´æ¥å¼€æ–°çº¿ç¨‹æ‰§è¡Œï¼Œ æœ€å¤§åªèƒ½å¼€åˆ° max æŒ‡å®šçš„æ•°é‡ * (3) ã€ max éƒ½æ‰§è¡Œå¥½äº†ã€‚ Max-core æ•°é‡ç©ºé—²çš„çº¿ç¨‹ä¼šåœ¨ keepAliveTime æŒ‡å®šçš„æ—¶é—´åè‡ªåŠ¨é”€æ¯ã€‚ æœ€ç»ˆä¿æŒåˆ° core å¤§å° * (4) ã€ å¦‚æœçº¿ç¨‹æ•°å¼€åˆ°äº† max çš„æ•°é‡ï¼Œ è¿˜æœ‰æ–°ä»»åŠ¡è¿›æ¥ï¼Œ å°±ä¼šä½¿ç”¨ reject æŒ‡å®šçš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç† * 3ã€ æ‰€æœ‰çš„çº¿ç¨‹åˆ›å»ºéƒ½æ˜¯ç”±æŒ‡å®šçš„ factory åˆ›å»ºçš„ã€‚ */ ThreadPoolExecutor executor = new ThreadPoolExecutor( 5, 200, 10, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;(100000), Executors.defaultThreadFactory(), new ThreadPoolExecutor.AbortPolicy()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125;&#125; ä¸ºä»€ä¹ˆä½¿ç”¨çº¿ç¨‹æ±  CompletableFuture å¼‚æ­¥ç¼–æ’ åˆ›å»ºå¼‚æ­¥å¯¹è±¡ CompletableFuture æä¾›äº†å››ä¸ªé™æ€æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå¼‚æ­¥æ“ä½œ 1ã€ runXxxx éƒ½æ˜¯æ²¡æœ‰è¿”å›ç»“æœçš„ï¼Œ supplyXxx éƒ½æ˜¯å¯ä»¥è·å–è¿”å›ç»“æœçš„2ã€ å¯ä»¥ä¼ å…¥è‡ªå®šä¹‰çš„çº¿ç¨‹æ± ï¼Œ å¦åˆ™å°±ç”¨é»˜è®¤çš„çº¿ç¨‹æ± ï¼› 1234567891011121314151617181920212223242526public class CompletableFutureTest &#123; // å•ä¾‹æ¨¡å¼ï¼Œçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ª public static ExecutorService executor = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); // CompletableFuture&lt;Void&gt; future = CompletableFuture.runAsync(() -&gt; &#123; // System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); // int i = 10 / 2; // System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); // &#125;, executor); CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125;, executor); System.out.println(&quot;futureç»“æœï¼š&quot; + future.get()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125;&#125; è®¡ç®—å®Œæˆæ—¶å›è°ƒæ–¹æ³•ã€å¼‚å¸¸å¤„ç† whenComplete å¯ä»¥å¤„ç†æ­£å¸¸å’Œå¼‚å¸¸çš„è®¡ç®—ç»“æœï¼Œ exceptionally å¤„ç†å¼‚å¸¸æƒ…å†µã€‚ whenComplete å’Œ whenCompleteAsync çš„åŒºåˆ« whenCompleteï¼š æ˜¯æ‰§è¡Œå½“å‰ä»»åŠ¡çš„çº¿ç¨‹æ‰§è¡Œç»§ç»­æ‰§è¡Œ whenComplete çš„ä»»åŠ¡ whenCompleteAsyncï¼š æ˜¯æ‰§è¡ŒæŠŠ whenCompleteAsync è¿™ä¸ªä»»åŠ¡ç»§ç»­æäº¤ç»™çº¿ç¨‹æ± æ¥è¿›è¡Œæ‰§è¡Œã€‚ æ–¹æ³•ä¸ä»¥ Async ç»“å°¾ï¼Œ æ„å‘³ç€ Action ä½¿ç”¨ç›¸åŒçš„çº¿ç¨‹æ‰§è¡Œï¼Œ è€Œ Async å¯èƒ½ä¼šä½¿ç”¨å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼ˆå¦‚æœæ˜¯ä½¿ç”¨ç›¸åŒçš„çº¿ç¨‹æ± ï¼Œ ä¹Ÿå¯èƒ½ä¼šè¢«åŒä¸€ä¸ªçº¿ç¨‹é€‰ä¸­æ‰§è¡Œ 12345678910111213141516171819202122public class CompletableFutureTest &#123; public static ExecutorService executor = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125;, executor).whenComplete((result, exception) -&gt; &#123; System.out.println(&quot;å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆäº†...ç»“æœæ˜¯ï¼š&quot; + result + &quot;ï¼›å¼‚å¸¸æ˜¯ï¼š&quot; + exception); &#125;); System.out.println(&quot;futureç»“æœï¼š&quot; + future.get()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125;&#125; 12345678910111213141516171819202122232425public class CompletableFutureTest &#123; public static ExecutorService executor = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 0; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125;, executor).whenComplete((result, exception) -&gt; &#123; // å½“futureæ‰§è¡Œå®Œä¹‹åæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¯ä»¥è·å¾—ç»“æœä¸å¼‚å¸¸ System.out.println(&quot;å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆäº†...ç»“æœæ˜¯ï¼š&quot; + result + &quot;ï¼›å¼‚å¸¸æ˜¯ï¼š&quot; + exception); &#125;).exceptionally((exception) -&gt; &#123; // ç”¨äºå¤„ç†å¼‚å¸¸ return 10; // å‡ºç°å¼‚å¸¸åï¼Œè¿”å›é»˜è®¤å€¼ &#125;); System.out.println(&quot;futureç»“æœï¼š&quot; + future.get()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125;&#125; handleæ–¹æ³• å’Œ complete ä¸€æ ·ï¼Œ å¯å¯¹ç»“æœåšæœ€åçš„å¤„ç†ï¼ˆå¯å¤„ç†å¼‚å¸¸ï¼‰ ï¼Œ å¯æ”¹å˜è¿”å›å€¼ã€‚ 1234567891011121314151617181920212223242526272829public class CompletableFutureTest &#123; public static ExecutorService executor = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 0; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125;, executor).handle((result, exception) -&gt; &#123; // æ—¢å¯ä»¥è·å¾—ä¹Ÿå¯ä»¥å¤„ç† System.out.println(&quot;å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆäº†...ç»“æœæ˜¯ï¼š&quot; + result + &quot;ï¼›å¼‚å¸¸æ˜¯ï¼š&quot; + exception); if (result != null) &#123; return result; &#125; if (exception != null) &#123; return 10; &#125; return 0; &#125;); System.out.println(&quot;futureç»“æœï¼š&quot; + future.get()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125; &#125; çº¿ç¨‹ä¸²è¡ŒåŒ–æ–¹æ³• thenApply æ–¹æ³•ï¼š å½“ä¸€ä¸ªçº¿ç¨‹ä¾èµ–å¦ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œ è·å–ä¸Šä¸€ä¸ªä»»åŠ¡è¿”å›çš„ç»“æœï¼Œ å¹¶è¿”å›å½“å‰ä»»åŠ¡çš„è¿”å›å€¼ã€‚ thenAccept æ–¹æ³•ï¼š æ¶ˆè´¹å¤„ç†ç»“æœã€‚ æ¥æ”¶ä»»åŠ¡çš„å¤„ç†ç»“æœï¼Œ å¹¶æ¶ˆè´¹å¤„ç†ï¼Œ æ— è¿”å›ç»“æœã€‚ thenRun æ–¹æ³•ï¼š åªè¦ä¸Šé¢çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œ å°±å¼€å§‹æ‰§è¡Œ thenRunï¼Œ åªæ˜¯å¤„ç†å®Œä»»åŠ¡åï¼Œ æ‰§è¡ŒthenRun çš„åç»­æ“ä½œå¸¦æœ‰ Async é»˜è®¤æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚ åŒä¹‹å‰ã€‚ ä»¥ä¸Šéƒ½è¦å‰ç½®ä»»åŠ¡æˆåŠŸå®Œæˆã€‚ Function&lt;? super T,? extends U&gt;Tï¼š ä¸Šä¸€ä¸ªä»»åŠ¡è¿”å›ç»“æœçš„ç±»å‹Uï¼š å½“å‰ä»»åŠ¡çš„è¿”å›å€¼ç±»å‹ 12345678910111213141516171819202122public class CompletableFutureTest &#123; public static ExecutorService executor = Executors.newFixedThreadPool(10); public static void main(String[] args) throws ExecutionException, InterruptedException &#123; System.out.println(&quot;---------- mainæ–¹æ³•start ----------&quot;); CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;å½“å‰çº¿ç¨‹IDï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 2; System.out.println(&quot;è¿è¡Œç»“æœï¼š&quot; + i); return i; &#125;, executor).thenApplyAsync(result -&gt; &#123; System.out.println(&quot;ä»»åŠ¡äºŒå¯åŠ¨ï¼Œä¸Šä¸€æ¬¡ç»“æœ+&quot; + result); return result + 1; &#125;, executor); System.out.println(&quot;futureç»“æœï¼š&quot; + future.get()); System.out.println(&quot;---------- mainæ–¹æ³•end ----------&quot;); &#125;&#125; ä¸¤ä»»åŠ¡ç»„åˆ - éƒ½è¦å®Œæˆ ä¸¤ä¸ªä»»åŠ¡å¿…é¡»éƒ½å®Œæˆï¼Œ è§¦å‘è¯¥ä»»åŠ¡ã€‚ thenCombineï¼š ç»„åˆä¸¤ä¸ª futureï¼Œ è·å–ä¸¤ä¸ª future çš„è¿”å›ç»“æœï¼Œ å¹¶è¿”å›å½“å‰ä»»åŠ¡çš„è¿”å›å€¼thenAcceptBothï¼š ç»„åˆä¸¤ä¸ª futureï¼Œ è·å–ä¸¤ä¸ª future ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œ ç„¶åå¤„ç†ä»»åŠ¡ï¼Œ æ²¡æœ‰è¿”å›å€¼ã€‚runAfterBothï¼š ç»„åˆä¸¤ä¸ª futureï¼Œ ä¸éœ€è¦è·å– future çš„ç»“æœï¼Œ åªéœ€ä¸¤ä¸ª future å¤„ç†å®Œä»»åŠ¡åï¼Œå¤„ç†è¯¥ä»»åŠ¡ã€‚ 123456789101112131415161718192021222324252627282930 CompletableFuture&lt;Object&gt; future01 = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;ä»»åŠ¡1çº¿ç¨‹ï¼š&quot; + Thread.currentThread().getId()); int i = 10 / 4; System.out.println(&quot;ä»»åŠ¡1ç»“æŸï¼š&quot; ); return i; &#125;, executor); CompletableFuture&lt;Object&gt; future02 = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;ä»»åŠ¡2çº¿ç¨‹ï¼š&quot; + Thread.currentThread().getId()); try &#123; Thread.sleep(3000); System.out.println(&quot;ä»»åŠ¡2ç»“æŸï¼š&quot; ); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; return &quot;Hello&quot;; &#125;, executor); future01.runAfterBothAsync(future02,()-&gt;&#123; System.out.println(&quot;ä»»åŠ¡3å¼€å§‹...&quot;); &#125;,executor);// void accept(T t, U u); future01.thenAcceptBothAsync(future02,(f1,f2)-&gt;&#123; System.out.println(&quot;ä»»åŠ¡3å¼€å§‹...ä¹‹å‰çš„ç»“æœï¼š&quot;+f1+&quot;--ã€‹&quot;+f2); &#125;,executor);//R apply(T t, U u); CompletableFuture&lt;String&gt; future = future01.thenCombineAsync(future02, (f1, f2) -&gt; &#123; return f1 + &quot;ï¼š&quot; + f2 + &quot; -&gt; Haha&quot;; &#125;, executor); ä¸¤ä»»åŠ¡ç»„åˆ - ä¸€ä¸ªå®Œæˆ å½“ä¸¤ä¸ªä»»åŠ¡ä¸­ï¼Œ ä»»æ„ä¸€ä¸ª future ä»»åŠ¡å®Œæˆçš„æ—¶å€™ï¼Œ æ‰§è¡Œä»»åŠ¡ã€‚ applyToEitherï¼š ä¸¤ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œ è·å–å®ƒçš„è¿”å›å€¼ï¼Œ å¤„ç†ä»»åŠ¡å¹¶æœ‰æ–°çš„è¿”å›å€¼ã€‚acceptEitherï¼š ä¸¤ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œ è·å–å®ƒçš„è¿”å›å€¼ï¼Œ å¤„ç†ä»»åŠ¡ï¼Œ æ²¡æœ‰æ–°çš„è¿”å›å€¼ã€‚runAfterEitherï¼š ä¸¤ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œ ä¸éœ€è¦è·å– future çš„ç»“æœï¼Œ å¤„ç†ä»»åŠ¡ï¼Œ ä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚ 1234567891011121314151617 /** * ä¸¤ä¸ªä»»åŠ¡ï¼Œåªè¦æœ‰ä¸€ä¸ªå®Œæˆï¼Œæˆ‘ä»¬å°±æ‰§è¡Œä»»åŠ¡3 * runAfterEitherAsyncï¼šä¸æ„ŸçŸ¥ç»“æœï¼Œè‡ªå·±æ²¡æœ‰è¿”å›å€¼ * acceptEitherAsyncï¼šæ„ŸçŸ¥ç»“æœï¼Œè‡ªå·±æ²¡æœ‰è¿”å›å€¼ * applyToEitherAsyncï¼šæ„ŸçŸ¥ç»“æœï¼Œè‡ªå·±æœ‰è¿”å›å€¼ */// future01.runAfterEitherAsync(future02,()-&gt;&#123;// System.out.println(&quot;ä»»åŠ¡3å¼€å§‹...ä¹‹å‰çš„ç»“æœï¼š&quot;);// &#125;,executor); //void accept(T t);// future01.acceptEitherAsync(future02,(res)-&gt;&#123;// System.out.println(&quot;ä»»åŠ¡3å¼€å§‹...ä¹‹å‰çš„ç»“æœï¼š&quot;+res);// &#125;,executor);// CompletableFuture&lt;String&gt; future = future01.applyToEitherAsync(future02, res -&gt; &#123;// System.out.println(&quot;ä»»åŠ¡3å¼€å§‹...ä¹‹å‰çš„ç»“æœï¼š&quot; + res);// return res.toString() + &quot;-&gt;å“ˆå“ˆ&quot;;// &#125;, executor); å¤šä»»åŠ¡ç»„åˆ allOfï¼š ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®ŒæˆanyOfï¼š åªè¦æœ‰ä¸€ä¸ªä»»åŠ¡å®Œæˆ 1234567891011121314151617181920212223242526272829 CompletableFuture&lt;String&gt; futureImg = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;æŸ¥è¯¢å•†å“çš„å›¾ç‰‡ä¿¡æ¯&quot;); return &quot;hello.jpg&quot;; &#125;,executor); CompletableFuture&lt;String&gt; futureAttr = CompletableFuture.supplyAsync(() -&gt; &#123; System.out.println(&quot;æŸ¥è¯¢å•†å“çš„å±æ€§&quot;); return &quot;é»‘è‰²+256G&quot;; &#125;,executor); CompletableFuture&lt;String&gt; futureDesc = CompletableFuture.supplyAsync(() -&gt; &#123; try &#123; Thread.sleep(3000); System.out.println(&quot;æŸ¥è¯¢å•†å“ä»‹ç»&quot;); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; return &quot;åä¸º&quot;; &#125;,executor);// CompletableFuture&lt;Void&gt; allOf = CompletableFuture.allOf(futureImg, futureAttr, futureDesc); CompletableFuture&lt;Object&gt; anyOf = CompletableFuture.anyOf(futureImg, futureAttr, futureDesc); anyOf.get();//ç­‰å¾…æ‰€æœ‰ç»“æœå®Œæˆ// System.out.println(&quot;main....end....&quot;+futureImg.get()+&quot;=&gt;&quot;+futureAttr.get()+&quot;=&gt;&quot;+futureDesc.get()); System.out.println(&quot;main....end....&quot;+anyOf.get()); &#125; å‰å° - å•†å“è¯¦æƒ…ç¯å¢ƒæ­å»ºé™æ€èµ„æº å­˜æ”¾åˆ°nginx -&gt; html -&gt; static ä¸‹å¯¹åº”æ–‡ä»¶å¤¹ htmlæ”¾åˆ°å¯¹åº”æ¨¡å—resources -&gt; templatesä¸‹ host 192.168.128.129 item.gulimall.com nacos ä¹‹å‰é…ç½®çš„*.gulimall.comå³å¯ gateway123456789# -----------------------nginxï¼Œä¸€å®šè¦æ”¾åœ¨æœ€åï¼Œè¦ä¸ç„¶/api/ä¸‹çš„é…ç½®ä¼šè¢«è¦†ç›–------------------------ id: gulimall_host_route uri: lb://gulimall-product predicates: - Host=gulimall.com,item.gulimall.com- id: gulimall_search_route uri: lb://gulimall-search predicates: - Host=search.gulimall.com é¡µé¢åŸºæœ¬è·³è½¬1234&lt;!-- |å†…å¯ç›´æ¥æ”¾å­—ç¬¦ä¸²| --&gt;&lt;a th:href=&quot;|http://item.gulimall.com/$&#123;product.skuId&#125;.html|&quot;&gt; &lt;img th:src=&quot;$&#123;product.skuImg&#125;&quot; class=&quot;dim&quot;&gt;&lt;/a&gt; controller12345678910111213141516@Controllerpublic class ItemController &#123; @Autowired SkuInfoService skuInfoService; /* * å±•ç¤ºå½“å‰å¯¹åº”skuIdçš„ä¿¡æ¯ */ @GetMapping(&quot;/&#123;skuId&#125;.html&quot;) public String skuItem(@PathVariable(&quot;skuId&quot;) Long skuId, Model model) &#123; SkuItemVo skuItemVo = skuInfoService.getItemInfo(skuId); model.addAttribute(&quot;item&quot;, skuItemVo); return &quot;item&quot;; &#125;&#125; SkuItemVo12345678910111213141516171819202122232425262728293031323334353637383940414243@Datapublic class SkuItemVo &#123; // 1 è·å–skuåŸºæœ¬ä¿¡æ¯ï¼Œpms_sku_info SkuInfoEntity info; boolean hasStock = true; // 2 skuå›¾ç‰‡ pms_sku_images List&lt;SkuImagesEntity&gt; images; // 3 è·å¾—spué”€å”®å±æ€§ç»„åˆ List&lt;SkuItemSaleAttrVo&gt; saleAttr; // 4 spué”€å”®å±æ€§ä»‹ç» SpuInfoDescEntity desp; // 5 spuè§„æ ¼å‚æ•° List&lt;SpuItemAttrGroupVo&gt; groupAttrs; @Data public static class SkuItemSaleAttrVo &#123; // å±æ€§id private Long attrId; // å±æ€§å private String attrName; // å±æ€§å€¼ private List&lt;AttrValueWithSkuIdVo&gt; attrValues; &#125; @Data public static class SpuItemAttrGroupVo &#123; private String groupName; private List&lt;SpuItemBaseAttrVo&gt; attrs; &#125; @Data public static class SpuItemBaseAttrVo &#123; private String attrName; private String attrValue; &#125; @Data public static class AttrValueWithSkuIdVo &#123; private String attrValue; private String skuIds; &#125;&#125; å°è£…åŸºæœ¬ä¿¡æ¯service1234567891011121314151617181920212223242526272829@Service(&quot;skuInfoService&quot;)public class SkuInfoServiceImpl extends ServiceImpl&lt;SkuInfoDao, SkuInfoEntity&gt; implements SkuInfoService &#123; /* * è·å–skuInfo,ç”¨äºè¯¦æƒ…é¡µå±•ç¤º */ @Override public SkuItemVo getItemInfo(Long skuId) &#123; SkuItemVo skuItemVo = new SkuItemVo(); // 1 è·å–skuåŸºæœ¬ä¿¡æ¯ï¼Œpms_sku_info SkuInfoEntity skuInfoEntity = getById(skuId); skuItemVo.setInfo(skuInfoEntity); Long spuId = skuInfoEntity.getSpuId(); Long catalogId = skuInfoEntity.getCatalogId(); // 2 skuå›¾ç‰‡ pms_sku_images List&lt;SkuImagesEntity&gt; skuImagesEntityList = skuImagesService.getBySkuId(skuId); skuItemVo.setImages(skuImagesEntityList); // 3 è·å¾—spué”€å”®å±æ€§ç»„åˆ // 4 spué”€å”®å±æ€§ä»‹ç» spu_info_desc SpuInfoDescEntity spuInfoDescEntity = spuInfoDescService.getById(spuId); skuItemVo.setDesp(spuInfoDescEntity); // 5 spuè§„æ ¼å‚æ•° return skuItemVo; &#125;&#125; å°è£…spuè§„æ ¼å‚æ•°service123// 5 spuè§„æ ¼å‚æ•° List&lt;SkuItemVo.SpuItemAttrGroupVo&gt; spuItemAttrGroupVoList = attrGroupService.getGroupWithAttrForSkuItem(spuId, catalogId); skuItemVo.setGroupAttrs(spuItemAttrGroupVoList); 12345678@Service(&quot;attrGroupService&quot;)public class AttrGroupServiceImpl extends ServiceImpl&lt;AttrGroupDao, AttrGroupEntity&gt; implements AttrGroupService &#123; @Override public List&lt;SkuItemVo.SpuItemAttrGroupVo&gt; getWithAttrForSkuItem(Long spuId, Long catalogId) &#123; return baseMapper.getWithAttrForSkuItem(spuId, catalogId); &#125;&#125; mapper è”è¡¨æŸ¥è¯¢ï¼Œè‡ªå®šä¹‰ç»“æœé›†ï¼Œå†…éƒ¨ç±»ä½¿ç”¨$ 123456789101112131415161718192021222324&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.atguigu.gulimall.product.dao.AttrGroupDao&quot;&gt; &lt;!-- resultMap æŒ‡å®šè¿”å›çš„ç»“æœé›†åŠå…¶ä¸­å…ƒç´  --&gt; &lt;resultMap id=&quot;spuItemAttrGroupVo&quot; type=&quot;com.atguigu.gulimall.product.vo.front.SkuItemVo$SpuItemAttrGroupVo&quot;&gt; &lt;result property=&quot;groupName&quot; column=&quot;attr_group_name&quot; /&gt; &lt;collection property=&quot;attrs&quot; ofType=&quot;com.atguigu.gulimall.product.vo.front.SkuItemVo$SpuItemBaseAttrVo&quot;&gt; &lt;result property=&quot;attrName&quot; column=&quot;attr_name&quot; /&gt; &lt;result property=&quot;attrValue&quot; column=&quot;attr_value&quot; /&gt; &lt;/collection&gt; &lt;/resultMap&gt; &lt;select id=&quot;getWithAttrForSkuItem&quot; resultMap=&quot;spuItemAttrGroupVo&quot;&gt; select ag.attr_group_id, ag.attr_group_name, aar.attr_id, pav.attr_name, pav.attr_value from gulimall_pms.pms_attr_group ag left join gulimall_pms.pms_attr_attrgroup_relation aar on aar.attr_group_id = ag.attr_group_id left join gulimall_pms.pms_product_attr_value pav on pav.attr_id = aar.attr_id where ag.catelog_id = #&#123;catalogId&#125; and pav.spu_id = #&#123;spuId&#125;; &lt;/select&gt;&lt;/mapper&gt; å°è£…spué”€å”®å±æ€§service123// 3 è·å¾—spué”€å”®å±æ€§ç»„åˆList&lt;SkuItemVo.SkuItemSaleAttrVo&gt; skuItemSaleAttrVoList = skuSaleAttrValueService.getAttrBySpuId(skuId);skuItemVo.setSaleAttr(skuItemSaleAttrVoList); 12345678@Service(&quot;skuSaleAttrValueService&quot;)public class SkuSaleAttrValueServiceImpl extends ServiceImpl&lt;SkuSaleAttrValueDao, SkuSaleAttrValueEntity&gt; implements SkuSaleAttrValueService &#123; @Override public List&lt;SkuItemVo.SkuItemSaleAttrVo&gt; getAttrBySpuId(Long spuId) &#123; return baseMapper.getAttrBySpuId(spuId); &#125;&#125; mapper12345678910111213141516171819202122232425&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.atguigu.gulimall.product.dao.SkuSaleAttrValueDao&quot;&gt; &lt;resultMap id=&quot;skuItemSaleAttrVo&quot; type=&quot;com.atguigu.gulimall.product.vo.front.SkuItemVo$SkuItemSaleAttrVo&quot;&gt; &lt;result property=&quot;attrId&quot; column=&quot;attr_id&quot; /&gt; &lt;result property=&quot;attrName&quot; column=&quot;attr_name&quot; /&gt; &lt;collection property=&quot;attrValues&quot; ofType=&quot;com.atguigu.gulimall.product.vo.front.SkuItemVo$AttrValueWithSkuIdVo&quot;&gt; &lt;result property=&quot;skuIds&quot; column=&quot;sku_ids&quot; /&gt; &lt;result property=&quot;attrValue&quot; column=&quot;attr_value&quot; /&gt; &lt;/collection&gt; &lt;/resultMap&gt; &lt;select id=&quot;getAttrBySpuId&quot; resultMap=&quot;skuItemSaleAttrVo&quot;&gt; select sav.attr_id, sav.attr_name, sav.attr_value, group_concat(distinct si.sku_id) sku_ids from gulimall_pms.pms_sku_info si left join gulimall_pms.pms_sku_sale_attr_value sav on sav.sku_id = si.sku_id where spu_id = #&#123;spuId&#125; group by sav.attr_id, sav.attr_name, sav.attr_value &lt;/select&gt;&lt;/mapper&gt; è¿™é‡Œæœ€å¥½èµ·åˆ«åï¼Œè¦ä¸ç„¶å¯èƒ½ä¼šå°è£…ä¸åˆ° å‰ç«¯ è‡ªå·±çœ‹ å¼‚æ­¥ç¼–æ’ä¼˜åŒ–å¤–éƒ¨é…ç½® å°±æ˜¯å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹çš„å±æ€§ 123456789// éœ€è¦å¼•å…¥ä¾èµ–spring-boot-configuration-processor@ConfigurationProperties(prefix = &quot;gulimall.thread&quot;) // å¤–éƒ¨åŒ–é…ç½®@Component@Datapublic class ThreadPoolConfigProperties &#123; private Integer coreSize; private Integer maxSize; private Integer keepAliveTime;&#125; çº¿ç¨‹æ± é…ç½®1234567891011@Configuration// @EnableConfigurationProperties(ThreadPoolConfigProperties.class) //å¼€å¯å±æ€§é…ç½®,è¿™ä¸ªæ³¨è§£å’Œé…ç½®ç±»çš„@Componentæ³¨è§£äºŒé€‰ä¸€public class MyThreadConfig &#123; @Bean public ThreadPoolExecutor threadPoolExecutor(ThreadPoolConfigProperties pool) &#123; return new ThreadPoolExecutor( pool.getCoreSize(), pool.getMaxSize(), pool.getKeepAliveTime(), TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(100000), Executors.defaultThreadFactory(), new ThreadPoolExecutor.AbortPolicy()); &#125;&#125; service1234567891011121314151617181920212223242526272829303132333435363738394041424344@Overridepublic SkuItemVo getItemInfo(Long skuId) throws ExecutionException, InterruptedException &#123; SkuItemVo skuItemVo = new SkuItemVo(); // ä»»åŠ¡1ï¼ŒsupplyAsyncæœ‰è¿”å›å€¼ CompletableFuture&lt;SkuInfoEntity&gt; infoFuture = CompletableFuture.supplyAsync(() -&gt; &#123; // 1 è·å–skuåŸºæœ¬ä¿¡æ¯ï¼Œpms_sku_info SkuInfoEntity skuInfoEntity = getById(skuId); skuItemVo.setInfo(skuInfoEntity); return skuInfoEntity; &#125;, executor); // ä¸€ä¸‹ä¸‰ä¸ªä»»åŠ¡ç­‰ä»»åŠ¡1å®Œæˆåæ‰å¯æ‰§è¡Œï¼Œè€Œä¸”æ˜¯å¹¶è¡Œçš„ CompletableFuture&lt;Void&gt; saleAttrFuture = infoFuture.thenAcceptAsync((skuInfoEntity) -&gt; &#123; // 3 è·å¾—spué”€å”®å±æ€§ç»„åˆ List&lt;SkuItemVo.SkuItemSaleAttrVo&gt; skuItemSaleAttrVoList = skuSaleAttrValueService.getAttrBySpuId(skuInfoEntity.getSpuId()); System.out.println(JSON.toJSONString(skuItemSaleAttrVoList)); skuItemVo.setSaleAttr(skuItemSaleAttrVoList); &#125;, executor); CompletableFuture&lt;Void&gt; descFuture = infoFuture.thenAcceptAsync((skuInfoEntity) -&gt; &#123; // 4 spué”€å”®å±æ€§ä»‹ç» spu_info_desc SpuInfoDescEntity spuInfoDescEntity = spuInfoDescService.getById(skuInfoEntity.getSpuId()); skuItemVo.setDesp(spuInfoDescEntity); &#125;, executor); CompletableFuture&lt;Void&gt; groupAttrFuture = infoFuture.thenAcceptAsync((skuInfoEntity) -&gt; &#123; // 5 spuè§„æ ¼å‚æ•° List&lt;SkuItemVo.SpuItemAttrGroupVo&gt; spuItemAttrGroupVoList = attrGroupService.getGroupWithAttrForSkuItem(skuInfoEntity.getSpuId(), skuInfoEntity.getCatalogId()); skuItemVo.setGroupAttrs(spuItemAttrGroupVoList); &#125;, executor); // ä»»åŠ¡2ï¼Œè¯¥ä»»åŠ¡å’Œä»»åŠ¡1æ— å…³ï¼Œæ‰€ä»¥å’Œä»»åŠ¡1å¹¶è¡Œå³å¯ï¼ŒrunAsyncæ— è¿”å›å€¼ CompletableFuture&lt;Void&gt; imageFuture = CompletableFuture.runAsync(() -&gt; &#123; // 2 skuå›¾ç‰‡ pms_sku_images List&lt;SkuImagesEntity&gt; skuImagesEntityList = skuImagesService.getBySkuId(skuId); skuItemVo.setImages(skuImagesEntityList); &#125;, executor); // æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåæ‰è¿”å› CompletableFuture.allOf(saleAttrFuture, descFuture, groupAttrFuture, imageFuture).get(); System.out.println(&quot;å•†å“è¯¦æƒ…ç»“æœï¼š&quot; + JSON.toJSONString(skuItemVo)); return skuItemVo;&#125;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜4","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜4","date":"2021-11-01T07:13:11.570Z","updated":"2021-11-13T05:53:11.936Z","comments":true,"path":"2021/11/01/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-4/","link":"","permalink":"http://example.com/2021/11/01/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-4/","excerpt":"","text":"SpringBootæ•´åˆES-Rest-ClientåŸºç¡€æ­å»ºæ¨¡å— åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„module ä¾èµ–12345678910 &lt;properties&gt; &lt;!-- è¦†ç›–springbootçš„é»˜è®¤ç‰ˆæœ¬ï¼Œå¿…é¡»å’Œclientä¿æŒä¸€è‡´æ‰è¡Œ --&gt; &lt;elasticsearch.version&gt;7.4.2&lt;/elasticsearch.version&gt; &lt;/properties&gt;&lt;!-- elasticsearch.client --&gt;&lt;dependency&gt; &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt; &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt; &lt;version&gt;7.4.2&lt;/version&gt;&lt;/dependency&gt; é…ç½® nacosã€springserverç­‰ 12spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848spring.application.name=gulimall-search é…ç½®ç±»123456789101112131415161718192021@Configurationpublic class GulimallElasticSearchConfig &#123; // requestè®¾ç½®é¡¹ public static final RequestOptions COMMON_OPTIONS; static &#123; RequestOptions.Builder builder = RequestOptions.DEFAULT.toBuilder(); // builder.addHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + TOKEN); // builder.setHttpAsyncResponseConsumerFactory( // new HttpAsyncResponseConsumerFactory // .HeapBufferedResponseConsumerFactory(30 * 1024 * 1024 * 1024)); COMMON_OPTIONS = builder.build(); &#125; // æ³¨å…¥RestHighLevelClient @Bean public RestHighLevelClient esRestClient() &#123; RestHighLevelClient client = new RestHighLevelClient( RestClient.builder( new HttpHost(&quot;192.168.128.129&quot;, 9200, &quot;http&quot;))); return client; &#125;&#125; TEST &amp; DEBUG error creating bean with name â€˜â€˜DataSourceâ€™ æ²¡æœ‰é…ç½®æ•°æ®æºï¼Œå¦‚æœä¸éœ€è¦å°±åœ¨applicationç±»ä¸Šæ·»åŠ @SpringBootApplication(exclude = DataSourceAutoConfiguration.class) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155package com.atguigu.gulimall.gulimallsearch;import com.alibaba.fastjson.JSON;import com.atguigu.gulimall.gulimallsearch.config.GulimallElasticSearchConfig;import lombok.Data;import lombok.ToString;import org.elasticsearch.action.index.IndexRequest;import org.elasticsearch.action.index.IndexResponse;import org.elasticsearch.action.search.SearchRequest;import org.elasticsearch.action.search.SearchResponse;import org.elasticsearch.client.RestHighLevelClient;import org.elasticsearch.common.xcontent.XContentType;import org.elasticsearch.index.query.QueryBuilders;import org.elasticsearch.search.SearchHit;import org.elasticsearch.search.SearchHits;import org.elasticsearch.search.aggregations.AggregationBuilders;import org.elasticsearch.search.aggregations.Aggregations;import org.elasticsearch.search.aggregations.bucket.terms.Terms;import org.elasticsearch.search.aggregations.bucket.terms.TermsAggregationBuilder;import org.elasticsearch.search.aggregations.metrics.Avg;import org.elasticsearch.search.aggregations.metrics.AvgAggregationBuilder;import org.elasticsearch.search.builder.SearchSourceBuilder;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.test.context.junit4.SpringRunner;import java.io.IOException;@RunWith(SpringRunner.class)@SpringBootTestpublic class GulimallSearchApplicationTests &#123; @Autowired private RestHighLevelClient client; /*\\ * æµ‹è¯•å¤æ‚æ£€ç´¢ */ @Test public void complexSearch() throws IOException &#123; // åˆ›å»ºæ£€ç´¢è¯·æ±‚ SearchRequest searchRequest = new SearchRequest(); // æŒ‡å®šç´¢å¼• searchRequest.indices(&quot;bank&quot;); // æŒ‡å®šæ£€ç´¢æ¡ä»¶ SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder(); /* * searchSourceBuilder.query(); * searchSourceBuilder.aggregation(); * searchSourceBuilder.from() * searchSourceBuilder.size() */ /* * searchSourceBuilder.query(QueryBuilders.matchAllQuery()); * searchSourceBuilder.query(QueryBuilders.matchPhraseQuery()); * searchSourceBuilder.query(QueryBuilders.matchQuery(&quot;address&quot;, &quot;mill&quot;)); */ /* * searchSourceBuilder.aggregation(AggregationBuilders.avg(&quot;&quot;).field(&quot;&quot;)); * searchSourceBuilder.aggregation(AggregationBuilders.terms(&quot;&quot;).field(&quot;&quot;).size(99)); * â€¦â€¦ */ searchSourceBuilder.query(QueryBuilders.matchQuery(&quot;address&quot;, &quot;mill&quot;)); //1.2ï¼‰ã€æŒ‰ç…§å¹´é¾„çš„å€¼åˆ†å¸ƒè¿›è¡Œèšåˆ TermsAggregationBuilder ageAgg = AggregationBuilders.terms(&quot;ageAgg&quot;).field(&quot;age&quot;).size(10); searchSourceBuilder.aggregation(ageAgg); //1.3ï¼‰ã€è®¡ç®—å¹³å‡è–ªèµ„ AvgAggregationBuilder balanceAvg = AggregationBuilders.avg(&quot;balanceAvg&quot;).field(&quot;balance&quot;); searchSourceBuilder.aggregation(balanceAvg); System.out.println(&quot;æ£€ç´¢æ¡ä»¶: &quot; + searchSourceBuilder.toString()); // æŒ‡å®šæ£€ç´¢æ¡ä»¶å¯¹è±¡ searchRequest.source(searchSourceBuilder); // æ‰§è¡Œæ£€ç´¢ SearchResponse response = client.search(searchRequest, GulimallElasticSearchConfig.COMMON_OPTIONS); // åˆ†æç»“æœ; // è·å¾—hitç»“æœ SearchHits hits = response.getHits(); SearchHit[] hitsHits = hits.getHits(); for (SearchHit hit : hitsHits) &#123; String sourceAsString = hit.getSourceAsString(); Accout accout = JSON.parseObject(sourceAsString, Accout.class); System.out.println(&quot;accoutï¼š&quot; + accout); &#125; //è·å–è¿™æ¬¡æ£€ç´¢åˆ°çš„åˆ†æä¿¡æ¯ï¼› Aggregations aggregations = response.getAggregations();// for (Aggregation aggregation : aggregations.asList()) &#123;// System.out.println(&quot;å½“å‰èšåˆï¼š&quot;+aggregation.getName());// &#125; Terms terms = aggregations.get(&quot;ageAgg&quot;); for (Terms.Bucket bucket : terms.getBuckets()) &#123; String keyAsString = bucket.getKeyAsString(); System.out.println(&quot;å¹´é¾„ï¼š&quot; + keyAsString + &quot;==&gt;&quot; + bucket.getDocCount()); &#125; Avg balanceAvg1 = aggregations.get(&quot;balanceAvg&quot;); System.out.println(&quot;å¹³å‡è–ªèµ„ï¼š&quot; + balanceAvg1.getValue()); &#125; @ToString @Data static class Accout &#123; private int account_number; private int balance; private String firstname; private String lastname; private int age; private String gender; private String address; private String employer; private String email; private String city; private String state; &#125; /*\\ * æµ‹è¯•å­˜å‚¨ */ @Test public void indexData() throws IOException &#123; // åˆ›å»ºindexRequestï¼Œä¼ å…¥indexå€¼ IndexRequest indexRequest = new IndexRequest(&quot;users&quot;); indexRequest.id(&quot;1&quot;); // ä¼ å…¥æ–‡æ¡£(jsonStringæ ¼å¼) User user = new User(&quot;å¼ ä¸‰&quot;, &quot;ç”·&quot;, 18); String jsonString = JSON.toJSONString(user); indexRequest.source(jsonString, XContentType.JSON); // æ‰§è¡Œæ“ä½œå¹¶è·å¾—å“åº”æ•°æ® IndexResponse response = client.index(indexRequest, GulimallElasticSearchConfig.COMMON_OPTIONS); System.out.println(response); &#125; // è‡ªå®šä¹‰ç±»å‹ @Data static class User &#123; private String username; private String gender; private Integer age; public User(String username, String gender, Integer age) &#123; this.username = username; this.gender = gender; this.age = age; &#125; &#125; @Test public void contextLoads() &#123; System.out.println(client); &#125;&#125; å•†å“ä¸Šæ¶ å•†å“ç³»ç»Ÿâ€”å•†å“ç»´æŠ¤â€”SPUç®¡ç†â€”ä¸Šæ¶ ä¸Šæ¶å³å°†å•†å“æ•°æ®ä¿å­˜è‡³ESä¸­ï¼Œåªæœ‰ä¸Šæ¶çš„å•†å“æ‰èƒ½è¢«å…¨æ–‡æ£€ç´¢ã€‚ SKUåœ¨ESä¸­å­˜å‚¨æ¨¡å‹ æ£€ç´¢ä¼šæ ¹æ®ï¼šSKUçš„æ ‡é¢˜ã€ä»·æ ¼ã€é”€é‡ã€å“ç‰Œã€åˆ†ç±»ã€å•†å“è§„æ ¼ç­‰è¿›è¡Œæ£€ç´¢ æ¨¡å‹è®¾è®¡éœ€è¦èŠ±è´¹ä¸€å®šå¿ƒæ€ï¼Œè¯¦è§æ–‡æ¡£09ã€å•†åŸä¸šåŠ¡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;skuId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;spuId&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;skuTitle&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;ik_smart&quot; &#125;, &quot;skuPrice&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;skuImg&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;index&quot;: false, &quot;doc_values&quot;: false &#125;, &quot;saleCount&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;hasStock&quot;: &#123; &quot;type&quot;: &quot;boolean&quot; &#125;, &quot;hotScore&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;brandId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;catalogId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;brandName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;index&quot;: false, &quot;doc_values&quot;: false &#125;, &quot;brandImg&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;index&quot;: false, &quot;doc_values&quot;: false &#125;, &quot;catalogName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;index&quot;: false, &quot;doc_values&quot;: false &#125;, &quot;attrs&quot;: &#123; &quot;type&quot;: &quot;nested&quot;, &quot;properties&quot;: &#123; &quot;attrId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;attrName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;index&quot;: false, &quot;doc_values&quot;: false &#125;, &quot;attrValue&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125; &#125; &#125;&#125; â€œindexâ€:falseâ€œdoc_valuesâ€:false è¡¨ç¤ºè¯¥å†—ä½™çš„å­—æ®µä¸éœ€è¦ç”¨äºæ£€ç´¢ä¸èšåˆ æ£€ç´¢æœåŠ¡å›æ¥è¡¨ç¤ºï¼Œè¿™ä¸ªè®¾ç½®æ•°æ®ç±»å‹çš„æ­¥éª¤å¾ˆé‡è¦ï¼Œç‰¹åˆ«æ˜¯nestedè¿™ç§ è¿™é‡Œçš„æ¨¡å‹å¿…é¡»ä¿®æ”¹ï¼Œè¶…çº§æ„Ÿè°¢ä¸€ä¸ªå¤§ä½¬ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»† æ£€ç´¢æœåŠ¡ Â· è¯­é›€ (yuque.com) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374# æŸ¥çœ‹åŸæ¥çš„æ˜ å°„è§„åˆ™GET gulimall_product/_mapping# ä¿®æ”¹ä¸ºæ–°çš„æ˜ å°„ å¹¶åˆ›å»ºæ–°çš„ç´¢å¼•ï¼Œä¸‹é¢è¿›è¡Œæ•°æ®è¿ç§»PUT /mall_product&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;skuId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;spuId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;skuTitle&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;ik_smart&quot; &#125;, &quot;skuPrice&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;skuImg&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;saleCount&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;hosStock&quot;: &#123; &quot;type&quot;: &quot;boolean&quot; &#125;, &quot;hotScore&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;brandId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;catalogId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;brandName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;brandImg&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;catalogName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;attrs&quot;: &#123; &quot;type&quot;: &quot;nested&quot;, &quot;properties&quot;: &#123; &quot;attrId&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;attrName&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;attrValue&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125; &#125; &#125;&#125;# æ•°æ®è¿ç§»POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;gulimall_product&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;mall_product&quot; &#125;&#125; gulimall-productSkuEsModel å†™åœ¨commonçš„toæ–‡ä»¶å¤¹ä¸­ï¼Œä½œä¸ºä¼ è¾“å¯¹è±¡ 12345678910111213141516171819202122232425262728293031323334353637@Datapublic class SkuEsModel &#123; private Long skuId; private Long spuId; private String skuTitle; private BigDecimal skuPrice; private String skuImg; private Long saleCount; private Boolean hasStock; private Long hotScore; private Long brandId; private Long catalogId; private String brandName; private String brandImg; private String catalogName; private List&lt;Attrs&gt; attrs; @Data public static class Attrs &#123; private Long attrId; private String attrName; private String attrValue; &#125;&#125; SkuHasStockTo12345@Datapublic class SkuHasStockTo &#123; private Long skuId; private Boolean hasStock;&#125; SpuInfoController123456789101112131415@RestController@RequestMapping(&quot;product/spuinfo&quot;)public class SpuInfoController &#123; @Autowired private SpuInfoService spuInfoService; /** * å•†å“ä¸Šæ¶ï¼Œä¿å­˜åˆ°ESä¸­ */ @PostMapping(&quot;/&#123;spuId&#125;/up&#125;&quot;) public R spuUp(@PathVariable(&quot;spuId&quot;) Long spuId) &#123; spuInfoService.spuUp(spuId); return R.ok(); &#125;&#125; SpuInfoServiceImpl12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485 /* * å•†å“ä¸Šæ¶ */ @Override public void spuUp(Long spuId) &#123; // å°†æ•°æ®å­˜å…¥SkuEsModelå¯¹è±¡å½“ä¸­ // 1 æŸ¥å‡ºskuå“ç‰Œå’Œåˆ†ç±»ä¿¡æ¯ï¼ˆä¸éœ€è¦å¯¹æ¯ä¸ªskuéƒ½æŸ¥è¯¢ï¼Œæ‰€ä»¥æ”¾åœ¨streamå¤–é¢ï¼‰ SpuInfoEntity spuInfoEntity = this.getById(spuId); BrandEntity brandEntity = brandService.getById(spuInfoEntity.getBrandId()); Long brandId = brandEntity.getBrandId(); String brandLogo = brandEntity.getLogo(); String brandName = brandEntity.getName(); CategoryEntity categoryEntity = categoryService.getById(spuInfoEntity.getCatalogId()); String categoryName = categoryEntity.getName(); // 2 æŸ¥å‡ºskuçš„attr,å¹¶ä¸”æ˜¯å¯ä»¥è¢«å…¨æ–‡æ£€ç´¢çš„ List&lt;ProductAttrValueEntity&gt; baseAttrList = productAttrValueService.baseAttrListForSpu(spuId); List&lt;Long&gt; attrIdList = baseAttrList.stream().map(attr -&gt; &#123; return attr.getAttrId(); &#125;).collect(Collectors.toList()); // æ ¹æ®æŸ¥å‡ºçš„æ‰€æœ‰attræ‰¾å‡ºå¯ä»¥è¢«å…¨æ–‡æ£€ç´¢çš„ List&lt;Long&gt; searchAttrIdList = attrService.getIdsCanSearch(attrIdList); // ä½¿ç”¨SETé›†åˆæ–¹ä¾¿åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŒ‡å®šid Set&lt;Long&gt; idSet = new HashSet&lt;&gt;(searchAttrIdList); List&lt;SkuEsModel.Attrs&gt; skuEsModelAttrsList = baseAttrList.stream().filter(attr -&gt; &#123; return idSet.contains(attr.getAttrId()); &#125;).map(attr -&gt; &#123; SkuEsModel.Attrs attrEntity = new SkuEsModel.Attrs(); BeanUtils.copyProperties(attr, attrEntity); return attrEntity; &#125;).collect(Collectors.toList()); // 3 æŸ¥å‡ºå½“å‰spuidå¯¹åº”çš„skuä¿¡æ¯ List&lt;SkuInfoEntity&gt; skuInfoEntities = skuInfoService.getSkuListBySpuId(spuId); Map&lt;Long, Boolean&gt; skuHasStockCollect = new HashMap&lt;&gt;(); try &#123; // 3.5 æŸ¥å‡ºæ‰€æœ‰skuçš„æ˜¯å¦æœ‰åº“å­˜ä¿¡æ¯ List&lt;SkuHasStockTo&gt; skuHasStockList = wareFeignService.getSkuHasStockList(skuInfoEntities.stream().map(SkuInfoEntity::getSkuId).collect(Collectors.toList())); // å°è£…åˆ°mapå½“ä¸­ï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢å¯¹åº”keyçš„value skuHasStockCollect = skuHasStockList.stream().collect(Collectors.toMap(SkuHasStockTo::getSkuId, item -&gt; item.getHasStock())); &#125; catch (Exception e) &#123; log.error(&quot;åº“å­˜æœåŠ¡è¿œç¨‹è°ƒç”¨å¼‚å¸¸ï¼šåŸå› &#123;&#125;&quot;, e); &#125; // 4 å°è£…æ¯ä¸ªskuä¿¡æ¯ Map&lt;Long, Boolean&gt; finalSkuHasStockCollect = skuHasStockCollect; List&lt;SkuEsModel&gt; upSku = skuInfoEntities.stream().map(skuInfo -&gt; &#123; SkuEsModel skuEsModel = new SkuEsModel(); BeanUtils.copyProperties(skuInfo, skuEsModel); skuEsModel.setSkuPrice(skuInfo.getPrice()); skuEsModel.setSkuImg(skuInfo.getSkuDefaultImg()); // è¿œç¨‹è°ƒç”¨åº“å­˜ç³»ç»Ÿæ˜¯å¦æœ‰åº“å­˜ if (finalSkuHasStockCollect == null) &#123; skuEsModel.setHasStock(true); &#125; else &#123; skuEsModel.setHasStock(finalSkuHasStockCollect.get(skuInfo.getSkuId())); &#125; skuEsModel.setHotScore(0L); skuEsModel.setBrandId(brandId); skuEsModel.setBrandImg(brandLogo); skuEsModel.setBrandName(brandName); skuEsModel.setCatalogName(categoryName); skuEsModel.setAttrs(skuEsModelAttrsList); return skuEsModel; &#125;).collect(Collectors.toList()); // 5 å‘ç»™ES R r = searchFeignService.productStatusUp(upSku); if (r.getCode() == 0) &#123; // è¿œç¨‹è°ƒç”¨æˆåŠŸ // ä¿®æ”¹spuçš„çŠ¶æ€ä¸ºä¸Šæ¶ SpuInfoEntity spu = new SpuInfoEntity(); spu.setId(spuId); spu.setPublishStatus(ProductConstant.StatusEnum.SPU_UP.getCode()); this.updateById(spu); &#125; else &#123; // TODO è¿œç¨‹è°ƒç”¨å¤±è´¥ &#125; &#125;&#125; WareFeignService12345678@FeignClient(&quot;gulimall-ware&quot;)public interface WareFeignService &#123; /* * æ£€æŸ¥æ¯ä¸ªskuæ˜¯å¦åˆåº“å­˜ */ @PostMapping(&quot;/ware/waresku/hasstock&quot;) R getSkuHasStockList(@RequestBody List&lt;Long&gt; skuIdList);&#125; SearchFeignService12345@FeignClient(&quot;gulimall-search&quot;)public interface SearchFeignService &#123; @PostMapping(&quot;/search/save/product&quot;) R productStatusUp(@RequestBody List&lt;SkuEsModel&gt; skuEsModelList);&#125; AttrDao12345678910&lt;!-- åœ¨æŒ‡å®šçš„é›†åˆä¸­æ‰¾åˆ°æ‰€æœ‰å¯ä»¥åˆ«å…¨æ–‡æ£€ç´¢çš„ --&gt;&lt;select id=&quot;selectIdsWithSearchAttr&quot; resultType=&quot;java.lang.Long&quot;&gt; SELECT attr_id from gulimall_pms.pms_attr WHERE attr_id IN &lt;foreach collection=&quot;attrIdList&quot; item=&quot;id&quot; separator=&quot;,&quot; open=&quot;(&quot; close=&quot;)&quot;&gt; #&#123;id&#125; &lt;/foreach&gt; AND search_type = 1&lt;/select&gt; R ç»™RåŠ ä¸Šæ³›å‹ï¼Œç”¨äºæ–¹ä¾¿è¿œç¨‹è°ƒç”¨ç›´æ¥ä¼ è¾“å¯¹åº”æ•°æ®ï¼ˆåˆ«çš„æ–¹æ³•ä¹Ÿå¯ä»¥ï¼‰ æˆ‘ä¸æƒ³å†™æ³›å‹ï¼Œæ³›å‹ä¹Ÿè¿˜æ˜¯è¦åŠ ä¸€ä¸ªTOï¼Œç›´æ¥ä¼ ä¸€ä¸ªTOå‘—ï¼Œæˆ‘ä¹Ÿä¸æƒ³çŸ¥é“Rçš„å…¶ä»–ä¿¡æ¯ 123456789101112public class R&lt;T&gt; extends HashMap&lt;String, Object&gt; &#123; private static final long serialVersionUID = 1L; private T data; public T getData() &#123; return data; &#125; public void setData(T data) &#123; this.data = data; &#125; gulimall-wareWareSkuController1234567891011121314@RestController@RequestMapping(&quot;ware/waresku&quot;)public class WareSkuController &#123; @Autowired private WareSkuService wareSkuService; /* * æ£€æŸ¥æ¯ä¸ªskuæ˜¯å¦åˆåº“å­˜ */ @PostMapping(&quot;/hasstock&quot;) public List&lt;SkuHasStockTo&gt; getSkuHasStockList(@RequestBody List&lt;Long&gt; skuIdList) &#123; List&lt;SkuHasStockTo&gt; hasStock = wareSkuService.getSkuHasStockList(skuIdList); return hasStock; &#125;&#125; WareSkuServiceImpl123456789101112131415/* * æ£€æŸ¥æ¯ä¸ªskuæ˜¯å¦åˆåº“å­˜ */@Overridepublic List&lt;SkuHasStockTo&gt; getSkuHasStockList(List&lt;Long&gt; skuIdList) &#123; List&lt;SkuHasStockTo&gt; voList = skuIdList.stream().map(skuId -&gt; &#123; SkuHasStockTo skuHasStockVo = new SkuHasStockTo(); Long count = baseMapper.getSkuStock(skuId); skuHasStockVo.setSkuId(skuId); // å¯èƒ½æ²¡æœ‰åº“å­˜è¿”å›null skuHasStockVo.setHasStock(count != null &amp;&amp; count &gt; 0); return skuHasStockVo; &#125;).collect(Collectors.toList()); return voList;&#125; WareSkuDao12345&lt;select id=&quot;getSkuStock&quot; resultType=&quot;java.lang.Long&quot;&gt; SELECT SUM(stock - stock_locked) FROM gulimall_wms.wms_ware_sku WHERE sku_id = #&#123;skuId&#125;;&lt;/select&gt; gulimall-searchElasticSearchController1234567891011121314151617181920@RestController@RequestMapping(&quot;/search&quot;)public class ElasticSearchController &#123; @Autowired ElasticSearchService searchService; /** * ä¸Šæ¶å•†å“ * * @param skuEsModelList * @return */ @PostMapping(&quot;/product&quot;) public R productStatusUp(@RequestBody List&lt;SkuEsModel&gt; skuEsModelList) &#123; searchService.productUp(skuEsModelList); return R.ok(); &#125;&#125; ElasticSearchServiceImpl123456789101112131415161718192021222324252627282930313233343536@Slf4j@Servicepublic class ElasticSearchServiceImpl implements ElasticSearchService &#123; @Autowired RestHighLevelClient client; /** * ä¸Šæ¶å•†å“ * * @param skuEsModelList * @return */ @Override public Boolean productUp(List&lt;SkuEsModel&gt; skuEsModelList) throws IOException &#123; // åˆ›å»ºç´¢å¼• BulkRequest bulkRequest = new BulkRequest(); for (SkuEsModel skuEsModel : skuEsModelList) &#123; //æ„é€ ä¿å­˜è¯·æ±‚ IndexRequest indexRequest = new IndexRequest(EsConstant.PRODUCT_INDEX); indexRequest.id(String.valueOf(skuEsModel.getSkuId())); indexRequest.source(JSON.toJSONString(skuEsModel), XContentType.JSON); // ä¿å­˜è¯·æ±‚æ·»åŠ åˆ°bulkä¸­ bulkRequest.add(indexRequest); &#125; // æ‰§è¡Œæ‰¹é‡æ“ä½œ BulkResponse bulk = client.bulk(bulkRequest, GulimallElasticSearchConfig.COMMON_OPTIONS); // TODO å¦‚æœæœ‰é”™è¯¯å¯ä»¥å¤„ç† boolean hasFailures = bulk.hasFailures(); List&lt;String&gt; collect = Arrays.stream(bulk.getItems()).map(item -&gt; &#123; return item.getId(); &#125;).collect(Collectors.toList()); log.error(&quot;å•†å“ä¸Šæ¶ä¿¡æ¯ï¼š&#123;&#125;&quot;, collect); return hasFailures; &#125;&#125; DEBUG æ‡’å¾—å†™ï¼Œä¸»è¦æ˜¯hasFailuresè¿”å›å€¼å¾—åˆ¤æ–­ï¼Œä»¥åŠè¿œç¨‹è°ƒç”¨è¿”å›å€¼ï¼ˆä½¿ç”¨TOå°±ä¸ä¼šï¼ŒRæ³›å‹éœ€è¦ä¿®æ”¹ï¼‰ kibana -&gt; GET product/_searchæŸ¥çœ‹æ˜¯å¦æœ‰æ•°æ® è·Ÿç€åšé¡ºç•…ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å†çœ‹ä¸€éç„¶åè‡ªå·±åš å•†åŸé¦–é¡µæ•´åˆthemeleaf éœ‡æƒŠï¼Œç«Ÿç„¶è¦ç”¨æ¨¡æ¿å¼•æ“ï¼Œæƒ³å¿µVUEçš„ç¬¬ä¸€å¤© ä¾èµ–123456&lt;!-- thymleafæ¨¡æ¿å¼•æ“ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;version&gt;2.1.8.RELEASE&lt;/version&gt;&lt;/dependency&gt; é…ç½® å…³é—­ç¼“å­˜ç­‰ æ‰€æœ‰å‰å°çš„controllerç»Ÿä¸€å­˜æ”¾åœ¨webæ–‡ä»¶å¤¹ä¸‹ï¼Œè€Œåå°åœ¨appå½“ä¸­ 123springboot: thymeleaf: cache: false é™æ€èµ„æº é™æ€èµ„æºæ”¾åœ¨resources -&gt; staticä¸‹ï¼Œæ¨¡æ¿é¡µé¢æ”¾åœ¨templatesæ–‡ä»¶å¤¹ä¸‹å³å¯ ä¹Ÿå¯ä»¥ä¿®æ”¹resources locationé…ç½® å¼•å…¥dev-tools çƒ­éƒ¨ç½² ä¾èµ–123456&lt;!-- dev tool --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt; é…ç½®æ¸²æŸ“ä¸€çº§åˆ†ç±» ç®€ç›´æ˜¯æ–‡è‰ºå¤å…´äº† ä»¥åthymeleafçš„æ¨¡æ¿ä¿®æ”¹æˆ‘å°±ä¸POäº†ï¼Œéº»çƒ¦ IndexController123456789101112131415@Controller // ä¸é€‚ç”¨RESTControllerpublic class IndexController &#123; @Autowired CategoryService categoryService; @GetMapping(&#123;&quot;/&quot;, &quot;/index.html&quot;&#125;) public String indexPage(Model model) &#123; // 1 æŸ¥å‡ºæ‰€æœ‰ä¸€çº§åˆ†ç±» List&lt;CategoryEntity&gt; categoryEntityList = categoryService.getLevel1List(); // thymeleafå·²ç»æœ‰äº†é»˜è®¤å‰ç¼€ï¼Œå®šä½åˆ°classpath:/resources/templates // é»˜è®¤åç¼€ html model.addAttribute(&quot;categoryList&quot;, categoryEntityList); return &quot;index&quot;; &#125;&#125; CategoryServiceImpl12345678/** * å‰å°ï¼šæ¸²æŸ“é¦–é¡µ */@Overridepublic List&lt;CategoryEntity&gt; getLevel1List() &#123; List&lt;CategoryEntity&gt; categoryEntityList = baseMapper.selectList(new QueryWrapper&lt;CategoryEntity&gt;().eq(&quot;parent_cid&quot;, 0)); return categoryEntityList;&#125; index.html1234567891011&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; &lt;!--è½®æ’­ä¸»ä½“å†…å®¹--&gt; &lt;div class=&quot;header_main&quot;&gt; &lt;div class=&quot;header_banner&quot;&gt; &lt;div class=&quot;header_main_left&quot;&gt; &lt;ul&gt; &lt;li th:each=&quot;category : $&#123;categoryList&#125;&quot;&gt; &lt;a href=&quot;/static/#&quot; class=&quot;header_main_left_a&quot; th:attr=&quot;ctg-data=$&#123;category.catId&#125;&quot;&gt;&lt;b th:text=&quot;$&#123;category.name&#125;&quot;&gt;å®¶ç”¨ç”µå™¨&lt;/b&gt;&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; æ¸²æŸ“å­çº§åˆ†ç±»CategoryFrontVo12345678910111213141516171819202122232425/* * äºŒçº§åˆ†ç±»VO */@AllArgsConstructor@NoArgsConstructor@Datapublic class Catalog2Vo &#123; // è¿™ä¸ªå±æ€§åè¦å’Œå‰ç«¯éœ€è¦çš„JSONå¯¹åº” private String catalog1Id; // ä¸€çº§çˆ¶åˆ†ç±»id private List&lt;Catalog3Vo&gt; catalog3List; // ä¸‰çº§åˆ†ç±»ï¼ˆæœ¬voä¸ºäºŒçº§åˆ†ç±»ï¼‰ private String id; private String name; /* * ä¸‰çº§åˆ†ç±»VO */ @AllArgsConstructor @NoArgsConstructor @Data public static class Catalog3Vo &#123; private String catalog2Id; private String id; private String name; &#125;&#125; IndexController12345678910/* * æ¸²æŸ“äºŒçº§ã€ä¸‰çº§åˆ†ç±» * è¿™é‡Œçš„è·¯å¾„ä¸catalogLoader.jsä¸­å‘é€è¯·æ±‚çš„è·¯å¾„ä¸€è‡´ */@ResponseBody // è¿”å›å€¼ä»¥JSONæ–¹å¼è¿”å›ï¼Œä¸”ä¸éœ€è¦è·³è½¬é¡µé¢@GetMapping(&quot;/index/catalog.json&quot;)public Map&lt;String, List&lt;Catalog2Vo&gt;&gt; getCatalogJson(Model model) &#123; Map&lt;String, List&lt;Catalog2Vo&gt;&gt; category = categoryService.getCatalogJson(); return category;&#125; CategoryServiceImpl1234567891011121314151617181920212223242526272829303132/* * æ¸²æŸ“äºŒçº§ã€ä¸‰çº§åˆ†ç±» */@Overridepublic Map&lt;String, List&lt;Catalog2Vo&gt;&gt; getCatalogJson() &#123; List&lt;CategoryEntity&gt; level1List = this.getLevel1List(); // å°è£…æ•°æ® Map&lt;String, List&lt;Catalog2Vo&gt;&gt; catalogMap = level1List.stream().collect(Collectors.toMap(k -&gt; &#123; return k.getCatId().toString(); &#125;, parent -&gt; &#123; // å°†äºŒçº§åˆ†ç±»çš„å†…å®¹å°è£…åˆ°ä¸€çº§åˆ†ç±»å½“ä¸­ List&lt;CategoryEntity&gt; children2List = baseMapper.selectList(new QueryWrapper&lt;CategoryEntity&gt;().eq(&quot;parent_cid&quot;, parent.getCatId())); List&lt;Catalog2Vo&gt; catalog2VoList = null; if (children2List != null) &#123; catalog2VoList = children2List.stream().map(child2 -&gt; &#123; Catalog2Vo catalog2Vo = new Catalog2Vo(parent.getCatId().toString(), null, child2.getCatId().toString(), child2.getName()); // å°è£…ä¸‰çº§åˆ†ç±»ä¿¡æ¯ List&lt;CategoryEntity&gt; children3List = baseMapper.selectList(new QueryWrapper&lt;CategoryEntity&gt;().eq(&quot;parent_cid&quot;, child2.getCatId())); if (children3List != null) &#123; List&lt;Catalog2Vo.Catalog3Vo&gt; catalog3VoList = children3List.stream().map(child3 -&gt; &#123; Catalog2Vo.Catalog3Vo catalog3Vo = new Catalog2Vo.Catalog3Vo(child2.getCatId().toString(), child3.getCatId().toString(), child3.getName()); return catalog3Vo; &#125;).collect(Collectors.toList()); catalog2Vo.setCatalog3List(catalog3VoList); &#125; return catalog2Vo; &#125;).collect(Collectors.toList()); &#125; return catalog2VoList; &#125;)); return catalogMap;&#125; ä¸ºå•¥è€å¸ˆè¿™ä¹ˆå–œæ¬¢åµŒå¥—ï¼Ÿ ä¼˜åŒ–å­çº§åˆ†ç±»CategoryServiceImpl1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/* * æ¸²æŸ“äºŒçº§ã€ä¸‰çº§åˆ†ç±» */@Overridepublic Map&lt;String, List&lt;Catalog2Vo&gt;&gt; getCatalogJson() &#123; /* * ä¼˜åŒ– * å¤šæ¬¡æŸ¥è¯¢æ•°æ®åº“ -ã€‹ ä¸€æ¬¡æŸ¥è¯¢ */ // ä¸€æ¬¡æŸ¥è¯¢æ•°æ®åº“ï¼Œè·å¾—æ‰€æœ‰çš„åˆ†ç±» List&lt;CategoryEntity&gt; allCatList = baseMapper.selectList(null); // è·å¾—ä¸€çº§åˆ†ç±» List&lt;CategoryEntity&gt; level1List = getCatListByParentCid(allCatList, 0L); // å°è£…æ•°æ® Map&lt;String, List&lt;Catalog2Vo&gt;&gt; catalogMap = level1List.stream().collect(Collectors.toMap(k -&gt; &#123; return k.getCatId().toString(); &#125;, parent -&gt; &#123; // å°†äºŒçº§åˆ†ç±»çš„å†…å®¹å°è£…åˆ°ä¸€çº§åˆ†ç±»å½“ä¸­ List&lt;CategoryEntity&gt; children2List = getCatListByParentCid(allCatList, parent.getCatId()); List&lt;Catalog2Vo&gt; catalog2VoList = null; if (children2List != null) &#123; catalog2VoList = children2List.stream().map(child2 -&gt; &#123; Catalog2Vo catalog2Vo = new Catalog2Vo(parent.getCatId().toString(), null, child2.getCatId().toString(), child2.getName()); // å°è£…ä¸‰çº§åˆ†ç±»ä¿¡æ¯ List&lt;CategoryEntity&gt; children3List = getCatListByParentCid(allCatList, child2.getCatId()); if (children3List != null) &#123; List&lt;Catalog2Vo.Catalog3Vo&gt; catalog3VoList = children3List.stream().map(child3 -&gt; &#123; Catalog2Vo.Catalog3Vo catalog3Vo = new Catalog2Vo.Catalog3Vo(child2.getCatId().toString(), child3.getCatId().toString(), child3.getName()); return catalog3Vo; &#125;).collect(Collectors.toList()); catalog2Vo.setCatalog3List(catalog3VoList); &#125; return catalog2Vo; &#125;).collect(Collectors.toList()); &#125; return catalog2VoList; &#125;)); return catalogMap;&#125;/* * æ ¹æ®parentCidæŸ¥è¯¢ä¸‹çº§åˆ†ç±» */private List&lt;CategoryEntity&gt; getCatListByParentCid(List&lt;CategoryEntity&gt; allCatList, Long parentCid) &#123; // return baseMapper.selectList(new QueryWrapper&lt;CategoryEntity&gt;().eq(&quot;parent_cid&quot;, parent.getCatId())); List&lt;CategoryEntity&gt; collect = allCatList.stream().filter(categoryEntity -&gt; &#123; return categoryEntity.getParentCid().equals(parentCid); &#125;).collect(Collectors.toList()); return collect;&#125; é…ç½®åå‘ä»£ç†ğŸ’¡ æ­£å‘ä»£ç†ï¼šå¦‚ç§‘å­¦ä¸Šç½‘ï¼Œéšè—å®¢æˆ·ç«¯ä¿¡æ¯ åå‘ä»£ç†ï¼šå±è”½å†…ç½‘æœåŠ¡å™¨ä¿¡æ¯ï¼Œè´Ÿè½½å‡è¡¡è®¿é—® é…ç½®host C:\\Windows\\System32\\drivers\\etc\\host æ–‡ä»¶æ·»åŠ ä¸Šåœ°å€ ä½¿ç”¨switchHostè½¯ä»¶å¯ä»¥å¿«é€Ÿåº”ç”¨æ–¹æ¡ˆ 192.168.128.129/192.168.128.129:80(nginxé»˜è®¤åœ°å€) -&gt; gulimall.com é…ç½®nginx è™šæ‹Ÿæœºå¤–éƒ¨æŒ‚è½½ä¸‹çš„confæ–‡ä»¶ /mydata/nginx/conf/nginx.conf /mydata/nginx/conf/conf.d/default.conf å¯ä»¥å…ˆå¤åˆ¶æœ‰ä»½confåœ¨é…ç½® 123456789101112131415161718http &#123;upstream gulimall&#123; server 192.168.128.1:88; &#125;&#125;server &#123; listen 80; server_name gulimall.com; #charset koi8-r; #access_log /var/log/nginx/log/host.access.log main; location / &#123; # éœ€è¦é…ç½®headerï¼Œæ·»åŠ ä¸Šhostï¼Œå› ä¸ºnginxè½¬å‘ä»£ç†ç»™ç½‘å…³çš„æ—¶å€™ä¼šä¸¢å¤±è®¸å¤šä¿¡æ¯ proxy_set_header Host $host; proxy_pass http://gulimall; &#125; TODO è½¬ä¸äº†ä¸ºä»€ä¹ˆï¼Ÿnginxå¯ä»¥è®¿é—®åˆ°ï¼Œä½†æ˜¯nginxè½¬å‘ä¸åˆ°æœ¬æœºï¼Œæˆ‘æ„Ÿè§‰è¿˜æ˜¯proxy_passé…ç½®çš„é—®é¢˜ï¼Œä½†æ˜¯æˆ‘æ¯ä¸ªipéƒ½è¯•è¿‡äº†ï¼Ÿ æˆ‘ä¸ç†è§£ï¼š192.168.128.1:10000æ˜¯å¯ä»¥çš„ï¼Œhttp://192.168.128.129:5601ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè™šæ‹Ÿæœºping 192.168.128.1ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Ÿ ç›®æµ‹æ˜¯æœ¬æœº -&gt; è™šæ‹Ÿæœºnginxæ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯nginx -&gt; æœ¬æœº192.168.128.1:10000å¤±è´¥äº† é‡ç‚¹è¯´æ˜ï¼ï¼ï¼ä»¥ä¸Šé—®é¢˜å·²è§£å†³ï¼Œæ˜¯æœ¬æœºé˜²ç«å¢™çš„åŸå› ï¼Œæ“ä½œå¦‚ä¸‹Windows é€šè¿‡å‘½ä»¤è¡Œå…³é—­é˜²ç«å¢™-ç™¾åº¦ç»éªŒ (baidu.com) æ„Ÿè°¢ï¼šè°·ç²’å•†åŸé«˜çº§ç¯‡p139ã€p140Nginxåå‘ä»£ç†ï¼Œç½‘å…³é…ç½®ä¸ç”Ÿæ•ˆè§£å†³_å«é›·çš„åšå®¢-CSDNåšå®¢ï¼ˆè¢«pingé€šæ¬ºéª—äº†ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æ’é™¤äº†é˜²ç«å¢™ï¼‰ å…³æ‰æœ¬æœºçš„é˜²ç«å¢™ï¼Œè™šæ‹Ÿæœºçš„nginxå°±èƒ½è½¬å‘åˆ°æœ¬æœºäº†ï¼ï¼ï¼ é…ç½®ç½‘å…³12345# -----------------------nginxï¼Œä¸€å®šè¦æ”¾åœ¨æœ€åï¼Œè¦ä¸ç„¶/api/ä¸‹çš„é…ç½®ä¼šè¢«è¦†ç›–------------------------ id: gulimall_host_route uri: lb://gulimall-product predicates: - Host=**.gulimall.com,gulimall.com æ€»ç»“ä¸€ä¸‹å®ç°ï¼šè™šæ‹Ÿæœº192.168.128.129 é€šè¿‡ä¿®æ”¹winçš„hostæ–‡ä»¶ï¼Œç›¸å½“äºgulimall.comï¼Œ192.168.128.1:10000 æ˜¯æœ¬æœºå•†å“æœåŠ¡çš„åœ°å€ï¼Œç°åœ¨éœ€è¦é€šè¿‡è¯·æ±‚nginxï¼Œç„¶ånginxä»£ç†ç½‘å…³ï¼Œç½‘å…³å†è½¬å‘ç»™å¯¹åº”æœåŠ¡åœ°å€ï¼Œæ‰€ä»¥åœ¨è™šæ‹Ÿæœºçš„nginxä¸­é…ç½®ï¼Œè¯·æ±‚192.168.128.129:80ï¼ˆnginxç«¯å£80ï¼‰ï¼Œæœ¬æ¥æ˜¯è¯·æ±‚è™šæ‹Ÿæœºçš„nginxï¼Œç„¶ånginxé…ç½®80ç«¯å£ä»£ç†åœ°å€192.168.128.1:88ï¼ˆå³æœ¬æœºçš„ç½‘å…³åœ°å€ï¼‰ï¼Œç„¶åç½‘å…³é…ç½®**.gulimall.comè½¬å‘åˆ°gulimall-productæœåŠ¡å®ç°ã€‚ æœ¬æœºè¯·æ±‚ -&gt; è™šæ‹Ÿæœºnginx -&gt; æœ¬æœºç½‘å…³ -&gt; æœ¬åœ°æœåŠ¡åœ°å€ æ€§èƒ½å‹æµ‹å‹åŠ›æµ‹è¯• å…·ä½“ä»‹ç»è§è¯¾ä»¶04 Jmeter æ­£å¥½æµ‹è¯•è¯¾è¦å†™æµ‹è¯•å·¥å…·æŠ¥å‘Š è¯¦ç»†è§æµ‹è¯•å·¥å…·æŠ¥å‘Š æ€§èƒ½ç›‘æ§å †å†…å­˜ä¸åƒåœ¾å›æ”¶ è¯¦è§P144 jvisualvm å‘½ä»¤è¡Œå¯åŠ¨ï¼šjvisualvm å®‰è£…æ’ä»¶ visual gcï¼ˆå»ºè®®æ‰‹åŠ¨ä¸‹è½½ç„¶åæ·»åŠ æ’ä»¶å³å¯ï¼‰ ç®€å•ä¼˜åŒ–ååé‡ å¼€å¯thymeleafç¼“å­˜ï¼Œå…³é—­æ—¥å¿—æ‰“å°ï¼Œæ•°æ®åº“æ·»åŠ ç´¢å¼• nginxåŠ¨é™åˆ†ç¦» å°†é™æ€èµ„æºå­˜æ”¾åœ¨nginxé‡Œï¼Œæ‰€ä»¥é™æ€è¯·æ±‚ç›´æ¥ä»nginxé‡Œæ‹¿èµ„æºå³å¯ï¼Œä¸éœ€è¦è¿‡ç½‘å…³åˆ°æœåŠ¡å™¨Tomcaté‡Œæ‹¿ è§„å®šï¼š/static/***ä¸‹çš„æ‰€æœ‰è¯·æ±‚ç”±nginxç›´æ¥è¿”å› å­˜æ”¾é™æ€èµ„æº å°†productæœåŠ¡çš„resourceä¸‹çš„æ‰€æœ‰é™æ€æ–‡ä»¶ï¼ˆstaticä¸‹ï¼‰å­˜æ”¾åˆ°nginxä¸‹çš„htmlæ–‡ä»¶å¤¹ä¸‹çš„staticä¸‹ï¼ˆè®°å½•ä¸€ä¸‹è™šæ‹Ÿæœºç§»åŠ¨æ–‡ä»¶ mv xxx xxxï¼‰ å°†htmlä¸­çš„é™æ€èµ„æºè·¯å¾„æ·»åŠ ä¸Š/static/å‰ç¼€ nginxé…ç½® å½“è®¿é—®/staticä¸‹çš„èµ„æºæ—¶ï¼Œè¦æ±‚nginxä¸ºæˆ‘ä»¬è¯·æ±‚nginxä¸‹çš„htmlæ–‡ä»¶å¤¹ä¸‹çš„staticæ–‡ä»¶å¤¹ 123location /static &#123; root /usr/share/nginx/html; &#125; å¦‚æœè¯·æ±‚å‡ºç°403çš„é—®é¢˜éœ€è¦ä¿®æ”¹nginxæ–‡ä»¶å¤¹çš„æƒé™ chmod -R 777 /mydata/nginx/html ç¼“å­˜ 1ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ â€”&gt; 2ä½¿ç”¨ç¼“å­˜ é€‚ç”¨äºè®¿é—®é‡è¾¾ã€æ›´æ–°é¢‘ç‡ä¸é«˜ã€åŠæ—¶æ€§æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸è¦çš„æ•°æ®ï¼Œæå¤§æå‡ç³»ç»Ÿæ€§èƒ½ åœ¨å¼€å‘ä¸­ï¼Œ å‡¡æ˜¯æ”¾å…¥ç¼“å­˜ä¸­çš„æ•°æ®æˆ‘ä»¬éƒ½åº”è¯¥æŒ‡å®šè¿‡æœŸæ—¶é—´ï¼Œ ä½¿å…¶å¯ä»¥åœ¨ç³»ç»Ÿå³ä½¿æ²¡æœ‰ä¸»åŠ¨æ›´æ–°æ•°æ®ä¹Ÿèƒ½è‡ªåŠ¨è§¦å‘æ•°æ®åŠ è½½è¿›ç¼“å­˜çš„æµç¨‹ã€‚ é¿å…ä¸šåŠ¡å´©æºƒå¯¼è‡´çš„æ•°æ®æ°¸ä¹…ä¸ä¸€è‡´é—®é¢˜ã€‚ æœ€ç›´æ¥çš„ç¼“å­˜ï¼šä¸€ä¸ªMapå¯¹è±¡ï¼Œæ˜¯æœ¬åœ°ç¼“å­˜åœ¨åˆ†å¸ƒå¼ä¸‹ï¼Œä¸€ä¸ªæœåŠ¡å­˜åœ¨å¤šä¸ªæœåŠ¡å™¨ï¼Œå°±ä¼šäº§ç”Ÿå¤šä¸ªç¼“å­˜ï¼Œå¯èƒ½æ•°æ®ä¸ä¸€è‡´ ç¼“å­˜ä¸­é—´ä»¶ï¼šredis Redisä¾èµ–12345&lt;!-- redis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt; ä½¿ç”¨spring-boot-starterçš„redisï¼Œç‰ˆæœ¬ç”±çˆ¶é¡¹ç›®ç»Ÿä¸€ç®¡ç† é…ç½®12345spring: redis: # redisåœ°å€ host: 192.168.128.129 port: 6379 æµ‹è¯•123456789@Testpublic void redis() &#123; ValueOperations&lt;String, String&gt; valueOperations = stringRedisTemplate.opsForValue(); // ä¿å­˜ valueOperations.set(&quot;hello&quot;, &quot;hello_&quot; + UUID.randomUUID()); // æŸ¥è¯¢ String hello = valueOperations.get(&quot;hello&quot;); System.out.println(&quot;ä¹‹å‰ä¿å­˜çš„æ•°æ®æ˜¯ï¼š &quot; + hello);&#125; å¯è§†åŒ–å·¥å…· RDMã€ARDMï¼ˆåè€…å¥½çœ‹ï¼‰ ä¼˜åŒ–åˆ†ç±»ä¸šåŠ¡CategoryServiceImpl12345678910111213141516171819/* * æ¸²æŸ“äºŒçº§ã€ä¸‰çº§åˆ†ç±»(ä½¿ç”¨ç¼“å­˜) */@Overridepublic Map&lt;String, List&lt;Catalog2Vo&gt;&gt; getCatalogJson() &#123; String catalogJSON = redisTemplate.opsForValue().get(&quot;catalogJSON&quot;); if (StringUtils.isEmpty(catalogJSON)) &#123; // ç¼“å­˜ä¸­æ²¡æœ‰ // æŸ¥è¯¢å¹¶å°è£… Map&lt;String, List&lt;Catalog2Vo&gt;&gt; catalogJsonFromDb = getCatalogJsonFromDb(); // æ”¾å…¥ç¼“å­˜ (æ³¨æ„å­˜å…¥JSONå­—ç¬¦ä¸²) redisTemplate.opsForValue().set(&quot;catalogJSON&quot;, JSON.toJSONString(catalogJsonFromDb)); return catalogJsonFromDb; &#125; // ä»ç¼“å­˜ä¸­æ‹¿æ•°æ® Map&lt;String, List&lt;Catalog2Vo&gt;&gt; result = JSON.parseObject(catalogJSON, new TypeReference&lt;Map&lt;String, List&lt;Catalog2Vo&gt;&gt;&gt;() &#123; &#125;); return result;&#125; è§£å†³OutOfDirectMemoryError TODO äº§ç”Ÿå †å¤–å†…å­˜æº¢å‡ºï¼šOutOfDirectMemoryError 1ï¼‰ã€springboot2.0ä»¥åé»˜è®¤ä½¿ç”¨lettuceä½œä¸ºæ“ä½œredisçš„å®¢æˆ·ç«¯ã€‚å®ƒä½¿ç”¨nettyè¿›è¡Œç½‘ç»œé€šä¿¡ã€‚ 2ï¼‰ã€lettuceçš„bugå¯¼è‡´nettyå †å¤–å†…å­˜æº¢å‡º -Xmx300mï¼›nettyå¦‚æœæ²¡æœ‰æŒ‡å®šå †å¤–å†…å­˜ï¼Œé»˜è®¤ä½¿ç”¨-Xmx300m å¯ä»¥é€šè¿‡-Dio.netty.maxDirectMemoryè¿›è¡Œè®¾ç½® è§£å†³æ–¹æ¡ˆï¼šä¸èƒ½ä½¿ç”¨-Dio.netty.maxDirectMemoryåªå»è°ƒå¤§å †å¤–å†…å­˜ã€‚ 1ï¼‰ã€å‡çº§lettuceå®¢æˆ·ç«¯ã€‚ 2ï¼‰ã€åˆ‡æ¢ä½¿ç”¨jedis 123456789101112131415161718&lt;!-- redis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;io.lettuce&lt;/groupId&gt; &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt;&lt;!-- è§£å†³rediså †å¤–å†…å­˜æº¢å‡ºé—®é¢˜ï¼Œå‡çº§lettuceçš„ç‰ˆæœ¬ --&gt;&lt;dependency&gt; &lt;groupId&gt;io.lettuce&lt;/groupId&gt; &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt; &lt;version&gt;5.2.0.RELEASE&lt;/version&gt;&lt;/dependency&gt; ç¼“å­˜å¤±æ•ˆ ç¼“å­˜ç©¿é€ ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ï¼Œ ç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­ï¼Œ å°†å»æŸ¥è¯¢æ•°æ®åº“ï¼Œ ä½†æ˜¯æ•°æ®åº“ä¹Ÿæ— æ­¤è®°å½•ï¼Œ æˆ‘ä»¬æ²¡æœ‰å°†è¿™æ¬¡æŸ¥è¯¢çš„ null å†™å…¥ç¼“å­˜ï¼Œ è¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œ å¤±å»äº†ç¼“å­˜çš„æ„ä¹‰ã€‚ åœ¨æµé‡å¤§æ—¶ï¼Œ å¯èƒ½ DB å°±æŒ‚æ‰äº†ï¼Œ è¦æ˜¯æœ‰äººåˆ©ç”¨ä¸å­˜åœ¨çš„ key é¢‘ç¹æ”»å‡»æˆ‘ä»¬çš„åº”ç”¨ï¼Œ è¿™å°±æ˜¯æ¼æ´ã€‚ è§£å†³ï¼šç¼“å­˜ç©ºç»“æœã€ å¹¶ä¸”è®¾ç½®çŸ­çš„è¿‡æœŸæ—¶é—´ã€‚ ç¼“å­˜é›ªå´© ç¼“å­˜é›ªå´©æ˜¯æŒ‡åœ¨æˆ‘ä»¬è®¾ç½®ç¼“å­˜æ—¶é‡‡ç”¨äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œ å¯¼è‡´ç¼“å­˜åœ¨æŸä¸€æ—¶åˆ»åŒæ—¶å¤±æ•ˆï¼Œ è¯·æ±‚å…¨éƒ¨è½¬å‘åˆ° DBï¼Œ DB ç¬æ—¶å‹åŠ›è¿‡é‡é›ªå´©ã€‚ è§£å†³ï¼šåŸæœ‰çš„å¤±æ•ˆæ—¶é—´åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªéšæœºå€¼ï¼Œ æ¯”å¦‚ 1-5 åˆ†é’Ÿéšæœºï¼Œ è¿™æ ·æ¯ä¸€ä¸ªç¼“å­˜çš„è¿‡æœŸæ—¶é—´çš„é‡å¤ç‡å°±ä¼šé™ä½ï¼Œ å°±å¾ˆéš¾å¼•å‘é›†ä½“å¤±æ•ˆçš„äº‹ä»¶ã€‚ ç¼“å­˜å‡»ç©¿ å¯¹äºä¸€äº›è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ keyï¼Œ å¦‚æœè¿™äº› key å¯èƒ½ä¼šåœ¨æŸäº›æ—¶é—´ç‚¹è¢«è¶…é«˜å¹¶å‘åœ°è®¿é—®ï¼Œæ˜¯ä¸€ç§éå¸¸â€œçƒ­ç‚¹â€çš„æ•°æ® è¿™ä¸ªæ—¶å€™ï¼Œ éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼š å¦‚æœè¿™ä¸ª key åœ¨å¤§é‡è¯·æ±‚åŒæ—¶è¿›æ¥å‰æ­£å¥½å¤±æ•ˆï¼Œ é‚£ä¹ˆæ‰€æœ‰å¯¹è¿™ä¸ª key çš„æ•°æ®æŸ¥è¯¢éƒ½è½åˆ° dbï¼Œ æˆ‘ä»¬ç§°ä¸ºç¼“å­˜å‡»ç©¿ã€‚ è§£å†³ï¼šåŠ é” Spring Cache ä¾èµ–12345&lt;!-- spring cacheç®€åŒ–ç¼“å­˜å¼€å‘ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½® CacheAutoConfiguration è‡ªåŠ¨å¯¼å…¥ RedisAutoConfigurationï¼Œå†…å« RedisCacheManager ç¼“å­˜ç®¡ç†å™¨ 12345678spring: # ç¼“å­˜ cache: type: redis # redis redis: host: 192.168.128.129 port: 6379 æ³¨è§£ @Cachableï¼šå°†æ•°æ®ä¿å­˜åˆ°ç¼“å­˜ @CacheEvictï¼šå°†æ•°æ®ä»ç¼“å­˜åˆ é™¤ @CachePutï¼šä¿å­˜ï¼ˆä¸å½±å“æ–¹æ³•æ‰§è¡Œï¼‰ @Cachingï¼šç»„åˆå¤šä¸ªç¼“å­˜æ“ä½œ @CacheConfigï¼šåœ¨ç±»çº§åˆ«å…±äº«ç›¸åŒé…ç½® @EnableCachingï¼šåœ¨å¯åŠ¨ç±»ä¸Šï¼Œå¼€å¯ç¼“å­˜ å®ç°12345678910111213141516171819202122/** * ä¿®æ”¹(çº§è”æ›´æ–°ï¼Œè¿è¡¨æ›´æ–°) */@Caching(evict = &#123; @CacheEvict(cacheNames = &quot;category&quot;, key = &quot;&#x27;level1Category1&#x27;&quot;), // åˆ é™¤ç¼“å­˜ @CacheEvict(cacheNames = &quot;category&quot;, key = &quot;&#x27;level1Category2&#x27;&quot;)&#125;)@Override@Transactionalpublic void updateDetail(CategoryEntity category) &#123; this.updateById(category); categoryBrandRelationService.updateCategory(category.getCatId(), category.getName());&#125;/** * å‰å°ï¼šæ¸²æŸ“é¦–é¡µï¼Œä¸€çº§åˆ†ç±» */@Cacheable(&#123;&quot;category&quot;&#125;) // @Cacheable(ç¼“å­˜åˆ†åŒºå)ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰åˆ™è¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼Œå¦åˆ™ä¼šè°ƒç”¨æ–¹æ³•å¹¶å°†ç»“æœæ”¾å…¥ç¼“å­˜@Overridepublic List&lt;CategoryEntity&gt; getLevel1List() &#123; List&lt;CategoryEntity&gt; categoryEntityList = baseMapper.selectList(new QueryWrapper&lt;CategoryEntity&gt;().eq(&quot;parent_cid&quot;, 0)); return categoryEntityList;&#125; è‡ªå®šä¹‰é…ç½® é»˜è®¤ keyé»˜è®¤è‡ªåŠ¨ç”Ÿæˆï¼Œåå­—ä¸º åˆ†åŒºå::SimpleKey [] ç¼“å­˜çš„valueå€¼é»˜è®¤ä½¿ç”¨jdkåºåˆ—åŒ–æœºåˆ¶ï¼Œå°†åºåˆ—åŒ–åçš„æ•°æ®ä¿å­˜åˆ°redis é»˜è®¤ttlæ—¶é—´ -1s è‡ªå®šä¹‰ æŒ‡å®škeyï¼šæ¥æ”¶SpELè¡¨è¾¾å¼ï¼ˆå®˜ç½‘æ–‡æ¡£æœ‰è§£é‡Šå„ç§å†™æ³•ï¼‰ 1@Cacheable(cacheNames = &#123;&quot;category&quot;&#125;, key = &quot;&#x27;level1Category&#x27;&quot;) æŒ‡å®šå­˜æ´»æ—¶é—´ï¼šå•ä½ä¸ºæ¯«ç§’ 1234cache: type: redis redis: time-to-live: 1000 æŒ‡å®šJSONåºåˆ—åŒ– 1234567891011121314151617181920212223242526272829303132/* * è‡ªå®šä¹‰é…ç½®spring cache */@Configuration@EnableCaching@EnableConfigurationProperties(CacheProperties.class)public class MyCacheConfig &#123; @Bean RedisCacheConfiguration redisCacheConfiguration(CacheProperties cacheProperties) &#123; RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig(); // è®¾ç½®è‡ªå®šä¹‰é…ç½®ï¼Œä½¿ç”¨JSONåºåˆ—åŒ–æœºåˆ¶ä¿å­˜value config = config.serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer())); config = config.serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer())); // å¼•å…¥é…ç½®æ–‡ä»¶çš„é…ç½® // CacheProperties.Redis redisProperties = cacheProperties.getRedis(); // if (redisProperties.getTimeToLive() != null) &#123; // config = config.entryTtl(redisProperties.getTimeToLive()); // &#125; // if (redisProperties.getKeyPrefix() != null) &#123; // config = config.prefixKeysWith(redisProperties.getKeyPrefix()); // &#125; // if (!redisProperties.isCacheNullValues()) &#123; // config = config.disableCachingNullValues(); // &#125; // if (!redisProperties.isUseKeyPrefix()) &#123; // config = config.disableKeyPrefix(); // &#125; // TODO è¿™é‡Œæˆ‘ä¸€å¼•å…¥å°±ä¼šå¯¼è‡´ç¼“å­˜ç”¨ä¸äº†ï¼Ÿ return config; &#125;&#125; åˆ†å¸ƒå¼é” RedisTemplateså®ç°åˆ†å¸ƒå¼é”æ¼”è¿› åŸå­æ€§ï¼šæŒ‡äº‹åŠ¡çš„ä¸å¯åˆ†å‰²æ€§ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆä¸é—´æ–­åœ°å…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆä¸€ä¸ªä¹Ÿæ²¡æœ‰æ‰§è¡Œ ä»£ç å®ç°1234567891011121314151617181920212223242526272829303132333435363738public Map&lt;String, List&lt;Catelog2Vo&gt;&gt; getCatalogJsonFromDbWithRedisLock() &#123;//1ã€ å åˆ†å¸ƒå¼é”ã€‚ å» redis å å‘String uuid = UUID.randomUUID().toString();Boolean lock =redisTemplate.opsForValue().setIfAbsent(&quot;lock&quot;,uuid,300,TimeUnit.SECONDS);if(lock)&#123;System.out.println(&quot;è·å–åˆ†å¸ƒå¼é”æˆåŠŸ...&quot;);//åŠ é”æˆåŠŸ... æ‰§è¡Œä¸šåŠ¡//2ã€ è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œ å¿…é¡»å’ŒåŠ é”æ˜¯åŒæ­¥çš„ï¼Œ åŸå­çš„//redisTemplate.expire(&quot;lock&quot;,30,TimeUnit.SECONDS);Map&lt;String, List&lt;Catelog2Vo&gt;&gt; dataFromDb;try&#123;dataFromDb = getDataFromDb();&#125;finally &#123;String script = &quot;if redis.call(&#x27;get&#x27;, KEYS[1]) == ARGV[1] thenreturn redis.call(&#x27;del&#x27;, KEYS[1]) else return 0 end&quot;;//åˆ é™¤é”Long lock1 = redisTemplate.execute(newDefaultRedisScript&lt;Long&gt;(script, Long.class), Arrays.asList(&quot;lock&quot;), uuid);&#125; //è·å–å€¼å¯¹æ¯”+å¯¹æ¯”æˆåŠŸåˆ é™¤=åŸå­æ“ä½œ lua è„šæœ¬è§£é”// String lockValue = redisTemplate.opsForValue().get(&quot;lock&quot;);// if(uuid.equals(lockValue))&#123;// //åˆ é™¤æˆ‘è‡ªå·±çš„é”// redisTemplate.delete(&quot;lock&quot;);//åˆ é™¤é”// &#125;return dataFromDb;&#125;else &#123;//åŠ é”å¤±è´¥...é‡è¯•ã€‚ synchronized ()//ä¼‘çœ  100ms é‡è¯•System.out.println(&quot;è·å–åˆ†å¸ƒå¼é”å¤±è´¥...ç­‰å¾…é‡è¯•&quot;);try&#123;Thread.sleep(200);&#125;catch (Exception e)&#123;&#125; return getCatalogJsonFromDbWithRedisLock();//è‡ªæ—‹çš„æ–¹å¼&#125;&#125; Redisson Redisson æ˜¯æ¶è®¾åœ¨ Redis åŸºç¡€ä¸Šçš„ä¸€ä¸ª Java é©»å†…å­˜æ•°æ®ç½‘æ ¼ï¼ˆIn-Memory Data Gridï¼‰ ã€‚ å……åˆ†çš„åˆ©ç”¨äº† Redis é”®å€¼æ•°æ®åº“æä¾›çš„ä¸€ç³»åˆ—ä¼˜åŠ¿ï¼Œ åŸºäº Java å®ç”¨å·¥å…·åŒ…ä¸­å¸¸ç”¨æ¥å£ï¼Œ ä¸ºä½¿ç”¨è€…æä¾›äº†ä¸€ç³»åˆ—å…·æœ‰åˆ†å¸ƒå¼ç‰¹æ€§çš„å¸¸ç”¨å·¥å…·ç±»ã€‚ ä½¿å¾—åŸæœ¬ä½œä¸ºåè°ƒå•æœºå¤šçº¿ç¨‹å¹¶å‘ç¨‹åºçš„å·¥å…·åŒ…è·å¾—äº†åè°ƒåˆ†å¸ƒå¼å¤šæœºå¤šçº¿ç¨‹å¹¶å‘ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œ å¤§å¤§é™ä½äº†è®¾è®¡å’Œç ”å‘å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„éš¾åº¦ã€‚ åŒæ—¶ç»“åˆå„å¯Œç‰¹è‰²çš„åˆ†å¸ƒå¼æœåŠ¡ï¼Œ æ›´è¿›ä¸€æ­¥ç®€åŒ–äº†åˆ†å¸ƒå¼ç¯å¢ƒä¸­ç¨‹åºç›¸äº’ä¹‹é—´çš„åä½œã€‚ å®˜æ–¹æ–‡æ¡£ï¼š https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95 ä¾èµ–123456&lt;!-- reddisson --&gt;&lt;dependency&gt; &lt;groupId&gt;org.redisson&lt;/groupId&gt; &lt;artifactId&gt;redisson&lt;/artifactId&gt; &lt;version&gt;3.12.0&lt;/version&gt;&lt;/dependency&gt; ç¨‹åºåŒ–é…ç½®1234567891011121314@Configurationpublic class MyRedissonConfig &#123; /* * æ‰€æœ‰å¯¹redissonçš„ä½¿ç”¨éƒ½æ˜¯é€šè¿‡clientå¯¹è±¡ */ @Bean(destroyMethod = &quot;shutdown&quot;) public RedissonClient redisson() throws IOException &#123; // åˆ›å»ºé…ç½® Config config = new Config(); // å•redisèŠ‚ç‚¹æ¨¡å¼ config.useSingleServer().setAddress(&quot;redis://192.168.128.129:6379&quot;); return Redisson.create(config); &#125;&#125; å‰å°-æ£€ç´¢æœåŠ¡æ­å»ºé¡µé¢ç¯å¢ƒ éœ€è¦å‘è™šæ‹Ÿæœºä¼ è¾“æ–‡ä»¶ï¼Œæ‰€æœ‰è¿˜æ˜¯ç”¨xshelå¥½ä½¿ï¼Œæ•™ç¨‹åœ¨p122 é™æ€èµ„æº css,imgç­‰èµ„æºæ”¾åœ¨nginxçš„htmlæ–‡ä»¶å¤¹ä¸‹ index.htmlæ”¾åœ¨é¡¹ç›®resourceä¸‹çš„templatesæ–‡ä»¶å¤¹ä¸‹ï¼ˆæ³¨æ„è¿™é‡Œindexåå­—æ”¹ä¸ºlistï¼Œå› ä¸ºé¦–é¡µæœç´¢å‘è¯·æ±‚åœ°å€å°±æ˜¯search.gulimall.com/list.html hosté…ç½® ä½¿ç”¨SwitchHost 192.168.128.129 gulimall.com192.168.128.129 search.gulimall.com nginxé…ç½® æ·»åŠ server_nameå¯¹åº”hostå³å¯ server_name gulimall.com *.gulimall.com; #charset koi8-r; #access_log /var/log/nginx/log/host.access.log main; location /static &#123; root /usr/share/nginx/html; &#125; location / &#123; proxy_set_header Host $host; proxy_pass http://gulimall; &#125; gatewayé…ç½®123456789# -----------------------nginxï¼Œä¸€å®šè¦æ”¾åœ¨æœ€åï¼Œè¦ä¸ç„¶/api/ä¸‹çš„é…ç½®ä¼šè¢«è¦†ç›–------------------------ id: gulimall_host_route uri: lb://gulimall-product predicates: - Host=gulimall.com- id: gulimall_search_route uri: lb://gulimall-search predicates: - Host=search.gulimall.com æ ¹æ®ä¹‹å‰nginxé…ç½®ä¸­çš„proxy_set_header Host $hostï¼Œç½‘å…³èƒ½æ ¹æ®hostæ¥é€‰æ‹©ä¸åŒçš„æœåŠ¡ list.htmlé‡Œé¢æœ‰å¾ˆå¤šè·¯å¾„é”™è¯¯ï¼Œè®°å¾—ä¿®æ”¹ä¸€ä¸‹ ä¿®æ”¹ä¸€ä¸‹å‘èµ·è¯·æ±‚çš„è¯·æ±‚è·¯å¾„ æ£€ç´¢æ¨¡å‹åˆ†ææŸ¥è¯¢å‚æ•°æ¨¡å‹ 12345678910111213141516171819/** * å°è£…é¡µé¢æ‰€æœ‰å¯èƒ½ä¼ é€’è¿‡æ¥çš„æ¡ä»¶ */@Datapublic class SearchParamVo &#123; private String keyword; // å…¨æ–‡åŒ¹é…å…³é”®å­— private Long catalog3Id; // ä¸‰çº§åˆ†ç±»id /** * sort=saleCount_asc/desc * sort=skuPrice_asc/desc * sort=hotScore_asc/desc */ private String sort; // æ’åºæ¡ä»¶ private Integer hasStock; // æ˜¯å¦æœ‰è´§ private String skuPrice; // ä»·æ ¼åŒºé—´ private List&lt;Long&gt; brandId; // å“ç‰Œid å¯å¤šé€‰ private List&lt;String&gt; attrs; // æŒ‰ç…§å±æ€§è¿›è¡Œç­›é€‰ private Integer pageNum; // é¡µç &#125; è¿”å›ç»“æœæ¨¡å‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * æ£€ç´¢è¿”å›æ•°æ®æ¨¡å‹ */@Datapublic class SearchResultVo &#123; private List&lt;SkuEsModel&gt; products; //skuåœ¨elasticsearchä¸­çš„æ¨¡å‹ // åˆ†é¡µä¿¡æ¯ private Integer pageNum; // å½“å‰é¡µç  private Long total; // æ€»è®°å½•æ•° private Integer totalPages; // æ€»é¡µç  private List&lt;BrandVo&gt; brands; // å½“å‰æŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ¶‰åŠåˆ°çš„å“ç‰Œ private List&lt;CatalogVo&gt; catalogs; // å½“å‰æŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ¶‰åŠåˆ°çš„åˆ†ç±» private List&lt;AttrVo&gt; attrs; // å½“å‰æŸ¥è¯¢åˆ°çš„æ‰€æœ‰æ¶‰åŠåˆ°çš„å±æ€§ /** * å†…éƒ¨ç±»ï¼Œå“ç‰Œä¿¡æ¯ */ @Data public static class BrandVo &#123; private Long brandId; private String brandName; private String brandImg; &#125; /** * å†…éƒ¨ç±»ï¼Œå±æ€§ä¿¡æ¯ */ @Data public static class AttrVo &#123; private Long attrId; private String attrName; private List&lt;String&gt; attrValue; &#125; /** * å†…éƒ¨ç±»ï¼Œåˆ†ç±»ä¿¡æ¯ */ @Data public static class CatalogVo &#123; private Long catalogId; private String catalogName; &#125;&#125; æ£€ç´¢DSLæµ‹è¯• TODO P177ã€P178 ååˆ†åŠé€€ï¼Œå¤´ç–¼ SearchRequestæŸ¥è¯¢ã€æ’åº123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133@Servicepublic class MallSearchServiceImpl implements MallSearchService &#123; @Autowired private RestHighLevelClient client; /* * æ ¹æ®keywordæ£€ç´¢æ‰€æœ‰å•†å“ */ @Override public SearchResultVo search(SearchParamVo searchParamVo) &#123; // å‡†å¤‡æ£€ç´¢è¯·æ±‚ SearchRequest searchRequest = buildSearchRequest(searchParamVo); try &#123; // æ‰§è¡Œæ£€ç´¢è¯·æ±‚ SearchResponse response = client.search(searchRequest, GulimallElasticSearchConfig.COMMON_OPTIONS); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; // åˆ†æå“åº”æ•°æ®å¹¶å°è£… SearchResult searchResult = buildSearchResult(); return null; &#125; /* * åˆ›å»ºæ£€ç´¢ç»“æœ */ private SearchResult buildSearchResult() &#123; return null; &#125; /* * åˆ›å»ºæ£€ç´¢è¯·æ±‚ */ private SearchRequest buildSearchRequest(SearchParamVo param) &#123; // æŒ‡å®šæ£€ç´¢æ¡ä»¶,è¯¦è§dsl.json SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder(); // æŸ¥è¯¢ï¼šæ¨¡ç³ŠåŒ¹é…ï¼Œè¿‡æ»¤ï¼ˆæŒ‰ç…§å±æ€§ã€åˆ†ç±»ã€å“ç‰Œã€ä»·æ ¼åŒºé—´ã€åº“å­˜ï¼‰ // 1 query -&gt; bool å¼€å§‹ BoolQueryBuilder boolQuery = QueryBuilders.boolQuery(); // 1.1 bool -&gt; must æ¨¡ç³ŠåŒ¹é… // must -&gt; match if (!StringUtils.isEmpty(param.getKeyword())) &#123; MatchQueryBuilder matchQuery = QueryBuilders.matchQuery(&quot;skuTitle&quot;, param.getKeyword()); boolQuery.must(matchQuery); &#125; // 1.2 bool -&gt; filter è¿‡æ»¤ // filter -&gt; ç¬¬ä¸€ä¸ªterm æŒ‰ç…§åˆ†ç±»è¿‡æ»¤ if (param.getCatalog3Id() != null) &#123; TermQueryBuilder termQuery = QueryBuilders.termQuery(&quot;catalogId&quot;, param.getCatalog3Id()); boolQuery.filter(termQuery); &#125; // filter -&gt; ç¬¬äºŒä¸ªterms æŒ‰ç…§å“ç‰Œè¿‡æ»¤ if (param.getBrandId() != null) &#123; TermsQueryBuilder termsQuery = QueryBuilders.termsQuery(&quot;brandId&quot;, param.getBrandId()); boolQuery.filter(termsQuery); &#125; // filter -&gt; ç¬¬ä¸‰ä¸ªnested æŒ‰ç…§å±æ€§è¿‡æ»¤ if (param.getAttrs() != null &amp;&amp; param.getAttrs().size() &gt; 0) &#123; // æ“ä½œæ¯ä¸€ä¸ªattr(æ¯ä¸€ä¸ªattréƒ½æœ‰ä¸€ä¸ªnested) for (String attrStr : param.getAttrs()) &#123; // nested -&gt; query -&gt; bool BoolQueryBuilder nestedBool = QueryBuilders.boolQuery(); // é¡µé¢æäº¤æ ¼å¼ï¼šattr = 1_5å¯¸:8å¯¸ String[] strings = attrStr.split(&quot;_&quot;); String attrId = strings[0]; String[] attrValues = strings[1].split(&quot;:&quot;); // bool -&gt; must -&gt; termã€terms nestedBool.must(QueryBuilders.termQuery(&quot;attrs.attrId&quot;, attrId)); nestedBool.must(QueryBuilders.termsQuery(&quot;attrs.attrValue&quot;, attrValues)); boolQuery.filter(QueryBuilders.nestedQuery(&quot;attrs&quot;, nestedBool, ScoreMode.None)); &#125; &#125; // filter -&gt; ç¬¬å››ä¸ªterm æŒ‰ç…§åº“å­˜è¿‡æ»¤ if (param.getHasStock() != null) &#123; TermQueryBuilder termQuery = QueryBuilders.termQuery(&quot;hasStock&quot;, param.getHasStock() == 1); boolQuery.filter(termQuery); &#125; else &#123; TermQueryBuilder termQuery = QueryBuilders.termQuery(&quot;hasStock&quot;, true); boolQuery.filter(termQuery); &#125; // filter -&gt; ç¬¬å››ä¸ªrange æŒ‰ç…§ä»·æ ¼åŒºé—´è¿‡æ»¤ if (!StringUtils.isEmpty(param.getSkuPrice())) &#123; RangeQueryBuilder rangeQuery = QueryBuilders.rangeQuery(&quot;skuPrice&quot;); String[] priceRange = param.getSkuPrice().split(&quot;_&quot;); if (param.getSkuPrice().startsWith(&quot;_&quot;)) &#123; // _xxx, å°äº rangeQuery.lte(priceRange[1]); &#125; else if (param.getSkuPrice().endsWith(&quot;_&quot;)) &#123; // xxx_, å¤§äº rangeQuery.gte(priceRange[0]); &#125; else &#123; // åŒºé—´ rangeQuery.gte(priceRange[0]).lte(priceRange[1]); &#125; boolQuery.filter(rangeQuery); &#125; searchSourceBuilder.query(boolQuery); // æ’åºã€åˆ†é¡µã€é«˜äº® // 2 sort if (!StringUtils.isEmpty(param.getSort())) &#123; String sort = param.getSort(); String[] sortValue = sort.split(&quot;_&quot;); searchSourceBuilder.sort(sortValue[0], SortOrder.fromString(sortValue[1])); &#125; // 2 from sieze if (param.getPageNum() != null) &#123; searchSourceBuilder.from((param.getPageNum() - 1) * EsConstant.PAGE_SIZE); &#125; else &#123; searchSourceBuilder.from(0); &#125; searchSourceBuilder.size(EsConstant.PAGE_SIZE); // 2 highlight if (!StringUtils.isEmpty(param.getKeyword())) &#123; searchSourceBuilder.highlighter(new HighlightBuilder().field(&quot;skuTitle&quot;).preTags(&quot;&lt;b style=&#x27;color:red&#x27;&gt;&quot;).postTags(&quot;&lt;/b&gt;&quot;)); &#125; // TODO èšåˆåˆ†æ // 3 aggs String s = searchSourceBuilder.toString(); System.out.println(&quot;æ„å»ºçš„DSLï¼š&quot; + s); // åˆ›å»ºrequestï¼ŒæŒ‡å®šç´¢å¼•ã€æ£€ç´¢æ¡ä»¶ SearchRequest searchRequest = new SearchRequest(new String[]&#123;EsConstant.PRODUCT_INDEX&#125;, searchSourceBuilder); return searchRequest; &#125;&#125; èšåˆ12345678910111213141516171819202122// èšåˆåˆ†æ// 3 aggs// 3.1 å“ç‰ŒèšåˆTermsAggregationBuilder brand_agg = AggregationBuilders.terms(&quot;brand_agg&quot;).field(&quot;brandId&quot;).size(EsConstant.BRAND_SIZE);// 3.1 å­èšåˆbrand_agg.subAggregation(AggregationBuilders.terms(&quot;brand_img_agg&quot;).field(&quot;brandImg&quot;).size(1));brand_agg.subAggregation(AggregationBuilders.terms(&quot;brand_name_agg&quot;).field(&quot;brandName&quot;).size(1));searchSourceBuilder.aggregation(brand_agg);// 3.2 åˆ†ç±»èšåˆTermsAggregationBuilder catalog_agg = AggregationBuilders.terms(&quot;catalog_agg&quot;).field(&quot;catalogId&quot;).size(EsConstant.CATALOG_SIZE);// 3.2 å­èšåˆcatalog_agg.subAggregation(AggregationBuilders.terms(&quot;catalog_name_agg&quot;).field(&quot;catalogName&quot;).size(1));searchSourceBuilder.aggregation(catalog_agg);// 3.3 å±æ€§èšåˆNestedAggregationBuilder attr_agg = AggregationBuilders.nested(&quot;attr_agg&quot;, &quot;attrs&quot;);// 3.3 å­èšåˆTermsAggregationBuilder attr_id_agg = AggregationBuilders.terms(&quot;attr_id_agg&quot;).field(&quot;attrs.attrId&quot;);// 3.3 å­å­èšåˆattr_id_agg.subAggregation(AggregationBuilders.terms(&quot;attr_name_agg&quot;).field(&quot;attrs.attrName&quot;).size(1));attr_id_agg.subAggregation(AggregationBuilders.terms(&quot;attr_value_agg&quot;).field(&quot;attrs.attrValue&quot;).size(50));attr_agg.subAggregation(attr_id_agg);searchSourceBuilder.aggregation(attr_agg); æ³¨æ„ï¼šå¦‚æœä½¿ç”¨æ–‡æ¡£çš„esæ¨¡å‹æ˜ å°„è§„åˆ™ï¼Œä¼šæœ‰é—®é¢˜ï¼Œè¯¦è§æœ¬æ–‡æ¡£çš„å•†å“ä¸Šæ¶çš„æ¨¡å‹åˆ†æ SearchResult1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889/* * åˆ›å»ºæ£€ç´¢ç»“æœ */ private SearchResultVo buildSearchResult(SearchResponse response, SearchParamVo param) &#123; SearchResultVo resultVo = new SearchResultVo(); SearchHits hits = response.getHits(); // 1 å°è£…å•†å“ List&lt;SkuEsModel&gt; skuList = new ArrayList&lt;&gt;(); if (hits.getHits() != null &amp;&amp; hits.getHits().length &gt; 0) &#123; for (SearchHit hit : hits.getHits()) &#123; // è·å¾—hitä¸­çš„resourceï¼Œjsonè½¬ä¸ºå¯¹è±¡ SkuEsModel sku = JSON.parseObject(hit.getSourceAsString(), SkuEsModel.class); // æ˜¯å¦é«˜äº® if (!StringUtils.isEmpty(param.getKeyword())) &#123; HighlightField highlightField = hit.getHighlightFields().get(&quot;skuTitle&quot;); String highlight = highlightField.getFragments()[0].toString(); sku.setSkuTitle(highlight); &#125; skuList.add(sku); &#125; &#125; resultVo.setProducts(skuList); // 2 å°è£…å±æ€§èšåˆä¿¡æ¯ List&lt;SearchResultVo.AttrVo&gt; attrVoList = new ArrayList&lt;&gt;(); // è·å¾—èšåˆ ParsedNested attr_agg = response.getAggregations().get(&quot;attr_agg&quot;); ParsedLongTerms attr_id_agg = attr_agg.getAggregations().get(&quot;attr_id_agg&quot;); for (Terms.Bucket bucket : attr_id_agg.getBuckets()) &#123; SearchResultVo.AttrVo attrVo = new SearchResultVo.AttrVo(); // å°è£…idï¼Œåœ¨èšåˆä¸­ attrVo.setAttrId(Long.valueOf(String.valueOf(bucket.getKeyAsNumber()))); // å°è£…nameï¼Œåœ¨å­èšåˆä¸­ ParsedStringTerms attr_name_agg = bucket.getAggregations().get(&quot;attr_name_agg&quot;); attrVo.setAttrName(attr_name_agg.getBuckets().get(0).getKeyAsString()); // å°è£…valueListï¼Œåœ¨å­èšåˆä¸­ List&lt;String&gt; attrValue = new ArrayList&lt;&gt;(); ParsedStringTerms attr_value_agg = bucket.getAggregations().get(&quot;attr_value_agg&quot;); for (Terms.Bucket aggBucket : attr_value_agg.getBuckets()) &#123; attrValue.add(aggBucket.getKeyAsString()); &#125; attrVo.setAttrValue(attrValue); attrVoList.add(attrVo); &#125; resultVo.setAttrs(attrVoList); // 3 å°è£…å“ç‰Œèšåˆä¿¡æ¯ List&lt;SearchResultVo.BrandVo&gt; brandVoList = new ArrayList&lt;&gt;(); // è·å¾—èšåˆ ParsedLongTerms brand_agg = response.getAggregations().get(&quot;brand_agg&quot;); // æ ¹æ®brandIdæœ‰è®¸å¤šä¸ªbucket for (Terms.Bucket bucket : brand_agg.getBuckets()) &#123; // å°è£…brandIdï¼Œåœ¨èšåˆä¸­ SearchResultVo.BrandVo brandVo = new SearchResultVo.BrandVo(); brandVo.setBrandId(Long.valueOf(bucket.getKeyAsString())); // å°è£…brandName\\brandImgï¼Œåœ¨å­èšåˆä¸­ ParsedStringTerms brand_name_agg = bucket.getAggregations().get(&quot;brand_name_agg&quot;); brandVo.setBrandName(brand_name_agg.getBuckets().get(0).getKeyAsString()); ParsedStringTerms brand_img_agg = bucket.getAggregations().get(&quot;brand_img_agg&quot;); brandVo.setBrandImg(brand_img_agg.getBuckets().get(0).getKeyAsString()); brandVoList.add(brandVo); &#125; resultVo.setBrands(brandVoList); // 4 å°è£…åˆ†ç±»èšåˆä¿¡æ¯ List&lt;SearchResultVo.CatalogVo&gt; catalogVoList = new ArrayList&lt;&gt;(); // è·å¾—èšåˆ ParsedLongTerms catalog_agg = response.getAggregations().get(&quot;catalog_agg&quot;); // æ ¹æ®catelogIdæœ‰è®¸å¤šä¸ªbucket for (Terms.Bucket bucket : catalog_agg.getBuckets()) &#123; // å°è£…CatalogIdï¼Œåœ¨èšåˆä¸­ SearchResultVo.CatalogVo catalogVo = new SearchResultVo.CatalogVo(); catalogVo.setCatalogId(Long.valueOf(bucket.getKeyAsString())); // å°è£…CatalogNameï¼Œåœ¨å­èšåˆä¸­ ParsedStringTerms catalog_name_agg = bucket.getAggregations().get(&quot;catalog_name_agg&quot;); catalogVo.setCatalogName(catalog_name_agg.getBuckets().get(0).getKeyAsString()); catalogVoList.add(catalogVo); &#125; resultVo.setCatalogs(catalogVoList); // 5 å°è£…åˆ†é¡µä¿¡æ¯ long total = hits.getTotalHits().value; resultVo.setTotal(total); resultVo.setTotalPages((int) ((total + EsConstant.PRODUCT_PAGE_SIZE - 1) / EsConstant.PRODUCT_PAGE_SIZE)); resultVo.setPageNum(param.getPageNum()); return resultVo; &#125; wcï¼Œtyporaæœ‰æ¯’ï¼Œä¸¤å¤©æ²¡äº†ä¸‰æ¬¡å†…å®¹ï¼Œè€Œä¸”æœªä¿å­˜å†…å®¹è‰ç¨¿ä¹Ÿæ²¡ç”¨ï¼Œä¸œè¥¿éƒ½æ²¡äº†ï¼Œæˆ‘åäº†ï¼Œå¯èƒ½æ˜¯å†…å®¹å¤ªå¤šäº†ï¼Œæ–°å¼€ä¸€ä¸ª","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘ElasticSearch","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘ElasticSearch","date":"2021-10-31T07:43:26.867Z","updated":"2021-11-01T07:09:40.533Z","comments":true,"path":"2021/10/31/xue-xi-bi-ji-elasticsearch/","link":"","permalink":"http://example.com/2021/10/31/xue-xi-bi-ji-elasticsearch/","excerpt":"","text":"ESåŸºç¡€æ¦‚å¿µ [Elasticsearch Guide 7.15] | Elastic æ–‡æ¡£ Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œæ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰ã€‚ mysqlæ›´é€‚ç”¨äºæ•°æ®é‡å°çš„CRUDï¼Œè€ŒElasticsearché€‚ç”¨äºå¤§æ•°æ®ã€‚ å¯¹ESçš„æ‰€æœ‰æ“ä½œåªéœ€è¦ä½¿ç”¨restè¯·æ±‚å³å¯å®Œæˆ åŸºç¡€æ¦‚å¿µ index ç´¢å¼• åŠ¨è¯ï¼šç›¸å½“äºinsert åè¯ï¼šç›¸å½“äºDatabase Type ç±»å‹ ç›¸å½“äºTable Document æ–‡æ¡£ JSONæ ¼å¼ï¼Œç›¸å½“äºè¡¨ä¸­çš„å†…å®¹ å€’æ’ç´¢å¼• åˆ†è¯ï¼šå°†æ•´å¥æ‹†åˆ†ä¸ºå•è¯ æ£€ç´¢ï¼šæŸ¥è¯¢è¯éƒ½å‡ºç°åœ¨å“ªä¸ªè®°å½•å½“ä¸­ ç›¸å…³æ€§å¾—åˆ†ï¼šåŸºäºä¸€å®šç®—æ³•ç®—å“ªä¸ªæƒé‡æ›´é«˜ Dockerå®‰è£…ESå’Œå¯è§†åŒ–å·¥å…·å®‰è£… docker pull elasticsearch:7.4.2 docker pull kibana:7.4.2 é…ç½® mkdir -p /mydata/elasticsearch/configmkdir -p /mydata/elasticsearch/data echo â€œhttp.host: 0.0.0.0â€ &gt;&gt; /mydata/elasticsearch/config/elasticsearch.yml docker run â€“name elasticsearch -p 9200:9200 -p 9300:9300 -e â€œdiscovery.type=single-nodeâ€ -e ES_JAVA_OPTS=â€-Xms64m -Xmx128mâ€ -v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml -v /mydata/elasticsearch/data:/usr/share/elasticsearch/data -v /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins -d elasticsearch:7.4.2 chmod -R 777 /mydata/elasticsearch/ ä¿è¯æƒé™ docker run â€“name kibana -e ELASTICSEARCH_HOSTS=http://192.168.128.129:9200 -p 5601:5601 -d kibana:7.4.2http://192.168.56.10:9200 ä¸ºè™šæ‹Ÿæœºåœ°å€ è®¿é—® http://192.168.128.129:9200/ è®¿é—®ä¸äº†çš„æ‰§è¡Œä¸Šè¿°ä¿è¯æƒé™çš„å‘½ä»¤ http://192.168.128.129:5601/ kibanaå¯èƒ½è¦ç­‰ä¸€ä¼šæ‰èƒ½å¯åŠ¨ï¼Œåˆ·æ–°å°±è¡Œ åŸºç¡€è¯·æ±‚æ ¼å¼æŸ¥è¯¢ _cat ä¿å­˜ã€æ›´æ–°æ–‡æ¡£ ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œ ä¿å­˜åœ¨å“ªä¸ªç´¢å¼•çš„å“ªä¸ªç±»å‹ä¸‹ï¼Œ æŒ‡å®šç”¨å“ªä¸ªå”¯ä¸€æ ‡è¯† åœ¨ customer ç´¢å¼•ä¸‹çš„ external ç±»å‹ä¸‹ä¿å­˜ 1 å·æ•°æ®ï¼Œæ•°æ®ä½¿ç”¨JSONæ ¼å¼ PUT customer/external/1 { â€œnameâ€: â€œJohn Doeâ€ } PUT å’Œ POST éƒ½å¯ä»¥ï¼ŒPOST æ–°å¢ã€‚POSTå¦‚æœä¸æŒ‡å®š idï¼Œ ä¼šè‡ªåŠ¨ç”Ÿæˆ idã€‚å¦‚æœæŒ‡å®š id ï¼ˆå¹¶ä¸”è¯¥idå­˜åœ¨ï¼‰å°±ä¼šä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œ å¹¶æ–°å¢ç‰ˆæœ¬å·ã€‚PUTå¯ä»¥æ–°å¢å¯ä»¥ä¿®æ”¹ã€‚PUT å¿…é¡»æŒ‡å®š idï¼› ç”±äº PUT éœ€è¦æŒ‡å®š idï¼Œ æˆ‘ä»¬ä¸€èˆ¬éƒ½ç”¨æ¥åšä¿®æ”¹æ“ä½œï¼Œä¸æŒ‡å®š id ä¼šæŠ¥é”™ã€‚ æŸ¥è¯¢æ–‡æ¡£ GET /customer/external/1 æ›´æ–°æ–‡æ¡£ ä¹è§‚é” PUT /customer/external/1?if_seq_no=1&amp;if_primary_term=1{ â€œnameâ€: â€œJohn Doe 1â€ } è¿™é‡Œå°†ifåˆ¤æ–­seq_noå’Œprimary_term æ›´æ–°æ–‡æ¡£ POST customer/external/1/_update{ â€œdocâ€: { â€œnameâ€: â€œJohn Doewâ€ }}PUT æ“ä½œå’ŒPOSTä¸å¸¦updateï¼Œæ€»ä¼šå°†æ•°æ®é‡æ–°ä¿å­˜å¹¶å¢åŠ  version ç‰ˆæœ¬ï¼›POST å¸¦_updateï¼Œå¯¹æ¯”å…ƒæ•°æ®å¦‚æœä¸€æ ·å°±ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œæ–‡æ¡£ versionä¸å¢åŠ  å¯¹äºå¤§å¹¶å‘æ›´æ–°ï¼Œ ä¸å¸¦ updateï¼›å¯¹äºå¤§å¹¶å‘æŸ¥è¯¢å¶å°”æ›´æ–°ï¼Œ å¸¦ updateï¼›å¯¹æ¯”æ›´æ–°ï¼Œ é‡æ–°è®¡ç®—åˆ†é…è§„åˆ™ã€‚ åˆ é™¤æ–‡æ¡£ã€ç´¢å¼• DELETE customer/external/1 DELETE customer æ²¡æœ‰åˆ é™¤ç±»å‹ï¼Œæ–°ç‰ˆæœ¬typeä¸å»ºè®®äº† bulk æ‰¹é‡ API POSTMANé‡Œé¢æµ‹ä¸äº†ï¼Œå»kibana -&gt; dev tools bulk API ä»¥æ­¤æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰çš„ actionï¼ˆåŠ¨ä½œï¼‰ ã€‚ å¦‚æœä¸€ä¸ªå•ä¸ªçš„åŠ¨ä½œå› ä»»ä½•åŸå› è€Œå¤±è´¥ï¼Œå®ƒå°†ç»§ç»­å¤„ç†å®ƒåé¢å‰©ä½™çš„åŠ¨ä½œã€‚ å½“ bulk API è¿”å›æ—¶ï¼Œ å®ƒå°†æä¾›æ¯ä¸ªåŠ¨ä½œçš„çŠ¶æ€ï¼ˆä¸å‘é€çš„é¡ºåºç›¸åŒï¼‰ ï¼Œ æ‰€ä»¥æ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦ä¸€ä¸ªæŒ‡å®šçš„åŠ¨ä½œæ˜¯ä¸æ˜¯å¤±è´¥äº†ã€‚ å¯¼å…¥æµ‹è¯•æ•°æ® æ„Ÿè°¢è¯„è®ºåŒºï¼Œå¥½äººä¸€ç”Ÿå¹³å®‰ï¼šesæµ‹è¯•æ•°æ®.json Â· åçœ‹äº‘èµ·æ—¶/common_content - Gitee.com POST /bank/account/_bulk è¿›é˜¶SearchAPI ES æ”¯æŒä¸¤ç§åŸºæœ¬æ–¹å¼æ£€ç´¢ : ä¸€ä¸ªæ˜¯é€šè¿‡ä½¿ç”¨ REST request URI å‘é€æœç´¢å‚æ•°ï¼ˆuri+æ£€ç´¢å‚æ•°ï¼‰ å¦ä¸€ä¸ªæ˜¯é€šè¿‡ä½¿ç”¨ REST request body æ¥å‘é€å®ƒä»¬ï¼ˆuri+è¯·æ±‚ä½“ï¼‰ QueryDSLåŸºæœ¬è¯­æ³•æ ¼å¼ è¿”å›ç‰¹å®šå­—æ®µ match åŒ¹é…æŸ¥è¯¢ address.keyword è¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œå¿…é¡»åŒ¹é…ä¸ºå®Œæ•´å­—æ®µï¼Œå¦‚æœä½¿ç”¨match_phraseåˆ™åŒ¹é…åŒ…å«å®Œæ•´å­—æ®µçš„å³å¯ match_phrase çŸ­è¯­åŒ¹é… multi_match å¤šå­—æ®µåŒ¹é… bool å¤åˆæŸ¥è¯¢ filter ç»“æœè¿‡æ»¤ must notã€filter ä¸ä¼šè®¡ç®—ç›¸å…³æ€§å¾—åˆ†ï¼Œmustã€shouldä¼š term å’Œ match ä¸€æ ·ã€‚ åŒ¹é…æŸä¸ªå±æ€§çš„å€¼ã€‚ å…¨æ–‡æ£€ç´¢å­—æ®µç”¨ matchï¼Œ å…¶ä»–é text å­—æ®µåŒ¹é…ç”¨ termã€‚ aggregations æ‰§è¡Œèšåˆ èšåˆæä¾›äº†ä»æ•°æ®ä¸­åˆ†ç»„å’Œæå–æ•°æ®çš„èƒ½åŠ›ã€‚ æœ€ç®€å•çš„èšåˆæ–¹æ³•å¤§è‡´ç­‰äº SQL GROUPBY å’Œ SQL èšåˆå‡½æ•°ã€‚ åœ¨ Elasticsearch ä¸­ï¼Œ æ‚¨æœ‰æ‰§è¡Œæœç´¢è¿”å› hitsï¼ˆ å‘½ä¸­ç»“æœï¼‰ ï¼Œ å¹¶ä¸”åŒæ—¶è¿”å›èšåˆç»“æœï¼Œ æŠŠä¸€ä¸ªå“åº”ä¸­çš„æ‰€æœ‰ hitsï¼ˆ å‘½ä¸­ç»“æœï¼‰ åˆ†éš”å¼€çš„èƒ½åŠ›ã€‚ è¿™æ˜¯éå¸¸å¼ºå¤§ä¸”æœ‰æ•ˆçš„ï¼Œæ‚¨å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢å’Œå¤šä¸ªèšåˆï¼Œ å¹¶ä¸”åœ¨ä¸€æ¬¡ä½¿ç”¨ä¸­å¾—åˆ°å„è‡ªçš„ï¼ˆ ä»»ä½•ä¸€ä¸ªçš„ï¼‰ è¿”å›ç»“æœï¼Œ ä½¿ç”¨ä¸€æ¬¡ç®€æ´å’Œç®€åŒ–çš„ API æ¥é¿å…ç½‘ç»œå¾€è¿”ã€‚ Mappingå­—æ®µç±»å‹ æ˜ å°„ Mapping æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£ï¼ˆ documentï¼‰ ï¼Œ ä»¥åŠå®ƒæ‰€åŒ…å«çš„å±æ€§ï¼ˆ fieldï¼‰ æ˜¯å¦‚ä½•å­˜å‚¨å’Œç´¢å¼•çš„ åˆ†è¯ å®‰è£… http://192.168.128.129:80/ å³å¯è®¿é—®linuxçš„nginx Elasticsearch-Rest-Client å®˜æ–¹RestClientï¼Œå°è£…äº†ESæ“ä½œ [Java High Level REST Client | Java REST Client 7.15] | Elastic","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://example.com/tags/ElasticSearch/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜3","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜3","date":"2021-10-28T04:09:39.860Z","updated":"2021-10-31T07:37:23.326Z","comments":true,"path":"2021/10/28/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-3/","link":"","permalink":"http://example.com/2021/10/28/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-3/","excerpt":"","text":"Controllerä¸‰ä¸ªæ³¨é‡Šï¼ˆè·å–å€¼ï¼‰ @RequestBodyè¯·æ±‚ä½“ä¸­çš„JSON @RequestParamæ˜¯url?åè·Ÿçš„é”®å€¼å¯¹ @PathVariableæ˜¯RESTé£æ ¼urlä¸­çš„{}å˜é‡ Objectåˆ’åˆ† é…ç½®æœåŠ¡å†…å­˜ ç»ˆäºä½ ä¹Ÿæœ‰ä»Šå¤©å•Šè€å¸ˆï¼Œå†…å­˜ç»ˆäºä¸å¤Ÿäº†å§ RunConfigurations -&gt; xxx application -&gt; environment -&gt; Vm opinion -&gt; è®¾ç½®-Xmx100mï¼Œæœ€å¤§100m å¹³å°å±æ€§â€”è§„æ ¼å‚æ•°ï¼ˆåç«¯ï¼‰æ–°å¢AttrRequestVo ä½¿ç”¨è‡ªå®šä¹‰çš„VOå¯¹è±¡ç”¨äºå°è£…æ•°æ® 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package com.atguigu.gulimall.product.vo;import lombok.Data;/** * ç”¨äºå°è£…è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ® * ä¸éœ€è¦æ·»åŠ ä¸Šä¸sqlç›¸å…³çš„æ³¨è§£ */@Datapublic class AttrVo &#123; /** * å±æ€§id */ private Long attrId; /** * å±æ€§å */ private String attrName; /** * æ˜¯å¦éœ€è¦æ£€ç´¢[0-ä¸éœ€è¦ï¼Œ1-éœ€è¦] */ private Integer searchType; /** * å±æ€§å›¾æ ‡ */ private String icon; /** * å¯é€‰å€¼åˆ—è¡¨[ç”¨é€—å·åˆ†éš”] */ private String valueSelect; /** * å±æ€§ç±»å‹[0-é”€å”®å±æ€§ï¼Œ1-åŸºæœ¬å±æ€§ï¼Œ2-æ—¢æ˜¯é”€å”®å±æ€§åˆæ˜¯åŸºæœ¬å±æ€§] */ private Integer attrType; /** * å¯ç”¨çŠ¶æ€[0 - ç¦ç”¨ï¼Œ1 - å¯ç”¨] */ private Long enable; /** * æ‰€å±åˆ†ç±» */ private Long catelogId; /** * å¿«é€Ÿå±•ç¤ºã€æ˜¯å¦å±•ç¤ºåœ¨ä»‹ç»ä¸Šï¼›0-å¦ 1-æ˜¯ã€‘ï¼Œåœ¨skuä¸­ä»ç„¶å¯ä»¥è°ƒæ•´ */ private Integer showDesc; /* * åˆ†ç»„ID */ private Long attrGroupId;&#125; AttrController123456789101112131415@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; @Autowired private AttrService attrService; /** * ä¿å­˜,è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„Voå¯¹è±¡ */ @RequestMapping(&quot;/save&quot;) //@RequiresPermissions(&quot;product:attr:save&quot;) public R save(@RequestBody AttrVo attr) &#123; attrService.saveAttr(attr); return R.ok(); &#125;&#125; AttrServiceImpl12345678910111213141516171819202122@Service(&quot;attrService&quot;)public class AttrServiceImpl extends ServiceImpl&lt;AttrDao, AttrEntity&gt; implements AttrService &#123; @Autowired AttrAttrgroupRelationDao relationDao; /** * ä¿å­˜è§„æ ¼å‚æ•°ï¼Œè¿è¡¨ */ @Override @Transactional // äº‹åŠ¡ public void saveAttr(AttrVo attr) &#123; // 1ã€ä¿å­˜åˆ°attrè¡¨ AttrEntity attrEntity = new AttrEntity(); // ä½¿ç”¨BeanUtilå°è£…å¯¹åº”å±æ€§ BeanUtils.copyProperties(attr, attrEntity); this.save(attrEntity); // 2ã€ä¿å­˜åˆ°relationè¡¨ AttrAttrgroupRelationEntity relationEntity = new AttrAttrgroupRelationEntity(); relationEntity.setAttrId(attrEntity.getAttrId());// æ³¨æ„è¿™é‡Œè¦ä½¿ç”¨attrEntityï¼Œå› ä¸ºä½¿ç”¨attræ˜¯æ²¡æœ‰idçš„ï¼ˆæ²¡æœ‰æ·»åŠ mybatisçš„æ³¨è§£ï¼Œæ‰€ä»¥æ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆidï¼‰ relationEntity.setAttrGroupId(attr.getAttrGroupId()); relationDao.insert(relationEntity); &#125;&#125; æŸ¥è¯¢åˆ†é¡µAttrResponseVo åŸæ¥å¯ä»¥ä½¿ç”¨ç»§æ‰¿çš„å†™æ³•ï¼Œå­¦åˆ°äº† 1234567891011@Datapublic class AttrResponseVo extends AttrEntity &#123; /* * åˆ†ç±»å */ private String catelogName; /* * åˆ†ç»„å */ private String groupName;&#125; AttrController123456789101112131415@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; @Autowired private AttrService attrService; /** * åˆ—è¡¨ */ @RequestMapping(&quot;/base/list/&#123;catelogId&#125;&quot;) public R baseAttrList(@RequestParam Map&lt;String, Object&gt; params, @PathVariable(&quot;catelogId&quot;) Long catelogId) &#123; PageUtils page = attrService.queryBaseAttrPage(params, catelogId); return R.ok().put(&quot;page&quot;, page); &#125;&#125; AttrServiceImpl å¸¦æ–°å¢çš„ä¸¤ä¸ªå±æ€§ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354@Service(&quot;attrService&quot;)public class AttrServiceImpl extends ServiceImpl&lt;AttrDao, AttrEntity&gt; implements AttrService &#123; @Autowired AttrAttrgroupRelationDao relationDao; /** * æŸ¥è¯¢attrè¡¨åˆ†é¡µ * * @param params * @param catelogId * @return */ @Override public PageUtils queryBaseAttrPage(Map&lt;String, Object&gt; params, Long catelogId) &#123; QueryWrapper&lt;AttrEntity&gt; queryWrapper = new QueryWrapper&lt;&gt;(); if (catelogId != 0) &#123; queryWrapper.eq(&quot;catelog_id&quot;, catelogId); &#125; String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; // andæ‹¼æ¥ï¼Œå› ä¸ºå¯èƒ½idä¸º0æ‰€ä»¥å·²ç»å«æœ‰äº†ä¸€ä¸ªeqæ¡ä»¶ queryWrapper.and((wrapper) -&gt; &#123; wrapper.eq(&quot;attr_id&quot;, key).or().like(&quot;attr_name&quot;, key); &#125;); &#125; // è·å¾—åˆ†é¡µå¯¹è±¡ IPage&lt;AttrEntity&gt; page = this.page( new Query&lt;AttrEntity&gt;().getPage(params), queryWrapper ); // åŒæ—¶è¿˜è¦æ·»åŠ ä¸ŠattrResponseVoä¸­å¤šçš„ä¸¤ä¸ªå±æ€§ // ä½†æ˜¯ä¸èƒ½ç›´æ¥è¿è¡¨æŸ¥è¯¢ï¼Œæ•°æ®é‡å¤ªå¤§äº†ã€‚ï¼ˆä¸¤è¡¨å‰ä¹˜ç¬›å¡å°”ç§¯ï¼‰ // æ‰€ä»¥å…ˆè·å–åˆ°åˆ†é¡µåè·å–æŸ¥è¯¢åˆ°çš„æ•°æ®,å†é‡æ–°å¤„ç† PageUtils pageUtils = new PageUtils(page); List&lt;AttrEntity&gt; records = page.getRecords(); List&lt;AttrResponseVo&gt; responseVoList = records.stream().map((attrEntity) -&gt; &#123; AttrResponseVo responseVo = new AttrResponseVo(); // å…ˆå¤åˆ¶åŸºæœ¬å±æ€§ BeanUtils.copyProperties(attrEntity, responseVo); // å†åŠ å…¥æ–°çš„ä¸¤ä¸ªå±æ€§ CategoryEntity categoryEntity = categoryDao.selectById(attrEntity.getCatelogId()); if (categoryEntity != null) &#123; responseVo.setCatelogName(categoryEntity.getName()); &#125; AttrAttrgroupRelationEntity relationEntity = relationDao.selectOne(new QueryWrapper&lt;AttrAttrgroupRelationEntity&gt;().eq(&quot;attr_id&quot;, attrEntity.getAttrId())); if (relationEntity != null) &#123; responseVo.setGroupName(attrGroupDao.selectById(relationEntity.getAttrGroupId()).getAttrGroupName()); &#125; return responseVo; &#125;).collect(Collectors.toList()); // é‡æ–°è®¾ç½®ç»“æœé›† pageUtils.setList(responseVoList); return pageUtils; &#125;&#125; æŸ¥è¯¢å›æ˜¾AttrResoponseVo12345678910111213141516171819@Datapublic class AttrResponseVo extends AttrEntity &#123; /* * åˆ†ç±»å */ private String catelogName; /* * åˆ†ç»„å */ private String groupName; /* * åˆ†ç±»å®Œæ•´è·¯å¾„ */ private Long[] catelogPath; /* * åˆ†ç»„ID */ private Long attrGroupId;&#125; AttrController1234567891011121314@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; @Autowired private AttrService attrService; /** * ä¿¡æ¯,è¿”å›AttrResponseVoå¯¹è±¡å±æ€§ */ @RequestMapping(&quot;/info/&#123;attrId&#125;&quot;) public R attrResponseInfo(@PathVariable(&quot;attrId&quot;) Long attrId) &#123; AttrResponseVo attr = attrService.getResponseAttrInfo(attrId); return R.ok().put(&quot;attr&quot;, attr); &#125; AttrServiceImpl1234567891011121314151617181920212223242526272829303132@Service(&quot;attrService&quot;)public class AttrServiceImpl extends ServiceImpl&lt;AttrDao, AttrEntity&gt; implements AttrService &#123; /** * è·å–ä¿¡æ¯,è¿”å›AttrResponseVoå¯¹è±¡å±æ€§ï¼Œå¸¦catelogPathå®Œæ•´è·¯å¾„ */ @Override public AttrResponseVo getResponseAttrInfo(Long attrId) &#123; AttrResponseVo responseVo = new AttrResponseVo(); AttrEntity attrEntity = this.getById(attrId); BeanUtils.copyProperties(attrEntity, responseVo); // é¢å¤–çš„å±æ€§ // è®¾ç½®GroupNameéœ€è¦ä»relationè¡¨ä¸­æŸ¥å‡ºgroupid AttrAttrgroupRelationEntity relationEntity = relationDao.selectOne(new QueryWrapper&lt;AttrAttrgroupRelationEntity&gt;().eq(&quot;attr_id&quot;, attrEntity.getAttrId())); if (relationEntity != null) &#123; responseVo.setAttrGroupId(relationEntity.getAttrGroupId()); // è®¾ç½®GroupNameå±æ€§ AttrGroupEntity attrGroupEntity = attrGroupDao.selectById(relationEntity.getAttrGroupId()); if (attrGroupEntity != null) &#123; responseVo.setGroupName(attrGroupEntity.getAttrGroupName()); &#125; &#125; // è®¾ç½®CatelogPathå±æ€§,ç›´æ¥ä»åˆ†ç±»æœåŠ¡ä¸­æ‹¿æ–¹æ³• Long[] categoryPath = categoryService.findCategoryPath(attrEntity.getCatelogId()); responseVo.setCatelogPath(categoryPath); // è®¾ç½®CatelogNameå±æ€§ CategoryEntity categoryEntity = categoryDao.selectById(attrEntity.getCatelogId()); if (categoryEntity != null) &#123; responseVo.setCatelogName(categoryEntity.getName()); &#125; return responseVo; &#125;&#125; ä¿®æ”¹AttrController éœ€è¦ç”¨AttrRequestVo 12345678/** * ä¿®æ”¹ */@RequestMapping(&quot;/update&quot;)public R update(@RequestBody AttrRequestVo attr) &#123; attrService.updateAttr(attr); return R.ok();&#125; AttrServiceImpl12345678910111213141516171819202122/** * ä¿®æ”¹,ä½¿ç”¨AttrRequestVo */@Override@Transactionalpublic void updateAttr(AttrRequestVo attr) &#123; // ä¿®æ”¹åŸºæœ¬è¡¨ AttrEntity attrEntity = new AttrEntity(); BeanUtils.copyProperties(attr, attrEntity); this.updateById(attrEntity); // ä¿®æ”¹/æ–°å¢relationè¡¨ AttrAttrgroupRelationEntity relationEntity = new AttrAttrgroupRelationEntity(); relationEntity.setAttrGroupId(attr.getAttrGroupId()); relationEntity.setAttrId(attr.getAttrId()); // è¿™é‡Œä¸»è¦åˆ¤æ–­relationè¡¨ä¸­æ˜¯å¦å­˜åœ¨å¯¹åº”attrå±æ€§idçš„æ•°æ®ï¼ˆå³è¡¨ä¸­æ˜¯å¦å­˜å…¥å¯¹åº”å±æ€§å¯¹åº”åˆ†ç»„ï¼Œå¦‚æœæ²¡æœ‰å¯¹åº”åˆ†ç»„ï¼Œé‚£ä¹ˆéœ€è¦æ‰§è¡Œæ’å…¥è¯­å¥è€Œä¸æ˜¯ä¿®æ”¹è¯­å¥ï¼‰ Integer count = relationDao.selectCount(new QueryWrapper&lt;AttrAttrgroupRelationEntity&gt;().eq(&quot;attr_id&quot;, attr.getAttrId())); if (count &gt; 0) &#123; relationDao.update(relationEntity, new UpdateWrapper&lt;AttrAttrgroupRelationEntity&gt;().eq(&quot;attr_id&quot;, attr.getAttrId())); &#125; else &#123; relationDao.insert(relationEntity); &#125;&#125; å¹³å°å±æ€§â€”é”€å”®å±æ€§ï¼ˆåç«¯ï¼‰ è§„æ ¼å‚æ•°å’Œé”€å”®å±æ€§å…¶å®å°±æ˜¯attrå±æ€§ä¸­attrTypeçš„ä¸åŒï¼Œæ‰€ä»¥controllerè¿˜æ˜¯åŒä¸€ä¸ªï¼Œåªæ˜¯è¯·æ±‚åœ°å€ä¸­ç‰‡æ®µä¸åŒï¼Œåªéœ€è¦åœ¨requestMappingä¸­è·å¾—å‚æ•°åˆ¤æ–­ä¸€ä¸‹å³å¯ï¼Œ å¸¸é‡ç±» åœ¨commonæ¨¡å—ä¸­å†™ä¸€ä¸ªç±»ï¼Œé‡Œé¢å†™å„ç§æšä¸¾ 1234567891011public class ProductConstant &#123; public enum AttrEnum &#123; ATTR_TYPE_BASE(1, &quot;åŸºæœ¬å±æ€§&quot;), ATTR_TYPE_SALE(0, &quot;é”€å”®å±æ€§&quot;); private int code; private String msg; AttrEnum(int code, String msg) &#123; this.code = code; this.msg = msg; &#125; &#125;&#125; AttrController12345678910111213141516171819202122232425262728@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; @Autowired private AttrService attrService; /** * ä¿¡æ¯,è¿”å›AttrResponseVoå¯¹è±¡å±æ€§ */ @RequestMapping(&quot;/info/&#123;attrId&#125;&quot;) public R attrResponseInfo(@PathVariable(&quot;attrId&quot;) Long attrId) &#123; AttrResponseVo attr = attrService.getResponseAttrInfo(attrId); return R.ok().put(&quot;attr&quot;, attr); &#125; /** * æ¡ä»¶æŸ¥è¯¢åˆ†é¡µåˆ—è¡¨,è¿”å›AttrResponseVoå¯¹è±¡å±æ€§ * attrType ç”¨äºåˆ¤æ–­æ˜¯é”€å”®å±æ€§è¿˜æ˜¯åŸºæœ¬å±æ€§ï¼ˆè¯¦è§æ–‡æ¡£ï¼‰ */ @GetMapping(&quot;/&#123;attrType&#125;/list/&#123;catelogId&#125;&quot;) public R attrResponseList(@RequestParam Map&lt;String, Object&gt; params, @PathVariable(&quot;attrType&quot;) String attrType, @PathVariable(&quot;catelogId&quot;) Long catelogId) &#123; PageUtils page = attrService.queryBaseAttrPage(params, catelogId,attrType); return R.ok().put(&quot;page&quot;, page); &#125;&#125; AttrService12345678910111213141516171819202122232425262728293031323334353637/** * æ¡ä»¶æŸ¥è¯¢attrè¡¨åˆ†é¡µ * * @param params * @param catelogId * @param attrType * @return */@Overridepublic PageUtils queryBaseAttrPage(Map&lt;String, Object&gt; params, Long catelogId, String attrType) &#123; // è¿™é‡Œåˆ¤æ–­attrTypeï¼Œç”¨äºæŸ¥è¯¢æ˜¯è§„æ ¼å‚æ•°è¿˜æ˜¯é”€å”®å±æ€§ QueryWrapper&lt;AttrEntity&gt; queryWrapper = new QueryWrapper&lt;AttrEntity&gt;().eq(&quot;attr_type&quot;, &quot;base&quot;.equalsIgnoreCase(attrType) ? 1 : 0); if (catelogId != 0) &#123; queryWrapper.eq(&quot;catelog_id&quot;, catelogId); &#125; /** * ä¿å­˜è§„æ ¼å‚æ•°ï¼Œè¿è¡¨ */ @Override @Transactional // äº‹åŠ¡ public void saveAttr(AttrRequestVo attr) &#123; // 1ã€ä¿å­˜åˆ°attrè¡¨ AttrEntity attrEntity = new AttrEntity(); // ä½¿ç”¨BeanUtilå°è£…å¯¹åº”å±æ€§ BeanUtils.copyProperties(attr, attrEntity); this.save(attrEntity); // 2ã€ä¿å­˜åˆ°relationè¡¨ // åˆ¤æ–­æ˜¯å¦æ˜¯é”€å”®å±æ€§ï¼Œå¦‚æœä¸æ˜¯é‚£ä¹ˆä¸éœ€è¦æ·»åŠ åˆ°relationè¡¨ if (attr.getAttrType() == ProductConstant.AttrEnum.ATTR_TYPE_BASE.getCode()) &#123; AttrAttrgroupRelationEntity relationEntity = new AttrAttrgroupRelationEntity(); relationEntity.setAttrId(attrEntity.getAttrId()); // æ³¨æ„è¿™é‡Œè¦ä½¿ç”¨attrEntityï¼Œå› ä¸ºä½¿ç”¨attræ˜¯æ²¡æœ‰idçš„ï¼ˆæ²¡æœ‰æ·»åŠ mybatisçš„æ³¨è§£ï¼Œæ‰€ä»¥æ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆidï¼‰ relationEntity.setAttrGroupId(attr.getAttrGroupId()); relationDao.insert(relationEntity); &#125; &#125; &#125; å¹³å°å±æ€§â€”å±æ€§åˆ†ç»„ï¼ˆåç«¯ï¼‰æŸ¥è¯¢å…³è” åˆ†ç»„å’Œå±æ€§å¤šå¯¹å¤šï¼Œéœ€è¦å…³è”è¡¨ AttrGroupController12345678910111213141516171819202122@RestController@RequestMapping(&quot;product/attrgroup&quot;)public class AttrGroupController &#123; @Autowired private AttrGroupService attrGroupService; @Autowired private CategoryService categoryService; @Autowired private AttrService attrService; /** * è·å¾—å¯¹åº”åˆ†ç»„Idçš„å±æ€§ * * @param attrgroupId * @return */ @GetMapping(&quot;/&#123;attrgroupId&#125;/attr/relation&quot;) public R attrRelationList(@PathVariable(&quot;attrgroupId&quot;) String attrgroupId) &#123; List&lt;AttrEntity&gt; list = attrService.getRelationAttr(attrgroupId); return R.ok().put(&quot;data&quot;, list); &#125;&#125; AttrService123456789101112131415/** * è·å¾—å¯¹åº”åˆ†ç»„Idçš„åŸºæœ¬å±æ€§ï¼ˆè§„æ ¼å‚æ•°ï¼‰ * * @param attrgroupId * @return */@Overridepublic List&lt;AttrEntity&gt; getRelationAttr(String attrgroupId) &#123; List&lt;AttrAttrgroupRelationEntity&gt; relationList = relationDao.selectList(new QueryWrapper&lt;AttrAttrgroupRelationEntity&gt;().eq(&quot;attr_group_id&quot;, attrgroupId)); List&lt;Long&gt; idList = relationList.stream().map((relationEntity) -&gt; &#123; return relationEntity.getAttrId(); &#125;).collect(Collectors.toList()); Collection&lt;AttrEntity&gt; attrEntities = this.listByIds(idList); return (List&lt;AttrEntity&gt;) attrEntities;&#125; åˆ é™¤å…³è”AttrGroupRelationVo12345@Datapublic class AttrGroupRelationVo &#123; private Long attrId; private Long attrGroupId;&#125; AttrGroupController12345678/** * åˆ é™¤å…³è” */@RequestMapping(&quot;/attr/relation/delete&quot;)public R deleteRelation(AttrGroupRelationVo[] vos) &#123; attrService.deleteRelation(vos); return R.ok();&#125; AttrGroupService1234567891011121314151617/** * åˆ é™¤å…³è” * * @param vos */@Overridepublic void deleteRelation(AttrGroupRelationVo[] vos) &#123; // relationDao.delete(new QueryWrapper&lt;&gt;().eq(&quot;attr_id&quot;, attrId).eq(&quot;attr_group_id&quot;, groupId)) // Vos-&gt;relationå¯¹è±¡é›†åˆ List&lt;AttrAttrgroupRelationEntity&gt; collect = Arrays.asList(vos).stream().map((vo) -&gt; &#123; AttrAttrgroupRelationEntity relationEntity = new AttrAttrgroupRelationEntity(); BeanUtils.copyProperties(vo, relationEntity); return relationEntity; &#125;).collect(Collectors.toList()); relationDao.deleteBatchRelation(collect);&#125; AttrAttrGroupRelationDao12345@Mapperpublic interface AttrAttrgroupRelationDao extends BaseMapper&lt;AttrAttrgroupRelationEntity&gt; &#123; void deleteBatchRelation(@Param(&quot;entities&quot;) List&lt;AttrAttrgroupRelationEntity&gt; entities);&#125; 12345678&lt;delete id=&quot;deleteBatchRelation&quot;&gt; DELETE FROM gulimall_pms.pms_attr_attrgroup_relation WHERE &lt;foreach collection=&quot;entities&quot; item=&quot;item&quot; separator=&quot; OR &quot;&gt; (attr_id = #&#123;item.attrId&#125; AND attr_group_id = #&#123;item.attrGroupId&#125;) &lt;/foreach&gt;&lt;/delete&gt; æŸ¥è¯¢æœªå…³è”å±æ€§AttrGroupController1234567891011/** * è·å¾—å¯¹åº”åˆ†ç»„Idæ²¡æœ‰å…³è”çš„å±æ€§ * * @param attrgroupId * @return */@GetMapping(&quot;/&#123;attrgroupId&#125;/noattr/relation&quot;)public R attrNoRelationList(@PathVariable(&quot;attrgroupId&quot;) String attrgroupId, @RequestParam Map&lt;String, Object&gt; params) &#123; PageUtils pageUtils = attrService.getNoRelationAttr(params, attrgroupId); return R.ok().put(&quot;page&quot;, pageUtils);&#125; AttrService123456789101112131415161718192021222324252627282930313233343536/** * è·å¾—å¯¹åº”åˆ†ç»„Idæ²¡æœ‰å…³è”çš„å±æ€§ * * @param params * @param attrgroupId * @return */@Overridepublic PageUtils getNoRelationAttr(Map&lt;String, Object&gt; params, String attrgroupId) &#123; // å½“å‰åˆ†ç»„åªèƒ½å…³è”è‡ªå·±æ‰€å±åˆ†ç±»é‡Œé¢çš„å±æ€§ AttrGroupEntity attrGroupEntity = attrGroupDao.selectById(attrgroupId); Long catelogId = attrGroupEntity.getCatelogId(); // å½“å‰åˆ†ç»„åªèƒ½å…³è”æ²¡æœ‰è¢«åˆ«çš„åˆ†ç»„å¼•ç”¨çš„å±æ€§ // è·å¾—å½“å‰åˆ†ç±»ä¸‹çš„å…¶ä»–åˆ†ç»„ List&lt;AttrGroupEntity&gt; groupEntities = attrGroupDao.selectList(new QueryWrapper&lt;AttrGroupEntity&gt;().eq(&quot;catelog_id&quot;, catelogId).ne(&quot;attr_group_id&quot;, attrgroupId)); List&lt;Long&gt; groupIdList = groupEntities.stream().map((item) -&gt; &#123; return item.getAttrGroupId(); &#125;).collect(Collectors.toList()); // è·å¾—å…¶ä»–åˆ†ç»„ä¸­å¯¹åº”çš„å±æ€§id List&lt;AttrAttrgroupRelationEntity&gt; relationEntities = relationDao.selectList(new QueryWrapper&lt;AttrAttrgroupRelationEntity&gt;().in(&quot;attr_group_id&quot;, groupIdList)); List&lt;Long&gt; attrIdList = relationEntities.stream().map((item) -&gt; &#123; return item.getAttrId(); &#125;).collect(Collectors.toList()); // ä»å½“å‰åˆ†ç±»çš„æ‰€æœ‰å±æ€§ä¸­å–å‡ºä¸Šè¿°å±æ€§ QueryWrapper&lt;AttrEntity&gt; queryWrapper = new QueryWrapper&lt;AttrEntity&gt;().eq(&quot;catelog_id&quot;, catelogId).notIn(&quot;attr_id&quot;, attrIdList); // æ¨¡ç³ŠæŸ¥è¯¢åˆ¤æ–­ String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; queryWrapper.and((wrapper) -&gt; &#123; wrapper.eq(&quot;attr_id&quot;, key).or().like(&quot;attr_name&quot;, key); &#125;); &#125; IPage&lt;AttrEntity&gt; iPage = this.page(new Query&lt;AttrEntity&gt;().getPage(params), queryWrapper); PageUtils pageUtils = new PageUtils(iPage); return pageUtils;&#125; TODOï¼šè¿™é‡Œæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„åœ°æ–¹ï¼Œæˆ‘ä¿®æ”¹ä¸€ä¸‹å…³è”çš„è¯ï¼Œå±æ€§ä¸­çš„æ‰€å±åˆ†ç»„ä¹Ÿä¼šæ”¹å˜ï¼Ÿ å“¦æˆ‘å‚»äº†ï¼Œè¿™ä¿©ä¸ªå°±æ˜¯å¯¹åº”çš„åŠŸèƒ½ æ·»åŠ å…³è”AttrGroupController1234567891011/** * æ–°å»ºå…³è” * * @param vos * @return */@PostMapping(&quot;/attr/relation&quot;)public R addRelation(@RequestBody List&lt;AttrGroupRelationVo&gt; vos) &#123; relationService.saveBatch(vos); return R.ok();&#125; AttrGroupService1234567891011121314/** * æ‰¹é‡ä¿å­˜ * * @param vos */@Overridepublic void saveBatch(List&lt;AttrGroupRelationVo&gt; vos) &#123; List&lt;AttrAttrgroupRelationEntity&gt; relationEntityList = vos.stream().map((vo) -&gt; &#123; AttrAttrgroupRelationEntity relationEntity = new AttrAttrgroupRelationEntity(); BeanUtils.copyProperties(vo, relationEntity); return relationEntity; &#125;).collect(Collectors.toList()); this.saveBatch(relationEntityList);&#125; å•†å“ç»´æŠ¤â€”å‘å¸ƒå•†å“ï¼ˆåç«¯ï¼‰è·å–ç”¨æˆ·ç­‰çº§é…ç½®ç½‘å…³application.yml è¯¦è§æ–‡æ¡£ï¼Œéœ€è¦memberæ¨¡å—ä¸­çš„åŠŸèƒ½ï¼Œä¹‹å‰è¿˜æ²¡æœ‰é…è¿‡è¯¥æ¨¡å—çš„ç½‘å…³é…ç½®ï¼Œé…ç½®ä¸€ä¸‹å³å¯ 123456789101112spring: cloud: gateway: routes: # memberä¼šå‘˜é…ç½® - id: member_route uri: lb://gulimall-member predicates: - Path=/api/member/** # å®ç°è½¬å‘ filters: - RewritePath=/api/(?&lt;segment&gt;.*),/$\\&#123;segment&#125; é¡µé¢æ¨¡æ¿ åŸæœ¬renren-generatorç”Ÿæˆçš„æ—¶å€™å°±æœ‰äº†ï¼Œç›´æ¥å¤åˆ¶åˆ°å‰ç«¯srcæ–‡ä»¶å¤¹ä¸‹å³å¯ ç„¶åå°±å¥½äº†ï¼ŒåŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ è·å¾—åˆ†ç±»å…³è”çš„å“ç‰ŒBrandVo12345@Datapublic class BrandVo &#123; private Long brandId; private String brandName;&#125; CategoryBrandRelationController123456789101112131415161718192021222324@RestController@RequestMapping(&quot;product/categorybrandrelation&quot;)public class CategoryBrandRelationController &#123; @Autowired private CategoryBrandRelationService relationService; /** * è·å–åˆ†ç±»å…³è”çš„æ‰€æœ‰å“ç‰Œåˆ—è¡¨ */ @GetMapping(&quot;/brand/list&quot;) public R relationListByBrand(@RequestParam(&quot;catId&quot;) Long catId) &#123; List&lt;BrandEntity&gt; brandEntities = relationService.getBrandsByCatId(catId); // å…ˆè·å¾—brandEntityï¼Œåœ¨è½¬æ¢æˆVo List&lt;BrandVo&gt; list = brandEntities.stream().map((item) -&gt; &#123; BrandVo brandVo = new BrandVo(); // è¿™é‡Œå±æ€§åæ²¡æœ‰å¯¹åº”ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨è®¾ç½® brandVo.setBrandId(item.getBrandId()); brandVo.setBrandName(item.getName()); return brandVo; &#125;).collect(Collectors.toList()); return R.ok().put(&quot;data&quot;, list); &#125;&#125; ä¸ºä»€ä¹ˆè¿™é‡Œä¸ç›´æ¥ä½¿ç”¨relationå¯¹è±¡çš„åŸå› æ˜¯ï¼Œä¸ºäº†é‡ç”¨ï¼Œå¦‚æœåé¢è¿˜æœ‰ä¸šåŠ¡éœ€è¦è·å¾—æ›´å¤šçš„brandä¿¡æ¯ï¼Œéœ€è¦ç”¨åˆ°brandEntity CategoryBrandRelationServiceImpl123456789101112131415/** * æ ¹æ®catIdæŸ¥è¯¢å…³è”çš„æ‰€æœ‰å“ç‰Œçš„æ‰€æœ‰ä¿¡æ¯ * * @param catId * @return */@Overridepublic List&lt;BrandEntity&gt; getBrandsByCatId(Long catId) &#123; List&lt;CategoryBrandRelationEntity&gt; relationList = baseMapper.selectList(new QueryWrapper&lt;CategoryBrandRelationEntity&gt;().eq(&quot;catelog_id&quot;, catId)); List&lt;BrandEntity&gt; collect = relationList.stream().map(relationEntity -&gt; &#123; Long brandId = relationEntity.getBrandId(); return brandService.getById(brandId); &#125;).collect(Collectors.toList()); return collect;&#125; è·å–åˆ†ç±»å…³è”çš„åˆ†ç»„å’Œå±æ€§ åˆ†ç±»ï¼šæ‰‹æœºæ‰‹è¡¨â€¦â€¦ åˆ†ç»„ï¼šä¸»ä½“ï¼ŒåŸºæœ¬ä¿¡æ¯ï¼Œå…¶ä»–ä¿¡æ¯ å±æ€§ï¼šå°ºå¯¸ï¼Œé¢œè‰² å±æ€§ä»å±äºåˆ†ç»„ï¼Œåˆ†ç»„ä»å±äºåˆ†ç±»ï¼ˆå¤šå¯¹ä¸€ï¼‰ï¼Œåˆ†ç±»å’Œå“ç‰Œå¤šå¯¹å¤š AttrGroupWithAttrsVo12345678910111213141516171819202122232425262728293031@Datapublic class AttrGroupWithAttrsVo &#123; /** * åˆ†ç»„id */ private Long attrGroupId; /** * ç»„å */ private String attrGroupName; /** * æ’åº */ private Integer sort; /** * æè¿° */ private String descript; /** * ç»„å›¾æ ‡ */ private String icon; /** * æ‰€å±åˆ†ç±»id */ private Long catelogId; /** * è¯¥åˆ†ç»„ä¸‹çš„æ‰€æœ‰å±æ€§ */ private List&lt;AttrEntity&gt; attrs;&#125; AttrGroupController1234567891011public class AttrGroupController &#123; /** * è·å¾—å¯¹åº”åˆ†ç±»Idå…³è”çš„åˆ†ç»„å’Œå±æ€§ */ @GetMapping(&quot;/&#123;catelogId&#125;/withattr&quot;) public R getAttrGroupWithAttr(@PathVariable(&quot;catelogId&quot;) Long catelogId, @RequestParam Map&lt;String, Object&gt; params) &#123; // æŸ¥å‡ºåˆ†ç»„ // æŸ¥å‡ºå±æ€§ List&lt;AttrGroupWithAttrsVo&gt; list = attrGroupService.getWithAttrByCatelogId(catelogId); return R.ok().put(&quot;data&quot;, list); &#125; AttrGroupService1234567891011121314151617/** * è·å¾—å¯¹åº”åˆ†ç±»Idå…³è”çš„åˆ†ç»„å’Œå±æ€§ */@Overridepublic List&lt;AttrGroupWithAttrsVo&gt; getWithAttrByCatelogId(Long catelogId) &#123; // æŸ¥è¯¢åˆ†ç»„ List&lt;AttrGroupEntity&gt; attrGroupList = this.list(new QueryWrapper&lt;AttrGroupEntity&gt;().eq(&quot;catelog_id&quot;, catelogId)); List&lt;AttrGroupWithAttrsVo&gt; collect = attrGroupList.stream().map(attrGroupEntity -&gt; &#123; AttrGroupWithAttrsVo attrGroupWithAttrsVo = new AttrGroupWithAttrsVo(); BeanUtils.copyProperties(attrGroupEntity, attrGroupWithAttrsVo); // æŸ¥è¯¢æ‰€æœ‰å±æ€§ List&lt;AttrEntity&gt; attrList = attrService.getRelationAttr(attrGroupEntity.getAttrGroupId()); attrGroupWithAttrsVo.setAttrs(attrList); return attrGroupWithAttrsVo; &#125;).collect(Collectors.toList()); return collect;&#125; æ–°å¢å•†å“Vo å‡†å¤‡ä¸€ä¸ªVoæ¥æ”¶JSONæ•°æ®ï¼Œä½¿ç”¨BEJSONç½‘ç«™ä¸‹çš„è½¬javaå®ä½“ç±»å·¥å…·ï¼Œç„¶åä¸‹è½½å³å¯ çœŸä¸æˆ³ï¼ SpuInfoController1234567891011121314151617@RestController@RequestMapping(&quot;product/spuinfo&quot;)public class SpuInfoController &#123; @Autowired private SpuInfoService spuInfoService; /** * ä¿å­˜ */ @RequestMapping(&quot;/save&quot;) //@RequiresPermissions(&quot;product:spuinfo:save&quot;) public R save(@RequestBody SpuSaveVo spuSaveVo) &#123; // spuInfoService.save(spuInfo); spuInfoService.saveSpuVo(spuSaveVo); return R.ok(); &#125;&#125; è¿œç¨‹æœåŠ¡ å› ä¸ºæ¶‰åŠåˆ°couponæ¨¡å—ï¼Œéœ€è¦è¿œç¨‹è°ƒç”¨ å¼€å¯æœåŠ¡ @EnableDiscoveryClient // è¢«è°ƒç”¨æœåŠ¡applicationä¸Šï¼Œå¼€å¯nacosæ³¨å†Œ@EnableFeignClients(basePackages = â€œcom.atguigu.gulimall.product.feignâ€) //feign TO : ç”±äºä¸¤ä¸ªæœåŠ¡ä¹‹é—´éœ€è¦å…¬ç”¨ä¸€ç§å¯¹è±¡ï¼Œä½¿ç”¨TOä¼ è¾“å¯¹è±¡ï¼Œå¯ä»¥å†™åœ¨commonå…¬å…±æ¨¡å—ä¸­ ç¼–å†™æ¥å£ è¿œç¨‹æœåŠ¡æ¥å£123456789101112@FeignClient(&quot;gulimall-coupon&quot;) // å£°æ˜è°ƒç”¨çš„æœåŠ¡public interface CouponFeignService &#123; /** * 1 å…ˆå°†è¿œç¨‹ç”µè°ƒç”¨æœåŠ¡æ–¹æ³•çš„å¯¹è±¡è½¬ä¸ºJSON * 2 è¯·æ±‚couponæœåŠ¡ä¸­çš„saveè¯·æ±‚ï¼ŒJSONå­˜æ”¾åœ¨è¯·æ±‚ä½“ä¸­ * 3 æ”¶åˆ°è¯·æ±‚ï¼Œå°†è¯·æ±‚ä½“ä¸­çš„JSONè½¬ä¸ºè¯·æ±‚æ–¹æ³•çš„å‚æ•° * ï¼ˆ@ResponseBodyæ–¹JSONå’Œå¯¹è±¡èƒ½å¤Ÿäº’ç›¸è½¬æ¢ï¼‰ */ @PostMapping(&quot;/coupon/spubounds/save&quot;) R saveSpuBound(@RequestBody SpuBoundTo spuBoundTo);&#125; SpuInfoServiceImpl å› ä¸ºè¿™ä¸ªå•†å“Voæ¶‰åŠè¡¨ä¼—å¤šï¼Œè¿˜æœ‰å…³è”åˆ°è¿œç¨‹è°ƒç”¨ï¼Œæ‰€ä»¥ä»£ç é‡è¾ƒé•¿ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130@Service(&quot;spuInfoService&quot;)public class SpuInfoServiceImpl extends ServiceImpl&lt;SpuInfoDao, SpuInfoEntity&gt; implements SpuInfoService &#123; @Autowired SpuInfoDescService spuInfoDescService; @Autowired SpuImagesService spuImagesService; @Autowired ProductAttrValueService productAttrValueService; @Autowired AttrService attrService; @Autowired SkuInfoService skuInfoService; @Autowired SkuImagesService skuImagesService; @Autowired SkuSaleAttrValueService skuSaleAttrValueService; @Autowired CouponFeignService couponFeignService; /** * ä¿å­˜saveSpuVoInfoï¼Œå‰ç«¯æ¥æ”¶çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ¶‰åŠå¤šä¸ªè¡¨ * * @param spuSaveVo */ @Transactional @Override public void saveSpuVoInfo(SpuSaveVo spuSaveVo) &#123; // ä¿å­˜spu info: spu_info SpuInfoEntity spuInfoEntity = new SpuInfoEntity(); BeanUtils.copyProperties(spuSaveVo, spuInfoEntity); spuInfoEntity.setCreateTime(new Date()); spuInfoEntity.setUpdateTime(new Date()); this.save(spuInfoEntity); // ä¿å­˜spu info_desc: spu_info_desc List&lt;String&gt; decrypts = spuSaveVo.getDecript(); SpuInfoDescEntity spuInfoDescEntity = new SpuInfoDescEntity(); spuInfoDescEntity.setSpuId(spuInfoEntity.getId()); // ä¿å­˜ä¹‹åä¼šå°†idè‡ªåŠ¨å°è£…åˆ°infoEntity spuInfoDescEntity.setDecript(String.join(&quot;,&quot;, decrypts)); // ä½¿ç”¨ï¼Œæ‹¼æ¥ spuInfoDescService.save(spuInfoDescEntity); // ä¿å­˜spu images: spu_images List&lt;String&gt; images = spuSaveVo.getImages(); List&lt;SpuImagesEntity&gt; spuImagesList = images.stream().map(image -&gt; &#123; SpuImagesEntity spuImagesEntity = new SpuImagesEntity(); spuImagesEntity.setSpuId(spuInfoEntity.getId()); spuImagesEntity.setImgUrl(image); return spuImagesEntity; &#125;).collect(Collectors.toList()); spuImagesService.saveBatch(spuImagesList); // ä¿å­˜spu product_attr_value: product_attr_valu List&lt;BaseAttrs&gt; baseAttrs = spuSaveVo.getBaseAttrs(); List&lt;ProductAttrValueEntity&gt; collect = baseAttrs.stream().map(attr -&gt; &#123; ProductAttrValueEntity attrValueEntity = new ProductAttrValueEntity(); attrValueEntity.setAttrId(attr.getAttrId()); attrValueEntity.setSpuId(spuInfoEntity.getId()); attrValueEntity.setAttrName(attrService.getById(attr.getAttrId()).getAttrName()); attrValueEntity.setAttrValue(attr.getAttrValues()); attrValueEntity.setQuickShow(attr.getShowDesc()); return attrValueEntity; &#125;).collect(Collectors.toList()); productAttrValueService.saveBatch(collect); // ä¿å­˜spu ç§¯åˆ†ä¿¡æ¯: sms_spu_bounds // ä¿å­˜skuå¯¹åº”sku_info: sku_infoã€sku_imagesã€sku_sale_attr_valueã€sms_sku_ladderã€sms_sku_full_reductionã€sms_member_price List&lt;Skus&gt; skus = spuSaveVo.getSkus(); if (skus != null &amp;&amp; skus.size() &gt; 0) &#123; skus.forEach(sku -&gt; &#123; // 1 ä¿å­˜åŸºæœ¬ä¿¡æ¯ SkuInfoEntity skuInfoEntity = new SkuInfoEntity(); BeanUtils.copyProperties(sku, skuInfoEntity); skuInfoEntity.setBrandId(spuInfoEntity.getBrandId()); skuInfoEntity.setCatalogId(spuInfoEntity.getCatalogId()); skuInfoEntity.setSaleCount(0L); skuInfoEntity.setSpuId(spuInfoEntity.getId()); String defaultImg = &quot;&quot;; for (Images img : sku.getImages()) &#123; // è¿™é‡Œç”¨forè€Œä¸æ˜¯foreachï¼Œæ³¨æ„çœ‹æŠ¥é”™çš„åŸå› ï¼Œlamdaè¡¨è¾¾å¼ä¸­çš„å˜é‡è¦final if (img.getDefaultImg() == 1) &#123; defaultImg = img.getImgUrl(); &#125; &#125; skuInfoEntity.setSkuDefaultImg(defaultImg); skuInfoService.save(skuInfoEntity); Long skuId = skuInfoEntity.getSkuId(); // å¿…é¡»æ˜¯ä¿å­˜å®Œä¹‹åæ‰èƒ½è·å¾— // 2 ä¿å­˜å›¾ç‰‡ List&lt;SkuImagesEntity&gt; skuImagesList = sku.getImages().stream().map(img -&gt; &#123; SkuImagesEntity skuImagesEntity = new SkuImagesEntity(); skuImagesEntity.setSkuId(skuId); skuImagesEntity.setImgUrl(img.getImgUrl()); skuImagesEntity.setDefaultImg(img.getDefaultImg()); return skuImagesEntity; &#125;).collect(Collectors.toList()); skuImagesService.saveBatch(skuImagesList); // 3 ä¿å­˜å±æ€§ List&lt;Attr&gt; attrList = sku.getAttr(); List&lt;SkuSaleAttrValueEntity&gt; skuSaleAttrValueList = attrList.stream().map(attr -&gt; &#123; SkuSaleAttrValueEntity skuSaleAttrValueEntity = new SkuSaleAttrValueEntity(); BeanUtils.copyProperties(attr, skuSaleAttrValueEntity); skuSaleAttrValueEntity.setSkuId(skuId); return skuSaleAttrValueEntity; &#125;).collect(Collectors.toList()); skuSaleAttrValueService.saveBatch(skuSaleAttrValueList); // ä»¥ä¸‹éœ€è¦è¿œç¨‹æœåŠ¡ // 4 ä¿å­˜ä¼˜æƒ  Bounds bounds = spuSaveVo.getBounds(); SpuBoundTo spuBoundTo = new SpuBoundTo(); BeanUtils.copyProperties(bounds, spuBoundTo); spuBoundTo.setSpuId(spuInfoEntity.getId()); R saveSpuBound = couponFeignService.saveSpuBound(spuBoundTo); if (saveSpuBound.getCode() != 0) &#123; log.error(&quot;è¿œç¨‹ä¿å­˜spuç§¯åˆ†ä¿¡æ¯å¤±è´¥&quot;); &#125; // 5 ä¿å­˜æ»¡å‡ SkuReductionTo skuReductionTo = new SkuReductionTo(); BeanUtils.copyProperties(sku, skuReductionTo); skuReductionTo.setSkuId(skuId); R saveSkuReduction = couponFeignService.saveSkuReduction(skuReductionTo); if (saveSkuReduction.getCode() != 0) &#123; log.error(&quot;è¿œç¨‹ä¿å­˜spuç§¯æ»¡å‡ä¿¡æ¯å¤±è´¥&quot;); &#125; &#125;); &#125; &#125;&#125; SkuFullReductionServiceImpl123456789101112131415161718192021222324252627282930313233@Service(&quot;skuFullReductionService&quot;)public class SkuFullReductionServiceImpl extends ServiceImpl&lt;SkuFullReductionDao, SkuFullReductionEntity&gt; implements SkuFullReductionService &#123; @Autowired SkuLadderService skuLadderService; @Autowired MemberPriceService memberPriceService; @Override public void saveSkuReduction(SkuReductionTo skuReductionTo) &#123; // ä¿å­˜ladder SkuLadderEntity skuLadderEntity = new SkuLadderEntity(); skuLadderEntity.setSkuId(skuReductionTo.getSkuId()); skuLadderEntity.setFullCount(skuReductionTo.getFullCount()); skuLadderEntity.setDiscount(skuReductionTo.getDiscount()); skuLadderEntity.setAddOther(skuReductionTo.getCountStatus()); skuLadderService.save(skuLadderEntity); // ä¿å­˜æ»¡å‡ SkuFullReductionEntity skuFullReductionEntity = new SkuFullReductionEntity(); BeanUtils.copyProperties(skuReductionTo, skuFullReductionEntity); this.save(skuFullReductionEntity); // ä¿å­˜ä¼šå‘˜ä»·æ ¼ List&lt;MemberPriceTo&gt; memberPriceToList = skuReductionTo.getMemberPrice(); List&lt;MemberPriceEntity&gt; memberPriceList = memberPriceToList.stream().map(memberPriceTo -&gt; &#123; MemberPriceEntity memberPriceEntity = new MemberPriceEntity(); memberPriceEntity.setSkuId(skuReductionTo.getSkuId()); memberPriceEntity.setMemberLevelId(memberPriceTo.getId()); memberPriceEntity.setMemberLevelName(memberPriceTo.getName()); memberPriceEntity.setMemberPrice(memberPriceTo.getPrice()); memberPriceEntity.setAddOther(1); return memberPriceEntity; &#125;).collect(Collectors.toList()); memberPriceService.saveBatch(memberPriceList); &#125;&#125; debug &amp; test å¦ˆè€¶ä¸€æ¬¡æˆåŠŸæœ‰ç‚¹å¼€å¿ƒ TODO: å¤±è´¥çš„æƒ…å†µæ²¡æœ‰ç¼–å†™ å•†å“ç»´æŠ¤â€”SPUç®¡ç†ï¼ˆåç«¯ï¼‰æ—¶é—´æˆ³æ ¼å¼åŒ–1234spring: jackson: # æ—¶é—´æˆ³æ ¼å¼åŒ– date-format: yyyy-MM-dd HH:mm:ss SPUå¾…æ¡ä»¶æ£€ç´¢123456789/** * åˆ—è¡¨ */@RequestMapping(&quot;/list&quot;)//@RequiresPermissions(&quot;product:spuinfo:list&quot;)public R list(@RequestParam Map&lt;String, Object&gt; params) &#123; PageUtils page = spuInfoService.queryPageByCondition(params); return R.ok().put(&quot;page&quot;, page);&#125; 123456789101112131415161718192021222324252627282930313233/* *å¾…æ¡ä»¶æŸ¥è¯¢ */@Overridepublic PageUtils queryPageByCondition(Map&lt;String, Object&gt; params) &#123; QueryWrapper&lt;SpuInfoEntity&gt; wrapper = new QueryWrapper&lt;&gt;(); String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; wrapper.and((w) -&gt; &#123; w.eq(&quot;id&quot;, key).or().like(&quot;spu_name&quot;, key); &#125;); &#125; String status = (String) params.get(&quot;status&quot;); if (!StringUtils.isEmpty(status)) &#123; wrapper.eq(&quot;publish_status&quot;, status); &#125; String brandId = (String) params.get(&quot;brandId&quot;); if (!StringUtils.isEmpty(brandId)) &#123; wrapper.eq(&quot;brand_id&quot;, brandId); &#125; String catelogId = (String) params.get(&quot;catelogId&quot;); if (!StringUtils.isEmpty(catelogId)) &#123; wrapper.eq(&quot;catalog_id&quot;, catelogId); &#125; IPage&lt;SpuInfoEntity&gt; page = this.page( new Query&lt;SpuInfoEntity&gt;().getPage(params), wrapper ); return new PageUtils(page);&#125; SKUæ£€ç´¢1234567891011121314@RestController@RequestMapping(&quot;product/skuinfo&quot;)public class SkuInfoController &#123; @Autowired private SkuInfoService skuInfoService; /** * åˆ—è¡¨ */ @RequestMapping(&quot;/list&quot;) //@RequiresPermissions(&quot;product:skuinfo:list&quot;) public R list(@RequestParam Map&lt;String, Object&gt; params) &#123; PageUtils page = skuInfoService.queryPageByCondition(params); return R.ok().put(&quot;page&quot;, page); &#125; 1234567891011121314151617181920212223242526272829303132333435363738@Overridepublic PageUtils queryPageByCondition(Map&lt;String, Object&gt; params) &#123; QueryWrapper&lt;SkuInfoEntity&gt; wrapper = new QueryWrapper&lt;&gt;(); String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; wrapper.and((w) -&gt; &#123; w.eq(&quot;sku_id&quot;, key).or().like(&quot;sku_name&quot;, key); &#125;); &#125; String brandId = (String) params.get(&quot;brandId&quot;); if (!StringUtils.isEmpty(brandId)) &#123; wrapper.eq(&quot;brand_id&quot;, brandId); &#125; String catelogId = (String) params.get(&quot;catelogId&quot;); if (!StringUtils.isEmpty(catelogId)) &#123; wrapper.eq(&quot;catalog_id&quot;, catelogId); &#125; String min = (String) params.get(&quot;min&quot;); if (!StringUtils.isEmpty(min)) &#123; wrapper.ge(&quot;price&quot;, min); &#125; String max = (String) params.get(&quot;max&quot;); if (!StringUtils.isEmpty(max)) &#123; try &#123; BigDecimal bigDecimal = new BigDecimal(max); if (bigDecimal.compareTo(new BigDecimal(0)) == 1) &#123; wrapper.le(&quot;price&quot;, max); &#125; &#125; catch (Exception e) &#123; &#125; &#125; IPage&lt;SkuInfoEntity&gt; page = this.page( new Query&lt;SkuInfoEntity&gt;().getPage(params), wrapper ); return new PageUtils(page);&#125; åº“å­˜ç³»ç»Ÿâ€”ä»“åº“ç»´æŠ¤ï¼ˆåç«¯ï¼‰ ä»“åº“ç›¸å…³è¡¨ï¼šgulimall_wms_xxx æœåŠ¡ï¼šware æœåŠ¡åŸºç¡€æ­å»º application.ymlä¸­é…ç½®nacosã€application name æ³¨è§£å¼€å¯nacosï¼ˆ@EnableDiscoveryClientï¼‰ï¼ˆcom.alibaba.nacos.api.exception.NacosException: java.lang.reflect.InvocationTargetExceptionè¿™ä¸ªæŠ¥é”™æ˜¯å› ä¸ºæ²¡æœ‰é…ç½®bootstrapï¼‰ é…ç½®æ—¥å¿— 1234# ç”¨äºè¾“å‡ºæ—¥å¿—logging: level: com.atguigu: debug é…ç½®ç½‘å…³ é…ç½®mybatisåˆ†é¡µæ’ä»¶ è·å¾—ä»“åº“åˆ—è¡¨å¸¦æ¡ä»¶ ä¿®æ”¹ä¸€ä¸‹åŸæ¥çš„queryPageå³å¯ï¼Œæ·»åŠ ä¸Šcondition 12345678910111213141516171819/** * æ¨¡ç³ŠæŸ¥è¯¢ * @param params * @return */@Overridepublic PageUtils queryPageByCondition(Map&lt;String, Object&gt; params) &#123; QueryWrapper&lt;WareInfoEntity&gt; wrapper = new QueryWrapper&lt;&gt;(); String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; // andæ‹¼æ¥ï¼Œå› ä¸ºå¯èƒ½idä¸º0æ‰€ä»¥å·²ç»å«æœ‰äº†ä¸€ä¸ªeqæ¡ä»¶ wrapper.eq(&quot;id&quot;, key).or().like(&quot;name&quot;, key).or().like(&quot;address&quot;, key); &#125; IPage&lt;WareInfoEntity&gt; page = this.page( new Query&lt;WareInfoEntity&gt;().getPage(params), wrapper ); return new PageUtils(page);&#125; åº“å­˜ç³»ç»Ÿâ€”å•†å“åº“å­˜ï¼ˆåç«¯ï¼‰è·å¾—åº“å­˜åˆ—è¡¨å¸¦æ¡ä»¶ åŒæ · åº“å­˜ç³»ç»Ÿâ€”é‡‡è´­éœ€æ±‚ï¼ˆåç«¯ï¼‰è·å¾—éœ€æ±‚åˆ—è¡¨å¸¦æ¡ä»¶ åŒæ · è·å¾—æœªé¢†å–çš„é‡‡è´­å•åˆ—è¡¨ å°†å¤šä¸ªé‡‡è´­éœ€æ±‚åˆå¹¶åˆ°ä¸€ä¸ªé‡‡è´­å•å½“ä¸­ï¼ˆå¹¶ä¸”è¯¥é‡‡è´­å•æœªè¢«é¢†å–ï¼‰ PurchaseController123456789101112131415@RestController@RequestMapping(&quot;ware/purchase&quot;)public class PurchaseController &#123; @Autowired private PurchaseService purchaseService; /** * è·å–æ‰€æœ‰æœªè¢«é¢†å–ï¼ˆæˆ–æ–°å»ºï¼‰çš„é‡‡è´­å• */ @RequestMapping(&quot;/unreceive/list&quot;) //@RequiresPermissions(&quot;ware:purchase:list&quot;) public R unreceiveList(@RequestParam Map&lt;String, Object&gt; params) &#123; PageUtils page = purchaseService.queryPageUnreceive(params); return R.ok().put(&quot;page&quot;, page); &#125; PurchaseServiceImpl1234567891011121314151617@Service(&quot;purchaseService&quot;)public class PurchaseServiceImpl extends ServiceImpl&lt;PurchaseDao, PurchaseEntity&gt; implements PurchaseService &#123; /** * è·å–æ‰€æœ‰æœªè¢«é¢†å–ï¼ˆæˆ–æ–°å»ºï¼‰çš„é‡‡è´­å• */ @Override public PageUtils queryPageUnreceive(Map&lt;String, Object&gt; params) &#123; QueryWrapper&lt;PurchaseEntity&gt; queryWrapper = new QueryWrapper&lt;&gt;(); queryWrapper.eq(&quot;status&quot;, 0).or().eq(&quot;status&quot;, 1); IPage&lt;PurchaseEntity&gt; page = this.page( new Query&lt;PurchaseEntity&gt;().getPage(params), queryWrapper ); return new PageUtils(page); &#125; åˆå¹¶é‡‡è´­å• å¦‚æœå‰ç«¯æ²¡æœ‰ä¼ é€’é‡‡è´­å•çš„idé‚£ä¹ˆå°±æ–°å»ºä¸€ä¸ªé‡‡è´­å• WareConstant1234567891011121314151617181920212223242526272829303132333435public class WareConstant &#123; public enum PurchaseStatusEnum &#123; CREATED(0, &quot;æ–°å»º&quot;), ASSIGN(1, &quot;å·²åˆ†é…&quot;), RECEIVE(2, &quot;å·²é¢†å–&quot;), FINISHED(3, &quot;å·²å®Œæˆ&quot;), HASERROR(4, &quot;å¼‚å¸¸&quot;); private int code; private String msg; PurchaseStatusEnum(int code, String msg) &#123; this.code = code; this.msg = msg; &#125; public int getCode() &#123; return code; &#125; public String getMsg() &#123; return msg; &#125; &#125; public enum PurchaseDetailStatusEnum &#123; CREATED(0, &quot;æ–°å»º&quot;), ASSIGN(1, &quot;å·²åˆ†é…&quot;), BUYYING(2, &quot;æ­£åœ¨é‡‡è´­&quot;), FINISHED(3, &quot;å·²å®Œæˆ&quot;), HASERROR(4, &quot;å¼‚å¸¸&quot;); private int code; private String msg; PurchaseDetailStatusEnum(int code, String msg) &#123; this.code = code; this.msg = msg; &#125; public int getCode() &#123; return code; &#125; public String getMsg() &#123; return msg; &#125; &#125;&#125; MergeVo12345678/** * åˆå¹¶é‡‡è´­å•è¯·æ±‚å¯¹è±¡ */@Datapublic class MergeVo &#123; private Long purchaseId; private List&lt;Long&gt; items;&#125; PurchaseController1234567891011121314@RestController@RequestMapping(&quot;ware/purchase&quot;)public class PurchaseController &#123; @Autowired private PurchaseService purchaseService; /** * åˆå¹¶é‡‡è´­å• */ @PostMapping(&quot;/merge&quot;) public R merge(@RequestBody MergeVo mergeVo) &#123; //@RequestBodyè¯·æ±‚ä½“ä¸­çš„JSONï¼Œ@RequestParamæ˜¯url?åè·Ÿçš„é”®å€¼å¯¹ï¼Œ@PathVariableæ˜¯RESTé£æ ¼urlä¸­çš„&#123;&#125;å˜é‡ purchaseService.mergePurchase(mergeVo); return R.ok() &#125; PurchaseServiceImpl1234567891011121314151617181920212223242526/** * åˆå¹¶é‡‡è´­å• */@Transactional@Overridepublic void mergePurchase(MergeVo mergeVo) &#123; Long purchaseId = mergeVo.getPurchaseId(); if (purchaseId == null) &#123; // æ²¡æœ‰é‡‡è´­å•idï¼Œé‚£ä¹ˆéœ€è¦æ–°å»º PurchaseEntity purchaseEntity = new PurchaseEntity(); purchaseEntity.setStatus(WareConstant.PurchaseStatusEnum.CREATED.getCode()); this.save(purchaseEntity); purchaseId = purchaseEntity.getId(); &#125; List&lt;Long&gt; items = mergeVo.getItems(); Long finalPurchaseId = purchaseId; // å°†é‡‡è´­éœ€æ±‚idé›†åˆå¯¹åº”å¯¹è±¡ä¿®æ”¹çŠ¶æ€å’Œé‡‡è´­å•id List&lt;PurchaseDetailEntity&gt; detailEntities = items.stream().map(detailId -&gt; &#123; PurchaseDetailEntity detailEntity = new PurchaseDetailEntity(); detailEntity.setId(detailId); detailEntity.setPurchaseId(finalPurchaseId); detailEntity.setStatus(WareConstant.PurchaseDetailStatusEnum.ASSIGN.getCode()); return detailEntity; &#125;).collect(Collectors.toList()); detailService.updateBatchById(detailEntities);&#125; é¢†å–é‡‡è´­å•PurchaseController1234567891011121314@RestController@RequestMapping(&quot;ware/purchase&quot;)public class PurchaseController &#123; @Autowired private PurchaseService purchaseService; /** * é¢†å–é‡‡è´­å• */ @PostMapping(&quot;/received&quot;) public R received(@RequestBody List&lt;Long&gt; ids) &#123; purchaseService.receivedByIds(ids); return R.ok(); &#125; PurchaseServiceImpl1234567891011121314151617181920212223242526272829/** * é¢†å–é‡‡è´­å• */ @Override public void receivedByIds(List&lt;Long&gt; ids) &#123; // åˆ¤æ–­æ˜¯å¦ä¸ºæ–°å»ºæˆ–è€…å·²åˆ†é…ï¼ˆç»™å½“å‰ç”¨æˆ·ï¼Œä½†æ˜¯è¿™é‡Œæ¶‰åŠæƒé™ï¼‰ // æ”¹å˜é‡‡è´­å•çŠ¶æ€ List&lt;PurchaseEntity&gt; purchaseEntityList = ids.stream().map(id -&gt; &#123; return this.getById(id); &#125;).filter(item -&gt; &#123; Integer status = item.getStatus(); return (status == WareConstant.PurchaseStatusEnum.ASSIGN.getCode()) || status == WareConstant.PurchaseStatusEnum.CREATED.getCode(); &#125;).map(purchaseEntity -&gt; &#123; purchaseEntity.setStatus(WareConstant.PurchaseStatusEnum.RECEIVE.getCode()); return purchaseEntity; &#125;).collect(Collectors.toList()); this.updateBatchById(purchaseEntityList); // æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€ purchaseEntityList.forEach(purchaseEntity -&gt; &#123; List&lt;PurchaseDetailEntity&gt; detailEntityList = detailService.list(new QueryWrapper&lt;PurchaseDetailEntity&gt;().eq(&quot;purchase_id&quot;, purchaseEntity.getId())); List&lt;PurchaseDetailEntity&gt; list = detailEntityList.stream().map(detail -&gt; &#123; PurchaseDetailEntity detailEntity = new PurchaseDetailEntity(); detailEntity.setId(detail.getId()); detailEntity.setStatus(WareConstant.PurchaseDetailStatusEnum.ASSIGN.getCode()); return detailEntity; &#125;).collect(Collectors.toList()); detailService.updateBatchById(list); &#125;); &#125; å®Œæˆé‡‡è´­ è‡ªåŠ¨ä¿®æ”¹å¯¹åº”é‡‡è´­å†…å®¹çš„åº“å­˜æ•° PurchaseDoneItemVo123456789/** * å®Œæˆé‡‡è´­å•çš„è¯·æ±‚item */@Datapublic class PurchaseDoneItemVo &#123; private Long itemId; private Integer status; private String reason;&#125; PurchaseFinishedVo123456789101112@Datapublic class PurchaseFinishedVo &#123; /* *é‡‡è´­å•id */ @NotNull private Long id; /* *é‡‡è´­é¡¹ */ private List&lt;PurchaseDoneItemVo&gt; items;&#125; PurchaseController1234567891011121314@RestController@RequestMapping(&quot;ware/purchase&quot;)public class PurchaseController &#123; @Autowired private PurchaseService purchaseService; /** * å®Œæˆé‡‡è´­å• */ @PostMapping(&quot;/done&quot;) public R finish(@RequestBody PurchaseFinishedVo finishedVo) &#123; purchaseService.finishPurchase(finishedVo); return R.ok(); &#125; PurchaseServiceImpl12345678910111213141516171819202122232425262728293031323334353637/** * å®Œæˆé‡‡è´­å• */@Overridepublic void finishPurchase(PurchaseFinishedVo finishedVo) &#123; // 1 æ”¹å˜é‡‡è´­é¡¹çŠ¶æ€ boolean purchaseFinished = true; List&lt;PurchaseDetailEntity&gt; updatedDetailList = new ArrayList&lt;&gt;(); List&lt;PurchaseDoneItemVo&gt; doneItemVoList = finishedVo.getItems(); for (PurchaseDoneItemVo doneItemVo : doneItemVoList) &#123; PurchaseDetailEntity detailEntity = new PurchaseDetailEntity(); if (doneItemVo.getStatus() == WareConstant.PurchaseDetailStatusEnum.HASERROR.getCode()) &#123; // å¦‚æœæœ‰ä¸€ä¸ªé‡‡è´­é¡¹å¼‚å¸¸ï¼Œåˆ™é‡‡è´­å•çŠ¶æ€æœªå®Œæˆ purchaseFinished = false; &#125; else &#123; // 3 å°†æˆåŠŸé‡‡è´­çš„é‡‡è´­é¡¹ä¿®æ”¹åº“å­˜ä¿¡æ¯ PurchaseDetailEntity detail = detailService.getById(doneItemVo.getItemId()); wareSkuService.addStock(detail.getSkuId(), detail.getWareId(), detail.getSkuNum()); &#125; // TODO åˆ¤æ–­é‡‡è´­æ•°æ˜¯å¦å®Œæˆ detailEntity.setStatus(doneItemVo.getStatus()); detailEntity.setId(doneItemVo.getItemId()); updatedDetailList.add(detailEntity); &#125; detailService.updateBatchById(updatedDetailList); // 2 æ”¹å˜é‡‡è´­å•çŠ¶æ€(æ‰€æœ‰é‡‡è´­é¡¹éƒ½å®Œæˆåæ‰å¯å®Œæˆï¼Œå¦åˆ™ä¸ºå¼‚å¸¸) PurchaseEntity purchaseEntity = new PurchaseEntity(); purchaseEntity.setId(finishedVo.getId()); if (purchaseFinished) &#123; purchaseEntity.setStatus(WareConstant.PurchaseStatusEnum.FINISHED.getCode()); &#125; else &#123; purchaseEntity.setStatus(WareConstant.PurchaseStatusEnum.HASERROR.getCode()); &#125; this.updateById(purchaseEntity);&#125; WareSkuServiceImpl12345678910111213141516/* *å°†æˆåŠŸé‡‡è´­çš„é‡‡è´­é¡¹ä¿®æ”¹åº“å­˜ä¿¡æ¯ */@Overridepublic void addStock(Long skuId, Long wareId, Integer skuNum) &#123; // åˆ¤æ–­æ˜¯å¦æœ‰è¯¥åº“å­˜ï¼Œæ²¡æœ‰åˆ™æ–°å¢ Integer count = baseMapper.selectCount(new QueryWrapper&lt;WareSkuEntity&gt;().eq(&quot;sku_id&quot;, skuId).eq(&quot;ware_id&quot;, wareId)); if (count == 0) &#123; WareSkuEntity wareSkuEntity = new WareSkuEntity(); wareSkuEntity.setSkuId(skuId); wareSkuEntity.setWareId(wareId); wareSkuEntity.setStock(skuNum); baseMapper.insert(wareSkuEntity); &#125; else baseMapper.addStock(skuId, wareId, skuNum);&#125; WareSkuDao1234567&lt;!-- å°†æˆåŠŸé‡‡è´­çš„é‡‡è´­é¡¹ä¿®æ”¹åº“å­˜ä¿¡æ¯ --&gt;&lt;update id=&quot;addStock&quot;&gt; UPDATE gulimall_wms.wms_ware_sku SET stock = stock + #&#123;skuNum&#125; WHERE sku_id = #&#123;skuId&#125; AND ware_id = #&#123;wareId&#125;&lt;/update&gt; å•†å“ç»´æŠ¤â€”SKUè§„æ ¼ç»´æŠ¤ï¼ˆåç«¯ï¼‰ è¿™æ˜¯ä¸€ä¸ªæŒ‰é’®è§¦å‘çš„é¡µé¢ï¼Œå…·ä½“è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ è°·ç²’å•†åŸè¸©å‘æ±‡æ€»ï¼ˆåˆ†å¸ƒå¼åŸºç¡€ï¼ˆå…¨æ ˆå¼€å‘ç¯‡ï¼‰ï¼‰ - å¤§å¨æ— ç›ç…® - åšå®¢å›­ (cnblogs.com) è·å–1234567891011121314151617@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; @Autowired private AttrService attrService; @Autowired private ProductAttrValueService valueService; /** * æŸ¥å‡ºå•†å“çš„è§„æ ¼å±æ€§ */ @GetMapping(&quot;/base/listforspu/&#123;spuId&#125;&quot;) public R baseAttrListForSpu(@PathVariable(&quot;spuId&quot;) Long spuId) &#123; List&lt;ProductAttrValueEntity&gt; data = valueService.baseAttrListForSpu(spuId); return R.ok().put(&quot;data&quot;, data); &#125; 123456@Service(&quot;productAttrValueService&quot;)public class ProductAttrValueServiceImpl extends ServiceImpl&lt;ProductAttrValueDao, ProductAttrValueEntity&gt; implements ProductAttrValueService &#123; @Override public List&lt;ProductAttrValueEntity&gt; baseAttrListForSpu(Long spuId) &#123; return baseMapper.selectList(new QueryWrapper&lt;ProductAttrValueEntity&gt;().eq(&quot;spu_id&quot;, spuId)); &#125; ä¿®æ”¹123456789101112@RestController@RequestMapping(&quot;product/attr&quot;)public class AttrController &#123; /** * ä¿®æ”¹,ä½¿ç”¨AttrRequestVo */ @PostMapping(&quot;/update/&#123;spuId&#125;&quot;) public R updateSpuAttr(@PathVariable(&quot;spuId&quot;) String spuId, @RequestBody List&lt;ProductAttrValueEntity&gt; entities) &#123; valueService.updateSpuAttr(spuId, entities); return R.ok(); &#125; 12345678910111213/** * ä¿®æ”¹SPUçš„ATTr */@Transactional@Overridepublic void updateSpuAttr(Long spuId, List&lt;ProductAttrValueEntity&gt; entities) &#123; baseMapper.delete(new QueryWrapper&lt;ProductAttrValueEntity&gt;().eq(&quot;spu_id&quot;, spuId)); List&lt;ProductAttrValueEntity&gt; collect = entities.stream().map(item -&gt; &#123; item.setSpuId(spuId); return item; &#125;).collect(Collectors.toList()); this.saveBatch(collect);&#125; åˆ†å¸ƒå¼åŸºç¡€ç¯‡â€”å®Œç»“æ’’èŠ±ğŸ‰","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜2","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜2","date":"2021-10-16T09:37:06.885Z","updated":"2021-10-30T07:35:19.902Z","comments":true,"path":"2021/10/16/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-2/","link":"","permalink":"http://example.com/2021/10/16/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-2/","excerpt":"","text":"å“ç‰Œç®¡ç†ï¼ˆåå°ï¼‰ å•†å“ç³»ç»Ÿä¸‹çš„å“ç‰Œç®¡ç†ï¼Œæ•°æ®åº“è¡¨å¯¹åº”product-brand ä½¿ç”¨é€†å‘å·¥ç¨‹ å…ˆä½¿ç”¨äººäººå¿«é€Ÿå¼€å‘å¹³å°ï¼Œç³»ç»Ÿç®¡ç†â€”&gt;èœå•ç®¡ç†â€”&gt;æ·»åŠ èœå• ä½¿ç”¨renren-generatoré€†å‘ç”Ÿæˆå·¥ç¨‹ï¼ˆä¹‹å‰å·²ç»åšè¿‡äº†ï¼‰ å¤åˆ¶ç²˜è´´å…¶ä¸­resourceä¸‹çš„modulesæ–‡ä»¶å¤¹ä¸‹çš„è§†å›¾æ¨¡æ¿ï¼ˆæˆ‘qiaoè¿™ä¹ˆæ£’çš„å—ï¼‰ è§†å›¾æ¨¡æ¿è¿™é‡Œå¯ä»¥å…ˆæŠŠæƒé™ç®¡ç†åˆ é™¤ï¼ˆv-if=â€isAuthâ€ï¼‰ï¼Œæˆ–è€…å»index.jsä¸­çš„isAuthæ–¹æ³•è¿”å›TRUE å¢åˆ æ”¹æŸ¥éƒ½å†™å¥½äº†ï¼ˆè¿˜å¯ä»¥è¿™æ ·æˆ‘qiaoï¼‰ å…³é—­è¯­æ³•æ£€æŸ¥ build -&gt; webpack.base.conf.js -&gt; createLintingRuleæ–¹æ³•ä¸­æ³¨é‡Šå³å¯ ï¼Ÿæˆ‘å‘ç°æˆ‘æ³¨é‡Šæ‰ä¹‹åä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨æˆ‘ä¹‹å‰é‚£ä¸ªæ–¹æ³• ä¼˜åŒ–åˆ—æ˜¾ç¤ºå¼€å…³æŒ‰é’®element-uiç»„ä»¶ æŒ‰é’®äº‹ä»¶ ç»‘å®šchangeäº‹ä»¶ æ³¨æ„showStatusåœ¨æ•°æ®åº“ä¸­æ˜¯intç±»å‹ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­è½¬æ¢ä¸€ä¸‹ï¼ˆä½†æ˜¯ç›´æ¥æŠŠSwitchçš„active-valueæ¢æˆ10å°±ä¸ç”¨å†è½¬æ¢äº†ï¼‰ 123456789101112131415161718&lt;el-table-column prop=&quot;showStatus&quot; header-align=&quot;center&quot; align=&quot;center&quot; label=&quot;æ˜¾ç¤ºçŠ¶æ€&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;el-switch v-model=&quot;scope.row.showStatus&quot; active-color=&quot;#13ce66&quot; inactive-color=&quot;#ff4949&quot; :active-value=&quot;1&quot; :inactive-value=&quot;0&quot; @change=&quot;updateBrandStatus(scope.row)&quot; &gt; &lt;/el-switch&gt; &lt;/template&gt; &lt;/el-table-column&gt; 12345678910111213141516171819 methods: &#123; // æ”¹å˜çŠ¶æ€ updateBrandStatus(data) &#123; console.log(&quot;å½“å‰scope.rowï¼š&quot;, data); // è§£æ„ let &#123; brandId, showStatus &#125; = data; // å‘é€è¯·æ±‚ä¿®æ”¹çŠ¶æ€ this.$http(&#123; url: this.$http.adornUrl(&quot;/product/brand/update&quot;), method: &quot;post&quot;, data: this.$http.adornData(&#123; brandId, showStatus &#125;, false) &#125;).then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; type: &quot;success&quot;, message: &quot;çŠ¶æ€æ›´æ–°æˆåŠŸ&quot; &#125;); &#125;); &#125;,&#125; äº‘å­˜å‚¨æœåŠ¡ï¼ˆæ–‡ä»¶ä¸Šä¼ å‰åç«¯ï¼‰ è€æ ·å­é˜¿é‡Œäº‘OSSï¼Œè¿™é‡Œä½¿ç”¨äº†å­ç”¨æˆ·AK æ–‡æ¡£ï¼šå®‰è£… (aliyun.com) AliyunOSSä¾èµ–12345&lt;dependency&gt; &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt; &lt;version&gt;3.10.2&lt;/version&gt;&lt;/dependency&gt; ä¸Šä¼ æ–‡ä»¶ ä¸‹é¢æ˜¯å®˜ç½‘æ–‡æ¡£çš„demo 12345678910111213141516// yourEndpointå¡«å†™Bucketæ‰€åœ¨åœ°åŸŸå¯¹åº”çš„Endpointã€‚ä»¥åä¸œ1ï¼ˆæ­å·ï¼‰ä¸ºä¾‹ï¼ŒEndpointå¡«å†™ä¸ºhttps://oss-cn-hangzhou.aliyuncs.comã€‚String endpoint = &quot;yourEndpoint&quot;;// é˜¿é‡Œäº‘è´¦å·AccessKeyæ‹¥æœ‰æ‰€æœ‰APIçš„è®¿é—®æƒé™ï¼Œé£é™©å¾ˆé«˜ã€‚å¼ºçƒˆå»ºè®®æ‚¨åˆ›å»ºå¹¶ä½¿ç”¨RAMç”¨æˆ·è¿›è¡ŒAPIè®¿é—®æˆ–æ—¥å¸¸è¿ç»´ï¼Œè¯·ç™»å½•RAMæ§åˆ¶å°åˆ›å»ºRAMç”¨æˆ·ã€‚String accessKeyId = &quot;yourAccessKeyId&quot;;String accessKeySecret = &quot;yourAccessKeySecret&quot;;// åˆ›å»ºOSSClientå®ä¾‹ã€‚OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);// å¡«å†™æœ¬åœ°æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚å¦‚æœæœªæŒ‡å®šæœ¬åœ°è·¯å¾„ï¼Œåˆ™é»˜è®¤ä»ç¤ºä¾‹ç¨‹åºæ‰€å±é¡¹ç›®å¯¹åº”æœ¬åœ°è·¯å¾„ä¸­ä¸Šä¼ æ–‡ä»¶æµã€‚InputStream inputStream = new FileInputStream(&quot;D:\\\\localpath\\\\examplefile.txt&quot;);// ä¾æ¬¡å¡«å†™Bucketåç§°ï¼ˆä¾‹å¦‚examplebucketï¼‰å’ŒObjectå®Œæ•´è·¯å¾„ï¼ˆä¾‹å¦‚exampledir/exampleobject.txtï¼‰ã€‚Objectå®Œæ•´è·¯å¾„ä¸­ä¸èƒ½åŒ…å«Bucketåç§°ã€‚ossClient.putObject(&quot;examplebucket&quot;, &quot;exampledir/exampleobject.txt&quot;, inputStream);// å…³é—­OSSClientã€‚ossClient.shutdown(); å­ç”¨æˆ· AKè¿›å…¥ååˆ›å»ºå­ç”¨æˆ·ï¼Œç„¶ååˆ†é…æƒé™ï¼ˆç°åœ¨ç”¨åˆ°çš„æƒé™å°±AliyunOSSFullAccessï¼Œç”¨äºè¯»å†™ï¼‰ SpringCloudAlibabaOSS ç›´æ¥ç”¨ æ–‡æ¡£ï¼šspring-cloud-alibaba-component/README.md at master Â· ylh23y/spring-cloud-alibaba-component (github.com) ä¾èµ–12345&lt;!-- springclcloud alibaba oss --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alicloud-oss&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®application.yml12345678spring: cloud: # ossé…ç½® alicloud: access-key: secret-key: oss: endpoint: æœåŠ¡ç«¯ç­¾ååä¸Šä¼ ï¼ˆåç«¯ï¼‰ æ–‡æ¡£ï¼šæœåŠ¡ç«¯ç­¾ååç›´ä¼  (aliyun.com) åˆ›å»ºç¬¬ä¸‰æ–¹æœåŠ¡æ¨¡å— åˆ›å»ºä¸“é—¨çš„æ¨¡å—third-party å°†ä¸Šè¿°çš„ä¾èµ–æ”¹åˆ°è¿™ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡çš„æ¨¡å—ä¸­ ä¾èµ–123456789101112131415161718&lt;dependency&gt; &lt;groupId&gt;com.atguigu.gulimall&lt;/groupId&gt; &lt;artifactId&gt;gulimall-common&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;exclusions&gt; &lt;!-- ä¸ä½¿ç”¨æ•°æ®åº“ï¼Œè¦ä¸ç„¶è¿˜è¦é…ç½® --&gt; &lt;exclusion&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt;&lt;!-- springclcloud alibaba oss --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alicloud-oss&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®nacos bootstrap.propertiesä¸­é…ç½® 123456#nacosæ³¨å†Œå’Œé…ç½®spring.cloud.nacos.config.server-addr=127.0.0.1:8848spring.cloud.nacos.config.namespace=925cc47f-8b1d-4756-ba4d-c8da28f784c9spring.cloud.nacos.config.ext-config[0].data-id=oss.ymlspring.cloud.nacos.config.ext-config[0].group=DEFAULT_GROUPspring.cloud.nacos.config.ext-config[0].refresh=true é…ç½®alicloud åœ¨application.ymlä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨nacosé…ç½®ä¸­å¿ƒé… 12345678910111213141516171819spring: cloud: # nacos nacos: discovery: server-addr: 127.0.0.1:8848 # ossé…ç½® alicloud: access-key: secret-key: oss: endpoint: bucket: application: name: gulimall-third-partyserver: port: 30000 å•å…ƒæµ‹è¯•123456789101112131415@RunWith(SpringRunner.class)@SpringBootTestpublic class GulimallThirdPartyApplicationTests &#123; @Autowired OSSClient ossClient; @Test public void aliyunOssTest() throws FileNotFoundException &#123; InputStream inputStream = new FileInputStream(&quot;C:\\\\Users\\\\å¢èŸ\\\\Desktop\\\\è°·ç²’ç”µå•†\\\\1\\\\docs\\\\pics\\\\6a1b2703a9ed8737.jpg&quot;); // ä¾æ¬¡å¡«å†™Bucketåç§°ï¼ˆä¾‹å¦‚examplebucketï¼‰å’ŒObjectå®Œæ•´è·¯å¾„ï¼ˆä¾‹å¦‚exampledir/exampleobject.txtï¼‰ã€‚Objectå®Œæ•´è·¯å¾„ä¸­ä¸èƒ½åŒ…å«Bucketåç§°ã€‚ ossClient.putObject(&quot;lh-demo-gulimall&quot;, &quot;test2.jpg&quot;, inputStream); // å…³é—­OSSClientã€‚ ossClient.shutdown(); System.out.println(&quot;ä¸Šä¼ å®Œæˆ&quot;); &#125;&#125; ç¼–å†™OSSController è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹è¦æ³¨æ„ï¼Œè‡ªåŠ¨æ³¨å…¥OSSæ¥å£ï¼Œè€Œä¸æ˜¯OSSClientå®ç°ç±» è§P63ï¼Œdebugå‡ ç§’é’Ÿç»äº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950@RestControllerpublic class OssController &#123; // è¿™é‡Œdebugå¥½å¿«å•Šï¼Œä¸æ„§æ˜¯è€å¸ˆï¼Œ // OSSæ¥å£ï¼ŒOSSClientæ˜¯å®ç°ç±»å·²ç»å†™å¥½çš„ï¼Œè¦è‡ªåŠ¨æ³¨å…¥æ¥å£ @Autowired OSS ossClient; @Value(&quot;$&#123;spring.cloud.alicloud.oss.endpoint&#125;&quot;) private String endpoint; @Value(&quot;$&#123;spring.cloud.alicloud.oss.bucket&#125;&quot;) private String bucket; @Value(&quot;$&#123;spring.cloud.alicloud.access-key&#125;&quot;) private String accessId; @RequestMapping(&quot;/oss/policy&quot;) public R policy() &#123; String host = &quot;https://&quot; + bucket + &quot;.&quot; + endpoint; // hostçš„æ ¼å¼ä¸º bucketname.endpoint // callbackUrlä¸ºä¸Šä¼ å›è°ƒæœåŠ¡å™¨çš„URLï¼Œè¯·å°†ä¸‹é¢çš„IPå’ŒPorté…ç½®ä¸ºæ‚¨è‡ªå·±çš„çœŸå®ä¿¡æ¯ã€‚ // String callbackUrl = &quot;http://88.88.88.88:8888&quot;; // ä»¥å½“å‰æ—¥æœŸåˆ†ç±» String format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(new Date()); String dir = format + &quot;/&quot;; // ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶æ—¶æŒ‡å®šçš„å‰ç¼€ã€‚ Map&lt;String, String&gt; respMap = null; try &#123; long expireTime = 30; long expireEndTime = System.currentTimeMillis() + expireTime * 1000; Date expiration = new Date(expireEndTime); // PostObjectè¯·æ±‚æœ€å¤§å¯æ”¯æŒçš„æ–‡ä»¶å¤§å°ä¸º5 GBï¼Œå³CONTENT_LENGTH_RANGEä¸º5*1024*1024*1024ã€‚ PolicyConditions policyConds = new PolicyConditions(); policyConds.addConditionItem(PolicyConditions.COND_CONTENT_LENGTH_RANGE, 0, 1048576000); policyConds.addConditionItem(MatchMode.StartWith, PolicyConditions.COND_KEY, dir); String postPolicy = ossClient.generatePostPolicy(expiration, policyConds); byte[] binaryData = postPolicy.getBytes(&quot;utf-8&quot;); String encodedPolicy = BinaryUtil.toBase64String(binaryData); String postSignature = ossClient.calculatePostSignature(postPolicy); respMap = new LinkedHashMap&lt;String, String&gt;(); respMap.put(&quot;accessid&quot;, accessId); respMap.put(&quot;policy&quot;, encodedPolicy); respMap.put(&quot;signature&quot;, postSignature); respMap.put(&quot;dir&quot;, dir); respMap.put(&quot;host&quot;, host); respMap.put(&quot;expire&quot;, String.valueOf(expireEndTime / 1000)); // respMap.put(&quot;expire&quot;, formatISO8601Date(expiration)); &#125; catch (Exception e) &#123; // Assert.fail(e.getMessage()); System.out.println(e.getMessage()); &#125; finally &#123; ossClient.shutdown(); &#125; return R.ok().put(&quot;data&quot;, respMap); &#125;&#125; ç„¶åå°±å¯ä»¥é€šè¿‡è®¿é—®localhost:30000/oss/policyè·å–ç­¾åç­‰æ•°æ® é…ç½®ç½‘å…³application.yml123456789101112spring: cloud: gateway: routes: - id: third_party_route uri: lb://gulimall-third-party predicates: - Path=/api/thirdparty/** # å®ç°è½¬å‘ filters: # localhost:88/api/thirdparty/oss/policy -&gt; localhost:30000/oss/policy - RewritePath=/api/thirdparty/(?&lt;segment&gt;.*),/$\\&#123;segment&#125; æ–‡ä»¶ä¸Šä¼ ï¼ˆå‰ç«¯ï¼‰ èµ„æ–™é‡Œæœ‰å°è£…å¥½çš„æ¨¡æ¿ï¼Œæ”¾å…¥componentï¼Œå°†å…¶ä¸­el-uploadä¸­actionå±æ€§å€¼æ”¹ä¸ºoss bucketçš„åŸŸå vue ä½¿ç”¨ä¸Šè¿°ç»„ä»¶ æ³¨æ„è¿™é‡Œcomponenté‡Œé¢çš„åå­—è¦å’Œimportå¯¹åº”ï¼Œè¦ä¸ç„¶ä¸æŠ¥é”™è¿˜æ˜¾ç¤ºä¸å‡ºæ¥é—®é¢˜ï¼ˆå·®ç‚¹å“æ­»æˆ‘ï¼‰ 1234567&lt;el-form-item label=&quot;å“ç‰Œlogoåœ°å€&quot; prop=&quot;logo&quot;&gt; &lt;singleUpload v-model=&quot;dataForm.logo&quot;&gt; &lt;/singleUpload&gt;&lt;/el-form-item&gt;&lt;script&gt;import singleUpload from &quot;@/components/upload/singleUpload&quot;;export default &#123; components: &#123; singleUpload &#125;, å¼€å¯è·¨åŸŸ OSSæ§åˆ¶å°é‡Œè¿›å…¥bucketï¼Œåˆ›å»ºè§„åˆ™ æµ‹è¯• OKï¼Œä¸»è¦å®ç°å¯ä»¥å»çœ‹ç»„ä»¶é‡Œçš„å®ç° è¡¨å•æ•°æ®æ ¡éªŒï¼ˆå‰ç«¯ï¼‰ä¼˜åŒ–åˆ—è¡¨æ˜¾ç¤º logoæ˜¾ç¤ºå›¾ç‰‡ è¡¨å•æ ¡éªŒ ä½¿ç”¨element-uiçš„è¡¨å•éªŒè¯ï¼Œè‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ 12345678910&lt;el-form-item label=&quot;æ£€ç´¢é¦–å­—æ¯&quot; prop=&quot;firstLetter&quot;&gt; &lt;el-input v-model=&quot;dataForm.firstLetter&quot; placeholder=&quot;æ£€ç´¢é¦–å­—æ¯&quot; &gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ’åº&quot; prop=&quot;sort&quot;&gt; &lt;!-- v-model.numberåªå…è®¸è¾“å…¥æ•°å­—ç±»å‹ --&gt; &lt;el-input v-model.number=&quot;dataForm.sort&quot; placeholder=&quot;æ’åº&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; 1234567891011121314151617181920212223242526272829303132333435363738data() &#123; return &#123; dataRule: &#123; firstLetter: [ &#123; // è‡ªå®šä¹‰éªŒè¯è§„åˆ™ï¼Œä½¿ç”¨validatorï¼Œåè·Ÿç®­å¤´å‡½æ•°å®šä¹‰è§„åˆ™ï¼Œä¹Ÿå¯ä»¥å†™åˆ°dataä¸­ validator: (rule, value, callback) =&gt; &#123; if (value === &quot;&quot;) &#123; callback(new Error(&quot;é¦–å­—æ¯å¿…é¡»å¡«å†™&quot;)); &#125; else if (!/^[a-zA-Z]$/.test(value)) &#123; // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­æ˜¯å¦ä¸ºa-z A-Z callback(new Error(&quot;é¦–å­—æ¯å¿…é¡»a-zæˆ–è€…A-Zä¹‹é—´çš„å•ä¸ªå­—æ¯&quot;)); &#125; else &#123; callback(); &#125; &#125;, trigger: &quot;blur&quot; &#125; ], sort: [ &#123; validator: (rule, value, callback) =&gt; &#123; if (value === &quot;&quot;) &#123; callback(new Error(&quot;æ’åºå­—æ®µå¿…é¡»å¡«å†™&quot;)); &#125; else if (!Number.isInteger(value)) &#123; callback(new Error(&quot;è¯·è¾“å…¥æ•°å­—å€¼&quot;)); &#125; else if (value &lt; 0) &#123; callback(new Error(&quot;æ’åºå­—æ®µå¿…é¡»å¤§äº0&quot;)); &#125; else &#123; callback(); &#125; &#125;, trigger: &quot;blur&quot; &#125; ] &#125; &#125;; &#125;, è¡¨å•æ•°æ®æ ¡éªŒï¼ˆåç«¯ï¼‰æ™®é€šæ ¡éªŒBeanæ ¡éªŒæ³¨è§£ æ ¡éªŒè§„åˆ™ @xxx javax.validation.constraintsä¸‹çš„æ³¨è§£ï¼Œç”¨äºå®šä¹‰æ ¡éªŒè§„åˆ™ 1234567891011121314151617181920212223242526272829303132333435363738394041424344@Data@TableName(&quot;pms_brand&quot;)public class BrandEntity implements Serializable &#123; private static final long serialVersionUID = 1L; /** * å“ç‰Œid */ @TableId private Long brandId; /** * å“ç‰Œå */ @NotEmpty // éªŒè¯è§„åˆ™ï¼ŒStringç±»å‹éç©º @NotBlank(message = &quot;å“ç‰Œåä¸èƒ½ä¸ºç©º&quot;) // éªŒè¯è§„åˆ™ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªéç©ºå­—ç¬¦ï¼Œmsgä¸ºå‡ºé”™æ—¶çš„æç¤ºä¿¡æ¯ private String name; /** * å“ç‰Œlogoåœ°å€ */ @NotEmpty @URL(message = &quot;LOGOå¿…é¡»æ˜¯åˆæ³•çš„URLåœ°å€&quot;) // éªŒè¯è§„åˆ™ï¼Œå¿…é¡»æ˜¯url private String logo; /** * ä»‹ç» */ @NotEmpty private String descript; /** * æ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º] */ @NotNull // éªŒè¯è§„åˆ™ï¼ŒIntegerç±»å‹éç©º private Integer showStatus; /** * æ£€ç´¢é¦–å­—æ¯ */ @NotEmpty @Pattern(regexp = &quot;/^[a-zA-Z]$/&quot;, message = &quot;æ£€ç´¢å­—æ¯å¿…é¡»æ˜¯a-zæˆ–è€…A-Zä¸­çš„å•ä¸ªå­—æ¯&quot;) // ä½¿ç”¨è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ï¼Œå¯ä»¥å†™æ­£åˆ™è¡¨è¾¾å¼ private String firstLetter; /** * æ’åº */ @NotEmpty @Min(value = 0) // éªŒè¯è§„åˆ™ï¼Œæœ€å°ä¸èƒ½å°äºvalue private Integer sort;&#125; Controlleræ ¡éªŒæ³¨è§£ å¼€å¯æ ¡éªŒ @Valid å¼€å¯æ ¡éªŒ 123456789101112131415@RestController@RequestMapping(&quot;product/brand&quot;)public class BrandController &#123; @Autowired private BrandService brandService; /** * ä¿å­˜ */ @RequestMapping(&quot;/save&quot;) //@RequiresPermissions(&quot;product:brand:save&quot;) public R save(@Valid @RequestBody BrandEntity brand) &#123; brandService.save(brand); return R.ok(); &#125;&#125; è·å–æ ¡éªŒç»“æœ BindingResult resultå°è£…äº†ç´§è·Ÿç€çš„å¯¹è±¡çš„æ ¡éªŒç»“æœ 123456789101112131415161718192021/** * ä¿å­˜ */@RequestMapping(&quot;/save&quot;)//BindingResult resultå°è£…äº†ç´§è·Ÿç€çš„å¯¹è±¡çš„æ ¡éªŒç»“æœpublic R save(@Valid @RequestBody BrandEntity brand, BindingResult result) &#123; // åˆ¤æ–­æ ¡éªŒæ˜¯å¦å‡ºé”™ if (result.hasErrors()) &#123; Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); // è·å–æ ¡éªŒç»“æœå¹¶ä¸”å°è£…åˆ°map result.getFieldErrors().forEach((fieldError) -&gt; &#123; String message = fieldError.getDefaultMessage(); String fieldName = fieldError.getField(); map.put(fieldName, message); &#125;); return R.error(400, &quot;é€’äº¤çš„æ•°æ®ä¸åˆæ³•&quot;).put(&quot;data&quot;, map); &#125; else &#123; brandService.save(brand); return R.ok(); &#125;&#125; è¿™ä¸ªå†™æ³•å¯ä»¥ä½¿ç”¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»è§£å†³ JSR303åˆ†ç»„æ ¡éªŒ è®¾æƒ³brandIdï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼šä¸€æ˜¯æ–°å¢ï¼ŒäºŒæ˜¯ä¿®æ”¹ã€‚å½“æ–°å¢çš„æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦ä¼ å…¥idï¼Œè€Œä¿®æ”¹çš„æ—¶å€™éœ€è¦ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°åˆ†ç»„æ ¡éªŒã€‚ ç¼–å†™æ¥å£ ä½¿ç”¨validä¸­çš„æ³¨è§£ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå±æ€§groupç”¨äºåˆ†ç»„ï¼Œåè·Ÿæ¥å£ç±»å‹ï¼ˆåªæ˜¯ç”¨äºæ ‡è¯†åŒºåˆ«ï¼Œæ¥å£ä¸­ä¸æ¯”å†™ä»£ç ï¼‰ Beanæ ¡éªŒæ³¨é‡Š å¸¦åˆ†ç»„12345678910111213/** * å“ç‰Œid */@NotNull(message = &quot;ä¿®æ”¹å¿…é¡»æŒ‡å®šid&quot;, groups = &#123;UpdateGroup.class&#125;)@Null(message = &quot;æ–°å¢ä¸èƒ½æŒ‡å®šid&quot;, groups = &#123;AddGroup.class&#125;)@TableIdprivate Long brandId; /** * å“ç‰Œå */@NotEmpty // éªŒè¯è§„åˆ™ï¼ŒStringç±»å‹éç©º@NotBlank(message = &quot;å“ç‰Œåä¸èƒ½ä¸ºç©º&quot;,, groups = &#123;AddGroup.class, UpdateGroup.class&#125;) // éªŒè¯è§„åˆ™ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªéç©ºå­—ç¬¦ï¼Œmsgä¸ºå‡ºé”™æ—¶çš„æç¤ºä¿¡æ¯private String name; æ²¡æœ‰æŒ‡å®šgroupçš„é»˜è®¤ä¸æ ¡éªŒï¼ˆå¦‚æœæ˜¯ä½¿ç”¨äº†@Validated({XXX.class})åˆ†ç»„æ ¡éªŒçš„æƒ…å†µä¸‹ï¼‰ Controlleræ ¡éªŒæ³¨é‡Š å¸¦åˆ†ç»„12345678910/** * ä¿å­˜ */@RequestMapping(&quot;/save&quot;)//BindingResult resultå°è£…äº†ç´§è·Ÿç€çš„å¯¹è±¡çš„æ ¡éªŒç»“æœpublic R save(@Validated(&#123;AddGroup.class&#125;) @RequestBody BrandEntity brand) &#123; // ä½¿ç”¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå½“æœ‰å¼‚å¸¸çš„æ—¶å€™ç›´æ¥æŠ›å‡ºå¼‚å¸¸å³å¯ brandService.save(brand); return R.ok();&#125; è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£ä¾èµ–123456&lt;!-- validation --&gt;&lt;dependency&gt; &lt;groupId&gt;javax.validation&lt;/groupId&gt; &lt;artifactId&gt;validation-api&lt;/artifactId&gt; &lt;version&gt;2.0.1.Final&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ValidationMessages.properties1com.atguigu.common.valid.ListValue.message=å¿…é¡»æäº¤æŒ‡å®šçš„å€¼ åˆ«çš„ä¹Ÿå¯ä»¥å†™åœ¨è¿™é‡Œé¢ è‡ªå®šä¹‰æ ¡éªŒå™¨ListValueConstraintValidator12345678910111213141516171819202122/** * è‡ªå®šä¹‰æ ¡éªŒå™¨ */// ConstraintValidatoræ¥å£ã€Šæ ¡éªŒæ³¨è§£åï¼Œå­—æ®µåã€‹public class ListValueConstraintValidator implements ConstraintValidator&lt;ListValue, Integer&gt; &#123; private Set&lt;Integer&gt; set = new HashSet&lt;&gt;(); @Override public void initialize(ListValue constraintAnnotation) &#123; int[] vals = constraintAnnotation.vals(); for (int val : vals) &#123; set.add(val); &#125; &#125; // åˆ¤æ–­æ˜¯å¦æ ¡éªŒæˆåŠŸ(æ˜¯å¦åŒ…å«åœ¨æ³¨è§£çš„valå€¼ä¸­) @Override public boolean isValid(Integer value, ConstraintValidatorContext context) &#123; return set.contains(value); &#125;&#125; è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£ListValue12345678910111213141516@Documented@Constraint(validatedBy = &#123;ListValueConstraintValidator.class&#125;) // æ”¾å…¥è‡ªå®šä¹‰æ ¡éªŒå™¨@Target(&#123;METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE&#125;)@Retention(RUNTIME)public @interface ListValue &#123; // éœ€è¦ä»é…ç½®æ–‡ä»¶ä¸­è·å– String message() default &quot;&#123;com.atguigu.common.valid.ListValue.message&#125;&quot;; Class&lt;?&gt;[] groups() default &#123;&#125;; Class&lt;? extends Payload&gt;[] payload() default &#123;&#125;; int[] vals() default &#123;&#125;;&#125; Beanæ³¨è§£123456/** * æ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º] */@NotNull(message = &quot;å¿…é¡»æŒ‡å®šæ˜¾ç¤ºçŠ¶æ€[0-ä¸æ˜¾ç¤ºï¼›1-æ˜¾ç¤º]&quot;, groups = &#123;AddGroup.class, UpdateGroup.class&#125;) // éªŒè¯è§„åˆ™ï¼ŒIntegerç±»å‹éç©º@ListValue(vals = &#123;0, 1&#125;, groups = &#123;AddGroup.class&#125;)// è‡ªå®šä¹‰éªŒè¯è§„åˆ™ï¼Œå¿…é¡»ä¸º0æˆ–1private Integer showStatus; controlleræ³¨è§£12345678910/** * ä¿å­˜ */@RequestMapping(&quot;/save&quot;)//BindingResult resultå°è£…äº†ç´§è·Ÿç€çš„å¯¹è±¡çš„æ ¡éªŒç»“æœpublic R save(@Validated(&#123;AddGroup.class&#125;) @RequestBody BrandEntity brand) &#123; // ä½¿ç”¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå½“æœ‰å¼‚å¸¸çš„æ—¶å€™ç›´æ¥æŠ›å‡ºå¼‚å¸¸å³å¯ brandService.save(brand); return R.ok();&#125; ç»Ÿä¸€å¼‚å¸¸å¤„ç† ä¸Šè¿°ä¸åŒç»“æœä¸åŒè¿”å›ï¼Œå¯ä»¥ä½¿ç”¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†è§£å†³é‡å¤ä»£ç çš„ç¼–å†™é—®é¢˜ ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±» ä½¿ç”¨ä¸¤ä¸ªæ³¨è§£@RestControllerAdvice+@ExceptionHandler 123456789101112131415161718192021/** * ç»Ÿä¸€å¼‚å¸¸å¤„ç† */@ResponseBody@Slf4j // æ—¥å¿—@RestControllerAdvice(basePackages = &quot;com.atguigu.gulimall.product.controller&quot;)// æ ‡å¿—è¿™æ˜¯ä¸€ä¸ªRESTé£æ ¼çš„ControllerAdviceï¼Œå³å¢å¼ºçš„controllerï¼Œå¯ä»¥ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†ï¼Œåè·Ÿéœ€è¦å¤„ç†çš„åŒ…åpublic class GulimallExceptionControllerAdvice &#123; @ExceptionHandler(value = MethodArgumentNotValidException.class) // å¼‚å¸¸å¤„ç†ï¼Œvalueä¸ºæŒ‡å®šå¤„ç†çš„å¼‚å¸¸ public R handleValidException(MethodArgumentNotValidException e) &#123; log.error(&quot;æ•°æ®æ ¡éªŒæœ‰è¯¯&#123;&#125;,å¼‚å¸¸ç±»å‹&#123;&#125;&quot;, e.getMessage(), e.getClass()); // ç”¨äºæµ‹è¯•ï¼Œå…ˆå†™Exceptionç„¶åä¸»åŠ¨å‡ºé”™,å°±å¯ä»¥è·å¾—å¼‚å¸¸çš„ç±»å‹ Map&lt;String, String&gt; errorMap = new HashMap&lt;&gt;(); BindingResult bindingResult = e.getBindingResult(); bindingResult.getFieldErrors().forEach((item) -&gt; &#123; errorMap.put(item.getField(), item.getDefaultMessage()); &#125;); return R.error(400, &quot;æ•°æ®æ ¡éªŒæœ‰è¯¯&quot;).put(&quot;data&quot;, errorMap); &#125; &#125; åˆ™controllerä¸­çš„æ–¹æ³•ä¸å†éœ€è¦è¿›è¡Œåˆ¤æ–­ï¼Œå‡ºç°å¼‚å¸¸åç»Ÿä¸€æŠ›å‡ºç»™è¿™ä¸ªç±»å¤„ç† ç³»ç»Ÿé”™è¯¯ç ï¼ˆæšä¸¾ï¼‰ å¯ä»¥å†™ä¸€ä¸ªæšä¸¾ï¼Œæ”¾åœ¨commoné‡Œé¢ 1234567891011121314151617181920212223/** * æšä¸¾ï¼Œé”™è¯¯ç  */public enum BizCodeEnum &#123; UNKNOWN_EXCEPTION(10000, &quot;ç³»ç»ŸæœªçŸ¥å¼‚å¸¸&quot;), VALID_EXCEPTION(10001, &quot;å‚æ•°æ ¼å¼æ ¡éªŒå¤±è´¥&quot;); private Integer code; private String msg; BizCodeEnum(int code, String msg) &#123; this.code = code; this.msg = msg; &#125; public Integer getCode() &#123; return code; &#125; public String getMsg() &#123; return msg; &#125;&#125; ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»ï¼ˆä½¿ç”¨é”™è¯¯ç ï¼‰12345678910111213141516171819202122232425/** * ç»Ÿä¸€å¼‚å¸¸å¤„ç† */@ResponseBody@Slf4j // æ—¥å¿—@RestControllerAdvice(basePackages = &quot;com.atguigu.gulimall.product.controller&quot;)// æ ‡å¿—è¿™æ˜¯ä¸€ä¸ªRESTé£æ ¼çš„ControllerAdviceï¼Œå³å¢å¼ºçš„controllerï¼Œå¯ä»¥ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†ï¼Œåè·Ÿéœ€è¦å¤„ç†çš„åŒ…åpublic class GulimallExceptionControllerAdvice &#123; @ExceptionHandler(value = MethodArgumentNotValidException.class) // å¼‚å¸¸å¤„ç†ï¼Œvalueä¸ºæŒ‡å®šå¤„ç†çš„å¼‚å¸¸ public R handleValidException(MethodArgumentNotValidException e) &#123; log.error(&quot;æ•°æ®æ ¡éªŒæœ‰è¯¯&#123;&#125;,å¼‚å¸¸ç±»å‹&#123;&#125;&quot;, e.getMessage(), e.getClass()); // ç”¨äºæµ‹è¯•ï¼Œå…ˆå†™Exceptionç„¶åä¸»åŠ¨å‡ºé”™,å°±å¯ä»¥è·å¾—å¼‚å¸¸çš„ç±»å‹ Map&lt;String, String&gt; errorMap = new HashMap&lt;&gt;(); BindingResult bindingResult = e.getBindingResult(); bindingResult.getFieldErrors().forEach((item) -&gt; &#123; errorMap.put(item.getField(), item.getDefaultMessage()); &#125;); return R.error(BizCodeEnum.VALID_EXCEPTION.getCode(), BizCodeEnum.VALID_EXCEPTION.getMsg()).put(&quot;data&quot;, errorMap); &#125; @ExceptionHandler(value = Throwable.class) public R handleException(Throwable throwable) &#123; return R.error(BizCodeEnum.UNKNOWN_EXCEPTION.getCode(), BizCodeEnum.UNKNOWN_EXCEPTION.getMsg()); &#125;&#125; å±æ€§åˆ†ç»„ï¼ˆå‰åç«¯ï¼‰SKU &amp; SPU &amp; è§„åˆ™å‚æ•° &amp; é”€å”®å±æ€§ SPUï¼š Standard Product Unitï¼ˆæ ‡å‡†åŒ–äº§å“å•å…ƒï¼‰æ˜¯å•†å“ä¿¡æ¯èšåˆçš„æœ€å°å•ä½ï¼Œ æ˜¯ä¸€ç»„å¯å¤ç”¨ã€ æ˜“æ£€ç´¢çš„æ ‡å‡†åŒ–ä¿¡æ¯çš„é›†åˆï¼Œ è¯¥é›†åˆæè¿°äº†ä¸€ä¸ªäº§å“çš„ç‰¹æ€§ã€‚ SKUï¼š Stock Keeping Unitï¼ˆåº“å­˜é‡å•ä½ï¼‰å³åº“å­˜è¿›å‡ºè®¡é‡çš„åŸºæœ¬å•å…ƒï¼Œ å¯ä»¥æ˜¯ä»¥ä»¶ï¼Œ ç›’ï¼Œ æ‰˜ç›˜ç­‰ä¸ºå•ä½ã€‚ SKU è¿™æ˜¯å¯¹äºå¤§å‹è¿é”è¶…å¸‚DCï¼ˆé…é€ä¸­å¿ƒï¼‰ ç‰©æµç®¡ç†çš„ä¸€ä¸ªå¿…è¦çš„æ–¹æ³•ã€‚ ç°åœ¨å·²ç»è¢«å¼•ç”³ä¸ºäº§å“ç»Ÿä¸€ç¼–å·çš„ç®€ç§°ï¼Œ æ¯ç§äº§å“å‡å¯¹åº”æœ‰å”¯ä¸€çš„ SKU å·ã€‚ æ¯ä¸ªåˆ†ç±»ä¸‹çš„å•†å“å…±äº«è§„æ ¼å‚æ•°ï¼Œ ä¸é”€å”®å±æ€§ã€‚ åªæ˜¯æœ‰äº›å•†å“ä¸ä¸€å®šè¦ç”¨è¿™ä¸ªåˆ†ç±»ä¸‹å…¨éƒ¨çš„å±æ€§ï¼› å±æ€§æ˜¯ä»¥ä¸‰çº§åˆ†ç±»ç»„ç»‡èµ·æ¥çš„ è§„æ ¼å‚æ•°ä¸­æœ‰äº›æ˜¯å¯ä»¥æä¾›æ£€ç´¢çš„ è§„æ ¼å‚æ•°ä¹Ÿæ˜¯åŸºæœ¬å±æ€§ï¼Œ ä»–ä»¬å…·æœ‰è‡ªå·±çš„åˆ†ç»„ å±æ€§çš„åˆ†ç»„ä¹Ÿæ˜¯ä»¥ä¸‰çº§åˆ†ç±»ç»„ç»‡èµ·æ¥çš„ å±æ€§åç¡®å®šçš„ï¼Œ ä½†æ˜¯å€¼æ˜¯æ¯ä¸€ä¸ªå•†å“ä¸åŒæ¥å†³å®šçš„ æ•°æ®åº“è®¾è®¡ P70 å‰ç«¯åŸºç¡€æ­å»ºåˆ›å»ºmenu äººäººå¿«é€Ÿå¼€å‘å¹³å° â€”ã€‹ç³»ç»Ÿç®¡ç† â€”ã€‹èœå•ç®¡ç† â€”ã€‹æ·»åŠ èœå• æŠ½å–ä¸‰çº§åˆ†ç±» æŠŠcategoryä¸­æ˜¾ç¤ºçš„éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼Œæ”¾åˆ°å•ç‹¬çš„vueä¸­ï¼Œç„¶ååœ¨éœ€è¦ä½¿ç”¨çš„vueä¸­importç»„ä»¶ï¼Œå¹¶ä¸”åœ¨componentä¸­å£°æ˜ï¼Œç„¶åç›´æ¥ä½¿ç”¨ç»„ä»¶åæ ‡ç­¾å³å¯ é€†å‘å·¥ç¨‹ ç”Ÿæˆattrgroupæ”¾åˆ°å¸ƒå±€çš„å³è¾¹ï¼Œå·¦è¾¹æ”¾ä¸‰çº§åˆ†ç±» VUEçˆ¶å­ç»„ä»¶ä¼ é€’æ•°æ®å­ç»„ä»¶-&gt;çˆ¶ç»„ä»¶ ä½¿ç”¨äº‹ä»¶æœºåˆ¶ï¼Œå­ç»„ä»¶ç»™çˆ¶ç»„ä»¶å‘é€æ—¶é—´å¹¶æºå¸¦æ•°æ® 123456789101112131415161718&lt;template&gt; &lt;el-tree @node-click=&quot;nodeClick&quot; &gt; &lt;/el-tree&gt;&lt;/template&gt;&lt;script&gt;export default &#123; methods: &#123; // èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶ nodeClick(data, node, component) &#123; // å‘çˆ¶ç»„ä»¶å‘é€æ—¶é—´ this.$emit(&quot;tree-node-click&quot;, data, node, component); &#125; &#125;&#125;;&lt;/script&gt; 1234567891011121314151617181920&lt;!-- --&gt;&lt;template&gt; &lt;div class=&quot;&quot;&gt; &lt;el-row :gutter=&quot;20&quot;&gt; &lt;el-col :span=&quot;6&quot; &gt;&lt;category @tree-node-click=&quot;nodeClick&quot;&gt;&lt;/category &gt;&lt;/el-col&gt; &lt;/el-row&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; methods: &#123; // å­ç»„ä»¶äº‹ä»¶å“åº” nodeClick(data, node, component) &#123; console.log(&quot;çˆ¶ç»„ä»¶æ•è·äº‹ä»¶å¹¶è·å–æ•°æ®ï¼š&quot;, data, node, component); &#125;, &#125;&#125;;&lt;/script&gt; è·å–åˆ†ç±»å±æ€§åˆ†ç»„ï¼ˆåç«¯ï¼‰AttrGroupController123456789/** * åˆ—è¡¨ */@RequestMapping(&quot;/list/&#123;catelogId&#125;&quot;)//@RequiresPermissions(&quot;product:attrgroup:list&quot;)public R list(@RequestParam Map&lt;String, Object&gt; params, @PathVariable Long catelogId) &#123; PageUtils page = attrGroupService.queryPage(params, catelogId); return R.ok().put(&quot;page&quot;, page);&#125; AttrGroupServiceImpl1234567891011121314151617181920@Overridepublic PageUtils queryPage(Map&lt;String, Object&gt; params, Long catelogId) &#123; if (catelogId == 0) &#123; // æœªæŒ‡å®šåˆ†ç±» IPage&lt;AttrGroupEntity&gt; page = this.page(new Query&lt;AttrGroupEntity&gt;().getPage(params), new QueryWrapper&lt;&gt;()); return new PageUtils(page); &#125; else &#123; // keyæ˜¯æ£€ç´¢æ¡ä»¶ï¼Œå·²ç»å°è£…å¥½çš„ String key = (String) params.get(&quot;key&quot;); QueryWrapper&lt;AttrGroupEntity&gt; wrapper = new QueryWrapper&lt;AttrGroupEntity&gt;().eq(&quot;catelog_id&quot;, catelogId); // å¦‚æœæœ‰key,é‚£ä¹ˆå†åŠ ä¸Šandæ¡ä»¶ï¼Œæ¡ä»¶ä¸­åˆ¤æ–­å¦‚ä¸‹ if (!StringUtils.isEmpty(key)) &#123; wrapper.and((obj) -&gt; &#123; obj.eq(&quot;attr_group_id&quot;, key).or().like(&quot;attr_group_name&quot;, key); &#125;); &#125; IPage&lt;AttrGroupEntity&gt; page = this.page(new Query&lt;AttrGroupEntity&gt;().getPage(params), wrapper); return new PageUtils(page); &#125;&#125; æ–°å¢ã€ä¿®æ”¹åˆ†ç»„ &amp; çº§è”é€‰æ‹©å™¨ å½“å­—æ®µä¸ºç©ºæ—¶ä¸è¿”å›ç©ºå€¼123456/** * å­åˆ†ç±» */@JsonInclude(JsonInclude.Include.NON_EMPTY) // å½“è¯¥å­—æ®µä¸ä¸ºç©ºæ—¶æ‰è¿”å›å­—æ®µkv@TableField(exist = false) // è¡¨ç¤ºè¯¥å±æ€§åœ¨æ•°æ®è¡¨ä¸­ä¸å­˜åœ¨private List&lt;CategoryEntity&gt; children; æ–°å¢åˆ†ç»„ /#/product-attrgroup 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160&lt;template&gt; &lt;el-dialog :title=&quot;!dataForm.attrGroupId ? &#x27;æ–°å¢&#x27; : &#x27;ä¿®æ”¹&#x27;&quot; :close-on-click-modal=&quot;false&quot; :visible.sync=&quot;visible&quot; &gt; &lt;el-form :model=&quot;dataForm&quot; :rules=&quot;dataRule&quot; ref=&quot;dataForm&quot; @keyup.enter.native=&quot;dataFormSubmit()&quot; label-width=&quot;80px&quot; &gt; &lt;el-form-item label=&quot;ç»„å&quot; prop=&quot;attrGroupName&quot;&gt; &lt;el-input v-model=&quot;dataForm.attrGroupName&quot; placeholder=&quot;ç»„å&quot; &gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ’åº&quot; prop=&quot;sort&quot;&gt; &lt;el-input v-model=&quot;dataForm.sort&quot; placeholder=&quot;æ’åº&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æè¿°&quot; prop=&quot;descript&quot;&gt; &lt;el-input v-model=&quot;dataForm.descript&quot; placeholder=&quot;æè¿°&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;ç»„å›¾æ ‡&quot; prop=&quot;icon&quot;&gt; &lt;el-input v-model=&quot;dataForm.icon&quot; placeholder=&quot;ç»„å›¾æ ‡&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ‰€å±åˆ†ç±»id&quot; prop=&quot;catelogId&quot;&gt; &lt;el-cascader v-model=&quot;dataForm.catelogIds&quot; :options=&quot;categorys&quot; :props=&quot;props&quot; &gt;&lt;/el-cascader&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;span slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;visible = false&quot;&gt;å–æ¶ˆ&lt;/el-button&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;dataFormSubmit()&quot;&gt;ç¡®å®š&lt;/el-button&gt; &lt;/span&gt; &lt;/el-dialog&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data() &#123; return &#123; categorys: [], props: &#123; value: &quot;catId&quot;, label: &quot;name&quot;, children: &quot;children&quot; &#125;, visible: false, dataForm: &#123; attrGroupId: 0, attrGroupName: &quot;&quot;, sort: &quot;&quot;, descript: &quot;&quot;, icon: &quot;&quot;, catelogIds: [], catelogId: 0 &#125;, dataRule: &#123; attrGroupName: [ &#123; required: true, message: &quot;ç»„åä¸èƒ½ä¸ºç©º&quot;, trigger: &quot;blur&quot; &#125; ], sort: [&#123; required: true, message: &quot;æ’åºä¸èƒ½ä¸ºç©º&quot;, trigger: &quot;blur&quot; &#125;], descript: [ &#123; required: true, message: &quot;æè¿°ä¸èƒ½ä¸ºç©º&quot;, trigger: &quot;blur&quot; &#125; ], icon: [&#123; required: true, message: &quot;ç»„å›¾æ ‡ä¸èƒ½ä¸ºç©º&quot;, trigger: &quot;blur&quot; &#125;], catelogId: [ &#123; required: true, message: &quot;æ‰€å±åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;, trigger: &quot;blur&quot; &#125; ] &#125; &#125;; &#125;, created() &#123; this.getMenus(); &#125;, methods: &#123; // è·å–æ‰€æœ‰åˆ†ç±» getMenus() &#123; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/list/tree&quot;), method: &quot;get&quot; &#125;).then((&#123; data &#125;) =&gt; &#123; console.log(data); // è¿™é‡Œdataä½¿ç”¨äº†è§£æ„ this.categorys = data.data; &#125;); &#125;, init(id) &#123; this.dataForm.attrGroupId = id || 0; this.visible = true; this.$nextTick(() =&gt; &#123; this.$refs[&quot;dataForm&quot;].resetFields(); if (this.dataForm.attrGroupId) &#123; this.$http(&#123; url: this.$http.adornUrl( `/product/attrgroup/info/$&#123;this.dataForm.attrGroupId&#125;` ), method: &quot;get&quot;, params: this.$http.adornParams() &#125;).then((&#123; data &#125;) =&gt; &#123; if (data &amp;&amp; data.code === 0) &#123; this.dataForm.attrGroupName = data.attrGroup.attrGroupName; this.dataForm.sort = data.attrGroup.sort; this.dataForm.descript = data.attrGroup.descript; this.dataForm.icon = data.attrGroup.icon; this.dataForm.catelogId = data.attrGroup.catelogId; &#125; &#125;); &#125; &#125;); &#125;, // è¡¨å•æäº¤ dataFormSubmit() &#123; this.$refs[&quot;dataForm&quot;].validate(valid =&gt; &#123; if (valid) &#123; this.$http(&#123; url: this.$http.adornUrl( `/product/attrgroup/$&#123; !this.dataForm.attrGroupId ? &quot;save&quot; : &quot;update&quot; &#125;` ), method: &quot;post&quot;, data: this.$http.adornData(&#123; attrGroupId: this.dataForm.attrGroupId || undefined, attrGroupName: this.dataForm.attrGroupName, sort: this.dataForm.sort, descript: this.dataForm.descript, icon: this.dataForm.icon, catelogId: this.dataForm.catelogIds[ this.dataForm.catelogIds.length - 1 ] &#125;) &#125;).then((&#123; data &#125;) =&gt; &#123; if (data &amp;&amp; data.code === 0) &#123; this.$message(&#123; message: &quot;æ“ä½œæˆåŠŸ&quot;, type: &quot;success&quot;, duration: 1500, onClose: () =&gt; &#123; this.visible = false; this.$emit(&quot;refreshDataList&quot;); &#125; &#125;); &#125; else &#123; this.$message.error(data.msg); &#125; &#125;); &#125; &#125;); &#125; &#125;&#125;;&lt;/script&gt; éæ•°æ®åº“ä¸­çš„å­—æ®µ@TableField(exist = false)12345/** * æ‰€å±åˆ†ç±»idçš„å®Œæ•´è·¯å¾„ */@TableField(exist = false) // ä¸æ˜¯æ•°æ®åº“ä¸­å­˜åœ¨çš„å­—æ®µprivate Long[] catelogPath; çº§è”é€‰æ‹©å™¨å›æ˜¾ï¼ˆåç«¯ï¼‰ ç”¨äºæœç´¢åˆ†ç±»çš„å®Œæ•´è·¯å¾„ç„¶åå›æ˜¾ç»™çº§è”é€‰æ‹©å™¨ 12345678910111213141516171819@RestController@RequestMapping(&quot;product/attrgroup&quot;)public class AttrGroupController &#123; /** * ä¿¡æ¯ */ @RequestMapping(&quot;/info/&#123;attrGroupId&#125;&quot;) //@RequiresPermissions(&quot;product:attrgroup:info&quot;) public R info(@PathVariable(&quot;attrGroupId&quot;) Long attrGroupId) &#123; AttrGroupEntity attrGroup = attrGroupService.getById(attrGroupId); Long catelogId = attrGroup.getCatelogId(); // è·å–å®Œæ•´åˆ†ç±»è·¯å¾„ï¼ˆå‰ç«¯æ‰€éœ€ï¼‰ Long[] path = categoryService.findCategoryPath(catelogId); attrGroup.setCatelogPath(path); return R.ok().put(&quot;attrGroup&quot;, attrGroup); &#125;&#125; 1234567891011121314151617@Overridepublic Long[] findCategoryPath(Long catelogId) &#123; List&lt;Long&gt; path = new ArrayList&lt;&gt;(); List&lt;Long&gt; parentPath = findParentPath(catelogId, path); // è¿™é‡Œéœ€è¦é€†åºä¸€ä¸‹ï¼ˆå› ä¸ºæ˜¯å€’ç€æ‰¾çš„ï¼‰ Collections.reverse(parentPath); return parentPath.toArray(new Long[0]);&#125;private List&lt;Long&gt; findParentPath(Long catelogId, List&lt;Long&gt; path) &#123; path.add(catelogId); CategoryEntity byId = this.getById(catelogId); if (byId.getParentCid() != 0) &#123; findParentPath(byId.getParentCid(), path); &#125; return path;&#125; çº§è”é€‰æ‹©å™¨å›æ˜¾ï¼ˆå‰ç«¯ï¼‰123456789101112131415161718192021222324252627init(id) &#123; this.dataForm.attrGroupId = id || 0; this.visible = true; // $nextTickå½“ç»„ä»¶å®Œå…¨æ¸²æŸ“å®Œæˆä¹‹åè°ƒç”¨ this.$nextTick(() =&gt; &#123; this.$refs[&quot;dataForm&quot;].resetFields(); if (this.dataForm.attrGroupId) &#123; this.$http(&#123; url: this.$http.adornUrl( `/product/attrgroup/info/$&#123;this.dataForm.attrGroupId&#125;` ), method: &quot;get&quot;, params: this.$http.adornParams() &#125;).then((&#123; data &#125;) =&gt; &#123; if (data &amp;&amp; data.code === 0) &#123; this.dataForm.attrGroupName = data.attrGroup.attrGroupName; this.dataForm.sort = data.attrGroup.sort; this.dataForm.descript = data.attrGroup.descript; this.dataForm.icon = data.attrGroup.icon; this.dataForm.catelogId = data.attrGroup.catelogId; // å½“å‰catlogçš„å®Œæ•´è·¯å¾„ this.dataForm.catelogPath = data.attrGroup.catelogPath; &#125; &#125;); &#125; &#125;); &#125;, 123456789// æ–°å¢ / ä¿®æ”¹addOrUpdateHandle(id) &#123; this.addOrUpdateVisible = true; // $nextTickå½“ç»„ä»¶å®Œå…¨æ¸²æŸ“å®Œæˆä¹‹åè°ƒç”¨ this.$nextTick(() =&gt; &#123; // è°ƒç”¨addOrUpdateç»„ä»¶ä¸­çš„initå‡½æ•° this.$refs.addOrUpdate.init(id); &#125;);&#125;, 123456789&lt;!-- @closed=&quot;dialogClose&quot; å¯¹è¯æ¡†å…³é—­å›è°ƒäº‹ä»¶ --&gt;&lt;el-dialog :title=&quot;!dataForm.attrGroupId ? &#x27;æ–°å¢&#x27; : &#x27;ä¿®æ”¹&#x27;&quot; :close-on-click-modal=&quot;false&quot; :visible.sync=&quot;visible&quot; @closed=&quot;dialogClose&quot;&gt; 123456methods: &#123; // å…³é—­å¯¹è¯æ¡†æ¸…ç©ºæ•°æ® dialogClose() &#123; this.dataForm.catelogPath = []; &#125;,&#125; å“ç‰Œç®¡ç†é¡µé¢ ä¹‹å‰é¡µé¢å®Œå–„ä¸€ä¸‹ MyBatis-Plusåˆ†é¡µæ’ä»¶ å†™æ³•ä¸ç‰ˆæœ¬æœ‰å…³ï¼Œæ³¨æ„å®˜ç½‘æ–‡æ¡£ 1234567891011121314151617181920212223package com.atguigu.gulimall.product.config;import com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;import org.mybatis.spring.annotation.MapperScan;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.transaction.annotation.EnableTransactionManagement;@Configuration // é…ç½®ç±»@EnableTransactionManagement // å¼€å¯äº‹åŠ¡åŠŸèƒ½@MapperScan(&quot;com.atguigu.gulimall.product.dao&quot;)public class MybatisPlusConfig &#123; // å¼•å…¥åˆ†é¡µæ’ä»¶ï¼ˆæ³¨æ„è¿™é‡Œæ˜¯æ—§ç‰ˆæœ¬ï¼Œå¦‚æœç‰ˆæœ¬è¾ƒæ–°éœ€è¦è‡ªè¡Œå»å®˜ç½‘æŸ¥çœ‹æœ€æ–°å†™æ³•ï¼‰ @Bean public PaginationInterceptor paginationInterceptor() &#123; PaginationInterceptor paginationInterceptor = new PaginationInterceptor(); // è®¾ç½®è¯·æ±‚çš„é¡µé¢å¤§äºæœ€å¤§é¡µåæ“ä½œï¼Œ trueè°ƒå›åˆ°é¦–é¡µï¼Œfalse ç»§ç»­è¯·æ±‚ é»˜è®¤false paginationInterceptor.setOverflow(true); // è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤ 500 æ¡ï¼Œ-1 ä¸å—é™åˆ¶ paginationInterceptor.setLimit(1000); return paginationInterceptor; &#125;&#125; æ¨¡ç³ŠæŸ¥è¯¢ å»pageå¯¹è±¡ä¸­æ·»åŠ querywrapperå³å¯ 1234567891011121314151617@Service(&quot;brandService&quot;)public class BrandServiceImpl extends ServiceImpl&lt;BrandDao, BrandEntity&gt; implements BrandService &#123; @Override public PageUtils queryPage(Map&lt;String, Object&gt; params) &#123; QueryWrapper&lt;BrandEntity&gt; queryWrapper = new QueryWrapper&lt;&gt;(); // æ¨¡ç³ŠæŸ¥è¯¢ String key = (String) params.get(&quot;key&quot;); if (!StringUtils.isEmpty(key)) &#123; queryWrapper.eq(&quot;brand_id&quot;, key).or().like(&quot;name&quot;, key); &#125; IPage&lt;BrandEntity&gt; page = this.page( new Query&lt;BrandEntity&gt;().getPage(params), queryWrapper ); return new PageUtils(page); &#125;&#125; å“ç‰Œåˆ†ç±»å…³è” ä¸€ä¸ªå“ç‰Œå¯èƒ½åšå¤šç§äº§å“ï¼Œæ‰€ä»¥éœ€è¦å…³è” å®ç°æŸ¥è¯¢å…³è”åˆ—è¡¨å’Œæ–°å¢å…³è” æ•°æ®è¡¨ æŠ½å–å‡ºæ¥ä¸€ä¸ªcategory_brand_relationè¡¨ï¼Œå› ä¸ºæ˜¯å¤šå¯¹å¤šçš„å…³ç³» æŸ¥è¯¢ã€æ–°å¢å“ç‰Œå…³è”ï¼ˆåç«¯ï¼‰123456789101112131415161718192021222324@RestController@RequestMapping(&quot;product/categorybrandrelation&quot;)public class CategoryBrandRelationController &#123; @Autowired private CategoryBrandRelationService categoryBrandRelationService; /** * è·å–å“ç‰Œå…³è”çš„æ‰€æœ‰åˆ†ç±»åˆ—è¡¨ */ @GetMapping(&quot;/catelog/list&quot;) public R relationList(@RequestParam(&quot;brandId&quot;) Long brandId) &#123; List&lt;CategoryBrandRelationEntity&gt; data = categoryBrandRelationService.list( new QueryWrapper&lt;CategoryBrandRelationEntity&gt;().eq(&quot;brand_id&quot;, brandId)); return R.ok().put(&quot;data&quot;, data); &#125; /** * ä¿å­˜å“ç‰Œå…³è”çš„æ‰€æœ‰åˆ†ç±» */ @PostMapping(&quot;/save&quot;) public R save(@RequestBody CategoryBrandRelationEntity categoryBrandRelation) &#123; categoryBrandRelationService.mySave(categoryBrandRelation); return R.ok(); &#125;&#125; 12345678910111213141516171819202122@Service(&quot;categoryBrandRelationService&quot;)public class CategoryBrandRelationServiceImpl extends ServiceImpl&lt;CategoryBrandRelationDao, CategoryBrandRelationEntity&gt; implements CategoryBrandRelationService &#123; @Autowired BrandDao brandDao; @Autowired CategoryDao categoryDao; /** * ä¿å­˜å“ç‰Œå…³è”çš„æ‰€æœ‰åˆ†ç±» */ @Override public void mySave(CategoryBrandRelationEntity categoryBrandRelation) &#123; Long brandId = categoryBrandRelation.getBrandId(); Long catelogId = categoryBrandRelation.getCatelogId(); // æŸ¥è¯¢å¯¹åº”name BrandEntity brandEntity = brandDao.selectById(brandId); categoryBrandRelation.setBrandName(brandEntity.getName()); CategoryEntity categoryEntity = categoryDao.selectById(catelogId); categoryBrandRelation.setCatelogName(categoryEntity.getName()); // ä¿å­˜ baseMapper.insert(categoryBrandRelation); &#125;&#125; è¿è¡¨ä¿®æ”¹ ä¾‹å¦‚ä¿®æ”¹å“ç‰Œä¿¡æ¯ï¼Œä¸ä»…è¦ä¿®æ”¹brandè¡¨ï¼Œè¿˜æœ‰ä¿®æ”¹category_brand_relationç­‰ç›¸å…³è¡¨ 1234567891011121314151617@Service(&quot;brandService&quot;)public class BrandServiceImpl extends ServiceImpl&lt;BrandDao, BrandEntity&gt; implements BrandService &#123; /** * ä¿®æ”¹å“ç‰Œä¿¡æ¯ç›¸å…³æ‰€æœ‰è¡¨çš„ä¿¡æ¯ * * @param brand */ @Override public void updateDetail(BrandEntity brand) &#123; this.updateById(brand); if (!StringUtils.isEmpty(brand.getName())) &#123; // æ›´æ–°å…¶ä»–å…³è”è¡¨ä¸­çš„æ•°æ® categoryBrandRelationService.updateBrand(brand.getBrandId(), brand.getName()); &#125; // TODO æ›´æ–°å…¶ä»–å…³è”è¡¨ &#125;&#125; 12345678910111213141516@Service(&quot;categoryBrandRelationService&quot;)public class CategoryBrandRelationServiceImpl extends ServiceImpl&lt;CategoryBrandRelationDao, CategoryBrandRelationEntity&gt; implements CategoryBrandRelationService &#123; /** * ç”±äºbrandä¿¡æ¯çš„æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦æ›´æ–°å…³è”æ•°æ® * * @param brandId * @param name */ @Override public void updateBrand(Long brandId, String name) &#123; CategoryBrandRelationEntity entity = new CategoryBrandRelationEntity(); entity.setBrandName(name); entity.setBrandId(brandId); this.update(entity, new UpdateWrapper&lt;CategoryBrandRelationEntity&gt;().eq(&quot;brand_id&quot;, brandId)); &#125;&#125; ä¿®æ”¹åˆ†ç±»ä¿¡æ¯ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåªä¸è¿‡æ¢äº†ä¸€ç§å†™æ³•ï¼Œå†™åœ¨äº†Mapperä¸­ 1234567891011@Service(&quot;categoryService&quot;)public class CategoryServiceImpl extends ServiceImpl&lt;CategoryDao, CategoryEntity&gt; implements CategoryService &#123;/** * ä¿®æ”¹(çº§è”æ›´æ–°ï¼Œè¿è¡¨æ›´æ–°) */@Overridepublic void updateDetail(CategoryEntity category) &#123; this.updateById(category); categoryBrandRelationService.updateCategory(category.getCatId(), category.getName());&#125;&#125; 1234567891011121314@Service(&quot;categoryBrandRelationService&quot;)public class CategoryBrandRelationServiceImpl extends ServiceImpl&lt;CategoryBrandRelationDao, CategoryBrandRelationEntity&gt; implements CategoryBrandRelationService &#123; /** * ç”±äºcatogoryä¿¡æ¯çš„æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦æ›´æ–°å…³è”æ•°æ® * * @param catId * @param name */ @Override public void updateCategory(Long catId, String name) &#123; baseMapper.updateCategory(catId, name); &#125;&#125; 1234@Mapperpublic interface CategoryBrandRelationDao extends BaseMapper&lt;CategoryBrandRelationEntity&gt; &#123; void updateCategory(@Param(&quot;catId&quot;) Long catId, @Param(&quot;name&quot;) String name);&#125; 123456&lt;!-- ç”±äºcatogoryä¿¡æ¯çš„æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦æ›´æ–°å…³è”æ•°æ® --&gt;&lt;update id=&quot;updateCategory&quot;&gt; UPDATE gulimall_pms.pms_category_brand_relation SET catelog_name = #&#123;name&#125; WHERE catelog_id = #&#123;catId&#125;&lt;/update&gt;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜1","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘å•†åŸé¡¹ç›®å®æˆ˜1","date":"2021-10-08T11:50:17.125Z","updated":"2021-10-29T06:37:34.579Z","comments":true,"path":"2021/10/08/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-1/","link":"","permalink":"http://example.com/2021/10/08/xiang-mu-bi-ji-shang-cheng-xiang-mu-shi-zhan-1/","excerpt":"","text":"åˆ†å¸ƒå¼åŸºç¡€æ¦‚å¿µå¾®æœåŠ¡ åŸºäºä¸šåŠ¡è¾¹ç•Œè¿›è¡ŒæœåŠ¡å¾®åŒ–æ‹†åˆ†ï¼Œå„ä¸ªæœåŠ¡å™¨ç‹¬ç«‹éƒ¨ç½²è¿è¡Œã€‚ é›†ç¾¤&amp;åˆ†å¸ƒå¼&amp;èŠ‚ç‚¹ é›†ç¾¤æ˜¯ä¸ªç‰©ç†å½¢æ€ï¼Œåˆ†å¸ƒå¼æ˜¯ä¸ªå·¥ä½œæ–¹å¼ã€‚ åˆ†å¸ƒå¼æ˜¯æŒ‡å°†ä¸åŒçš„ä¸šåŠ¡åˆ†å¸ƒåœ¨ä¸åŒçš„åœ°æ–¹ï¼Œé›†ç¾¤æ˜¯æŒ‡å°†å‡ å°æœåŠ¡å™¨é›†ä¸­åœ¨ä¸€èµ·å®ç°åŒä¸€ä¸šåŠ¡ã€‚ åˆ†å¸ƒå¼ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ˆé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼‰ï¼Œéƒ½å¯ä»¥åšé›†ç¾¤ï¼Œç„¶è€Œé›†ç¾¤ä¸ä¸€å®šå°±æ˜¯åˆ†å¸ƒå¼çš„ã€‚ è¿œç¨‹è°ƒç”¨ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå„ä¸ªæœåŠ¡å¯èƒ½å¤„äºä¸åŒä¸»æœºï¼Œä½†æ˜¯æœåŠ¡ä¹‹é—´ä¸å¯é¿å…çš„éœ€è¦ç›¸äº’è°ƒç”¨ï¼Œå³è¿œç¨‹è°ƒç”¨ã€‚ åœ¨spring-cloudä¸­ä½¿ç”¨HTTP+JSONçš„æ–¹å¼å®Œæˆè¿œç¨‹è°ƒç”¨ã€‚ è´Ÿè½½å‡è¡¡ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒAæœåŠ¡éœ€è¦è°ƒç”¨BæœåŠ¡ï¼Œä¸”BæœåŠ¡å­˜åœ¨äºå¤šå°æœºå™¨ä¸­ï¼ŒAæœåŠ¡è°ƒç”¨ä»»æ„ä¸€ä¸ªæœåŠ¡å™¨å‡å¯å®ŒæˆåŠŸèƒ½ã€‚ä½†æ˜¯ä¸ºäº†ä½¿å¾—æ¯ä¸€ä¸ªæœåŠ¡å™¨ä¸è¦å¤ªå¿™æˆ–è€…å¤ªé—²ï¼Œå¯ä»¥ä½¿ç”¨è´Ÿè½½å‡è¡¡çš„è°ƒç”¨æ¯ä¸€ä¸ªæœåŠ¡å™¨ã€‚ å¸¸è§çš„è´Ÿè½½å‡è¡¡ç®—æ³•å¦‚ä¸‹ï¼š è½®è¯¢ï¼šæŒ‰é¡ºåºï¼ŒçŸ¥é“æœ€åä¸€ä¸ªï¼Œç„¶åå¾ªç¯ã€‚ æœ€å°è¿æ¥ï¼šæœ‰é™é€‰æ‹©è¿æ¥æ•°æœ€å°‘ï¼ˆå‹åŠ›æœ€å°ï¼‰çš„æœåŠ¡å™¨ã€‚ æ•£åˆ—ï¼šæ ¹æ®è¯·æ±‚æºçš„IPçš„æ•£åˆ—ï¼ˆHASHï¼‰æ¥é€‰æ‹©è¦è½¬å‘çš„æœåŠ¡å™¨ã€‚ æœåŠ¡æ³¨å†Œã€å‘ç°&amp;æ³¨å†Œä¸­å¿ƒ æœåŠ¡ä¸Šçº¿ååœ¨æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œä»è€Œä½¿å¾—å…¶ä»–æœåŠ¡å™¨æˆ–è€…äººèƒ½å¤Ÿæ„ŸçŸ¥å…¶å­˜åœ¨ä¸çŠ¶æ€ é…ç½®ä¸­å¿ƒ æ¯ä¸€ä¸ªæœåŠ¡å™¨éƒ½å«æœ‰å¤§é‡çš„é…ç½®ï¼Œå¹¶ä¸”æ¯ä¸ªæœåŠ¡å¯èƒ½éƒ¨ç½²åœ¨å¤šå°æœºå™¨ä¸Šï¼Œæ‰€ä»¥ç»å¸¸éœ€è¦å˜æ›´é…ç½®ï¼Œå°±å¯ä»¥ä½¿ç”¨é…ç½®ä¸­å¿ƒæ¥é›†ä¸­ç®¡ç†å¾®æœåŠ¡çš„é…ç½®ä¿¡æ¯ã€‚ æœåŠ¡ç†”æ–­&amp;æœåŠ¡é™çº§ åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¾®æœåŠ¡ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šè®¯ï¼Œå½“ä¸€ä¸ªæœåŠ¡ä¸å¯ç”¨çš„æ—¶å€™å¯èƒ½é€ æˆé›ªå´©æ•ˆåº”ã€‚ä¸ºé˜²æ­¢è¿™æ ·çš„æƒ…å†µï¼Œå¿…é¡»è¦æœ‰å®¹é”™æœºåˆ¶æ¥ä¿æŠ¤æœåŠ¡ã€‚ æœåŠ¡ç†”æ–­ï¼šè®¾ç½®æœåŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œå½“è¢«è°ƒç”¨çš„æœåŠ¡ç»å¸¸å¤±è´¥åˆ°è¾¾æŸä¸ªé˜ˆå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å¯æ–­è·¯ä¿æŠ¤æœºåˆ¶ï¼Œä½¿å¾—åæ¥çš„è¯·æ±‚ä¸å†å»è°ƒç”¨è¿™ä¸ªæœåŠ¡ï¼Œè€Œæ˜¯æœ¬åœ°ç›´æ¥è¿”å›é»˜è®¤çš„æ•°æ®ã€‚ æœåŠ¡é™çº§ï¼šåœ¨è¿ç»´æœŸé—´ï¼Œå½“ç³»ç»Ÿå¤„äºé«˜å³°æœŸï¼Œç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯ä»¥è®©éæ ¸å¿ƒä¸šåŠ¡é™çº§è¿è¡Œï¼Œå³æŸäº›æœåŠ¡ä¸å¤„ç†æˆ–è€…ç®€å•å¤„ç†ã€‚ APIç½‘å…³ æŠ½è±¡äº†å¾®æœåŠ¡ä¸­éƒ½éœ€è¦çš„å…¬å…±åŠŸèƒ½ï¼ŒåŒæ—¶æä¾›äº†å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€æœåŠ¡ç†”æ–­ã€ç»Ÿä¸€è®¤è¯ã€é™æµæµæ§ã€æ—¥å¿—ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚ å¾®æœåŠ¡æ¶æ„å›¾ å¾®æœåŠ¡åˆ’åˆ†å›¾ Linuxè™šæ‹Ÿæœºç¯å¢ƒæ­å»º ä¹‹å‰çš„é¡¹ç›®å·²ç»æ­å»ºçš„å·®ä¸å¤šäº† ç›¸å…³å‘½ä»¤ winï¼š ipconfig ping 192.168.128.129 linuxï¼š ip addr ping 10.67.99.2 dockerï¼š æˆ‘çš„æŒ‚è½½æ–‡ä»¶åœ°å€éƒ½åœ¨mydataä¸­ docker images å½“å‰æ‰€æœ‰é•œåƒ docker ps å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker start xxx å¯åŠ¨å®¹å™¨ docker exec -it mysql /bin/bash docker exec -it redis redis-cli whereis [å®¹å™¨å] æŸ¥çœ‹å½“å‰è¿›å…¥çš„å®¹å™¨æ–‡ä»¶çš„åœ°å€ docker update redis â€“restart=always è‡ªåŠ¨é‡å¯å®¹å™¨ exit mysqlï¼š mysql -u root -p è®¿é—®mysql redisï¼š keys * é¡¹ç›®å‰åç«¯åŸºç¡€æ­å»º åé¢å›æ¥å¾—æˆ‘è¡¨ç¤ºï¼Œä»ä¸€å¼€å§‹ç›´æ¥å¤åˆ¶ä¸€æ ·çš„ç‰ˆæœ¬å·ï¼ï¼ï¼ åŸºç¡€æœåŠ¡æ¨¡å— æ³¨æ„æ¯ä¸ªæœåŠ¡æ¨¡å—ï¼Œå…ˆå¯¼å…¥webå’Œopenfeign æ•°æ®åº“ æ¯ä¸ªæœåŠ¡éƒ½éœ€è¦ç‹¬ç«‹çš„æ•°æ®åº“ æ³¨æ„è¿™é‡Œsqlæ–‡ä»¶ä¸è¦ç›´æ¥å¯¼å…¥ï¼Œå¯èƒ½å¯¼å‡ºçš„æ—¶å€™æ ¼å¼è®¾ç½®å’Œç°åœ¨ä¸ç¬¦åˆï¼ˆåˆ›å»ºçš„æ•°æ®åº“å­—ç¬¦ç¼–ç ä¸ºutf8mb4ï¼‰,ç›´æ¥å¯¼å…¥ä¼šä¸­æ–‡ä¹±ç ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€åå†ç²˜è´´è¿è¡Œã€‚ äººäººå¼€æºæ¨¡æ¿ äººäººå¼€æº (gitee.com) renren-fastï¼ˆåç«¯ï¼‰renren-fast-vueï¼ˆå‰ç«¯ï¼‰renren-generatorï¼ˆç”Ÿæˆå™¨ï¼‰ renren-fast renren-fast cloneåæ”¾åˆ°çˆ¶æ¨¡å—ä¸­ï¼Œè®°å¾—åœ¨çˆ¶æ¨¡å—çš„pomæ–‡ä»¶ä¸­å†™å…¥modelã€‚ è¿è¡Œdbæ–‡ä»¶å¤¹ä¸­çš„å¯¹åº”sql ä¿®æ”¹resourcesä¸‹çš„é…ç½®æ–‡ä»¶ application-dev.ymlä¸­çš„druidæ•°æ®æºä¿¡æ¯ renren-fast-vue cloneåç”¨vscodeæ‰“å¼€ npm installï¼ˆæ³¨æ„å…ˆæŠŠpackage.jsonä¸­sassçš„ç‰ˆæœ¬æ”¹ä¸º4.14ä»¥ä¸Šï¼Œå› ä¸ºnpmçš„ç‰ˆæœ¬ä¸º14ï¼Œä¸¤è€…ç‰ˆæœ¬æœ‰æ‰€å¯¹åº”ï¼Œè¯¦è§ğŸ‘‰Vueè§£å†³æŠ¥é”™9_äººäººå¼€æºrenren-fast-vueæ‰§è¡Œnpm installæŠ¥é”™è§£å†³(sassçš„ç‰ˆæœ¬å¤ªä½è€Œnodeçš„ç‰ˆæœ¬å¤ªé«˜å¯¼è‡´ï¼‰_xiaosiçš„åšå®¢-CSDNåšå®¢ï¼Œå¥‡æ€ªçš„æ˜¯package-lock.jsonä¸­çš„ç‰ˆæœ¬ä¸º4.14.1ï¼Œç„¶è€Œpackageä¸­å´æ˜¯4.13.1ï¼‰ npm run devï¼Œå¦ˆè€¶runäº†ä¸€ä¸‹è¯•è¯•ï¼Œå°±å¼€äº†ä¸€ä¸ªæœåŠ¡ï¼Œå†…å­˜å·²ç»85%äº† å¯ä»¥åœ¨.eslintignoreä¸­æ·»åŠ *.jså’Œ*.vueç”¨äºå¿½ç•¥è¯­æ³•æ£€æŸ¥ renren-generator cloneï¼Œå¯¼å…¥åˆ°åç«¯é¡¹ç›®ä¸­ï¼Œè®°å¾—åœ¨çˆ¶æ¨¡å—çš„pomæ–‡ä»¶ä¸­å†™å…¥modelã€‚ é…ç½®application.ymlä¸­çš„æ•°æ®æºé…ç½®ï¼ˆæ³¨æ„æ•°æ®åº“åçš„ç¼–å†™ï¼‰ é…ç½®generator.propertiesä¸­çš„ç”Ÿæˆæ•°æ®é…ç½®ï¼ˆæ³¨æ„æ¨¡å—åã€è¡¨å‰ç¼€å³å¯ï¼‰ è¿è¡Œapplicationæ‰“å¼€é¡µé¢ç‚¹å‡»ç”Ÿæˆä»£ç ï¼ˆå¦‚æœä¸€ç›´åœ¨è¯»å–è¯´æ˜é…ç½®ä¿¡æ¯æœ‰è¯¯ï¼‰ å°†å‹ç¼©åŒ…ä¸­çš„mainæ–‡ä»¶æ”¾å…¥å¯¹åº”æ¨¡å—srcæ–‡ä»¶å¤¹ å»renren-fastæ¨¡å—ä¸­çš„commonæ–‡ä»¶å¤¹ä¸­å¤åˆ¶æŠ¥é”™æ‰€éœ€è¦çš„ç±» commonæ¨¡å— æ‰¿æ¥ä¸Šæ–‡ï¼Œåæ­£å°±æ˜¯ä¿®ä¿®è¡¥è¡¥ controllerä¸­çš„@RequiresPermissionsæ³¨é‡Šå¯ä»¥é€šè¿‡ä¿®æ”¹generatorçš„controller templateï¼ˆæ‰€ä»¥è¯´ä¸ºä»€ä¹ˆä¸èƒ½ä¸€å¼€å§‹å°±æŠŠæ¨¡æ¿ä¿®æ”¹äº†ï¼‰ å½“å‰é¡¹ç›®ç»“æ„ æ•´åˆmybatis-plusä¾èµ– ç”±äºcommonæ¨¡å—ä¸­å·²ç»å¯¼å…¥äº†mybatis-plusä¾èµ–ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åªéœ€è¦å¯¼å…¥commonæ¨¡å—å³å¯ åŒæ—¶éœ€è¦åœ¨commonä¸­å¯¼å…¥mysqlé©±åŠ¨ é…ç½® é…ç½®datasourceã€mapperåœ°å€ã€mybatis-plusç­‰ï¼Œæœ€å¥½ä½¿ç”¨ymlæ ¼å¼ application.yml123456789101112131415161718192021# mysqlspring: datasource: #type: com.alibaba.druid.pool.DruidDataSource #MySQLé…ç½® driverClassName: com.mysql.cj.jdbc.Driver url: jdbc:mysql://192.168.128.129:3306/gulimall_pms?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai username: root password: root# mappermybatis-plus: # mapper.xmlåœ°å€ mapper-locations: classpath:/mapper/**/*.xml # ä¸»é”®è‡ªå¢ global-config: db-config: id-type: auto #æœåŠ¡å™¨ï¼ˆæ³¨æ„ä¸èƒ½é…ç½®æˆä¸€æ ·çš„ï¼‰server: port: 7000 classpath*è¡¨ç¤ºä¸ä»…æ‰«ææœ¬æ¨¡å—ä¸‹çš„ç±»è·¯å¾„ï¼Œè¿˜åŒ…æ‹¬å¼•å…¥çš„å…¶ä»–ä¾èµ–çš„ç±»è·¯å¾„ GulimallProductApplication1234567@MapperScan(&quot;com.atguigu.gulimall.product.dao&quot;) // mapperåŒ…æ‰«æ@SpringBootApplicationpublic class GulimallProductApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(GulimallProductApplication.class, args); &#125;&#125; å•å…ƒæµ‹è¯•âœ…123456789101112@RunWith(SpringRunner.class) // è®°å¾—åŠ ï¼Œè€Œä¸”è¦å¼•å…¥Junitå’Œspringboot-starter-testä¾èµ–@SpringBootTestclass GulimallProductApplicationTests &#123; @Autowired BrandService brandService; @Test void contextLoads() &#123; BrandEntity be = new BrandEntity(); be.setName(&quot;huawei&quot;); brandService.save(be); &#125;&#125; å‰ç«¯è°ƒç”¨apiæ¥å£è¯·æ±‚åœ°å€é…ç½® æ³¨æ„å»static-&gt;config-&gt;index.jsä¸­é…ç½®æœåŠ¡åœ°å€ 123456789101112131415/** * å¼€å‘ç¯å¢ƒ */; (function () &#123; window.SITE_CONFIG = &#123;&#125;; // apiæ¥å£è¯·æ±‚åœ°å€(88ä¸ºç½‘å…³é…ç½®çš„ç«¯å£å·,apiä¸ºè‡ªå®šä¹‰è§„åˆ™)ï¼Œæ³¨æ„æœ€åä¸è¦æœ‰/ window.SITE_CONFIG[&#x27;baseUrl&#x27;] = &#x27;http://localhost:88/api&#x27;; // cdnåœ°å€ = åŸŸå + ç‰ˆæœ¬å· window.SITE_CONFIG[&#x27;domain&#x27;] = &#x27;./&#x27;; // åŸŸå window.SITE_CONFIG[&#x27;version&#x27;] = &#x27;&#x27;; // ç‰ˆæœ¬å·(å¹´æœˆæ—¥æ—¶åˆ†) window.SITE_CONFIG[&#x27;cdnUrl&#x27;] = window.SITE_CONFIG.domain + window.SITE_CONFIG.version;&#125;)(); ç½‘å…³é…ç½® å†™åœ¨application.ymlä¸­ï¼Œåƒä¸‡æ³¨æ„ç¼©è¿› è§£å†³renren-faseéªŒè¯ç  å› ä¸ºä¿®æ”¹äº†ç«¯å£å·ï¼Œä½†æ˜¯renren-fastç™»å½•æ—¶å€™çš„éªŒè¯ç æ˜¯åœ¨å¥¹æœ¬æ¥çš„ç«¯å£8080æ‰èƒ½è·å–ï¼Œæ‰€ä»¥éœ€è¦è®©ç½‘å…³å‘ç°renren-fast æ”¹å˜å¦‚localhost:88/api/captcha -&gt; localhost:8080/renren-fast/captcha å…ˆç»™renren-fastæŠŠnacosé…å¥½ï¼ˆæ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒçš„éƒ½å¯ä»¥é…ï¼‰ ç¼–å†™ç½‘å…³é…ç½®å¦‚ä¸‹ 123456789101112131415spring: cloud: gateway: routes: - id: admin_route # lbè´Ÿè½½å‡è¡¡ï¼Œè‡ªåŠ¨æŸ¥è¯¢æœåŠ¡åä¸ºrenren-fastçš„æœåŠ¡å™¨ï¼Œä»è€Œè‡ªåŠ¨è·å¾—å…¶ip:port uri: lb://renren-fast predicates: # åŒ¹é…æ‰€æœ‰ä»¥apiå¼€å¤´çš„å‰ç«¯è¯·æ±‚åœ°å€ - Path=/api/** # å®ç°è½¬å‘ filters: # æ³¨æ„è¿™é‡Œçš„å†™æ³•ï¼Œsegmentè¿™ä¸€éƒ¨åˆ†æ•´ä½“ä¸å˜ï¼Œç„¶ååˆ«çš„åœ°æ–¹è¿›è¡Œæ›¿æ¢ # localhost:88/api/xxx -&gt; localhost:8080/renren-fast/xxx - RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\\&#123;segment&#125; è¿˜è¦å¼€å¯è·¨åŸŸ è§£å†³è·¨åŸŸ åœ¨ç½‘å…³å½“ä¸­å†™ä¸€ä¸ªconfigç±»ç»Ÿä¸€é…ç½®è·¨åŸŸï¼Œå¯ 12345678910111213141516171819202122package com.atguigu.gulimall.config;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.web.cors.CorsConfiguration;import org.springframework.web.cors.reactive.CorsWebFilter;import org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource;@Configurationpublic class GulimallCorsConfiguration &#123; @Bean // åŠ å…¥åˆ°springå®¹å™¨ä¸­ç›´æ¥ä½¿ç”¨ public CorsWebFilter crosWebFilter() &#123; UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource(); CorsConfiguration corsConfiguration = new CorsConfiguration(); // é…ç½®è·¨åŸŸ corsConfiguration.addAllowedHeader(&quot;*&quot;); corsConfiguration.addAllowedMethod(&quot;*&quot;); corsConfiguration.addAllowedOrigin(&quot;*&quot;); corsConfiguration.setAllowCredentials(true); // æ˜¯å¦å…è®¸æºå¸¦cookie // pathä¸ºéœ€è¦è·¨åŸŸçš„åœ°å€ï¼ŒcorsConfigurationä¸ºè·¨åŸŸé…ç½® source.registerCorsConfiguration(&quot;/**&quot;, corsConfiguration); return new CorsWebFilter(source); &#125;&#125; è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œä¸€ä¸ªloginï¼ˆmethodsä¸ºOPTIONè¡¨ç¤ºé¢„è§è¯·æ±‚ï¼‰å·²ç»é€šè¿‡äº† ç¬¬äºŒæ˜¯çœŸå®è¯·æ±‚ï¼Œæºå¸¦äº†è¯·æ±‚æ•°æ®ç­‰ è¿™é‡Œæµ‹è¯•è¿˜æ˜¯å¤±è´¥çš„åŸå› æ˜¯renren-fastè‡ªå·±å·²ç»é…ç½®è¿‡äº†è·¨åŸŸï¼Œä¸¤æ¬¡è·¨åŸŸ=æ²¡è·¨ï¼ŒæŠŠrenren-fastçš„configæ–‡ä»¶å¤¹ä¸‹çš„CorsConfigæ³¨é‡Šæ‰å³å¯ åˆ†å¸ƒå¼ç»„ä»¶ spring-cloud-alibaba nacosï¼šæ³¨å†Œä¸­å¿ƒé…ç½®ä¸­å¿ƒ Sentinelï¼šæœåŠ¡å®¹é”™ï¼ˆé™æµã€é™çº§ã€ç†”æ–­ï¼‰ Seataï¼šåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ spring-cloudï¼š Ribbonï¼šè´Ÿè½½å‡è¡¡ Feignï¼šå£°æ˜å¼HTTPå®¢æˆ·ç«¯ï¼ˆè¿œç¨‹æœåŠ¡ï¼‰ Gatewayï¼šAPIç½‘å…³ Sleuthï¼šè°ƒç”¨é“¾ç›‘æ§ spring-cloudå’Œspring-bootç‰ˆæœ¬å¯¹åº” https://start.spring.io/actuator/info ç‰ˆæœ¬è¯´æ˜ Â· alibaba/spring-cloud-alibaba Wiki (github.com) è¿™ä¸ªç‰ˆæœ¬ä¸€å®šè¦å¯¹åº”èµ·æ¥ nacosæ³¨å†Œä¸­å¿ƒä¾èµ– commonæ¨¡å—å³å¯ 123456789101112131415161718192021&lt;dependencies&gt; &lt;!-- ******************** spring-cloud ******************** --&gt; &lt;!-- nacos --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ******************** spring-cloudç‰ˆæœ¬ç®¡ç† ******************** --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;2021.1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; é…ç½®nacosåœ°å€ æ³¨æ„éœ€è¦ä½¿ç”¨çš„æœåŠ¡å°±éœ€è¦åœ¨applicationä¸­é…ç½® 1234567891011121314151617# mysqlspring: datasource: #type: com.alibaba.druid.pool.DruidDataSource #MySQLé…ç½® driverClassName: com.mysql.cj.jdbc.Driver url: jdbc:mysql://192.168.128.129:3306/gulimall_sms?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai username: root password: root #nacosåœ°å€ cloud: nacos: discovery: server-addr: 127.0.0.1:8848 # æœåŠ¡å application: name: gulimall-coupon æ³¨è§£å¼€å¯12345678@MapperScan(&quot;com.atguigu.gulimall.coupon.dao&quot;) // mapperåŒ…æ‰«æ@SpringBootApplication@EnableDiscoveryClient // nacospublic class GulimallCouponApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(GulimallCouponApplication.class, args); &#125;&#125; å¯è§†åŒ–ç•Œé¢ http://127.0.0.1:8848/nacos Feignè¿œç¨‹æœåŠ¡ä¾èµ–1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt; æœåŠ¡æ¥å£ feignæ–‡ä»¶å¤¹ä¸‹å†™ä¸€ä¸ªæ¥å£ï¼Œåœ¨æ¥å£ä¸­æä¾›å£°æ˜éœ€è¦è¢«è°ƒç”¨çš„æœåŠ¡çš„controllerä¸­çš„å¯¹åº”æ–¹æ³•ï¼Œå¹¶ä¸”æŠŠæ˜ å°„åœ°å€æ”¹ä¸ºå…¨åœ°å€ï¼Œå¹¶ä¸”ä¸ºæ¥å£æ·»åŠ @FeignClientæ³¨é‡Šï¼Œvalueä¸ºéœ€è¦è°ƒç”¨çš„æœåŠ¡çš„æœåŠ¡åã€‚ æ³¨è§£å¼€å¯ åœ¨è°ƒç”¨æœåŠ¡çš„å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@EnableFeignClients(basepackages=â€æ¥å£åœ°å€â€) (è¢«è°ƒç”¨çš„æœåŠ¡éœ€è¦åœ¨å¼€å¯nacosæ³¨å†Œå‘ç°) nacosé…ç½®ä¸­å¿ƒä¾èµ–1234&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ åœ¨resourcesæ–‡ä»¶å¤¹ä¸‹çš„bootstrap.propertiesæ–‡ä»¶ä¸­é…ç½®Nacos Configå…ƒæ•°æ®ï¼ˆä¸€å®šå¾—æ˜¯bootstrapï¼‰ ï¼ï¼ï¼ä¸€å®šè¦åœ¨bootstrap.propertiesä¸­é…ç½® 1234567# å½“å‰åº”ç”¨åspring.application.name=gulimall-coupon# nacosé…ç½®ä¸­å¿ƒçš„åœ°å€spring.cloud.nacos.config.server-addr=127.0.0.1:8848# nacosé…ç½®ä¸­å¿ƒä½¿ç”¨çš„å‘½åç©ºé—´ï¼ˆå¦‚æœæ˜¯è‡ªå®šä¹‰çš„å¡«å†™å¯¹åº”idï¼‰å’Œç»„spring.cloud.nacos.config.namespace=d066b643-6689-4ed1-967d-585be9a3b121spring.cloud.nacos.config.group=dev é…ç½®ä¸­å¿ƒ åœ¨é…ç½®ä¸­å¿ƒçš„é…ç½®åˆ—è¡¨ä¸­æ–°å»ºé…ç½®ï¼ŒDataIDä¸ºæœåŠ¡å.propertiesï¼ˆå¦‚æœæ˜¯è¦åŠ è½½application.propertiesçš„è¯ï¼‰ï¼Œç„¶åå¯ä»¥ç²˜è´´ä¸Šé…ç½®å†…å®¹ æ³¨æ„è¿™é‡Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯æŠŠç‰ˆæœ¬éƒ½å’Œè¯¾ä»¶å¯¹åº”ä¸Šæ¯”è¾ƒå¥½ï¼Œè¦ä¸ç„¶ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚ æ³¨è§£å¼€å¯ åœ¨å¯¹åº”controllerä¸­@RefreshScopeï¼Œå½“é…ç½®ä¸­å¿ƒçš„é…ç½®å€¼æ”¹å˜çš„æ—¶å€™ï¼Œå¯¹åº”æœåŠ¡ä¸­çš„é…ç½®å€¼ä¹Ÿä¼šæ”¹å˜ 1234567891011121314151617@RefreshScope // å¼€å¯é…ç½®ä¸­å¿ƒåŠ¨æ€è·å–é…ç½®@RestController@RequestMapping(&quot;coupon/coupon&quot;)public class CouponController &#123; @Value(&quot;$&#123;coupon.user.name&#125;&quot;)// ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ private String name; @Value(&quot;$&#123;coupon.user.age&#125;&quot;) private String age; /** * testé…ç½®ä¸­å¿ƒ */ @RequestMapping(&quot;/test&quot;) //@RequiresPermissions(&quot;coupon:coupon:list&quot;) public R test() &#123; return R.ok().put(&quot;name&quot;, name).put(&quot;age&quot;, age); &#125;&#125; å¤šé…ç½®é›† 12345678910111213# nacosé…ç½®ä¸­å¿ƒä½¿ç”¨çš„å‘½åç©ºé—´ï¼ˆå¦‚æœæ˜¯è‡ªå®šä¹‰çš„å¡«å†™å¯¹åº”idï¼‰å’Œç»„spring.cloud.nacos.config.namespace=d066b643-6689-4ed1-967d-585be9a3b121spring.cloud.nacos.config.group=dev# å¤šé…ç½®é›†spring.cloud.nacos.config.ext-config[0].data-id=datasource.ymlspring.cloud.nacos.config.ext-config[0].group=devspring.cloud.nacos.config.ext-config[0].refresh=truespring.cloud.nacos.config.ext-config[1].data-id=mybatis.ymlspring.cloud.nacos.config.ext-config[1].group=devspring.cloud.nacos.config.ext-config[1].refresh=truespring.cloud.nacos.config.ext-config[2].data-id=others.ymlspring.cloud.nacos.config.ext-config[2].group=devspring.cloud.nacos.config.ext-config[2].refresh=true å…¶ä»– å‘½åç©ºé—´ï¼šç”¨äºé…ç½®éš”ç¦»ï¼Œå¯ä»¥é€šè¿‡åœ¨bootstrap.propertiesé…ç½®æ–‡ä»¶ä¿®æ”¹ä»è€Œä¿®æ”¹å¯¹åº”å†…å®¹ ä¸åŒçš„ç”Ÿäº§ç¯èŠ‚ä¸‹ä½¿ç”¨ä¸åŒå‘½åç©ºé—´éš”ç¦» ä¸åŒå¾®æœåŠ¡ä¹‹é—´éš”ç¦» é…ç½®é›†ï¼šæ‰€æœ‰çš„é…ç½®çš„é›†åˆ é…ç½®é›†IDï¼šå³nacosä¸­çš„Data ID é…ç½®åˆ†ç»„ï¼šå³nacosä¸­çš„groupï¼Œä¹Ÿå¯ä»¥éš”ç¦» Gatewayç½‘å…³æ¨¡å— åˆ›å»ºGatewayæ¨¡å—ï¼Œè®°å¾—å¼•å…¥commonï¼Œåœ¨çˆ¶æ¨¡å—ä¸­æ·»åŠ model å¯åŠ¨ç±»ä¸ŠåŠ å¦‚ä¸‹ 12@EnableDiscoveryClient //nacos@SpringBootApplication(exclude = &#123;DataSourceAutoConfiguration.class&#125;) ä¾èµ–1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶application.properties 123456#nacosæ³¨å†Œä¸­å¿ƒspring.cloud.nacos.discovery.server-addr=127.0.0.1.8848#åº”ç”¨åspring.application.name=gulimall-gateway#æœåŠ¡ç«¯å£å·server.port=12000 ç½‘å…³é…ç½®12345678910111213spring: cloud: gateway: routes: - id: test_route uri: https://www.baidu.com predicates: - Query=url,baidu - id: qq_route uri: https://www.qq.com predicates: - Query=url,qq urlä¸ºè½¬å‘çš„åœ°å€ï¼Œpredicatesæ–­è¨€ä¸ºåˆ¤æ–­æ¡ä»¶ï¼ˆè¯¦è§å®˜ç½‘ï¼‰ï¼Œä»¥ä¸Šçš„æ„æ€ä¸ºå½“uriä¸­æœ‰ä¸€ä¸ªkey valueå¯¹åº”url=baiduã€url=qqï¼Œåˆ™è¿›è¡Œè·³è½¬ã€‚ æµ‹è¯•åœ°å€ï¼šhttp://localhost:88/?url=baidu æ¥å£æ–‡æ¡£1ã€åˆ†é¡µè¯·æ±‚å‚æ•° - è°·ç²’å•†åŸ - æ˜“æ–‡æ¡£ (easydoc.net) å•†å“æœåŠ¡ - ä¸‰çº§åˆ†ç±»ï¼ˆåå°ï¼‰ productæ¨¡å—ï¼Œcategoryç›¸å…³ nacosé…ç½®application.yml123456789101112# mysqlspring: # nacos æ³¨å†Œä¸­å¿ƒ cloud: nacos: discovery: # nacosåœ°å€ server-addr: 127.0.0.1:8848 # æœåŠ¡å application: name: gulimall-product bootstrap.properties123456# å½“å‰åº”ç”¨åspring.application.name=gulimall-product# nacosé…ç½®ä¸­å¿ƒçš„åœ°å€spring.cloud.nacos.config.server-addr=127.0.0.1:8848# nacosé…ç½®ä¸­å¿ƒä½¿ç”¨çš„å‘½åç©ºé—´ï¼ˆå¦‚æœæ˜¯è‡ªå®šä¹‰çš„å¡«å†™å¯¹åº”idï¼‰å’Œç»„spring.cloud.nacos.config.namespace=415d4381-f509-4bb6-8ad8-c0497e20d904 ç½‘å…³é…ç½® è¿™é‡Œå‘å¾ˆå¤šï¼Œé¡ºåºï¼Œè¿˜æœ‰ç¼©è¿›ï¼Œè¿˜æœ‰æ–­è¨€åŒ¹é…è¿˜æœ‰è½¬å‘çš„å†™æ³• 123456789101112131415161718192021222324spring: cloud: gateway: routes: - id: product_route uri: lb://gulimall-product predicates: - Path=/api/product/** # å®ç°è½¬å‘ filters: # localhost:88/api/product/xxx -&gt; localhost:10000/product/xxx - RewritePath=/api/(?&lt;segment&gt;.*),/$\\&#123;segment&#125; # æ³¨æ„é¡ºåºï¼Œé«˜ç²¾åº¦çš„åœ¨å‰ - id: admin_route # lbè´Ÿè½½å‡è¡¡ï¼Œè‡ªåŠ¨æŸ¥è¯¢æœåŠ¡åä¸ºrenren-fastçš„æœåŠ¡å™¨ï¼Œä»è€Œè‡ªåŠ¨è·å¾—å…¶ip:port uri: lb://renren-fast predicates: # åŒ¹é…æ‰€æœ‰ä»¥apiå¼€å¤´çš„å‰ç«¯è¯·æ±‚åœ°å€ - Path=/api/** # å®ç°è½¬å‘ filters: # æ³¨æ„è¿™é‡Œçš„å†™æ³•ï¼Œsegmentè¿™ä¸€éƒ¨åˆ†æ•´ä½“ä¸å˜ï¼Œç„¶ååˆ«çš„åœ°æ–¹è¿›è¡Œæ›¿æ¢ # localhost:88/api/xxx -&gt; localhost:8080/renren-fast/xxx - RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\\&#123;segment&#125; é€’å½’æ ‘å½¢ç»“æ„æŸ¥è¯¢æ‰€æœ‰åˆ†ç±»ï¼ˆåç«¯ï¼‰CategoryEntity123456789@Data@TableName(&quot;pms_category&quot;)public class CategoryEntity implements Serializable &#123; /** * å­åˆ†ç±» */ @TableField(exist = false) // è¡¨ç¤ºè¯¥å±æ€§åœ¨æ•°æ®è¡¨ä¸­ä¸å­˜åœ¨ private List&lt;CategoryEntity&gt; children;&#125; CategoryController12345678910111213141516@RestController@RequestMapping(&quot;product/category&quot;)public class CategoryController &#123; @Autowired private CategoryService categoryService; /** * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰åˆ†ç±»ï¼Œå¹¶ä¸”ä»¥æ ‘å½¢ç»“æ„ç»„åˆ */ @RequestMapping(&quot;/list/tree&quot;) public R listWithTree() &#123; List&lt;CategoryEntity&gt; list = categoryService.listWithTree(); return R.ok().put(&quot;data&quot;, list); &#125;&#125; CategoryServiceImpl123456789101112131415161718192021222324252627282930313233343536373839404142434445@Service(&quot;categoryService&quot;)public class CategoryServiceImpl extends ServiceImpl&lt;CategoryDao, CategoryEntity&gt; implements CategoryService &#123; /** * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰åˆ†ç±»ï¼Œå¹¶ä¸”ä»¥æ ‘å½¢ç»“æ„ç»„åˆ * * @return */ @Override public List&lt;CategoryEntity&gt; listWithTree() &#123; // 1ã€æŸ¥å‡ºæ‰€æœ‰åˆ†ç±» List&lt;CategoryEntity&gt; categories = baseMapper.selectList(null); // 2ã€ç»„è£…æ ‘å½¢ç»“æ„ // æµå¼ã€è¿‡æ»¤ã€mapæ˜ å°„ã€æ’åºã€é€’å½’ã€lambda List&lt;CategoryEntity&gt; level1Menus = categories.stream().filter((categoryEntity) -&gt; &#123; return categoryEntity.getParentCid() == 0; &#125;).map(categoryEntity -&gt; &#123; categoryEntity.setChildren(getChildrens(categoryEntity, categories)); return categoryEntity; &#125;).sorted((ce1, ce2) -&gt; &#123; return (ce1.getSort() == null ? 0 : ce1.getSort()) - (ce2.getSort() == null ? 0 : ce2.getSort()); &#125;).collect(Collectors.toList()); return level1Menus; &#125; /** * é€’å½’æŸ¥è¯¢æ‰€æœ‰å­åˆ†ç±» * * @param father * @param entityList * @return */ private List&lt;CategoryEntity&gt; getChildrens(CategoryEntity father, List&lt;CategoryEntity&gt; entityList) &#123; List&lt;CategoryEntity&gt; childList = entityList.stream().filter((categoryEntity) -&gt; &#123; // å–å‡ºæ¯ä¸€ä¸ªentityï¼Œåˆ¤æ–­å…¶æ˜¯å¦ç¬¦åˆï¼Œç¬¦åˆçš„ç•™ä¸‹ return categoryEntity.getParentCid() == father.getCatId(); &#125;).map(categoryEntity -&gt; &#123; // å–å‡ºæ¯ä¸€ä¸ªentityï¼Œä¸ºå…¶è®¾ç½®childrenï¼ˆä½¿ç”¨é€’å½’ï¼‰ categoryEntity.setChildren(getChildrens(categoryEntity, entityList)); return categoryEntity; &#125;).sorted((ce1, ce2) -&gt; &#123; // è¿™é‡Œé˜²æ­¢getSort()è¿”å›nullï¼Œç„¶åæ ¹æ®sortæƒé‡æ’åº return (ce1.getSort() == null ? 0 : ce1.getSort()) - (ce2.getSort() == null ? 0 : ce2.getSort()); &#125;).collect(Collectors.toList()); return childList; &#125;&#125; ä¸Šæ¥å°±æ”¾äº†ä¸ªå¤§æ‹›ï¼Œjava8çš„æ–°ç‰¹æ€§ æ˜¾ç¤ºæ‰€æœ‰åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰è·¯ç”±é…ç½® å¯åŠ¨renrenfastå’Œrenrenfase-vue ç³»ç»Ÿç®¡ç† -&gt; èœå•ç®¡ç† -&gt; æ·»åŠ ç›®å½•å’Œèœå•ï¼ˆæˆ‘çš„å¦ˆå‘€å¯è§†åŒ–æ“ä½œè¿™ä¹Ÿå¤ªæ£’äº†å§ï¼‰ è·¯å¾„ä¸­å¡«å†™/ä¼šè¢«æ›¿æ¢æˆ-ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®è¿™ä¸ªå¯¹åº”src-&gt;views-&gt;modulesä¸‹çš„è·¯å¾„ å³http://localhost:8001/#/product-categoryå¯¹åº”æ–‡ä»¶å¤¹src-&gt;views-&gt;modules-&gt;product-&gt;category.vue vueé¡µé¢ renren-fast-vue\\src\\views\\modules\\product\\category.vue 1234567891011121314151617181920212223242526272829303132333435363738&lt;!-- å•†å“ç®¡ç†-åˆ†ç±»ç»´æŠ¤ --&gt;&lt;template&gt; &lt;el-tree :data=&quot;menus&quot; :props=&quot;defaultProps&quot; @node-click=&quot;handleNodeClick&quot; &gt;&lt;/el-tree&gt;&lt;/template&gt;&lt;script&gt;export default &#123; components: &#123;&#125;, data() &#123; return &#123; menus: [], defaultProps: &#123; children: &quot;children&quot;, // å­èŠ‚ç‚¹å±æ€§ label: &quot;name&quot; //æ˜¾ç¤ºçš„å±æ€§ &#125; &#125;; &#125;, methods: &#123; // è·å–æ‰€æœ‰åˆ†ç±» getMenus() &#123; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/list/tree&quot;), method: &quot;get&quot; &#125;).then((&#123; data &#125;) =&gt; &#123; // è¿™é‡Œdataä½¿ç”¨äº†è§£æ„ console.log(&quot;è°ƒç”¨apiè·å¾—èœå•æ•°æ®&quot; + data.data); this.menus = data.data; &#125;); &#125; &#125;, created() &#123; this.getMenus(); &#125;,&#125;;&lt;/script&gt; åˆ é™¤åˆ†ç±»ï¼ˆåç«¯ï¼‰é€»è¾‘åˆ é™¤ åœ¨application.ymlä¸­é…ç½® 1234567891011# mybatismybatis-plus: # mapper.xmlåœ°å€ mapper-locations: classpath:/mapper/**/*.xml global-config: db-config: # ä¸»é”®è‡ªå¢ id-type: auto # é€»è¾‘åˆ é™¤ logic-delete-value: 0 logic-not-delete-value: 1 åœ¨å¯¹åº”å®ä½“ç±»çš„å­—æ®µä¸Šæ·»åŠ æ³¨è§£@TableLogic 123456789@Data@TableName(&quot;pms_category&quot;)public class CategoryEntity implements Serializable &#123; /** * é€»è¾‘åˆ é™¤ */ @TableLogic(value = &quot;1&quot;, delval = &quot;0&quot;) private Integer showStatus;&#125; CategoryController12345678910111213141516@RestController@RequestMapping(&quot;product/category&quot;)public class CategoryController &#123; @Autowired private CategoryService categoryService; /** * åˆ é™¤åˆ†ç±»ï¼Œåˆ¤æ–­æ˜¯å¦è¢«å…¶ä»–å¼•ç”¨ */ @PostMapping(&quot;/delete&quot;) //@RequiresPermissions(&quot;product:category:delete&quot;) public R deleteWithoutUse(@RequestBody Long[] catIds) &#123; // æ£€æŸ¥å½“å‰åˆ é™¤çš„èœå•æ˜¯å¦è¢«å…¶ä»–çš„åœ°æ–¹å¼•ç”¨ categoryService.removeByIdsWithoutUse(Arrays.asList(catIds)); return R.ok(); &#125;&#125; CategoryServiceImpl12345678910111213@Service(&quot;categoryService&quot;)public class CategoryServiceImpl extends ServiceImpl&lt;CategoryDao, CategoryEntity&gt; implements CategoryService &#123; /** * åˆ é™¤åˆ†ç±»ï¼Œåˆ¤æ–­æ˜¯å¦è¢«å…¶ä»–å¼•ç”¨ * * @param asList */ @Override public void removeByIdsWithoutUse(List&lt;Long&gt; asList) &#123; //TODO æ£€æŸ¥æ˜¯å¦è¢«å…¶ä»–çš„ä¸œè¥¿å¼•ç”¨ baseMapper.deleteBatchIds(asList); &#125;&#125; åˆ é™¤åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798&lt;!-- å•†å“ç®¡ç†-åˆ†ç±»ç»´æŠ¤ --&gt;&lt;template&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º å¼€å§‹ ====================== --&gt; &lt;!-- node-key=&quot;catId&quot; å…¶å€¼ä¸ºèŠ‚ç‚¹æ•°æ®ä¸­çš„ä¸€ä¸ªå­—æ®µå :expand-on-click-node=&quot;false&quot; è¡¨ç¤ºè®¾ç½®å±•å¼€èŠ‚ç‚¹çš„ç‚¹å‡»ä½ç½®ï¼ŒFALSEåªæœ‰å½“ç‚¹å‡»ç®­å¤´çš„æ—¶å€™æ‰å±•å¼€ :default-expanded-keys=&quot;[2, 3]&quot; è¡¨ç¤ºé»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ --&gt; &lt;el-tree node-key=&quot;catId&quot; show-checkbox :data=&quot;menus&quot; :props=&quot;defaultProps&quot; :expand-on-click-node=&quot;false&quot; :default-expanded-keys=&quot;expandedKey&quot; &gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® å¼€å§‹ ====================== --&gt; &lt;!-- ä½¿ç”¨slotæ·»åŠ å¯æ“ä½œæ€§æŒ‰é’® --&gt; &lt;!-- nodeä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼ˆä¸å’Œåç«¯ä¸­entityå¯¹åº”ï¼Œè€Œæ˜¯elementè‡ªå®šä¹‰çš„ï¼‰ï¼Œdataä¸ºè¯¥èŠ‚ç‚¹çš„æ•°æ® --&gt; &lt;span class=&quot;custom-tree-node&quot; slot-scope=&quot;&#123; node, data &#125;&quot;&gt; &lt;span&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt; &lt;span&gt; &lt;!-- è¿™é‡Œéœ€è¦æœ‰æ‰€åˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºå¯¹åº”æŒ‰é’® --&gt; &lt;el-button v-if=&quot;node.level &lt;= 2&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;() =&gt; append(data)&quot; &gt; Append &lt;/el-button&gt; &lt;el-button v-if=&quot;node.childNodes.length == 0&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;() =&gt; remove(node, data)&quot; &gt; Delete &lt;/el-button&gt; &lt;/span&gt; &lt;/span&gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® ç»“æŸ ====================== --&gt; &lt;/el-tree&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º ç»“æŸ ====================== --&gt;&lt;/template&gt;&lt;script&gt;export default &#123; components: &#123;&#125;, data() &#123; return &#123; menus: [], // èœå•åˆ—è¡¨ defaultProps: &#123; children: &quot;children&quot;, // å­èŠ‚ç‚¹å±æ€§ label: &quot;name&quot; // æ˜¾ç¤ºçš„å±æ€§ &#125;, expandedKey: [] // é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ &#125;; &#125;, methods: &#123; // æŒ‰é’®æ“ä½œ append(data) &#123;&#125;, remove(node, data) &#123; var ids = [data.catId]; this.$confirm(`ç¡®å®šåˆ é™¤ã€$&#123;data.name&#125;ã€‘èœå•å—?`, &quot;æç¤º&quot;, &#123; confirmButtonText: &quot;ç¡®å®š&quot;, cancelButtonText: &quot;å–æ¶ˆ&quot;, type: &quot;warning&quot; &#125;) .then(() =&gt; &#123; // è°ƒç”¨API this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/delete&quot;), method: &quot;post&quot;, data: this.$http.adornData(ids, false) &#125;).then((&#123; data &#125;) =&gt; &#123; if (data &amp;&amp; data.code === 0) &#123; this.$message(&#123; message: &quot;åˆ é™¤æˆåŠŸ&quot;, type: &quot;success&quot;, duration: 800, onClose: () =&gt; &#123; // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [node.parent.data.catId]; &#125; &#125;); &#125; else &#123; this.$message.error(data.msg); &#125; &#125;); &#125;) .catch(() =&gt; &#123;&#125;); &#125; &#125;,&#125;;&lt;/script&gt; æ·»åŠ åˆ†ç±»ï¼ˆåç«¯ï¼‰ å·²æœ‰ æ·»åŠ åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127&lt;!-- å•†å“ç®¡ç†-åˆ†ç±»ç»´æŠ¤ --&gt;&lt;template&gt; &lt;div&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º å¼€å§‹ ====================== --&gt; &lt;!-- node-key=&quot;catId&quot; å…¶å€¼ä¸ºèŠ‚ç‚¹æ•°æ®ä¸­çš„ä¸€ä¸ªå­—æ®µå :expand-on-click-node=&quot;false&quot; è¡¨ç¤ºè®¾ç½®å±•å¼€èŠ‚ç‚¹çš„ç‚¹å‡»ä½ç½®ï¼ŒFALSEåªæœ‰å½“ç‚¹å‡»ç®­å¤´çš„æ—¶å€™æ‰å±•å¼€ :default-expanded-keys=&quot;[2, 3]&quot; è¡¨ç¤ºé»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ --&gt; &lt;el-tree node-key=&quot;catId&quot; show-checkbox :data=&quot;menus&quot; :props=&quot;defaultProps&quot; :expand-on-click-node=&quot;false&quot; :default-expanded-keys=&quot;expandedKey&quot; &gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® å¼€å§‹ ====================== --&gt; &lt;!-- ä½¿ç”¨slotæ·»åŠ å¯æ“ä½œæ€§æŒ‰é’® --&gt; &lt;!-- nodeä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼ˆä¸å’Œåç«¯ä¸­entityå¯¹åº”ï¼Œè€Œæ˜¯elementè‡ªå®šä¹‰çš„ï¼‰ï¼Œdataä¸ºè¯¥èŠ‚ç‚¹çš„æ•°æ® --&gt; &lt;span class=&quot;custom-tree-node&quot; slot-scope=&quot;&#123; node, data &#125;&quot;&gt; &lt;span&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt; &lt;span&gt; &lt;!-- è¿™é‡Œéœ€è¦æœ‰æ‰€åˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºå¯¹åº”æŒ‰é’® --&gt; &lt;el-button v-if=&quot;node.level &lt;= 2&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;() =&gt; append(data)&quot; &gt; Append &lt;/el-button&gt; &lt;el-button v-if=&quot;node.childNodes.length == 0&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;() =&gt; remove(node, data)&quot; &gt; Delete &lt;/el-button&gt; &lt;/span&gt; &lt;/span&gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® ç»“æŸ ====================== --&gt; &lt;/el-tree&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º ç»“æŸ ====================== --&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† å¼€å§‹ ====================== --&gt; &lt;el-dialog title=&quot;æ·»åŠ åˆ†ç±»èœå•&quot; :visible.sync=&quot;dialogVisible&quot; width=&quot;30%&quot; center &gt; &lt;el-form :model=&quot;category&quot;&gt; &lt;el-form-item label=&quot;åˆ†ç±»å&quot;&gt; &lt;el-input v-model=&quot;category.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;addCategory()&quot;&gt;ç¡® å®š&lt;/el-button&gt; &lt;/div&gt; &lt;/el-dialog&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† ç»“æŸ ====================== --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; components: &#123;&#125;, data() &#123; return &#123; menus: [], // èœå•åˆ—è¡¨ defaultProps: &#123; // èœå•æ ‘å±æ€§ children: &quot;children&quot;, // å­èŠ‚ç‚¹å±æ€§ label: &quot;name&quot; // æ˜¾ç¤ºçš„å±æ€§ &#125;, expandedKey: [], // é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ dialogVisible: false, // æ˜¯å¦æ‰“å¼€æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† category: &#123; name: &quot;&quot;, parentCid: 0, catLevel: 0, showStatus: 1, sort: 0 &#125; // èœå•å¯¹è±¡ &#125;; &#125;, methods: &#123; // æ·»åŠ åˆ†ç±»èœå• addCategory() &#123; // è°ƒç”¨api this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/save&quot;), method: &quot;post&quot;, data: this.$http.adornData(this.category, false) &#125;) .then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;ä¿å­˜æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // å…³é—­å¯¹è¯æ¡† this.dialogVisible = false; // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®æ•°ç»„(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [this.category.parentCid]; &#125;) .catch(result =&gt; &#123; this.$message(&#123; message: &quot;ä¿å­˜å¤±è´¥&quot;, type: &quot;error&quot; &#125;); &#125;); &#125;, // æ‰“å¼€æ·»åŠ èœå•å¯¹è¯æ¡† append(data) &#123; this.dialogVisible = true; // åˆå§‹åŒ–categoryå¯¹è±¡ this.category.name = &quot;&quot;; this.category.parentCid = data.catId; this.category.catLevel = data.catLevel * 1 + 1; &#125;, &#125;&#125;;&lt;/script&gt; ä¿®æ”¹åˆ†ç±»ï¼ˆåç«¯ï¼‰ å·²æœ‰ ä¿®æ”¹åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰ å®ç°ç®€å•åœ°ä¿¡æ¯ä¿®æ”¹ï¼ŒåŒ…æ‹¬nameï¼Œiconï¼ŒproductUnit 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140&lt;!-- å•†å“ç®¡ç†-åˆ†ç±»ç»´æŠ¤ --&gt;&lt;template&gt; &lt;div&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º å¼€å§‹ ====================== --&gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® å¼€å§‹ ====================== --&gt; &lt;!-- ä½¿ç”¨slotæ·»åŠ å¯æ“ä½œæ€§æŒ‰é’® --&gt; &lt;!-- nodeä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼ˆä¸å’Œåç«¯ä¸­entityå¯¹åº”ï¼Œè€Œæ˜¯elementè‡ªå®šä¹‰çš„ï¼‰ï¼Œdataä¸ºè¯¥èŠ‚ç‚¹çš„æ•°æ® --&gt; &lt;span class=&quot;custom-tree-node&quot; slot-scope=&quot;&#123; node, data &#125;&quot;&gt; &lt;span&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt; &lt;span&gt; &lt;el-button type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;openDialogWithInfo(data)&quot;&gt; ä¿®æ”¹ &lt;/el-button&gt; &lt;/span&gt; &lt;/span&gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® ç»“æŸ ====================== --&gt; &lt;/el-tree&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º ç»“æŸ ====================== --&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† å¼€å§‹ ====================== --&gt; &lt;el-dialog :title=&quot;dialogTitle&quot; :visible.sync=&quot;dialogVisible&quot; :close-on-click-modal=&quot;false&quot; width=&quot;30%&quot; &gt; &lt;el-form :model=&quot;category&quot;&gt; &lt;el-form-item label=&quot;åˆ†ç±»å&quot;&gt; &lt;el-input v-model=&quot;category.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;å›¾è¡¨&quot;&gt; &lt;el-input v-model=&quot;category.icon&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®¡é‡å•ä½&quot;&gt; &lt;el-input v-model=&quot;category.productUnit&quot; autocomplete=&quot;off&quot; &gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;addOrUpdate()&quot;&gt;ç¡® å®š&lt;/el-button&gt; &lt;/div&gt; &lt;/el-dialog&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† ç»“æŸ ====================== --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; components: &#123;&#125;, data() &#123; return &#123; menus: [], // èœå•åˆ—è¡¨ defaultProps: &#123; // èœå•æ ‘å±æ€§ children: &quot;children&quot;, // å­èŠ‚ç‚¹å±æ€§ label: &quot;name&quot; // æ˜¾ç¤ºçš„å±æ€§ &#125;, expandedKey: [], // é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ dialogVisible: false, // æ˜¯å¦æ‰“å¼€æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† dialogType: &quot;&quot;, // å¯¹è¯æ¡†ç”¨äºæ·»åŠ è¿˜æ˜¯ä¿®æ”¹ dialogTitle: &quot;&quot;, // å¯¹è¯æ¡†æ ‡é¢˜ category: &#123; name: &quot;&quot;, catId: null, parentCid: 0, catLevel: 0, showStatus: 1, sort: 0, icon: &quot;&quot;, productUnit: &quot;&quot; &#125; // èœå•å¯¹è±¡ &#125;; &#125;, methods: &#123; // æ‰“å¼€æ·»åŠ èœå•å¯¹è¯æ¡† openDialog(data) &#123; this.dialogVisible = true; this.dialogType = &quot;add&quot;; this.dialogTitle = &quot;æ·»åŠ åˆ†ç±»&quot;; // åˆå§‹åŒ–categoryå¯¹è±¡ this.category.catId = null; this.category.name = &quot;&quot;; this.category.parentCid = data.catId; this.category.icon = &quot;&quot;; this.category.productUnit = &quot;&quot;; this.category.catLevel = data.catLevel * 1 + 1; &#125;, // æ‰“å¼€ä¿®æ”¹èœå•å¯¹è¯æ¡† openDialogWithInfo(data) &#123; this.dialogVisible = true; this.dialogType = &quot;update&quot;; this.dialogTitle = &quot;ä¿®æ”¹åˆ†ç±»&quot;; // è°ƒç”¨æ¥å£è·å–å¯¹åº”idçš„ä¿¡æ¯ï¼Œå¹¶åˆå§‹åŒ–categoryå¯¹è±¡ this.$http(&#123; url: this.$http.adornUrl(`/product/category/info/$&#123;data.catId&#125;`), method: &quot;get&quot; &#125;).then((&#123; data &#125;) =&gt; &#123; this.category.catId = data.data.catId; // åªä¿®æ”¹è¿™å‡ ä¸ªå€¼ this.category.name = data.data.name; this.category.icon = data.data.icon; this.category.productUnit = data.data.productUnit; // ç”¨äºä¿®æ”¹å®Œä¹‹åå±•å¼€çˆ¶èœå• this.category.parentCid = data.data.parentCid; &#125;); &#125;, // å¯¹è¯æ¡†ç¡®å®šæŒ‰é’®åˆ¤æ–­ addOrUpdate() &#123; if (this.dialogType == &quot;update&quot;) &#123; this.updateCategory(); &#125; else if (this.dialogType == &quot;add&quot;) &#123; this.addCategory(); &#125; &#125;, // ä¿®æ”¹åˆ†ç±»èœå• updateCategory() &#123; // ä½¿ç”¨è§£æ„ var &#123; catId, name, icon, productUnit &#125; = this.category; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/update&quot;), method: &quot;post&quot;, // ä¸èƒ½ç›´æ¥å‘é€this.categoryå¯¹è±¡,è€Œæ˜¯é‡æ–°å°è£…éœ€è¦ä¿®æ”¹çš„å¯¹è±¡ data: this.$http.adornData(&#123; catId, name, icon, productUnit &#125;, false) &#125;).then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;ä¿®æ”¹æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // å…³é—­å¯¹è¯æ¡† this.dialogVisible = false; // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®æ•°ç»„(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [this.category.parentCid]; &#125;); &#125;, &#125;&#125;;&lt;/script&gt; æ‹–æ‹½ä¿®æ”¹åˆ†ç±»ï¼ˆåç«¯ï¼‰12345678/** * æ‰¹é‡ä¿®æ”¹ */@RequestMapping(&quot;/update/sort&quot;)public R updateSort(@RequestBody CategoryEntity[] category) &#123; categoryService.updateBatchById(Arrays.asList(category)); return R.ok();&#125; æ‹–æ‹½ä¿®æ”¹åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰ el-tree å¼€å¯draggableå³å¯ï¼Œallow-dropåˆ¤æ–­ è¿™ä¸€partå€¼å¾—é‡å¤è§‚çœ‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406&lt;!-- å•†å“ç®¡ç†-åˆ†ç±»ç»´æŠ¤ --&gt;&lt;template&gt; &lt;div&gt; &lt;el-switch v-model=&quot;draggable&quot; active-text=&quot;å¼€å¯æ‹–æ‹½æ’åº&quot; inactive-text=&quot;å…³é—­æ‹–æ‹½æ’åº&quot; &gt; &lt;/el-switch&gt; &lt;el-button v-if=&quot;draggable&quot; @click=&quot;batchSave&quot;&gt; æ‰¹é‡ä¿å­˜ &lt;/el-button&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º å¼€å§‹ ====================== --&gt; &lt;!-- node-key=&quot;catId&quot; å…¶å€¼ä¸ºèŠ‚ç‚¹æ•°æ®ä¸­çš„ä¸€ä¸ªå­—æ®µå :expand-on-click-node=&quot;false&quot; è¡¨ç¤ºè®¾ç½®å±•å¼€èŠ‚ç‚¹çš„ç‚¹å‡»ä½ç½®ï¼ŒFALSEåªæœ‰å½“ç‚¹å‡»ç®­å¤´çš„æ—¶å€™æ‰å±•å¼€ :default-expanded-keys=&quot;[2, 3]&quot; è¡¨ç¤ºé»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ draggable å¼€å¯å¯æ‹–æ‹½çš„æ–¹å¼ --&gt; &lt;el-tree node-key=&quot;catId&quot; show-checkbox :data=&quot;menus&quot; :props=&quot;defaultProps&quot; :expand-on-click-node=&quot;false&quot; :default-expanded-keys=&quot;expandedKey&quot; :draggable=&quot;draggable&quot; :allow-drop=&quot;allowDrop&quot; @node-drop=&quot;handleDrop&quot; &gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® å¼€å§‹ ====================== --&gt; &lt;!-- ä½¿ç”¨slotæ·»åŠ å¯æ“ä½œæ€§æŒ‰é’® --&gt; &lt;!-- nodeä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼ˆä¸å’Œåç«¯ä¸­entityå¯¹åº”ï¼Œè€Œæ˜¯elementè‡ªå®šä¹‰çš„ï¼‰ï¼Œdataä¸ºè¯¥èŠ‚ç‚¹çš„æ•°æ® --&gt; &lt;span class=&quot;custom-tree-node&quot; slot-scope=&quot;&#123; node, data &#125;&quot;&gt; &lt;span&gt;&#123;&#123; node.label &#125;&#125;&lt;/span&gt; &lt;span&gt; &lt;!-- è¿™é‡Œéœ€è¦æœ‰æ‰€åˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºå¯¹åº”æŒ‰é’® --&gt; &lt;el-button v-if=&quot;node.level &lt;= 2&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;openDialog(data)&quot; &gt; æ·»åŠ  &lt;/el-button&gt; &lt;el-button type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;openDialogWithInfo(data)&quot;&gt; ä¿®æ”¹ &lt;/el-button&gt; &lt;el-button v-if=&quot;node.childNodes.length == 0&quot; type=&quot;text&quot; size=&quot;mini&quot; @click=&quot;remove(node, data)&quot; &gt; åˆ é™¤ &lt;/el-button&gt; &lt;/span&gt; &lt;/span&gt; &lt;!-- ====================== æ“ä½œæŒ‰é’® ç»“æŸ ====================== --&gt; &lt;/el-tree&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º ç»“æŸ ====================== --&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† å¼€å§‹ ====================== --&gt; &lt;el-dialog :title=&quot;dialogTitle&quot; :visible.sync=&quot;dialogVisible&quot; :close-on-click-modal=&quot;false&quot; width=&quot;30%&quot; &gt; &lt;el-form :model=&quot;category&quot;&gt; &lt;el-form-item label=&quot;åˆ†ç±»å&quot;&gt; &lt;el-input v-model=&quot;category.name&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;å›¾è¡¨&quot;&gt; &lt;el-input v-model=&quot;category.icon&quot; autocomplete=&quot;off&quot;&gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®¡é‡å•ä½&quot;&gt; &lt;el-input v-model=&quot;category.productUnit&quot; autocomplete=&quot;off&quot; &gt;&lt;/el-input&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;addOrUpdate()&quot;&gt;ç¡® å®š&lt;/el-button&gt; &lt;/div&gt; &lt;/el-dialog&gt; &lt;!-- ====================== æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† ç»“æŸ ====================== --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; components: &#123;&#125;, data() &#123; return &#123; menus: [], // èœå•åˆ—è¡¨ defaultProps: &#123; // èœå•æ ‘å±æ€§ children: &quot;children&quot;, // å­èŠ‚ç‚¹å±æ€§ label: &quot;name&quot; // æ˜¾ç¤ºçš„å±æ€§ &#125;, expandedKey: [], // é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ dialogVisible: false, // æ˜¯å¦æ‰“å¼€æ·»åŠ åˆ†ç±»çš„å¯¹è¯æ¡† dialogType: &quot;&quot;, // å¯¹è¯æ¡†ç”¨äºæ·»åŠ è¿˜æ˜¯ä¿®æ”¹ dialogTitle: &quot;&quot;, // å¯¹è¯æ¡†æ ‡é¢˜ category: &#123; name: &quot;&quot;, catId: null, parentCid: 0, catLevel: 0, showStatus: 1, sort: 0, icon: &quot;&quot;, productUnit: &quot;&quot; &#125;, // èœå•å¯¹è±¡ pCid: 0, maxLevel: 0, // ç”¨äºè®°å½•å­èŠ‚ç‚¹æœ€æ·±æ·±åº¦ updateNodes: [], //æ‰€æœ‰éœ€è¦ä¿®æ”¹çš„èŠ‚ç‚¹ draggable: false // å¯å¦æ‹–æ‹½ &#125;; &#125;, created() &#123; this.getMenus(); &#125;, methods: &#123; batchSave() &#123; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/update/sort&quot;), method: &quot;post&quot;, data: this.$http.adornData(this.updateNodes, false) &#125;) .then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;èœå•é¡ºåºä¿®æ”¹æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // åˆ·æ–°,åˆå§‹åŒ– this.updateNodes = []; this.maxLevel = 0; this.getMenus(); this.expandedKey = [this.pCid]; this.pCid = 0; &#125;) .catch(() =&gt; &#123; this.$message(&#123; message: &quot;èœå•é¡ºåºä¿®æ”¹å¤±è´¥&quot;, type: &quot;error&quot; &#125;); &#125;); &#125;, // ä¿®æ”¹å­èŠ‚ç‚¹çš„å±‚çº§ updateNodesChildLevel(node) &#123; if (node.childNodes.length &gt; 0) &#123; for (let i = 0; i &lt; node.childNodes.length; i++) &#123; this.updateNodes.push(&#123; catId: node.childNodes[i].data.catId, catLevel: node.childNodes[i].level &#125;); this.updateNodesChildLevel(node.childNodes[i]); &#125; &#125; &#125;, // æ‹–æ‹½æˆåŠŸè§¦å‘ handleDrop(draggingNode, dropNode, dropType, ev) &#123; // è·å–æœ€æ–°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹id(çœŸå®æ•°æ®åº“ä¸­çš„id,è€Œä¸æ˜¯nodeçš„id)å’Œé¡ºåºå’Œå±‚çº§ let pCid = 0; let siblings = null; if (dropType == &quot;inner&quot;) &#123; pCid = dropNode.data.catId; siblings = dropNode.childNodes; &#125; else &#123; pCid = dropNode.parent.data.catId == undefined ? 0 : dropNode.parent.data.catId; siblings = dropNode.parent.childNodes; &#125; //å¯¹å…„å¼ŸèŠ‚ç‚¹æ’åºï¼Œè·å¾—å½“å‰çš„é¡ºåº for (let i = 0; i &lt; siblings.length; i++) &#123; // å…ˆåˆ¤æ–­å½“å‰éå†åˆ°çš„èŠ‚ç‚¹æ˜¯ä¸æ˜¯è¢«æ‹–æ‹½çš„èŠ‚ç‚¹ï¼Œæ˜¯çš„è¯éœ€è¦ä¿®æ”¹ä»–çš„pCid if (siblings[i].data.catId == draggingNode.data.catId) &#123; // åˆ¤æ–­å±‚çº§æ˜¯å¦æ”¹å˜ if (siblings[i].level != draggingNode.level) &#123; // å­—èŠ‚ç‚¹çš„å±‚çº§ä¹Ÿè¦æ”¹å˜ this.updateNodesChildLevel(siblings[i]); this.updateNodes.push(&#123; catId: siblings[i].data.catId, sort: i, parentCid: pCid, catLevel: siblings[i].level &#125;); &#125; else &#123; this.updateNodes.push(&#123; catId: siblings[i].data.catId, sort: i, parentCid: pCid &#125;); &#125; &#125; else &#123; // éœ€è¦ä¿®æ”¹çš„å•†å“å¯¹è±¡ï¼Œæ”¾å…¥updateNodes this.updateNodes.push(&#123; catId: siblings[i].data.catId, sort: i &#125;); &#125; &#125; this.pCid = pCid; console.log(&quot;this.updateNodes:&quot;, this.updateNodes); // è°ƒç”¨api // this.$http(&#123; // url: this.$http.adornUrl(&quot;/product/category/update/sort&quot;), // method: &quot;post&quot;, // data: this.$http.adornData(this.updateNodes, false) // &#125;) // .then((&#123; data &#125;) =&gt; &#123; // this.$message(&#123; // message: &quot;èœå•é¡ºåºä¿®æ”¹æˆåŠŸ&quot;, // type: &quot;success&quot; // &#125;); // // åˆ·æ–°,åˆå§‹åŒ– // this.updateNodes = []; // this.maxLevel = 0; // this.getMenus(); // this.expandedKey = [pCid]; // &#125;) // .catch(() =&gt; &#123; // this.$message(&#123; // message: &quot;èœå•é¡ºåºä¿®æ”¹å¤±è´¥&quot;, // type: &quot;error&quot; // &#125;); // &#125;); &#125;, // åˆ¤æ–­æ˜¯å¦è¢«æ‹–æ‹½æ”¾ç½®ï¼ˆè¿™é‡Œè¦æ³¨æ„å±‚çº§å’Œæ·±åº¦ï¼‰ allowDrop(draggingNode, dropNode, type) &#123; // å½“å‰è¢«æ‹–åŠ¨åˆ°çš„èŠ‚ç‚¹çš„æœ€å¤§æ·±åº¦ï¼ˆå› ä¸ºå¯èƒ½æ‹–å®¶å¸¦å£ï¼‰+æ‹–åŠ¨åˆ°çš„èŠ‚ç‚¹çš„å±‚æ•° &lt;= 3å³å¯ // æ±‚å½“å‰å­èŠ‚ç‚¹æœ€å¤§å±‚çº§ console.log(&quot;draggingNode:&quot;, draggingNode); this.countNodeLevel(draggingNode); // æ³¨æ„è¿™é‡Œï¼Œéœ€è¦ç”¨å­èŠ‚ç‚¹çš„æœ€å¤§å±‚çº§-å½“å‰è¢«æ‹–åŠ¨çš„èŠ‚ç‚¹çš„å±‚çº§+1ï¼Œè·å¾—çš„å€¼å°±æ˜¯è¢«æ‹–åŠ¨æ•´ä½“çš„æœ€å¤§æ·±åº¦ console.log(&quot;maxLevel:&quot; + this.maxLevel); console.log(&quot;draggingNode.level:&quot; + draggingNode.level); let deep = this.maxLevel - draggingNode.level + 1; console.log(&quot;deep:&quot; + deep); this.maxLevel = 0; // æ³¨æ„è¿™é‡Œè¦åˆ¤æ–­type: å‰åä¸­ï¼ˆå› ä¸ºelementuiä»–çš„è®¾è®¡å°±æ˜¯è¿™æ ·ï¼Œä¸¤ä¸ªnodeæ˜¯æŒ‡æ‹–æ‹½åæœ‰ä½ç½®å…³ç³»çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œtypeæ˜¯è¿”å›çš„ä¸¤ä¸ªnodeä¹‹é—´çš„å…³ç³»ï¼Œï¼‰ if (type == &quot;inner&quot;) &#123; console.log(&quot;dropNode.level:&quot; + dropNode.level); return deep + dropNode.level &lt;= 3; &#125; else &#123; console.log(&quot;dropNode.parent.level:&quot; + dropNode.parent.level); return deep + dropNode.parent.level &lt;= 3; &#125; &#125;, // é€’å½’æŸ¥æ‰¾æœ€æ·±å­èŠ‚ç‚¹ï¼Œè®°å½•åœ¨this.maxLevelä¸­ countNodeLevel(node) &#123; // å¦‚æœæœ‰å­èŠ‚ç‚¹ if (node.childNodes != null &amp;&amp; node.childNodes.length &gt; 0) &#123; // éå†é€’å½’ for (let i = 0; i &lt; node.childNodes.length; i++) &#123; if (node.childNodes[i].level &gt; this.maxLevel) &#123; this.maxLevel = node.childNodes[i].level; &#125; // æ³¨æ„è¿™é‡ŒmaxLevelæ”¾åœ¨dataä¸­ï¼Œè¦ä¸ç„¶é€’å½’æ‹¿ä¸åˆ° this.countNodeLevel(node.childNodes[i]); &#125; &#125; else &#123; // æ²¡æœ‰å­èŠ‚ç‚¹ this.maxLevel = node.level; &#125; &#125;, // è·å–æ‰€æœ‰åˆ†ç±» getMenus() &#123; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/list/tree&quot;), method: &quot;get&quot; &#125;).then((&#123; data &#125;) =&gt; &#123; console.log(data); // è¿™é‡Œdataä½¿ç”¨äº†è§£æ„ this.menus = data.data; &#125;); &#125;, // æ‰“å¼€æ·»åŠ èœå•å¯¹è¯æ¡† openDialog(data) &#123; this.dialogVisible = true; this.dialogType = &quot;add&quot;; this.dialogTitle = &quot;æ·»åŠ åˆ†ç±»&quot;; // åˆå§‹åŒ–categoryå¯¹è±¡ this.category.catId = null; this.category.name = &quot;&quot;; this.category.parentCid = data.catId; this.category.icon = &quot;&quot;; this.category.productUnit = &quot;&quot;; this.category.catLevel = data.catLevel * 1 + 1; &#125;, // æ‰“å¼€ä¿®æ”¹èœå•å¯¹è¯æ¡† openDialogWithInfo(data) &#123; this.dialogVisible = true; this.dialogType = &quot;update&quot;; this.dialogTitle = &quot;ä¿®æ”¹åˆ†ç±»&quot;; // è°ƒç”¨æ¥å£è·å–å¯¹åº”idçš„ä¿¡æ¯ï¼Œå¹¶åˆå§‹åŒ–categoryå¯¹è±¡ this.$http(&#123; url: this.$http.adornUrl(`/product/category/info/$&#123;data.catId&#125;`), method: &quot;get&quot; &#125;).then((&#123; data &#125;) =&gt; &#123; this.category.catId = data.data.catId; // åªä¿®æ”¹è¿™å‡ ä¸ªå€¼ this.category.name = data.data.name; this.category.icon = data.data.icon; this.category.productUnit = data.data.productUnit; // ç”¨äºä¿®æ”¹å®Œä¹‹åå±•å¼€çˆ¶èœå• this.category.parentCid = data.data.parentCid; &#125;); &#125;, // å¯¹è¯æ¡†ç¡®å®šæŒ‰é’®åˆ¤æ–­ addOrUpdate() &#123; if (this.dialogType == &quot;update&quot;) &#123; this.updateCategory(); &#125; else if (this.dialogType == &quot;add&quot;) &#123; this.addCategory(); &#125; &#125;, // ä¿®æ”¹åˆ†ç±»èœå• updateCategory() &#123; // ä½¿ç”¨è§£æ„ var &#123; catId, name, icon, productUnit &#125; = this.category; this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/update&quot;), method: &quot;post&quot;, // ä¸èƒ½ç›´æ¥å‘é€this.categoryå¯¹è±¡,è€Œæ˜¯é‡æ–°å°è£…éœ€è¦ä¿®æ”¹çš„å¯¹è±¡ data: this.$http.adornData(&#123; catId, name, icon, productUnit &#125;, false) &#125;).then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;ä¿®æ”¹æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // å…³é—­å¯¹è¯æ¡† this.dialogVisible = false; // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®æ•°ç»„(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [this.category.parentCid]; &#125;); &#125;, // æ·»åŠ åˆ†ç±»èœå• addCategory() &#123; // è°ƒç”¨api this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/save&quot;), method: &quot;post&quot;, data: this.$http.adornData(this.category, false) &#125;) .then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;ä¿å­˜æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // å…³é—­å¯¹è¯æ¡† this.dialogVisible = false; // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®æ•°ç»„(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [this.category.parentCid]; &#125;) .catch(result =&gt; &#123; this.$message(&#123; message: &quot;ä¿å­˜å¤±è´¥&quot;, type: &quot;error&quot; &#125;); &#125;); &#125;, // åˆ é™¤å¯¹åº”èœå• remove(node, data) &#123; var ids = [data.catId]; this.$confirm(`ç¡®å®šåˆ é™¤ã€$&#123;data.name&#125;ã€‘èœå•å—?`, &quot;æç¤º&quot;, &#123; confirmButtonText: &quot;ç¡®å®š&quot;, cancelButtonText: &quot;å–æ¶ˆ&quot;, type: &quot;warning&quot; &#125;) .then(() =&gt; &#123; // è°ƒç”¨API this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/delete&quot;), method: &quot;post&quot;, data: this.$http.adornData(ids, false) &#125;) .then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;åˆ é™¤æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // åˆ·æ–°åˆ—è¡¨ this.getMenus(); // å±•å¼€çˆ¶èŠ‚ç‚¹ä½ç½®(è¿™é‡Œçš„idå¯¹åº”node-keyç»‘å®šçš„å±æ€§å) this.expandedKey = [node.parent.data.catId]; &#125;) .catch(result =&gt; &#123; this.$message(&#123; message: &quot;åˆ é™¤å¤±è´¥&quot;, type: &quot;error&quot; &#125;); &#125;); &#125;) .catch(() =&gt; &#123;&#125;); &#125; &#125;&#125;;&lt;/script&gt; TODO : å½“å‰bugï¼Œå¦‚æœå±‚çº§3çš„èœå•æ‹–æ‹½åˆ°å±‚çº§2åå¤±è¸ªï¼Œåº”è¯¥å’Œpcidæœ‰å…³ï¼ˆæ‹–æ‹½è‡³å±‚çº§1æœ‰æ•ˆï¼‰ å±‚çº§2æ— å­èŠ‚ç‚¹æ‹–æ‹½åˆ°å±‚çº§2åå¤±è¸ªï¼ˆä¸è¿‡çœ‹èµ·æ¥åå°æ•°æ®åº“æ²¡é—®é¢˜å‘€ï¼Ÿï¼‰ TODOï¼šè¿™ä¸ªbugè¢«åæ¥çš„æ‰¹é‡ä¿å­˜æ”¹æ­£äº†ï¼Œåæ­£éƒ½æ‰¹é‡ä¿å­˜äº†ï¼Œä¹Ÿæœ‰é—®é¢˜äº† æ‰¹é‡åˆ é™¤åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869 &lt;div&gt; &lt;el-button type=&quot;danger&quot; @click=&quot;batchDelete&quot;&gt;æ‰¹é‡åˆ é™¤&lt;/el-button&gt; &lt;!-- ====================== åˆ†ç±»æ ‘å½¢ç»“æ„æ˜¾ç¤º å¼€å§‹ ====================== --&gt; &lt;!-- node-key=&quot;catId&quot; å…¶å€¼ä¸ºèŠ‚ç‚¹æ•°æ®ä¸­çš„ä¸€ä¸ªå­—æ®µå :expand-on-click-node=&quot;false&quot; è¡¨ç¤ºè®¾ç½®å±•å¼€èŠ‚ç‚¹çš„ç‚¹å‡»ä½ç½®ï¼ŒFALSEåªæœ‰å½“ç‚¹å‡»ç®­å¤´çš„æ—¶å€™æ‰å±•å¼€ :default-expanded-keys=&quot;[2, 3]&quot; è¡¨ç¤ºé»˜è®¤å±•å¼€çš„èŠ‚ç‚¹ draggable å¼€å¯å¯æ‹–æ‹½çš„æ–¹å¼â€˜ ref å¯ä»¥ä»this.$refsä¸­è·å–åˆ°è¯¥å¯¹åº”ç»„ä»¶ --&gt; &lt;el-tree node-key=&quot;catId&quot; show-checkbox :data=&quot;menus&quot; :props=&quot;defaultProps&quot; :expand-on-click-node=&quot;false&quot; :default-expanded-keys=&quot;expandedKey&quot; :draggable=&quot;draggable&quot; :allow-drop=&quot;allowDrop&quot; @node-drop=&quot;handleDrop&quot; ref=&quot;menuTree&quot; &gt; &lt;script&gt;export default &#123; methods: &#123; // æ‰¹é‡åˆ é™¤ batchDelete() &#123; let catIds = []; // è·å–å½“å‰é€‰ä¸­çš„èŠ‚ç‚¹ let checkedNodes = this.$refs.menuTree.getCheckedNodes(); // console.log(checkedNodes); // éå†æ‰€æœ‰è¢«é€‰ä¸­çš„èŠ‚ç‚¹ for (let i = 0; i &lt; checkedNodes.length; i++) &#123; catIds.push(checkedNodes[i].catId); &#125; // å‘é€è¯·æ±‚ this.$confirm(`ç¡®å®šæ‰¹é‡åˆ é™¤ã€$&#123;catIds&#125;ã€‘èœå•å—?`, &quot;æç¤º&quot;, &#123; confirmButtonText: &quot;ç¡®å®š&quot;, cancelButtonText: &quot;å–æ¶ˆ&quot;, type: &quot;warning&quot; &#125;) .then(() =&gt; &#123; // è°ƒç”¨API this.$http(&#123; url: this.$http.adornUrl(&quot;/product/category/delete&quot;), method: &quot;post&quot;, data: this.$http.adornData(catIds, false) &#125;) .then((&#123; data &#125;) =&gt; &#123; this.$message(&#123; message: &quot;æ‰¹é‡åˆ é™¤æˆåŠŸ&quot;, type: &quot;success&quot; &#125;); // åˆ·æ–°åˆ—è¡¨ this.getMenus(); &#125;) .catch(result =&gt; &#123; this.$message(&#123; message: &quot;æ‰¹é‡åˆ é™¤å¤±è´¥&quot;, type: &quot;error&quot; &#125;); &#125;); &#125;) .catch(() =&gt; &#123;&#125;); &#125;,&#125;&#125;&lt;/script&gt;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜7","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜7","date":"2021-10-05T07:16:37.992Z","updated":"2021-10-07T09:44:59.733Z","comments":true,"path":"2021/10/05/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-7/","link":"","permalink":"http://example.com/2021/10/05/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-7/","excerpt":"","text":"ç»Ÿè®¡åˆ†æåå°ï¼ˆåç«¯+å‰ç«¯ï¼‰ç¯å¢ƒæ­å»º è€æ ·å­ ç”Ÿæˆç»Ÿè®¡æ•°æ®ï¼ˆåç«¯ï¼‰ æ³¨æ„ï¼Œè¦æŸ¥è¯¢ä»€ä¹ˆæ•°æ®è¦åœ¨å¯¹åº”æ¨¡å—ä¸­æŸ¥è¯¢ï¼Œç„¶ååœ¨ç»Ÿè®¡æ¨¡å—è¿œç¨‹è°ƒç”¨è·å– è¢«è°ƒç”¨æ–¹controller12345678910111213@RestController@RequestMapping(&quot;/educenter/member&quot;)@CrossOriginpublic class UcenterMemberController &#123; @Autowired private UcenterMemberService memberService; // æŸ¥è¯¢ç‰¹å®šå¤©çš„æ³¨å†Œäººæ•° @GetMapping(&quot;countRegister/&#123;day&#125;&quot;) public Integer countRegister(@PathVariable String day) &#123; Integer count = memberService.countRegister(day); return count; &#125;&#125; è¢«è°ƒç”¨æ–¹service12345// æŸ¥è¯¢ç‰¹å®šå¤©çš„æ³¨å†Œäººæ•°@Overridepublic Integer countRegister(String day) &#123; return baseMapper.countRegisterByDay(day);&#125; è¢«è°ƒç”¨æ–¹mapper12345678910&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.atguigu.educenter.mapper.UcenterMemberMapper&quot;&gt; &lt;!-- æŸ¥è¯¢ç‰¹å®šå¤©çš„æ³¨å†Œäººæ•° --&gt; &lt;select id=&quot;countRegisterByDay&quot; resultType=&quot;java.lang.Integer&quot;&gt; SELECT COUNT(*) FROM ucenter_member uc WHERE DATE(uc.gmt_create) = #&#123;day&#125; &lt;/select&gt;&lt;/mapper&gt; è¿œç¨‹è°ƒç”¨æ¥å£1234567@Component@FeignClient(&quot;service-ucenter&quot;)public interface UcenterClient &#123; // æŸ¥è¯¢ç‰¹å®šå¤©çš„æ³¨å†Œäººæ•° @GetMapping(&quot;/educenter/member/countRegister/&#123;day&#125;&quot;) public Integer countRegister(@PathVariable(&quot;day&quot;) String day);&#125; è°ƒç”¨æ–¹controller123456789101112131415@RestController@RequestMapping(&quot;/staservice/sta&quot;)@CrossOriginpublic class StatisticsDailyController &#123; @Autowired private StatisticsDailyService staService; // ç»Ÿè®¡ç‰¹å®šå¤©çš„æ³¨å†Œäººæ•° @PostMapping(&quot;countRegister/&#123;day&#125;&quot;) public R countRegister(@PathVariable String day) &#123; staService.countRegister(day); return R.ok(); &#125;&#125; è°ƒç”¨æ–¹service1234567891011121314151617181920212223242526@Servicepublic class StatisticsDailyServiceImpl extends ServiceImpl&lt;StatisticsDailyMapper, StatisticsDaily&gt; implements StatisticsDailyService &#123; @Autowired private UcenterClient ucenterClient; @Override public void countRegister(String day) &#123; // å…ˆåˆ é™¤ç›¸åŒæ—¥æœŸçš„è®°å½• QueryWrapper&lt;StatisticsDaily&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;date_calculated&quot;, day); baseMapper.delete(wrapper); // è·å¾—æŒ‡å®šæ—¥æœŸçš„ç»Ÿè®¡æ•° Integer count = ucenterClient.countRegister(day); // æŠŠç»Ÿè®¡æ•°æ®æ·»åŠ åˆ°ç»Ÿè®¡è¡¨å½“ä¸­ StatisticsDaily statisticsDaily = new StatisticsDaily(); statisticsDaily.setRegisterNum(count); statisticsDaily.setDateCalculated(day); // ä¸€ä¸‹æ˜¯ä¸€äº›éšæœºæ•° statisticsDaily.setVideoViewNum(RandomUtils.nextInt(100, 200)); statisticsDaily.setLoginNum(RandomUtils.nextInt(100, 200)); statisticsDaily.setCourseNum(RandomUtils.nextInt(100, 200)); // æ’å…¥æ•°æ®åº“ baseMapper.insert(statisticsDaily); &#125;&#125; ç”Ÿæˆç»Ÿè®¡æ•°æ®ï¼ˆå‰ç«¯ï¼‰router12345678910111213141516171819202122// ç»Ÿè®¡åˆ†ææ¨¡å— &#123; path: &#x27;/sta&#x27;, component: Layout, redirect: &#x27;/sta/create&#x27;, name: &#x27;ç»Ÿè®¡åˆ†æ&#x27;, meta: &#123; title: &#x27;ç»Ÿè®¡åˆ†æ&#x27;, icon: &#x27;example&#x27; &#125;, children: [ &#123; path: &#x27;create&#x27;, name: &#x27;ç”Ÿæˆæ•°æ®&#x27;, component: () =&gt; import(&#x27;@/views/statistics/create&#x27;), meta: &#123; title: &#x27;ç”Ÿæˆæ•°æ®&#x27;, icon: &#x27;table&#x27; &#125; &#125;, &#123; path: &#x27;show&#x27;, name: &#x27;å›¾è¡¨æ˜¾ç¤º&#x27;, component: () =&gt; import(&#x27;@/views/statistics/show&#x27;), meta: &#123; title: &#x27;å›¾è¡¨æ˜¾ç¤º&#x27;, icon: &#x27;tree&#x27; &#125; &#125; ] &#125;, api1234567891011import request from &#x27;@/utils/request&#x27;export default &#123; // ç»Ÿè®¡æŒ‡å®šæ—¥æœŸçš„æ³¨å†Œæ•° createCountRegister(day) &#123; return request(&#123; url: `/staservice/sta/countRegister/$&#123;day&#125;`, method: &#x27;post&#x27; &#125;) &#125;&#125; vueæ¨¡æ¿ä¸æ–¹æ³•1&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!--è¡¨å•--&gt; &lt;el-form :inline=&quot;true&quot; class=&quot;demo-form-inline&quot;&gt; &lt;el-form-item label=&quot;æ—¥æœŸ&quot;&gt; &lt;!-- è¿™é‡Œç»‘å®šäº†day --&gt; &lt;el-date-picker v-model=&quot;day&quot; type=&quot;date&quot; placeholder=&quot;é€‰æ‹©è¦ç»Ÿè®¡çš„æ—¥æœŸ&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt; &lt;/el-form-item&gt; &lt;el-button :disabled=&quot;btnDisabled&quot; type=&quot;primary&quot; @click=&quot;create()&quot; &gt;ç”Ÿæˆ&lt;/el-button &gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import staApi from &#x27;@/api/statistics&#x27; export default &#123; data() &#123; return &#123; day: &#x27;&#x27;, btnDisabled: false &#125; &#125;, created() &#123;&#125;, methods: &#123; create() &#123; staApi.createCountRegister(this.day).then(result =&gt; &#123; // æç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;ç”Ÿæˆæ•°æ®æˆåŠŸ!&#x27; &#125;) // è·³è½¬åˆ°å›¾è¡¨æ˜¾ç¤ºé¡µé¢ this.$router.push(&#123; path: &#x27;/sta/show&#x27; &#125;) &#125;) &#125; &#125; &#125;&lt;/script&gt; å®šæ—¶ä»»åŠ¡ åœ¨å›ºå®šæ—¶å€™è‡ªåŠ¨æ‰§è¡Œç¨‹åº é…ç½® åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@EnableScheduling 1@EnableScheduling // ä½¿ç”¨è‡ªåŠ¨ä»»åŠ¡public class StatisticsApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(StatisticsApplication.class, args); &#125;&#125; å®šæ—¶ä»»åŠ¡ç±» ä½¿ç”¨cronè¡¨è¾¾å¼ï¼Œè®¾ç½®æ‰§è¡Œè§„åˆ™ 1@Componentpublic class ScheduledTask &#123; @Autowired private StatisticsDailyService staService; // 0/5 * * * * ?è¡¨ç¤ºæ¯éš”5ç§’æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæ–¹æ³• @Scheduled(cron = &quot;0/5 * * * * ?&quot;) public void task1() &#123; System.out.println(&quot;**************task1æ‰§è¡Œäº†..&quot;); &#125; //åœ¨æ¯å¤©å‡Œæ™¨1ç‚¹ï¼ŒæŠŠå‰ä¸€å¤©æ•°æ®è¿›è¡Œæ•°æ®æŸ¥è¯¢æ·»åŠ  @Scheduled(cron = &quot;0 0 1 * * ?&quot;) public void task2() &#123; staService.countRegister(DateUtil.formatDate(DateUtil.addDays(new Date(), -1))); &#125;&#125; æ—¥æœŸå·¥å…·ç±»1public class DateUtil &#123; private static final String dateFormat = &quot;yyyy-MM-dd&quot;; /** * æ ¼å¼åŒ–æ—¥æœŸ * * @param date * @return */ public static String formatDate(Date date) &#123; SimpleDateFormat sdf = new SimpleDateFormat(dateFormat); return sdf.format(date); &#125; /** * åœ¨æ—¥æœŸdateä¸Šå¢åŠ amountå¤© ã€‚ * * @param date å¤„ç†çš„æ—¥æœŸï¼Œénull * @param amount è¦åŠ çš„å¤©æ•°ï¼Œå¯èƒ½ä¸ºè´Ÿæ•° */ public static Date addDays(Date date, int amount) &#123; Calendar now =Calendar.getInstance(); now.setTime(date); now.set(Calendar.DATE,now.get(Calendar.DATE)+amount); return now.getTime(); &#125; public static void main(String[] args) &#123; System.out.println(DateUtil.formatDate(new Date())); System.out.println(DateUtil.formatDate(DateUtil.addDays(new Date(), -1))); &#125;&#125; ç»Ÿè®¡åˆ†æå›¾è¡¨æ˜¾ç¤ºï¼ˆåç«¯+å‰ç«¯ï¼‰ ä½¿ç”¨echarts åç«¯controller1// echatrtså›¾è¡¨æ˜¾ç¤º@GetMapping(&quot;showChartData/&#123;type&#125;/&#123;begin&#125;/&#123;end&#125;&quot;)public R getChartData(@PathVariable String begin, @PathVariable String end, @PathVariable String type) &#123; Map&lt;String, Object&gt; map = staService.getChartData(type, begin, end); return R.ok().data(map);&#125; service1// echatrtså›¾è¡¨æ˜¾ç¤º@Overridepublic Map&lt;String, Object&gt; getChartData(String type, String begin, String end) &#123; // æŒ‡å®šæ—¥æœŸèŒƒå›´ QueryWrapper&lt;StatisticsDaily&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.between(&quot;date_calculated&quot;, begin, end); // è¿™é‡Œè¦æ±‚å‰ç«¯çš„ä¼ é€’çš„valueå’Œè¡¨ä¸­å¯¹åº”å­—æ®µå€¼ç›¸åŒï¼ŒselectæŒ‡å®šæŸ¥è¯¢åˆ— wrapper.select(&quot;date_calculated&quot;, type); List&lt;StatisticsDaily&gt; staDataList = baseMapper.selectList(wrapper); //å‰ç«¯è¦æ±‚æ•°ç»„jsonç»“æ„ï¼Œå¯¹åº”åç«¯javaä»£ç æ˜¯listé›†åˆ //åˆ›å»ºä¸¤ä¸ªlisté›†åˆï¼Œä¸€ä¸ªæ—¥æœŸlistï¼Œä¸€ä¸ªæ•°é‡list List&lt;String&gt; dateList = new ArrayList&lt;&gt;(); List&lt;Integer&gt; numList = new ArrayList&lt;&gt;(); //éå†æŸ¥è¯¢æ‰€æœ‰æ•°æ®listé›†åˆï¼Œè¿›è¡Œå°è£… for (int i = 0; i &lt; staDataList.size(); i++) &#123; StatisticsDaily daily = staDataList.get(i); //å°è£…æ—¥æœŸlisté›†åˆ dateList.add(daily.getDateCalculated()); //å°è£…å¯¹åº”é€‰æ‹©çš„æ•°é‡ switch (type) &#123; case &quot;login_num&quot;: numList.add(daily.getLoginNum()); break; case &quot;register_num&quot;: numList.add(daily.getRegisterNum()); break; case &quot;video_view_num&quot;: numList.add(daily.getVideoViewNum()); break; case &quot;course_num&quot;: numList.add(daily.getCourseNum()); break; default: break; &#125; &#125; //æŠŠå°è£…ä¹‹åä¸¤ä¸ªlisté›†åˆæ”¾åˆ°mapé›†åˆï¼Œè¿›è¡Œè¿”å› Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;dateList&quot;, dateList); map.put(&quot;numList&quot;, numList); return map;&#125; å‰ç«¯å¼•å…¥npmä¾èµ– npm install â€“save &#x65;&#x63;&#x68;&#97;&#114;&#116;&#115;&#64;&#52;&#46;&#x31;&#x2e;&#48; api è¿™é‡Œæ²¡æœ‰ä½¿ç”¨RequestBodyä¼ é€’å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥å‰ç«¯è°ƒç”¨çš„æ—¶å€™ä¼ é€’å¯¹è±¡å–å¯¹åº”å€¼ 1// è·å¾—å›¾è¡¨æ•°æ® getChartData(searchObj) &#123; return request(&#123; url: `/staservice/sta/getChartData/$&#123;searchObj.type&#125;/$&#123;searchObj.begin&#125;/$&#123;searchObj.end&#125;`, method: &#x27;get&#x27; &#125;) &#125; vueæ¨¡æ¿å’Œæ–¹æ³•1&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!--è¡¨å•--&gt; &lt;el-form :inline=&quot;true&quot; class=&quot;demo-form-inline&quot;&gt; &lt;el-form-item&gt; &lt;el-select v-model=&quot;searchObj.type&quot; clearable placeholder=&quot;è¯·é€‰æ‹©&quot;&gt; &lt;el-option label=&quot;å­¦å‘˜ç™»å½•æ•°ç»Ÿè®¡&quot; value=&quot;login_num&quot; /&gt; &lt;el-option label=&quot;å­¦å‘˜æ³¨å†Œæ•°ç»Ÿè®¡&quot; value=&quot;register_num&quot; /&gt; &lt;el-option label=&quot;è¯¾ç¨‹æ’­æ”¾æ•°ç»Ÿè®¡&quot; value=&quot;video_view_num&quot; /&gt; &lt;el-option label=&quot;æ¯æ—¥è¯¾ç¨‹æ•°ç»Ÿè®¡&quot; value=&quot;course_num&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-date-picker v-model=&quot;searchObj.begin&quot; type=&quot;date&quot; placeholder=&quot;é€‰æ‹©å¼€å§‹æ—¥æœŸ&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-date-picker v-model=&quot;searchObj.end&quot; type=&quot;date&quot; placeholder=&quot;é€‰æ‹©æˆªæ­¢æ—¥æœŸ&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt; &lt;/el-form-item&gt; &lt;el-button :disabled=&quot;btnDisabled&quot; type=&quot;primary&quot; icon=&quot;el-icon-search&quot; @click=&quot;showChart()&quot; &gt;æŸ¥è¯¢&lt;/el-button &gt; &lt;/el-form&gt; &lt;div class=&quot;chart-container&quot;&gt; &lt;div id=&quot;chart&quot; class=&quot;chart&quot; style=&quot;height: 500px; width: 100%&quot; /&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import echarts from &#x27;echarts&#x27; import staApi from &#x27;@/api/statistics&#x27; export default &#123; data() &#123; return &#123; searchObj: &#123;&#125;, btnDisabled: false, xData: [], yData: [] &#125; &#125;, methods: &#123; showChart() &#123; staApi.getChartData(this.searchObj).then(result =&gt; &#123; this.yData = result.data.numList this.xData = result.data.dateList // è°ƒç”¨ä¸‹é¢ç”Ÿæˆå›¾è¡¨çš„æ–¹æ³•ï¼Œæ”¹å˜å€¼ this.setChart() &#125;) &#125;, // é»˜è®¤æ˜¾ç¤ºå›¾è¡¨æ–¹æ³• setChart() &#123; // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹ this.chart = echarts.init(document.getElementById(&#x27;chart&#x27;)) // console.log(this.chart) // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ® var option = &#123; title: &#123; text: &#x27;æ•°æ®ç»Ÿè®¡&#x27; &#125;, tooltip: &#123; trigger: &#x27;axis&#x27; &#125;, dataZoom: [ &#123; show: true, height: 30, xAxisIndex: [0], bottom: 30, start: 10, end: 80, handleIcon: &#x27;path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z&#x27;, handleSize: &#x27;110%&#x27;, handleStyle: &#123; color: &#x27;#d3dee5&#x27; &#125;, textStyle: &#123; color: &#x27;#fff&#x27; &#125;, borderColor: &#x27;#90979c&#x27; &#125;, &#123; type: &#x27;inside&#x27;, show: true, height: 15, start: 1, end: 35 &#125; ], // xè½´æ˜¯ç±»ç›®è½´ï¼ˆç¦»æ•£æ•°æ®ï¼‰,å¿…é¡»é€šè¿‡dataè®¾ç½®ç±»ç›®æ•°æ® xAxis: &#123; type: &#x27;category&#x27;, data: this.xData &#125;, // yè½´æ˜¯æ•°æ®è½´ï¼ˆè¿ç»­æ•°æ®ï¼‰ yAxis: &#123; type: &#x27;value&#x27; &#125;, // ç³»åˆ—åˆ—è¡¨ã€‚æ¯ä¸ªç³»åˆ—é€šè¿‡ type å†³å®šè‡ªå·±çš„å›¾è¡¨ç±»å‹ series: [ &#123; // ç³»åˆ—ä¸­çš„æ•°æ®å†…å®¹æ•°ç»„ data: this.yData, // æŠ˜çº¿å›¾ type: &#x27;line&#x27; &#125; ] &#125; this.chart.setOption(option) &#125; &#125; &#125;&lt;/script&gt; Canalæ•°æ®åŒæ­¥ å°†è¿œç¨‹æ•°æ®åº“ä¸­çš„æ•°æ®åŒæ­¥åˆ°æœ¬åœ°æ•°æ®åº“ä¸­ï¼Œä¸€èˆ¬å®é™…ä¸­é¡¹ç›®æœ‰å¾ˆå¤šä¸ªæ•°æ®åº“ï¼ˆæ¯”å¦‚è¯´ç»Ÿè®¡åˆ†æä¸“é—¨ä¸€ä¸ªæ•°æ®åº“ï¼‰ï¼Œå…¶ä¸è¿œç¨‹æœåŠ¡è°ƒç”¨è°ƒç”¨çš„åŒºåˆ«æ˜¯ï¼Œè¯¥åŒæ­¥è€¦åˆåº¦ä½ï¼Œæ•ˆç‡æ›´é«˜ã€‚ linuxé…ç½®ä¸å¼€å¯ linuxä¸­éœ€è¦å®‰è£…mysqlï¼ˆæœ¬åœ°Windowsä¹Ÿéœ€è¦mysqlï¼‰ åˆ›å»ºæ•°æ®åº“è¡¨ï¼ˆç»“æ„éœ€è¦ä¸€æ ·ï¼‰ linuxä¸­dockerä¸­ä½¿ç”¨mysqlä¸€äº›å¸¸è§å‘½ä»¤ su root docker ps docker start mysql docker exec -it mysql bash mysql -u root -p å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨é…å¥½çš„Navicatï¼ˆå®æˆ˜5ä¸­é…ç½®redisçš„æ—¶å€™å·²ç»é…ç½®å¥½äº†mysqlï¼‰ exit docker stop CONTAINER ID åˆ›å»ºæ•°æ®åº“è¡¨ æ•°æ®åº“guliï¼Œè¡¨test_canal æ³¨æ„ç»“æ„éœ€è¦ä¸€æ · mysqlå¼€å¯binlog å¼€å¯å¹¶è¿›å…¥mysql show variables like â€˜log_binâ€™; æŸ¥è¯¢æ˜¯å¦å¼€å¯binlog ä¿®æ”¹my.cnfï¼ˆå¦‚æœä½¿ç”¨dockerï¼Œé‚£ä¹ˆè¦å»æŒ‚è½½çš„ç›®å½•ä¸‹ä¿®æ”¹ï¼‰ï¼Œå…·ä½“å¦‚ä¸‹ç¯‡æ–‡ç«  https://www.freebytes.net/it/java/dokcer-mysql-binlog.htmlz è¿™é‡ŒèŠ±äº†å¤§æ¦‚åŠä¸ªå°æ—¶å§ï¼Œè¿˜æ˜¯ä¸ªäººåšå®¢æ–‡ç« é è°±ï¼Œé‚£äº›CSDNçš„æ–‡ç« éƒ½æ˜¯ç‚’æ¥ç‚’å»çš„ï¼Œè¿™ç¯‡æ–‡ç« å¾ˆæ¸…æ¥šåœ°è®²äº†ä½ æŒ‚è½½çš„ç›®å½•æ˜¯å‰åŠéƒ¨åˆ†ï¼ˆæˆ‘çœ‹CSDNé‚£äº›æ–‡ç« æ€»ä»¥ä¸ºæ˜¯é…ç½®æŒ‚è½½çš„æ—¶å€™çš„ååŠéƒ¨åˆ†ï¼Œæ‰€ä»¥å¼„äº†å¥½ä¹…éƒ½æ²¡æœ‰ç”¨ï¼Œçœ‹äº†è¿™ç¯‡æ–‡ç« å‡ åˆ†é’Ÿå°±è§£å†³äº†ï¼‰ å®‰è£…å¹¶é…ç½®canal linuxä¸­ä¸‹è½½ç„¶åè§£å‹ å…·ä½“é…ç½®è§è§†é¢‘ å¼€å¯canalå³å¯ï¼Œè¿›å…¥binæ–‡ä»¶å¤¹ä¸‹sh startup.sh å®¢æˆ·ç«¯ä»£ç ç¼–å†™ åˆ›å»ºæ¨¡å— å¼•å…¥ä¾èµ–123456789101112131415161718192021222324252627 &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-dbutils&lt;/groupId&gt; &lt;artifactId&gt;commons-dbutils&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.otter&lt;/groupId&gt; &lt;artifactId&gt;canal.client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½®æ–‡ä»¶12345678910111213# æœåŠ¡ç«¯å£server.port=10000# æœåŠ¡åspring.application.name=canal-client# ç¯å¢ƒè®¾ç½®ï¼šdevã€testã€prodspring.profiles.active=dev# mysqlæ•°æ®åº“è¿æ¥spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789 canalå®¢æˆ·ç«¯ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197@Componentpublic class CanalClient &#123; //sqlé˜Ÿåˆ— private Queue&lt;String&gt; SQL_QUEUE = new ConcurrentLinkedQueue&lt;&gt;(); @Resource private DataSource dataSource; /** * canalå…¥åº“æ–¹æ³• */ public void run() &#123; CanalConnector connector = CanalConnectors.newSingleConnector(new InetSocketAddress(&quot;192.168.128.129&quot;, 11111), &quot;example&quot;, &quot;&quot;, &quot;&quot;); int batchSize = 1000; try &#123; connector.connect(); connector.subscribe(&quot;.*\\\\..*&quot;); connector.rollback(); try &#123; while (true) &#123; //å°è¯•ä»masteré‚£è¾¹æ‹‰å»æ•°æ®batchSizeæ¡è®°å½•ï¼Œæœ‰å¤šå°‘å–å¤šå°‘ Message message = connector.getWithoutAck(batchSize); long batchId = message.getId(); int size = message.getEntries().size(); if (batchId == -1 || size == 0) &#123; Thread.sleep(1000); &#125; else &#123; dataHandle(message.getEntries()); &#125; connector.ack(batchId); //å½“é˜Ÿåˆ—é‡Œé¢å †ç§¯çš„sqlå¤§äºä¸€å®šæ•°å€¼çš„æ—¶å€™å°±æ¨¡æ‹Ÿæ‰§è¡Œ if (SQL_QUEUE.size() &gt;= 1) &#123; executeQueueSql(); &#125; &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; catch (InvalidProtocolBufferException e) &#123; e.printStackTrace(); &#125; &#125; finally &#123; connector.disconnect(); &#125; &#125; /** * æ¨¡æ‹Ÿæ‰§è¡Œé˜Ÿåˆ—é‡Œé¢çš„sqlè¯­å¥ */ public void executeQueueSql() &#123; int size = SQL_QUEUE.size(); for (int i = 0; i &lt; size; i++) &#123; String sql = SQL_QUEUE.poll(); System.out.println(&quot;[sql]----&gt; &quot; + sql); this.execute(sql.toString()); &#125; &#125; /** * æ•°æ®å¤„ç† * * @param entrys */ private void dataHandle(List&lt;Entry&gt; entrys) throws InvalidProtocolBufferException &#123; for (Entry entry : entrys) &#123; if (EntryType.ROWDATA == entry.getEntryType()) &#123; RowChange rowChange = RowChange.parseFrom(entry.getStoreValue()); EventType eventType = rowChange.getEventType(); if (eventType == EventType.DELETE) &#123; saveDeleteSql(entry); &#125; else if (eventType == EventType.UPDATE) &#123; saveUpdateSql(entry); &#125; else if (eventType == EventType.INSERT) &#123; saveInsertSql(entry); &#125; &#125; &#125; &#125; /** * ä¿å­˜æ›´æ–°è¯­å¥ * * @param entry */ private void saveUpdateSql(Entry entry) &#123; try &#123; RowChange rowChange = RowChange.parseFrom(entry.getStoreValue()); List&lt;RowData&gt; rowDatasList = rowChange.getRowDatasList(); for (RowData rowData : rowDatasList) &#123; List&lt;Column&gt; newColumnList = rowData.getAfterColumnsList(); StringBuffer sql = new StringBuffer(&quot;update &quot; + entry.getHeader().getTableName() + &quot; set &quot;); for (int i = 0; i &lt; newColumnList.size(); i++) &#123; sql.append(&quot; &quot; + newColumnList.get(i).getName() + &quot; = &#x27;&quot; + newColumnList.get(i).getValue() + &quot;&#x27;&quot;); if (i != newColumnList.size() - 1) &#123; sql.append(&quot;,&quot;); &#125; &#125; sql.append(&quot; where &quot;); List&lt;Column&gt; oldColumnList = rowData.getBeforeColumnsList(); for (Column column : oldColumnList) &#123; if (column.getIsKey()) &#123; //æš‚æ—¶åªæ”¯æŒå•ä¸€ä¸»é”® sql.append(column.getName() + &quot;=&quot; + column.getValue()); break; &#125; &#125; SQL_QUEUE.add(sql.toString()); &#125; &#125; catch (InvalidProtocolBufferException e) &#123; e.printStackTrace(); &#125; &#125; /** * ä¿å­˜åˆ é™¤è¯­å¥ * * @param entry */ private void saveDeleteSql(Entry entry) &#123; try &#123; RowChange rowChange = RowChange.parseFrom(entry.getStoreValue()); List&lt;RowData&gt; rowDatasList = rowChange.getRowDatasList(); for (RowData rowData : rowDatasList) &#123; List&lt;Column&gt; columnList = rowData.getBeforeColumnsList(); StringBuffer sql = new StringBuffer(&quot;delete from &quot; + entry.getHeader().getTableName() + &quot; where &quot;); for (Column column : columnList) &#123; if (column.getIsKey()) &#123; //æš‚æ—¶åªæ”¯æŒå•ä¸€ä¸»é”® sql.append(column.getName() + &quot;=&quot; + column.getValue()); break; &#125; &#125; SQL_QUEUE.add(sql.toString()); &#125; &#125; catch (InvalidProtocolBufferException e) &#123; e.printStackTrace(); &#125; &#125; /** * ä¿å­˜æ’å…¥è¯­å¥ * * @param entry */ private void saveInsertSql(Entry entry) &#123; try &#123; RowChange rowChange = RowChange.parseFrom(entry.getStoreValue()); List&lt;RowData&gt; rowDatasList = rowChange.getRowDatasList(); for (RowData rowData : rowDatasList) &#123; List&lt;Column&gt; columnList = rowData.getAfterColumnsList(); StringBuffer sql = new StringBuffer(&quot;insert into &quot; + entry.getHeader().getTableName() + &quot; (&quot;); for (int i = 0; i &lt; columnList.size(); i++) &#123; sql.append(columnList.get(i).getName()); if (i != columnList.size() - 1) &#123; sql.append(&quot;,&quot;); &#125; &#125; sql.append(&quot;) VALUES (&quot;); for (int i = 0; i &lt; columnList.size(); i++) &#123; sql.append(&quot;&#x27;&quot; + columnList.get(i).getValue() + &quot;&#x27;&quot;); if (i != columnList.size() - 1) &#123; sql.append(&quot;,&quot;); &#125; &#125; sql.append(&quot;)&quot;); SQL_QUEUE.add(sql.toString()); &#125; &#125; catch (InvalidProtocolBufferException e) &#123; e.printStackTrace(); &#125; &#125; /** * å…¥åº“ * * @param sql */ public void execute(String sql) &#123; Connection con = null; try &#123; if (null == sql) return; con = dataSource.getConnection(); QueryRunner qr = new QueryRunner(); int row = qr.execute(con, sql); System.out.println(&quot;update: &quot; + row); &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; finally &#123; DbUtils.closeQuietly(con); &#125; &#125;&#125; å¯åŠ¨ç±»123456789101112131415@SpringBootApplicationpublic class CanalApplication implements CommandLineRunner &#123; @Resource private CanalClient canalClient; public static void main(String[] args) &#123; SpringApplication.run(CanalApplication.class, args); &#125; @Override public void run(String... strings) throws Exception &#123; //é¡¹ç›®å¯åŠ¨ï¼Œæ‰§è¡Œcanalå®¢æˆ·ç«¯ç›‘å¬ canalClient.run(); &#125;&#125; æµ‹è¯• TODOï¼Œè¿™é‡Œapplicationå¯åŠ¨å¤±è´¥ï¼Œå»canalçš„logé‡Œçœ‹ï¼Œè¯´è¿æ¥mysqlçš„ipå¤±è´¥äº†ï¼ŒåŸå› æ˜¯address already in use, ç„¶åæˆ‘æ”¹äº†é‡å¯è¿˜æ˜¯è¿™ä¸ªåŸå› ï¼Œæœ¬æ¥æ²¡æœ‰è¢«å ç”¨çš„ç«¯å£å¯åŠ¨äº†ä¹‹åå°±è¢«å ç”¨äº†ï¼Œä½†æ˜¯canalè¿˜æ˜¯å¯åŠ¨å¤±è´¥ï¼Œå°±ç¦»è°±ï¼Œ æ€»ä¹‹åŸå› æ˜¯canalæ²¡æœ‰å¯åŠ¨ï¼Œaddress already in use è¿˜æ˜¯æ²¡è§£å†³ï¼Œæ”¾å¼ƒäº†ï¼ˆæˆ‘ä¸ç†è§£ï¼ï¼ï¼ï¼‰ SpringCloudå¾®æœåŠ¡Gatewayç½‘å…³æ¦‚å¿µ å¾®æœåŠ¡æ¶æ„ä¹‹ä¸‹ä¸åŒçš„å¾®æœåŠ¡æœ‰ä¸åŒçš„ç½‘ç»œåœ°å€ï¼Œå¤–éƒ¨å®¢æˆ·ç«¯éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡çš„æ¥å£æ‰èƒ½å®Œæˆä¸€ä¸ªä¸šåŠ¡éœ€æ±‚ï¼Œä½†æ˜¯å¦‚æœç›´æ¥è®©å®¢æˆ·ç«¯ä¸å„ä¸ªæœåŠ¡å™¨é€šä¿¡ï¼Œä¼šå‡ºç°è®¸å¤šé—®é¢˜ï¼Œæ‰€ä»¥è¿™äº›é—®é¢˜éœ€è¦å€ŸåŠ©APIç½‘å…³è§£å†³ã€‚ ç½‘å…³æ˜¯ç»“ä½™å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„ä¹‹é—´å±‚ï¼Œæ‰€æœ‰å¤–éƒ¨è¯·æ±‚éƒ½ä¼šå…ˆç»è¿‡APIç½‘å…³è¿™ä¸€å±‚ï¼Œæ‰€ä»¥ç½‘å…³å®ç°å®‰å…¨ï¼Œæ€§èƒ½ï¼Œç›‘æ§ç­‰æ“ä½œã€‚ å°±æ˜¯ä¹‹å‰çš„nginxçš„å¢å¼ºç‰ˆ åˆ›å»ºæ¨¡å— åˆ›å»ºæ¨¡å—infrastructureï¼Œå­æ¨¡å—api_gateway ä¾èµ–12345678910111213141516171819202122232425&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;artifactId&gt;common_utils&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--gson--&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--æœåŠ¡è°ƒç”¨--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½®æ–‡ä»¶ é…ç½®æœåŠ¡æŒ‰å¦‚ä¸‹é…ç½®å³å¯ ä¹Ÿå¯ä»¥ä½¿ç”¨YAMLæ ¼å¼ï¼Œæ›´æ–¹ä¾¿ä¸ç”¨å†™ä¸‹æ ‡ 12345678910111213141516171819202122# æœåŠ¡ç«¯å£server.port=8222# æœåŠ¡åspring.application.name=service-gateway# nacosæœåŠ¡åœ°å€spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848#ä½¿ç”¨æœåŠ¡å‘ç°è·¯ç”±spring.cloud.gateway.discovery.locator.enabled=true#è®¾ç½®è·¯ç”±idspring.cloud.gateway.routes[0].id=service-acl#è®¾ç½®è·¯ç”±çš„uri lb://nacosæ³¨å†ŒæœåŠ¡åç§°spring.cloud.gateway.routes[0].uri=lb://service-acl#è®¾ç½®è·¯ç”±æ–­è¨€,ä»£ç†servicerIdä¸ºauth-serviceçš„/auth/è·¯å¾„spring.cloud.gateway.routes[0].predicates=Path=/*/acl/**#é…ç½®service-eduæœåŠ¡spring.cloud.gateway.routes[1].id=service-eduspring.cloud.gateway.routes[1].uri=lb://service-eduspring.cloud.gateway.routes[1].predicates=Path=/eduservice/**#é…ç½®service-eduæœåŠ¡spring.cloud.gateway.routes[2].id=service-msmspring.cloud.gateway.routes[2].uri=lb://service-msmspring.cloud.gateway.routes[2].predicates=Path=/edumsm/** å¯åŠ¨ç±»1234567@SpringBootApplication@EnableDiscoveryClient //nacospublic class GatewayApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(GatewayApplication.class, args); &#125;&#125; æµ‹è¯•ï¼šä½¿ç”¨ç½‘å…³çš„ç«¯å£å·å³å¯è®¿é—®å·²é…ç½®çš„å¾®æœåŠ¡OK è·¨åŸŸé—®é¢˜ åœ¨ç½‘å…³ä¸­ç»Ÿä¸€å¼€å¯è·¨åŸŸï¼Œcvä¸€ä¸‹å›ºå®šconfigã€filterã€handler æ³¨æ„controllerä¸­çš„è·¨åŸŸæ³¨è§£ä¸èƒ½æœ‰ï¼Œè¦ä¸ç„¶ä¸¤æ¬¡è·¨åŸŸæŠµæ¶ˆ æƒé™ç®¡ç†ï¼ˆåç«¯ï¼‰![07 æƒé™ç®¡ç†éœ€æ±‚](https://gitee.com/ReRia/images/raw/master/img/07 æƒé™ç®¡ç†éœ€æ±‚.png) ç¯å¢ƒæ­å»ºæ¨¡å— service_aclï¼Œspring_security ä¾èµ–1234567891011&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;artifactId&gt;spring_security&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; æ•´åˆæ¥å£ ç›´æ¥CVå¥½å®¶ä¼™ï¼Œå¥½åƒæ˜¯å› ä¸ºå¤ªå¤æ‚äº†å§ï¼Œæ²¡äº‹ä¸‹ä¸ªé¡¹ç›®è‡ªå·±åš è·å–æ‰€æœ‰èœå• é€’å½’ï¼Œæ„å»ºæ ‘å½¢ç»“æ„ï¼ˆæ³¨æ„èœå•å¯èƒ½æœ‰å¤šçº§ç»“æ„ï¼ˆä¹‹å‰åšè¿‡ä¸¤çº§çš„ï¼‰ï¼‰ entity æ³¨æ„è¿™ä¸ªå®ä½“ç±»çš„å±æ€§ï¼Œä½¿ç”¨äº†é€’å½’å­˜å‚¨children 1234567891011121314151617181920public class Permission implements Serializable &#123; private static final long serialVersionUID = 1L; @ApiModelProperty(value = &quot;ç¼–å·&quot;) @TableId(value = &quot;id&quot;, type = IdType.ID_WORKER_STR) private String id; @ApiModelProperty(value = &quot;æ‰€å±ä¸Šçº§&quot;) private String pid; @ApiModelProperty(value = &quot;å±‚çº§&quot;) @TableField(exist = false) private Integer level; @ApiModelProperty(value = &quot;ä¸‹çº§&quot;) @TableField(exist = false) private List&lt;Permission&gt; children; &#125; controller12345678910111213@RestController@RequestMapping(&quot;/admin/acl/permission&quot;)public class PermissionController &#123; @Autowired private PermissionService permissionService; //è·å–å…¨éƒ¨èœå• @ApiOperation(value = &quot;æŸ¥è¯¢æ‰€æœ‰èœå•&quot;) @GetMapping public R indexAllPermission() &#123; List&lt;Permission&gt; list = permissionService.queryAllMenuGuli(); return R.ok().data(&quot;children&quot;,list); &#125;&#125; service12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849//è·å–å…¨éƒ¨èœå•@Overridepublic List&lt;Permission&gt; queryAllMenuGuli() &#123; //1 æŸ¥è¯¢èœå•è¡¨æ‰€æœ‰æ•°æ® QueryWrapper&lt;Permission&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.orderByDesc(&quot;id&quot;); List&lt;Permission&gt; permissionList = baseMapper.selectList(wrapper); //2 æŠŠæŸ¥è¯¢æ‰€æœ‰èœå•listé›†åˆæŒ‰ç…§è¦æ±‚è¿›è¡Œå°è£… List&lt;Permission&gt; resultList = bulidPermission(permissionList); return resultList;&#125;//æŠŠè¿”å›æ‰€æœ‰èœå•listé›†åˆè¿›è¡Œå°è£…çš„æ–¹æ³•public static List&lt;Permission&gt; bulidPermission(List&lt;Permission&gt; permissionList) &#123; //åˆ›å»ºlisté›†åˆï¼Œç”¨äºæ•°æ®æœ€ç»ˆå°è£… List&lt;Permission&gt; finalNode = new ArrayList&lt;&gt;(); //æŠŠæ‰€æœ‰èœå•listé›†åˆéå†ï¼Œå¾—åˆ°é¡¶å±‚èœå• pid=0èœå•ï¼Œè®¾ç½®levelæ˜¯1 for(Permission permissionNode : permissionList) &#123; //å¾—åˆ°é¡¶å±‚èœå• pid=0èœå• if(&quot;0&quot;.equals(permissionNode.getPid())) &#123; //è®¾ç½®é¡¶å±‚èœå•çš„levelæ˜¯1 permissionNode.setLevel(1); //æ ¹æ®é¡¶å±‚èœå•ï¼Œå‘é‡Œé¢è¿›è¡ŒæŸ¥è¯¢å­èœå•ï¼Œå°è£…åˆ°finalNodeé‡Œé¢ finalNode.add(selectChildren(permissionNode,permissionList)); &#125; &#125; return finalNode;&#125;private static Permission selectChildren(Permission permissionNode, List&lt;Permission&gt; permissionList) &#123; //1 å› ä¸ºå‘ä¸€å±‚èœå•é‡Œé¢æ”¾äºŒå±‚èœå•ï¼ŒäºŒå±‚é‡Œé¢è¿˜è¦æ”¾ä¸‰å±‚ï¼ŒæŠŠå¯¹è±¡åˆå§‹åŒ– permissionNode.setChildren(new ArrayList&lt;Permission&gt;()); //2 éå†æ‰€æœ‰èœå•listé›†åˆï¼Œè¿›è¡Œåˆ¤æ–­æ¯”è¾ƒï¼Œæ¯”è¾ƒidå’Œpidå€¼æ˜¯å¦ç›¸åŒ for(Permission it : permissionList) &#123; //åˆ¤æ–­ idå’Œpidå€¼æ˜¯å¦ç›¸åŒ if(permissionNode.getId().equals(it.getPid())) &#123; //å½“å‰level=çˆ¶èœå•çš„levelå€¼+1 int level = permissionNode.getLevel()+1; it.setLevel(level); //å¦‚æœchildrenä¸ºç©ºï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œ //if(permissionNode.getChildren() == null) &#123; // permissionNode.setChildren(new ArrayList&lt;Permission&gt;()); //&#125; //æŠŠæŸ¥è¯¢å‡ºæ¥çš„å­èœå•æ”¾åˆ°çˆ¶èœå•é‡Œé¢ permissionNode.getChildren().add(selectChildren(it,permissionList)); &#125; &#125; return permissionNode;&#125; æµ‹è¯• SwaggerConfigç±»ä¸­æœ‰ä¸€è¡Œä»£ç éœ€è¦æ³¨é‡Šæ‰èƒ½æµ‹è¯•,ï¼Œè¡¨ç¤ºè·¯å¾„ä¸­æœ‰è¿™ä¸ªå…³é”®å­—åˆ™ä¸è®©æµ‹è¯•ï¼Œå¯ä»¥æ³¨é‡Šæ‰è¿™è¡Œä»£ç ä¹Ÿå¯ä»¥ä¿®æ”¹controllerçš„è·¯å¾„ 1234567891011@Bean public Docket webApiConfig() &#123; return new Docket(DocumentationType.SWAGGER_2) .groupName(&quot;webApi&quot;) .apiInfo(webApiInfo()) .select() // .paths(Predicates.not(PathSelectors.regex(&quot;/admin/.*&quot;))) .paths(Predicates.not(PathSelectors.regex(&quot;/error.*&quot;))) .build(); &#125; åˆ é™¤èœå• é€’å½’åˆ é™¤ï¼Œåˆ é™¤ä¸Šçº§èœå•ä¸‹çº§èœå•ä¹Ÿè¦åŒæ—¶åˆ é™¤ controller123456@ApiOperation(value = &quot;é€’å½’åˆ é™¤èœå•&quot;)@DeleteMapping(&quot;remove/&#123;id&#125;&quot;)public R remove(@PathVariable String id) &#123; permissionService.removeChildByIdGuli(id); return R.ok();&#125; service123456789101112131415161718192021222324252627//============é€’å½’åˆ é™¤èœå•==================================@Overridepublic void removeChildByIdGuli(String id) &#123; //1 åˆ›å»ºlisté›†åˆï¼Œç”¨äºå°è£…æ‰€æœ‰åˆ é™¤èœå•idå€¼ List&lt;String&gt; idList = new ArrayList&lt;&gt;(); //2 å‘idListé›†åˆè®¾ç½®åˆ é™¤èœå•id this.selectPermissionChildById(id, idList); //æŠŠå½“å‰idå°è£…åˆ°listé‡Œé¢ idList.add(id); baseMapper.deleteBatchIds(idList);&#125;//2 æ ¹æ®å½“å‰èœå•idï¼ŒæŸ¥è¯¢èœå•é‡Œé¢å­èœå•idï¼Œå°è£…åˆ°listé›†åˆprivate void selectPermissionChildById(String id, List&lt;String&gt; idList) &#123; //æŸ¥è¯¢èœå•é‡Œé¢å­èœå•id QueryWrapper&lt;Permission&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;pid&quot;, id); wrapper.select(&quot;id&quot;); List&lt;Permission&gt; childIdList = baseMapper.selectList(wrapper); //æŠŠchildIdListé‡Œé¢èœå•idå€¼è·å–å‡ºæ¥ï¼Œå°è£…idListé‡Œé¢ï¼Œåšé€’å½’æŸ¥è¯¢ childIdList.stream().forEach(item -&gt; &#123; //å°è£…idListé‡Œé¢ idList.add(item.getId()); //é€’å½’æŸ¥è¯¢ this.selectPermissionChildById(item.getId(), idList); &#125;);&#125; è§’è‰²åˆ†é…æƒé™controller123456@ApiOperation(value = &quot;ç»™è§’è‰²åˆ†é…æƒé™&quot;)@PostMapping(&quot;/doAssign&quot;)public R doAssign(String roleId,String[] permissionId) &#123; permissionService.saveRolePermissionRealtionShipGuli(roleId,permissionId); return R.ok();&#125; service12345678910111213141516171819//=========================ç»™è§’è‰²åˆ†é…èœå•=======================@Overridepublic void saveRolePermissionRealtionShipGuli(String roleId, String[] permissionIds) &#123; //roleIdè§’è‰²id //permissionIdèœå•id æ•°ç»„å½¢å¼ //1 åˆ›å»ºlisté›†åˆï¼Œç”¨äºå°è£…æ·»åŠ æ•°æ® List&lt;RolePermission&gt; rolePermissionList = new ArrayList&lt;&gt;(); //éå†æ‰€æœ‰èœå•æ•°ç»„ for (String perId : permissionIds) &#123; //RolePermissionå¯¹è±¡ RolePermission rolePermission = new RolePermission(); rolePermission.setRoleId(roleId); rolePermission.setPermissionId(perId); //å°è£…åˆ°listé›†åˆ rolePermissionList.add(rolePermission); &#125; //æ·»åŠ åˆ°è§’è‰²èœå•å…³ç³»è¡¨ rolePermissionService.saveBatch(rolePermissionList);&#125; SpringSecurityä»‹ç» spring-securityå®ç°åŠŸèƒ½å¦‚ä¸‹ï¼š ç”¨æˆ·è®¤è¯ï¼šç”¨æˆ·ç™»å½•æ—¶æŸ¥è¯¢æ•°æ®åº“éªŒè¯ç”¨æˆ·åå’Œå¯†ç  ç”¨æˆ·æˆæƒï¼šç™»å½•ä¹‹åç»™äºˆç”¨æˆ·å¯¹åº”çš„æƒé™å’Œæ“ä½œåŠŸèƒ½ spring-securityæœ¬è´¨ä¸Šæ˜¯filterï¼Œå¯¹è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼š åŸºäºsessionï¼Œåˆ™å¯¹cookieä¸­çš„sessionidè¿›è¡Œè§£ææ‰¾åˆ°æœåŠ¡å™¨å­˜å‚¨çš„sessionä¿¡æ¯ç„¶ååˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ç¬¦åˆè¯·æ±‚çš„è¦æ±‚ åŸºäºtokenï¼Œåˆ™è§£æå‡ºtokenç„¶åå°†å½“å‰è¯·æ±‚åŠ å…¥åˆ°spring-securityç®¡ç†çš„æƒé™ä¿¡æ¯å½“ä¸­ è®¤è¯å’Œæˆæƒå®ç°æ€è·¯ å¦‚æœç³»ç»Ÿçš„æ¨¡å—ä¼—å¤šï¼Œæ¯ä¸ªæ¨¡å—éƒ½éœ€è¦å°±è¡Œæˆæƒä¸è®¤è¯ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åŸºäºtokençš„å½¢å¼è¿›è¡Œæˆæƒä¸è®¤è¯ï¼Œç”¨æˆ·æ ¹æ®ç”¨æˆ·åå¯†ç è®¤è¯æˆåŠŸï¼Œç„¶åè·å–å½“å‰ç”¨æˆ·è§’è‰²çš„ä¸€ç³»åˆ—æƒé™å€¼ï¼Œå¹¶ä»¥ç”¨æˆ·åä¸ºkeyï¼Œæƒé™åˆ—è¡¨ä¸ºvalueçš„å½¢å¼å­˜å…¥redisç¼“å­˜ä¸­ï¼Œæ ¹æ®ç”¨æˆ·åç›¸å…³ä¿¡æ¯ç”Ÿæˆtokenè¿”å›ï¼Œæµè§ˆå™¨å°†tokenè®°å½•åˆ°cookieä¸­ï¼Œæ¯æ¬¡è°ƒç”¨apiæ¥å£éƒ½é»˜è®¤å°†tokenæºå¸¦åˆ°headerè¯·æ±‚å¤´ä¸­ï¼ŒSpring-securityè§£æheaderå¤´è·å–tokenä¿¡æ¯ï¼Œè§£ætokenè·å–å½“å‰ç”¨æˆ·åï¼Œæ ¹æ®ç”¨æˆ·åå°±å¯ä»¥ä»redisä¸­è·å–æƒé™åˆ—è¡¨ï¼Œè¿™æ ·Spring-securityå°±èƒ½å¤Ÿåˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦æœ‰æƒé™è®¿é—® æ•´åˆä¾èµ–1234567891011121314151617&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;artifactId&gt;common_utils&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring Securityä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é¡¹ç›®ç»“æ„ æµ‹è¯• å¦ˆè€¶å¤ªå“äººäº†å¹¸å¥½æˆ‘å¤‡ä»½äº†ï¼ˆä¸ºå•¥gitä¸å…ˆè®²ï¼‰ï¼Œè¯•äº†ä¸‹æ•´åˆï¼Œèœå•æ è¿˜æ˜¯æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œå…ˆæ¢å¤äº†ï¼Œä»¥åå†è¯• Nacosé…ç½®ç®¡ç†Gitç‰ˆæœ¬ç®¡ç† åˆ›å»ºæœ¬åœ°gitä»“åº“ï¼šidea -&gt; VCS -&gt; Create Git Repository å°†æ–‡ä»¶åŠ åˆ°æœ¬åœ°ä»“åº“ï¼šidea -&gt; çˆ¶é¡¹ç›®å -&gt; å³é”® -&gt; git -&gt; add æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€ï¼šidea -&gt; çˆ¶é¡¹ç›®å -&gt; å³é”® -&gt; git -&gt; git remotes å°†æ–‡ä»¶æäº¤è‡³è¿œç¨‹ä»“åº“ï¼šcommit ä¸Šä¼ ï¼špush","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜6","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜6","date":"2021-10-02T04:51:33.699Z","updated":"2021-10-05T07:14:17.776Z","comments":true,"path":"2021/10/02/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-6/","link":"","permalink":"http://example.com/2021/10/02/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-6/","excerpt":"","text":"å‰å°è®²å¸ˆåˆ—è¡¨å’Œè¯¦æƒ…ï¼ˆåç«¯+å‰ç«¯ï¼‰è®²å¸ˆåˆ†é¡µåˆ—è¡¨ï¼ˆåç«¯ï¼‰controller1234567891011121314151617@RestController@RequestMapping(&quot;/eduservice/teacherfront&quot;)@CrossOriginpublic class TeacherController &#123; @Autowired private EduTeacherService teacherService; // åˆ†é¡µæŸ¥è¯¢è®²å¸ˆåˆ—è¡¨ @GetMapping(&quot;getTeacherFront/&#123;pageNo&#125;/&#123;limit&#125;&quot;) public R getTeacherFront(@PathVariable Long limit, @PathVariable Long pageNo) &#123; // åˆ›å»ºpageå¯¹è±¡ Page&lt;EduTeacher&gt; pageTeacher = new Page&lt;&gt;(pageNo, limit); // è°ƒç”¨æ–¹æ³•å®ç°åˆ†ç±» Map&lt;String, Object&gt; map = teacherService.getTeacherFront(pageTeacher); // è¿”å›åˆ†é¡µæ‰€æœ‰æ•°æ® return R.ok().data(map); &#125;&#125; service123456789101112131415161718192021222324@Servicepublic class EduTeacherServiceImpl extends ServiceImpl&lt;EduTeacherMapper, EduTeacher&gt; implements EduTeacherService &#123; @Override @Cacheable(key = &quot;&#x27;indexTeacherList&#x27;&quot;, value = &quot;teacher&quot;) // redis public List&lt;EduTeacher&gt; getIndexList() &#123; return baseMapper.selectIndexList(); &#125; // åˆ†é¡µæŸ¥è¯¢è®²å¸ˆåˆ—è¡¨ @Override public Map&lt;String, Object&gt; getTeacherFront(Page&lt;EduTeacher&gt; pageTeacher) &#123; QueryWrapper wrapper = new QueryWrapper&lt;&gt;(); wrapper.orderByDesc(&quot;id&quot;); baseMapper.selectPage(pageTeacher, wrapper); Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;records&quot;, pageTeacher.getRecords()); map.put(&quot;total&quot;, pageTeacher.getTotal()); map.put(&quot;size&quot;, pageTeacher.getSize()); map.put(&quot;current&quot;, pageTeacher.getCurrent()); map.put(&quot;pages&quot;, pageTeacher.getPages()); map.put(&quot;hasNext&quot;, pageTeacher.hasNext()); map.put(&quot;hasPrevious&quot;, pageTeacher.hasPrevious()); return map; &#125;&#125; è®²å¸ˆåˆ†é¡µåˆ—è¡¨ï¼ˆå‰ç«¯ï¼‰api12345678910import request from &#x27;@/utils/request&#x27;export default &#123; // è®²å¸ˆåˆ†é¡µåˆ—è¡¨ getTeacherList(pageNo, limit) &#123; return request(&#123; url: `/eduservice/teacherfront/getTeacherFront/$&#123;pageNo&#125;/$&#123;limit&#125;`, method: &#x27;get&#x27;, &#125;) &#125;&#125; vue12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;!-- è®²å¸ˆåˆ—è¡¨ å¼€å§‹ --&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title all-teacher-title&quot;&gt; &lt;h2 class=&quot;fl tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;å…¨éƒ¨è®²å¸ˆ&lt;/span&gt; &lt;/h2&gt; &lt;section class=&quot;c-tab-title&quot;&gt; &lt;a id=&quot;subjectAll&quot; title=&quot;å…¨éƒ¨&quot; href=&quot;#&quot;&gt;å…¨éƒ¨&lt;/a&gt; &lt;/section&gt; &lt;/header&gt; &lt;section class=&quot;c-sort-box unBr&quot;&gt; &lt;div&gt; &lt;!-- /æ— æ•°æ®æç¤º å¼€å§‹--&gt; &lt;section class=&quot;no-data-wrap&quot; v-if=&quot;listMap.total == 0&quot;&gt; &lt;em class=&quot;icon30 no-data-ico&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;span class=&quot;c-666 fsize14 ml10 vam&quot; &gt;æ²¡æœ‰ç›¸å…³æ•°æ®ï¼Œå°ç¼–æ­£åœ¨åŠªåŠ›æ•´ç†ä¸­...&lt;/span &gt; &lt;/section&gt; &lt;!-- /æ— æ•°æ®æç¤º ç»“æŸ--&gt; &lt;article class=&quot;i-teacher-list&quot; v-if=&quot;listMap.total &gt; 0&quot;&gt; &lt;ul class=&quot;of&quot;&gt; &lt;li v-for=&quot;teacher in listMap.records&quot; :key=&quot;teacher.id&quot;&gt; &lt;section class=&quot;i-teach-wrap&quot;&gt; &lt;div class=&quot;i-teach-pic&quot;&gt; &lt;a :href=&quot;&#x27;/teacehr/&#x27;+teacher.id&quot; :title=&quot;teacher.name&quot; target=&quot;_blank&quot;&gt; &lt;img :src=&quot;teacher.avatar&quot; alt /&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;mt10 hLh30 txtOf tac&quot;&gt; &lt;a :href=&quot;&#x27;/teacehr/&#x27;+teacher.id&quot; :title=&quot;teacher.name&quot; target=&quot;_blank&quot; class=&quot;fsize18 c-666&quot; &gt;&#123;&#123; teacher.name &#125;&#125;&lt;/a &gt; &lt;/div&gt; &lt;div class=&quot;hLh30 txtOf tac&quot;&gt; &lt;span class=&quot;fsize14 c-999&quot;&gt;&#123;&#123; teacher.intro &#125;&#125;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;mt15 i-q-txt&quot;&gt; &lt;p class=&quot;c-999 f-fA&quot;&gt;&#123;&#123; teacher.career &#125;&#125;&lt;/p&gt; &lt;/div&gt; &lt;/section&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;/div&gt; &lt;/section&gt; &lt;/section&gt; &lt;!-- /è®²å¸ˆåˆ—è¡¨ ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import teacherApi from &#x27;@/api/teacher&#x27; export default &#123; // è¿™ä¸ªé¡µé¢æ¨¡æ¿æ²¡æœ‰ä½¿ç”¨element-uiçš„åˆ†é¡µæ¡ï¼Œæ‰€ä»¥å†™æ³•æœ‰æ‰€å˜åŒ– // ä½¿ç”¨å¼‚æ­¥è°ƒç”¨ï¼ˆthis.$route.param == paramsè·å–urlä¸­çš„å‚æ•°å€¼ï¼‰ // è¯¥æ–¹æ³•åªè°ƒç”¨ä¸€æ¬¡ asyncData(&#123; params, error &#125;) &#123; return teacherApi.getTeacherList(1, 8).then(result =&gt; &#123; // è¿™é‡Œæ˜¯èµ‹å€¼çš„ç®€å†™æ–¹å¼ return &#123; listMap: result.data.data &#125; &#125;) &#125; &#125;&lt;/script&gt; åˆ†é¡µæ¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;!-- å…¬å…±åˆ†é¡µ å¼€å§‹ --&gt; &lt;div&gt; &lt;div class=&quot;paging&quot;&gt; &lt;!-- undisableè¿™ä¸ªclassæ˜¯å¦å­˜åœ¨ï¼Œå–å†³äºæ•°æ®å±æ€§hasPrevious --&gt; &lt;a :class=&quot;&#123; undisable: !listMap.hasPrevious &#125;&quot; href=&quot;#&quot; title=&quot;é¦–é¡µ&quot; @click.prevent=&quot;gotoPage(1)&quot; &gt;é¦–é¡µ&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !listMap.hasPrevious &#125;&quot; href=&quot;#&quot; title=&quot;å‰ä¸€é¡µ&quot; @click.prevent=&quot;gotoPage(listMap.current - 1)&quot; &gt;&amp;lt;&lt;/a &gt; &lt;a v-for=&quot;page in listMap.pages&quot; :key=&quot;page&quot; :class=&quot;&#123; current: listMap.current == page, undisable: listMap.current == page, &#125;&quot; :title=&quot;&#x27;ç¬¬&#x27; + page + &#x27;é¡µ&#x27;&quot; href=&quot;#&quot; @click.prevent=&quot;gotoPage(page)&quot; &gt;&#123;&#123; page &#125;&#125;&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !listMap.hasNext &#125;&quot; href=&quot;#&quot; title=&quot;åä¸€é¡µ&quot; @click.prevent=&quot;gotoPage(listMap.current + 1)&quot; &gt;&amp;gt;&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !listMap.hasNext &#125;&quot; href=&quot;#&quot; title=&quot;æœ«é¡µ&quot; @click.prevent=&quot;gotoPage(listMap.pages)&quot; &gt;æœ«é¡µ&lt;/a &gt; &lt;div class=&quot;clear&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- å…¬å…±åˆ†é¡µ ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import teacherApi from &#x27;@/api/teacher&#x27; export default &#123; methods: &#123; // åˆ†é¡µåˆ‡æ¢ gotoPage(page) &#123; teacherApi.getTeacherList(page, 8).then(result =&gt; &#123; this.listMap = result.data.data &#125;) &#125; &#125; &#125;&lt;/script&gt; è®²å¸ˆè¯¦æƒ…ï¼ˆåç«¯ï¼‰123456789// è®²å¸ˆè¯¦æƒ…@GetMapping(&quot;getTeacherInfoFront/&#123;teacherId&#125;&quot;)public R getTeacherInfoFront(@PathVariable String teacherId) &#123; EduTeacher teacherInfo = teacherService.getById(teacherId); QueryWrapper wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;teacher_id&quot;, teacherId); List&lt;EduCourse&gt; courseList = courseService.list(wrapper); return R.ok().data(&quot;teacherInfo&quot;, teacherInfo).data(&quot;courseList&quot;, courseList);&#125; è®²å¸ˆè¯¦æƒ…ï¼ˆå‰ç«¯ï¼‰api1234567// è®²å¸ˆè¯¦æƒ…getTeacherInfo(teacherId) &#123; return request(&#123; url: `/eduservice/teacherfront/getTeacherInfoFront/$&#123;teacherId&#125;`, method: &#x27;get&#x27;, &#125;)&#125; vue æ³¨æ„NUXTçš„åŠ¨æ€å˜é‡çš„é¡µé¢ä¸º_xxx.vue 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;!-- è®²å¸ˆä»‹ç» å¼€å§‹ --&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;fl tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;è®²å¸ˆä»‹ç»&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;div class=&quot;t-infor-wrap&quot;&gt; &lt;!-- è®²å¸ˆåŸºæœ¬ä¿¡æ¯ --&gt; &lt;section class=&quot;fl t-infor-box c-desc-content&quot;&gt; &lt;div class=&quot;mt20 ml20&quot;&gt; &lt;section class=&quot;t-infor-pic&quot;&gt; &lt;img :src=&quot;teacherInfo.avatar&quot; /&gt; &lt;/section&gt; &lt;h3 class=&quot;hLh30&quot;&gt; &lt;span class=&quot;fsize24 c-333&quot; &gt;&#123;&#123; teacherInfo.name &#125;&#125;&amp;nbsp;&#123;&#123; teacherInfo.level === 1 ? &quot;é«˜çº§è®²å¸ˆ&quot; : &quot;é¦–å¸­è®²å¸ˆ&quot; &#125;&#125;&lt;/span &gt; &lt;/h3&gt; &lt;section class=&quot;mt10&quot;&gt; &lt;span class=&quot;t-tag-bg&quot;&gt;&#123;&#123; teacherInfo.career &#125;&#125;&lt;/span&gt; &lt;/section&gt; &lt;section class=&quot;t-infor-txt&quot;&gt; &lt;p class=&quot;mt20&quot;&gt; &#123;&#123; teacherInfo.intro &#125;&#125; &lt;/p&gt; &lt;/section&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;section class=&quot;mt30&quot;&gt; &lt;div&gt; &lt;header class=&quot;comm-title all-teacher-title c-course-content&quot;&gt; &lt;h2 class=&quot;fl tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;ä¸»è®²è¯¾ç¨‹&lt;/span&gt; &lt;/h2&gt; &lt;section class=&quot;c-tab-title&quot;&gt; &lt;a href=&quot;javascript: void(0)&quot;&gt;&amp;nbsp;&lt;/a&gt; &lt;/section&gt; &lt;/header&gt; &lt;!-- /æ— æ•°æ®æç¤º å¼€å§‹--&gt; &lt;section class=&quot;no-data-wrap&quot; v-if=&quot;courseList.length == 0&quot;&gt; &lt;em class=&quot;icon30 no-data-ico&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;span class=&quot;c-666 fsize14 ml10 vam&quot; &gt;æ²¡æœ‰ç›¸å…³æ•°æ®ï¼Œå°ç¼–æ­£åœ¨åŠªåŠ›æ•´ç†ä¸­...&lt;/span &gt; &lt;/section&gt; &lt;!-- /æ— æ•°æ®æç¤º ç»“æŸ--&gt; &lt;article class=&quot;comm-course-list&quot; v-if=&quot;courseList.length &gt; 0&quot;&gt; &lt;ul class=&quot;of&quot;&gt; &lt;li v-for=&quot;course in courseList&quot; :key=&quot;course.id&quot;&gt; &lt;div class=&quot;cc-l-wrap&quot;&gt; &lt;section class=&quot;course-img&quot;&gt; &lt;img :src=&quot;course.cover&quot; class=&quot;img-responsive&quot; /&gt; &lt;div class=&quot;cc-mask&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å¼€å§‹å­¦ä¹ &quot; target=&quot;_blank&quot; class=&quot;comm-btn c-btn-1&quot; &gt;å¼€å§‹å­¦ä¹ &lt;/a &gt; &lt;/div&gt; &lt;/section&gt; &lt;h3 class=&quot;hLh30 txtOf mt10&quot;&gt; &lt;a href=&quot;#&quot; :title=&quot;course.title&quot; target=&quot;_blank&quot; class=&quot;course-title fsize18 c-333&quot; &gt;&#123;&#123; course.title &#125;&#125;&lt;/a &gt; &lt;/h3&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;/div&gt; &lt;/section&gt; &lt;/section&gt; &lt;!-- /è®²å¸ˆä»‹ç» ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import teacherApi from &#x27;@/api/teacher&#x27; export default &#123; asyncData(&#123; params, error &#125;) &#123; // æ³¨æ„è¿™é‡Œçš„paramsåè·Ÿçš„åå­—è¦å’Œvueæ–‡ä»¶åå¯¹åº”ï¼ˆæ‰€ä»¥ä»–æ˜¯åªèƒ½ä¼ ä¸€ä¸ªå‚æ•°å—ï¼Ÿï¼‰ return teacherApi.getTeacherInfo(params.id).then(result =&gt; &#123; return &#123; teacherInfo: result.data.data.teacherInfo, courseList: result.data.data.courseList &#125; &#125;) &#125; &#125;&lt;/script&gt; å‰å°è¯¾ç¨‹åˆ—è¡¨å’Œè¯¦æƒ…ï¼ˆåç«¯+å‰ç«¯ï¼‰è¯¾ç¨‹åˆ—è¡¨ï¼ˆåç«¯ï¼‰voç±»1234567891011121314151617181920212223@Datapublic class CourseFrontVo &#123; @ApiModelProperty(value = &quot;è¯¾ç¨‹åç§°&quot;) private String title; @ApiModelProperty(value = &quot;è®²å¸ˆid&quot;) private String teacherId; @ApiModelProperty(value = &quot;ä¸€çº§ç±»åˆ«id&quot;) private String subjectParentId; @ApiModelProperty(value = &quot;äºŒçº§ç±»åˆ«id&quot;) private String subjectId; @ApiModelProperty(value = &quot;é”€é‡æ’åº&quot;) private String buyCountSort; @ApiModelProperty(value = &quot;æœ€æ–°æ—¶é—´æ’åº&quot;) private String gmtCreateSort; @ApiModelProperty(value = &quot;ä»·æ ¼æ’åº&quot;) private String priceSort;&#125; controller12345678910111213141516@RestController@CrossOrigin@RequestMapping(&quot;/eduservice/coursefront&quot;)public class CourseController &#123; @Autowired private EduCourseService courseService; // æ¡ä»¶æŸ¥è¯¢å¸¦åˆ†é¡µ @PostMapping(&quot;getCourseList/&#123;pageNo&#125;/&#123;limit&#125;&quot;) public R getCourseListCondition(@PathVariable Long limit, @PathVariable Long pageNo, @RequestBody(required = false) CourseFrontVo courseFrontVo) &#123; Page&lt;EduCourse&gt; pageCourse = new Page&lt;&gt;(pageNo, limit); Map&lt;String, Object&gt; map = courseService.getCOurseFrontList(pageCourse, courseFrontVo); return R.ok().data(map); &#125; &#125; service12345678910111213141516171819202122232425262728293031323334353637383940414243@Overridepublic Map&lt;String, Object&gt; getCourseFrontList(Page&lt;EduCourse&gt; pageCourse, CourseFrontVo courseFrontVo) &#123; QueryWrapper wrapper = new QueryWrapper(); // åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºç©º if (!StringUtils.isEmpty(courseFrontVo.getSubjectParentId())) &#123; wrapper.eq(&quot;subject_parent_id&quot;, courseFrontVo.getSubjectParentId()); &#125; if (!StringUtils.isEmpty(courseFrontVo.getSubjectId())) &#123; wrapper.eq(&quot;subject_id&quot;, courseFrontVo.getSubjectId()); &#125; if (!StringUtils.isEmpty(courseFrontVo.getBuyCountSort())) &#123; wrapper.orderByDesc(&quot;buy_count&quot;); &#125; if (!StringUtils.isEmpty(courseFrontVo.getGmtCreateSort())) &#123; //æœ€æ–° wrapper.orderByDesc(&quot;gmt_create&quot;); &#125; if (!StringUtils.isEmpty(courseFrontVo.getPriceSort())) &#123;//ä»·æ ¼ wrapper.orderByDesc(&quot;price&quot;); &#125; baseMapper.selectPage(pageCourse, wrapper); List&lt;EduCourse&gt; records = pageCourse.getRecords(); long current = pageCourse.getCurrent(); long pages = pageCourse.getPages(); long size = pageCourse.getSize(); long total = pageCourse.getTotal(); boolean hasNext = pageCourse.hasNext();//ä¸‹ä¸€é¡µ boolean hasPrevious = pageCourse.hasPrevious();//ä¸Šä¸€é¡µ //æŠŠåˆ†é¡µæ•°æ®è·å–å‡ºæ¥ï¼Œæ”¾åˆ°mapé›†åˆ Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;items&quot;, records); map.put(&quot;current&quot;, current); map.put(&quot;pages&quot;, pages); map.put(&quot;size&quot;, size); map.put(&quot;total&quot;, total); map.put(&quot;hasNext&quot;, hasNext); map.put(&quot;hasPrevious&quot;, hasPrevious); //mapè¿”å› return map;&#125; è¯¾ç¨‹åˆ—è¡¨ï¼ˆå‰ç«¯ï¼‰api12345678910111213141516171819import request from &#x27;@/utils/request&#x27;export default &#123; // è®²å¸ˆåˆ†é¡µåˆ—è¡¨ getCourseList(pageNo, limit, queryCourse) &#123; return request(&#123; url: `/eduservice/coursefront/getCourseList/$&#123;pageNo&#125;/$&#123;limit&#125;`, method: &#x27;post&#x27;, data: queryCourse &#125;) &#125;, // è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨ getSubjectList() &#123; return request(&#123; url: `/eduservice/subject/getAllSubjects`, method: &#x27;get&#x27; &#125;)&#125;&#125; vue è¿™ä¸€å—å†…å®¹æŒºå¤šçš„ï¼Œæœ‰äºŒçº§è”åŠ¨æŸ¥è¯¢ï¼Œæœ‰åˆ†é¡µæ¡ï¼Œæœ‰æ¡ä»¶æ’åºç­‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;!-- /è¯¾ç¨‹åˆ—è¡¨ å¼€å§‹ --&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;fl tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;å…¨éƒ¨è¯¾ç¨‹&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;section class=&quot;c-sort-box&quot;&gt; &lt;section class=&quot;c-s-dl&quot;&gt; &lt;dl&gt; &lt;dt&gt; &lt;span class=&quot;c-999 fsize14&quot;&gt;è¯¾ç¨‹ç±»åˆ«&lt;/span&gt; &lt;/dt&gt; &lt;dd class=&quot;c-s-dl-li&quot;&gt; &lt;ul class=&quot;clearfix&quot;&gt; &lt;li&gt; &lt;a title=&quot;å…¨éƒ¨&quot; href=&quot;#&quot;&gt;å…¨éƒ¨&lt;/a&gt; &lt;/li&gt; &lt;li v-for=&quot;(item, index) in subjectNestedList&quot; :key=&quot;index&quot; :class=&quot;&#123; active: oneIndex == index &#125;&quot; &gt; &lt;a :title=&quot;item.title&quot; href=&quot;#&quot; @click=&quot;searchOne(item.id, index)&quot; &gt;&#123;&#123; item.title &#125;&#125;&lt;/a &gt; &lt;/li&gt; &lt;/ul&gt; &lt;/dd&gt; &lt;/dl&gt; &lt;dl&gt; &lt;dt&gt; &lt;span class=&quot;c-999 fsize14&quot;&gt;&lt;/span&gt; &lt;/dt&gt; &lt;dd class=&quot;c-s-dl-li&quot;&gt; &lt;ul class=&quot;clearfix&quot;&gt; &lt;li v-for=&quot;(item, index) in subSubjectList&quot; :key=&quot;index&quot; :class=&quot;&#123; active: twoIndex == index &#125;&quot; &gt; &lt;a :title=&quot;item.title&quot; href=&quot;#&quot; @click=&quot;searchTwo(item.id, index)&quot; &gt;&#123;&#123; item.title &#125;&#125;&lt;/a &gt; &lt;/li&gt; &lt;/ul&gt; &lt;/dd&gt; &lt;/dl&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/section&gt; &lt;div class=&quot;js-wrap&quot;&gt; &lt;section class=&quot;fr&quot;&gt; &lt;span class=&quot;c-ccc&quot;&gt; &lt;i class=&quot;c-master f-fM&quot;&gt;1&lt;/i&gt;/ &lt;i class=&quot;c-666 f-fM&quot;&gt;1&lt;/i&gt; &lt;/span&gt; &lt;/section&gt; &lt;section class=&quot;fl&quot;&gt; &lt;ol class=&quot;js-tap clearfix&quot;&gt; &lt;li :class=&quot;&#123; &#x27;current bg-orange&#x27;: buyCountSort != &#x27;&#x27; &#125;&quot;&gt; &lt;a title=&quot;é”€é‡&quot; href=&quot;javascript:void(0);&quot; @click=&quot;searchBuyCount()&quot; &gt;é”€é‡ &lt;span :class=&quot;&#123; hide: buyCountSort == &#x27;&#x27; &#125;&quot;&gt;â†“&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li :class=&quot;&#123; &#x27;current bg-orange&#x27;: gmtCreateSort != &#x27;&#x27; &#125;&quot;&gt; &lt;a title=&quot;æœ€æ–°&quot; href=&quot;javascript:void(0);&quot; @click=&quot;searchGmtCreate()&quot; &gt;æœ€æ–° &lt;span :class=&quot;&#123; hide: gmtCreateSort == &#x27;&#x27; &#125;&quot;&gt;â†“&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li :class=&quot;&#123; &#x27;current bg-orange&#x27;: priceSort != &#x27;&#x27; &#125;&quot;&gt; &lt;a title=&quot;ä»·æ ¼&quot; href=&quot;javascript:void(0);&quot; @click=&quot;searchPrice()&quot; &gt;ä»·æ ¼&amp;nbsp; &lt;span :class=&quot;&#123; hide: priceSort == &#x27;&#x27; &#125;&quot;&gt;â†“&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;/ol&gt; &lt;/section&gt; &lt;/div&gt; &lt;div class=&quot;mt40&quot;&gt; &lt;!-- /æ— æ•°æ®æç¤º å¼€å§‹--&gt; &lt;section class=&quot;no-data-wrap&quot; v-if=&quot;data.total == 0&quot;&gt; &lt;em class=&quot;icon30 no-data-ico&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;span class=&quot;c-666 fsize14 ml10 vam&quot; &gt;æ²¡æœ‰ç›¸å…³æ•°æ®ï¼Œå°ç¼–æ­£åœ¨åŠªåŠ›æ•´ç†ä¸­...&lt;/span &gt; &lt;/section&gt; &lt;!-- /æ— æ•°æ®æç¤º ç»“æŸ--&gt; &lt;article v-if=&quot;data.total &gt; 0&quot; class=&quot;comm-course-list&quot;&gt; &lt;ul class=&quot;of&quot; id=&quot;bna&quot;&gt; &lt;li v-for=&quot;item in data.items&quot; :key=&quot;item.id&quot;&gt; &lt;div class=&quot;cc-l-wrap&quot;&gt; &lt;section class=&quot;course-img&quot;&gt; &lt;img :src=&quot;item.cover&quot; class=&quot;img-responsive&quot; :alt=&quot;item.title&quot; /&gt; &lt;div class=&quot;cc-mask&quot;&gt; &lt;a :href=&quot;&#x27;/course/&#x27; + item.id&quot; title=&quot;å¼€å§‹å­¦ä¹ &quot; class=&quot;comm-btn c-btn-1&quot; &gt;å¼€å§‹å­¦ä¹ &lt;/a &gt; &lt;/div&gt; &lt;/section&gt; &lt;h3 class=&quot;hLh30 txtOf mt10&quot;&gt; &lt;a :href=&quot;&#x27;/course/&#x27; + item.id&quot; :title=&quot;item.title&quot; class=&quot;course-title fsize18 c-333&quot; &gt;&#123;&#123; item.title &#125;&#125;&lt;/a &gt; &lt;/h3&gt; &lt;section class=&quot;mt10 hLh20 of&quot;&gt; &lt;span v-if=&quot;Number(item.price) === 0&quot; class=&quot;fr jgTag bg-green&quot; &gt; &lt;i class=&quot;c-fff fsize12 f-fA&quot;&gt;å…è´¹&lt;/i&gt; &lt;/span&gt; &lt;span class=&quot;fl jgAttr c-ccc f-fA&quot;&gt; &lt;i class=&quot;c-999 f-fA&quot;&gt;9634äººå­¦ä¹ &lt;/i&gt; | &lt;i class=&quot;c-999 f-fA&quot;&gt;9634è¯„è®º&lt;/i&gt; &lt;/span&gt; &lt;/section&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;/div&gt; &lt;!-- å…¬å…±åˆ†é¡µ å¼€å§‹ --&gt; &lt;div&gt; &lt;div class=&quot;paging&quot;&gt; &lt;!-- undisableè¿™ä¸ªclassæ˜¯å¦å­˜åœ¨ï¼Œå–å†³äºæ•°æ®å±æ€§hasPrevious --&gt; &lt;a :class=&quot;&#123; undisable: !data.hasPrevious &#125;&quot; href=&quot;#&quot; title=&quot;é¦–é¡µ&quot; @click.prevent=&quot;gotoPage(1)&quot; &gt;é¦–&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !data.hasPrevious &#125;&quot; href=&quot;#&quot; title=&quot;å‰ä¸€é¡µ&quot; @click.prevent=&quot;gotoPage(data.current - 1)&quot; &gt;&amp;lt;&lt;/a &gt; &lt;a v-for=&quot;page in data.pages&quot; :key=&quot;page&quot; :class=&quot;&#123; current: data.current == page, undisable: data.current == page, &#125;&quot; :title=&quot;&#x27;ç¬¬&#x27; + page + &#x27;é¡µ&#x27;&quot; href=&quot;#&quot; @click.prevent=&quot;gotoPage(page)&quot; &gt;&#123;&#123; page &#125;&#125;&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !data.hasNext &#125;&quot; href=&quot;#&quot; title=&quot;åä¸€é¡µ&quot; @click.prevent=&quot;gotoPage(data.current + 1)&quot; &gt;&amp;gt;&lt;/a &gt; &lt;a :class=&quot;&#123; undisable: !data.hasNext &#125;&quot; href=&quot;#&quot; title=&quot;æœ«é¡µ&quot; @click.prevent=&quot;gotoPage(data.pages)&quot; &gt;æœ«&lt;/a &gt; &lt;div class=&quot;clear&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/section&gt; &lt;!-- /è¯¾ç¨‹åˆ—è¡¨ ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import courseApi from &#x27;@/api/course&#x27; export default &#123; data() &#123; return &#123; page: 1, // å½“å‰é¡µ data: &#123;&#125;, // è¯¾ç¨‹åˆ—è¡¨ subjectNestedList: [], // ä¸€çº§åˆ†ç±»åˆ—è¡¨ subSubjectList: [], // äºŒçº§åˆ†ç±»åˆ—è¡¨ queryObj: &#123;&#125;, // æŸ¥è¯¢è¡¨å•å¯¹è±¡ oneIndex: -1, twoIndex: -1, buyCountSort: &#x27;&#x27;, gmtCreateSort: &#x27;&#x27;, priceSort: &#x27;&#x27; &#125; &#125;, created() &#123; // è¯¾ç¨‹ç¬¬ä¸€æ¬¡æŸ¥è¯¢ this.initCourseFirst() // ä¸€çº§åˆ†ç±»æ˜¾ç¤º this.initSubject() &#125;, methods: &#123; // 1 æŸ¥è¯¢ç¬¬ä¸€é¡µæ•°æ® initCourseFirst() &#123; courseApi.getCourseList(1, 8, this.queryObj).then(response =&gt; &#123; this.data = response.data.data &#125;) &#125;, // 2 æŸ¥è¯¢æ‰€æœ‰ä¸€çº§åˆ†ç±» initSubject() &#123; courseApi.getSubjectList().then(response =&gt; &#123; this.subjectNestedList = response.data.data.list &#125;) &#125;, // 3 åˆ†é¡µåˆ‡æ¢çš„æ–¹æ³• gotoPage(page) &#123; courseApi.getCourseList(page, 8, this.queryObj).then(response =&gt; &#123; this.data = response.data.data &#125;) &#125;, // 4 ç‚¹å‡»æŸä¸ªä¸€çº§åˆ†ç±»ï¼ŒæŸ¥è¯¢å¯¹åº”äºŒçº§åˆ†ç±» searchOne(subjectParentId, index) &#123; // æŠŠä¼ é€’indexå€¼èµ‹å€¼ç»™oneIndex,ä¸ºäº†activeæ ·å¼ç”Ÿæ•ˆ this.oneIndex = index this.twoIndex = -1 this.queryObj.subjectId = &#x27;&#x27; this.subSubjectList = [] // æŠŠä¸€çº§åˆ†ç±»ç‚¹å‡»idå€¼ï¼Œèµ‹å€¼ç»™queryObj this.queryObj.subjectParentId = subjectParentId // ç‚¹å‡»æŸä¸ªä¸€çº§åˆ†ç±»è¿›è¡Œæ¡ä»¶æŸ¥è¯¢ this.gotoPage(1) // æ‹¿ç€ç‚¹å‡»ä¸€çº§åˆ†ç±»id å’Œ æ‰€æœ‰ä¸€çº§åˆ†ç±»idè¿›è¡Œæ¯”è¾ƒï¼Œ // å¦‚æœidç›¸åŒï¼Œä»ä¸€çº§åˆ†ç±»é‡Œé¢è·å–å¯¹åº”çš„äºŒçº§åˆ†ç±» for (let i = 0; i &lt; this.subjectNestedList.length; i++) &#123; // è·å–æ¯ä¸ªä¸€çº§åˆ†ç±» var oneSubject = this.subjectNestedList[i] // æ¯”è¾ƒidæ˜¯å¦ç›¸åŒ if (subjectParentId == oneSubject.id) &#123; // ä»ä¸€çº§åˆ†ç±»é‡Œé¢è·å–å¯¹åº”çš„äºŒçº§åˆ†ç±» this.subSubjectList = oneSubject.children &#125; &#125; &#125;, // 5 ç‚¹å‡»æŸä¸ªäºŒçº§åˆ†ç±»å®ç°æŸ¥è¯¢ searchTwo(subjectId, index) &#123; // æŠŠindexèµ‹å€¼,ä¸ºäº†æ ·å¼ç”Ÿæ•ˆ this.twoIndex = index // æŠŠäºŒçº§åˆ†ç±»ç‚¹å‡»idå€¼ï¼Œèµ‹å€¼ç»™queryObj this.queryObj.subjectId = subjectId // ç‚¹å‡»æŸä¸ªäºŒçº§åˆ†ç±»è¿›è¡Œæ¡ä»¶æŸ¥è¯¢ this.gotoPage(1) &#125;, // 6 æ ¹æ®é”€é‡æ’åº searchBuyCount() &#123; // è®¾ç½®å¯¹åº”å˜é‡å€¼ï¼Œä¸ºäº†æ ·å¼ç”Ÿæ•ˆ this.buyCountSort = &#x27;1&#x27; this.gmtCreateSort = &#x27;&#x27; this.priceSort = &#x27;&#x27; // æŠŠå€¼èµ‹å€¼åˆ°queryObj this.queryObj.buyCountSort = this.buyCountSort this.queryObj.gmtCreateSort = this.gmtCreateSort this.queryObj.priceSort = this.priceSort // è°ƒç”¨æ–¹æ³•æŸ¥è¯¢ this.gotoPage(1) &#125;, // 7 æœ€æ–°æ’åº searchGmtCreate() &#123; // è®¾ç½®å¯¹åº”å˜é‡å€¼ï¼Œä¸ºäº†æ ·å¼ç”Ÿæ•ˆ this.buyCountSort = &#x27;&#x27; this.gmtCreateSort = &#x27;1&#x27; this.priceSort = &#x27;&#x27; // æŠŠå€¼èµ‹å€¼åˆ°queryObj this.queryObj.buyCountSort = this.buyCountSort this.queryObj.gmtCreateSort = this.gmtCreateSort this.queryObj.priceSort = this.priceSort // è°ƒç”¨æ–¹æ³•æŸ¥è¯¢ this.gotoPage(1) &#125;, // 8 ä»·æ ¼æ’åº searchPrice() &#123; // è®¾ç½®å¯¹åº”å˜é‡å€¼ï¼Œä¸ºäº†æ ·å¼ç”Ÿæ•ˆ this.buyCountSort = &#x27;&#x27; this.gmtCreateSort = &#x27;&#x27; this.priceSort = &#x27;1&#x27; // æŠŠå€¼èµ‹å€¼åˆ°queryObj this.queryObj.buyCountSort = this.buyCountSort this.queryObj.gmtCreateSort = this.gmtCreateSort this.queryObj.priceSort = this.priceSort // è°ƒç”¨æ–¹æ³•æŸ¥è¯¢ this.gotoPage(1) &#125; &#125; &#125;&lt;/script&gt;&lt;style scoped&gt; .active &#123; background: #bdbdbd; &#125; .hide &#123; display: none; &#125; .show &#123; display: block; &#125;&lt;/style&gt; è¯¾ç¨‹è¯¦æƒ…ï¼ˆåç«¯ï¼‰voç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** * è¯¾ç¨‹åŸºç¡€ä¿¡æ¯VO */@Datapublic class CourseFrontInfoVo &#123; private String id; @ApiModelProperty(value = &quot;è¯¾ç¨‹æ ‡é¢˜&quot;) private String title; @ApiModelProperty(value = &quot;è¯¾ç¨‹é”€å”®ä»·æ ¼ï¼Œè®¾ç½®ä¸º0åˆ™å¯å…è´¹è§‚çœ‹&quot;) private BigDecimal price; @ApiModelProperty(value = &quot;æ€»è¯¾æ—¶&quot;) private Integer lessonNum; @ApiModelProperty(value = &quot;è¯¾ç¨‹å°é¢å›¾ç‰‡è·¯å¾„&quot;) private String cover; @ApiModelProperty(value = &quot;é”€å”®æ•°é‡&quot;) private Long buyCount; @ApiModelProperty(value = &quot;æµè§ˆæ•°é‡&quot;) private Long viewCount; @ApiModelProperty(value = &quot;è¯¾ç¨‹ç®€ä»‹&quot;) private String description; @ApiModelProperty(value = &quot;è®²å¸ˆID&quot;) private String teacherId; @ApiModelProperty(value = &quot;è®²å¸ˆå§“å&quot;) private String teacherName; @ApiModelProperty(value = &quot;è®²å¸ˆèµ„å†,ä¸€å¥è¯è¯´æ˜è®²å¸ˆ&quot;) private String intro; @ApiModelProperty(value = &quot;è®²å¸ˆå¤´åƒ&quot;) private String avatar; @ApiModelProperty(value = &quot;è¯¾ç¨‹ä¸€çº§ç±»åˆ«ID&quot;) private String subjectLevelOneId; @ApiModelProperty(value = &quot;ç±»åˆ«ä¸€çº§åç§°&quot;) private String subjectLevelOne; @ApiModelProperty(value = &quot;è¯¾ç¨‹äºŒçº§ç±»åˆ«ID&quot;) private String subjectLevelTwoId; @ApiModelProperty(value = &quot;ç±»åˆ«äºŒçº§åç§°&quot;) private String subjectLevelTwo;&#125; controller1234567// è¯¾ç¨‹è¯¦æƒ…ä¿¡æ¯@GetMapping(&quot;getCourseInfo/&#123;courseId&#125;&quot;)public R getCourseInfo(@PathVariable String courseId) &#123; CourseFrontInfoVo courseInfo = courseService.getBaseCourseInfo(courseId); List&lt;ChapterVo&gt; chapterList = chapterService.getChapterVideoByCourseId(courseId); return R.ok().data(&quot;courseInfo&quot;, courseInfo).data(&quot;chapterList&quot;, chapterList);&#125; service12345// æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ä»¥åŠå…¶ç« èŠ‚åˆ—è¡¨@Overridepublic CourseFrontInfoVo getBaseCourseInfo(String courseId) &#123; return baseMapper.getBaseCourseInfo(courseId);&#125; mapper12345678910111213141516171819202122232425&lt;!-- æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ --&gt;&lt;select id=&quot;getBaseCourseInfo&quot; resultType=&quot;com.atguigu.eduservice.entity.frontVo.CourseFrontInfoVo&quot;&gt; select ec.id, ec.title, ec.price, ec.cover, ec.lesson_num AS lessonNum, ec.buy_count AS buyCount, ec.view_count AS viewCount, ecd.description, et.id AS teacherId, et.name AS teacherName, et.intro, et.avatar, es1.id AS subjectLevelOneId, es1.title AS subjectLevelOne, es2.id AS subjectLevelTwoId, es2.title AS subjectLevelTwo from edu_course ec left join edu_course_description ecd on ec.id = ecd.id left join edu_teacher et on ec.teacher_id = et.id left join edu_subject es1 on ec.subject_parent_id = es1.id left join edu_subject es2 on ec.subject_id = es2.id where ec.id = #&#123;courseId&#125;&lt;/select&gt; è¯¾ç¨‹è¯¦æƒ…ï¼ˆå‰ç«¯ï¼‰api1234567// è·å¾—è¯¾ç¨‹ä¿¡æ¯getCourseInfo(courseId) &#123; return request(&#123; url: `/eduservice/coursefront/getCourseInfo/$&#123;courseId&#125;`, method: &#x27;get&#x27; &#125;)&#125; vue æ³¨æ„è¿™é‡Œçš„ç®€ä»‹æ˜¾ç¤ºï¼Œéœ€è¦ä½¿ç”¨v-html 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;!-- /è¯¾ç¨‹è¯¦æƒ… å¼€å§‹ --&gt; &lt;section class=&quot;container&quot;&gt; &lt;!-- è¿™é‡Œæ˜¯ä¸€ä¸ªé¢åŒ…å±‘å¯¼èˆª --&gt; &lt;section class=&quot;path-wrap txtOf hLh30&quot;&gt; &lt;a href=&quot;#&quot; title class=&quot;c-999 fsize14&quot;&gt;é¦–é¡µ&lt;/a&gt; \\ &lt;a href=&quot;#&quot; title class=&quot;c-999 fsize14&quot;&gt;&#123;&#123; courseInfo.subjectLevelOne &#125;&#125;&lt;/a&gt; \\ &lt;span class=&quot;c-333 fsize14&quot;&gt;&#123;&#123; courseInfo.subjectLevelTwo &#125;&#125;&lt;/span&gt; &lt;/section&gt; &lt;div&gt; &lt;article class=&quot;c-v-pic-wrap&quot; style=&quot;height: 357px&quot;&gt; &lt;section class=&quot;p-h-video-box&quot; id=&quot;videoPlay&quot;&gt; &lt;img :src=&quot;courseInfo.cover&quot; :alt=&quot;courseInfo.title&quot; class=&quot;dis c-v-pic&quot; /&gt; &lt;/section&gt; &lt;/article&gt; &lt;aside class=&quot;c-attr-wrap&quot;&gt; &lt;section class=&quot;ml20 mr15&quot;&gt; &lt;h2 class=&quot;hLh30 txtOf mt15&quot;&gt; &lt;span class=&quot;c-fff fsize24&quot;&gt;&#123;&#123; courseInfo.title &#125;&#125;&lt;/span&gt; &lt;/h2&gt; &lt;section class=&quot;c-attr-jg&quot;&gt; &lt;span class=&quot;c-fff&quot;&gt;ä»·æ ¼ï¼š&lt;/span&gt; &lt;b class=&quot;c-yellow&quot; style=&quot;font-size: 24px&quot; &gt;ï¿¥&#123;&#123; courseInfo.price &#125;&#125;&lt;/b &gt; &lt;/section&gt; &lt;section class=&quot;c-attr-mt c-attr-undis&quot;&gt; &lt;span class=&quot;c-fff fsize14&quot; &gt;ä¸»è®²ï¼š &#123;&#123; courseInfo.teacherName &#125;&#125;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span &gt; &lt;/section&gt; &lt;section class=&quot;c-attr-mt of&quot;&gt; &lt;span class=&quot;ml10 vam&quot;&gt; &lt;em class=&quot;icon18 scIcon&quot;&gt;&lt;/em&gt; &lt;a class=&quot;c-fff vam&quot; title=&quot;æ”¶è—&quot; href=&quot;#&quot;&gt;æ”¶è—&lt;/a&gt; &lt;/span&gt; &lt;/section&gt; &lt;section class=&quot;c-attr-mt&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;ç«‹å³è§‚çœ‹&quot; class=&quot;comm-btn c-btn-3&quot;&gt;ç«‹å³è§‚çœ‹&lt;/a&gt; &lt;/section&gt; &lt;/section&gt; &lt;/aside&gt; &lt;aside class=&quot;thr-attr-box&quot;&gt; &lt;ol class=&quot;thr-attr-ol clearfix&quot;&gt; &lt;li&gt; &lt;p&gt;&amp;nbsp;&lt;/p&gt; &lt;aside&gt; &lt;span class=&quot;c-fff f-fM&quot;&gt;è´­ä¹°æ•°&lt;/span&gt; &lt;br /&gt; &lt;h6 class=&quot;c-fff f-fM mt10&quot;&gt;&#123;&#123; courseInfo.buyCount &#125;&#125;&lt;/h6&gt; &lt;/aside&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&amp;nbsp;&lt;/p&gt; &lt;aside&gt; &lt;span class=&quot;c-fff f-fM&quot;&gt;è¯¾æ—¶æ•°&lt;/span&gt; &lt;br /&gt; &lt;h6 class=&quot;c-fff f-fM mt10&quot;&gt;&#123;&#123; courseInfo.lessonNum &#125;&#125;&lt;/h6&gt; &lt;/aside&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&amp;nbsp;&lt;/p&gt; &lt;aside&gt; &lt;span class=&quot;c-fff f-fM&quot;&gt;æµè§ˆæ•°&lt;/span&gt; &lt;br /&gt; &lt;h6 class=&quot;c-fff f-fM mt10&quot;&gt;&#123;&#123; courseInfo.viewCount &#125;&#125;&lt;/h6&gt; &lt;/aside&gt; &lt;/li&gt; &lt;/ol&gt; &lt;/aside&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;!-- /è¯¾ç¨‹å°é¢ä»‹ç» --&gt; &lt;div class=&quot;mt20 c-infor-box&quot;&gt; &lt;article class=&quot;fl col-7&quot;&gt; &lt;section class=&quot;mr30&quot;&gt; &lt;div class=&quot;i-box&quot;&gt; &lt;div&gt; &lt;section id=&quot;c-i-tabTitle&quot; class=&quot;c-infor-tabTitle c-tab-title&quot;&gt; &lt;a name=&quot;c-i&quot; class=&quot;current&quot; title=&quot;è¯¾ç¨‹è¯¦æƒ…&quot;&gt;è¯¾ç¨‹è¯¦æƒ…&lt;/a&gt; &lt;/section&gt; &lt;/div&gt; &lt;article class=&quot;ml10 mr10 pt20&quot;&gt; &lt;div&gt; &lt;h6 class=&quot;c-i-content c-infor-title&quot;&gt; &lt;span&gt;è¯¾ç¨‹ä»‹ç»&lt;/span&gt; &lt;/h6&gt; &lt;div class=&quot;course-txt-body-wrap&quot;&gt; &lt;section class=&quot;course-txt-body&quot;&gt; &lt;!-- ç”±äºå½“åˆç¼–å†™çš„æ—¶å€™ä½¿ç”¨çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºè¦ä½¿ç”¨v-html --&gt; &lt;p v-html=&quot;courseInfo.description&quot;&gt; &#123;&#123; courseInfo.description &#125;&#125; &lt;/p&gt; &lt;/section&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- /è¯¾ç¨‹ä»‹ç» --&gt; &lt;div class=&quot;mt50&quot;&gt; &lt;h6 class=&quot;c-g-content c-infor-title&quot;&gt; &lt;span&gt;è¯¾ç¨‹å¤§çº²&lt;/span&gt; &lt;/h6&gt; &lt;section class=&quot;mt20&quot;&gt; &lt;div class=&quot;lh-menu-wrap&quot;&gt; &lt;menu id=&quot;lh-menu&quot; class=&quot;lh-menu mt10 mr10&quot;&gt; &lt;ul&gt; &lt;!-- æ–‡ä»¶ç›®å½• --&gt; &lt;li class=&quot;lh-menu-stair&quot; v-for=&quot;chapter in chapterList&quot; :key=&quot;chapter.id&quot; &gt; &lt;a href=&quot;javascript: void(0)&quot; :title=&quot;chapter.title&quot; class=&quot;current-1&quot; &gt; &lt;em class=&quot;lh-menu-i-1 icon18 mr10&quot;&gt;&lt;/em &gt;&#123;&#123; chapter.title &#125;&#125; &lt;/a&gt; &lt;ol class=&quot;lh-menu-ol&quot; style=&quot;display: block&quot;&gt; &lt;li class=&quot;lh-menu-second ml30&quot; v-for=&quot;video in chapter.children&quot; :key=&quot;video.id&quot; &gt; &lt;a href=&quot;#&quot; :title=&quot;video.title&quot;&gt; &lt;span class=&quot;fr&quot;&gt; &lt;i class=&quot;free-icon vam mr10&quot;&gt;å…è´¹è¯•å¬&lt;/i&gt; &lt;/span&gt; &lt;em class=&quot;lh-menu-i-2 icon16 mr5&quot;&gt;&amp;nbsp;&lt;/em &gt;&#123;&#123;video.title&#125;&#125; &lt;/a&gt; &lt;/li&gt; &lt;/ol&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/menu&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt; &lt;!-- /è¯¾ç¨‹å¤§çº² --&gt; &lt;/article&gt; &lt;/div&gt; &lt;/section&gt; &lt;/article&gt; &lt;aside class=&quot;fl col-3&quot;&gt; &lt;div class=&quot;i-box&quot;&gt; &lt;div&gt; &lt;section class=&quot;c-infor-tabTitle c-tab-title&quot;&gt; &lt;a title href=&quot;javascript:void(0)&quot;&gt;ä¸»è®²è®²å¸ˆ&lt;/a&gt; &lt;/section&gt; &lt;section class=&quot;stud-act-list&quot;&gt; &lt;ul style=&quot;height: auto&quot;&gt; &lt;li&gt; &lt;div class=&quot;u-face&quot;&gt; &lt;a href=&quot;#&quot;&gt; &lt;img :src=&quot;courseInfo.avatar&quot; width=&quot;50&quot; height=&quot;50&quot; /&gt; &lt;/a&gt; &lt;/div&gt; &lt;section class=&quot;hLh30 txtOf&quot;&gt; &lt;a class=&quot;c-333 fsize16 fl&quot; href=&quot;#&quot;&gt;&#123;&#123; courseInfo.teacherName &#125;&#125;&lt;/a&gt; &lt;/section&gt; &lt;section class=&quot;hLh20 txtOf&quot;&gt; &lt;span class=&quot;c-999&quot;&gt;&#123;&#123; courseInfo.intro &#125;&#125;&lt;/span&gt; &lt;/section&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/section&gt; &lt;/div&gt; &lt;/div&gt; &lt;/aside&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;!-- /è¯¾ç¨‹è¯¦æƒ… ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import courseApi from &#x27;@/api/course&#x27; export default &#123; asyncData(&#123; params, error &#125;) &#123; return courseApi.getCourseInfo(params.id).then(result =&gt; &#123; return &#123; courseInfo: result.data.data.courseInfo, chapterList: result.data.data.chapterList &#125; &#125;) &#125; &#125;&lt;/script&gt; TODOï¼šé‡Œé¢è¿˜æœ‰ä¸€äº›è·³è½¬è¿˜è¦å®Œå–„ è§†é¢‘æ’­æ”¾å™¨ é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾å™¨ï¼Œä½¿ç”¨æ’­æ”¾å‡­è¯æ’­æ”¾ æ³¨æ„è¿™é‡Œè¦å†™åˆ°service_vodæ¨¡å—ï¼Œå› ä¸ºæ˜¯å’Œé˜¿é‡Œäº‘è§†é¢‘ç›¸å…³ åç«¯controller12345678910111213// æ ¹æ®è§†é¢‘idè·å–è§†é¢‘å‡­è¯@GetMapping(&quot;getPlayAuth/&#123;id&#125;&quot;)public R getPlayAuth(@PathVariable String id) throws ClientException &#123; // åˆ›å»ºåˆå§‹åŒ–å¯¹è±¡ DefaultAcsClient client = InitVodClient.initVodClient(ConstantVodUtils.ACCESS_KEY_ID, ConstantVodUtils.ACCESS_KEY_SECRET); // åˆ›å»ºè·å–å‡­è¯çš„requestå’Œresponse GetVideoPlayAuthRequest request = new GetVideoPlayAuthRequest(); request.setVideoId(id); // è°ƒç”¨æ–¹æ³•è·å¾—å‡­è¯ GetVideoPlayAuthResponse acsResponse = client.getAcsResponse(request); String playAuth = acsResponse.getPlayAuth(); return R.ok().data(&quot;playAuth&quot;, playAuth);&#125; å‰ç«¯ å…ˆå»ä¿®æ”¹aæ ‡ç­¾çš„hrefå€¼ :href=&quot;&#39;/video_player/&#39; + video.videoSourceId&quot; target=&quot;_blank&quot; ç„¶åå‰ç«¯åœ¨pagesæ–‡ä»¶å¤¹ä¸‹ç¼–å†™ä¸€ä¸ªåŠ¨æ€è·¯ç”±çš„vueè§†å›¾ï¼Œå¯ä»¥å‘½åä¸º_vid.vueï¼Œé‡Œé¢ç¼–å†™æ’­æ”¾å™¨çš„æ¨¡æ¿ï¼Œè¿™é‡Œè¿˜ä¸“é—¨å†™äº†ä¸€ä¸ªvideoçš„å¸ƒå±€layoutï¼Œcvå³å¯ layout1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;template&gt; &lt;div class=&quot;guli-player&quot;&gt; &lt;div class=&quot;head&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;è°·ç²’å­¦é™¢&quot;&gt; &lt;img class=&quot;logo&quot; src=&quot;~/assets/img/logo.png&quot; lt=&quot;è°·ç²’å­¦é™¢&quot;&gt; &lt;/a&gt;&lt;/div&gt; &lt;div class=&quot;body&quot;&gt; &lt;div class=&quot;content&quot;&gt;&lt;nuxt/&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123;&#125;&lt;/script&gt;&lt;style&gt;html,body&#123; height:100%;&#125;&lt;/style&gt;&lt;style scoped&gt;.head &#123; height: 50px; position: absolute; top: 0; left: 0; width: 100%;&#125;.head .logo&#123; height: 50px; margin-left: 10px;&#125;.body &#123; position: absolute; top: 50px; left: 0; right: 0; bottom: 0; overflow: hidden;&#125;&lt;/style&gt; api12345678910import request from &#x27;@/utils/request&#x27;export default &#123; getPlayAuth(id) &#123; return request(&#123; url: `/eduvod/video/getPlayAuth/$&#123;id&#125;`, method: &#x27;get&#x27;, &#125;) &#125;,&#125; vueè§†å›¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;template&gt; &lt;div&gt; &lt;!-- é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾å™¨æ ·å¼ --&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://g.alicdn.com/de/prismplayer/2.8.1/skins/default/aliplayer-min.css&quot; &gt; &lt;!-- é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾å™¨è„šæœ¬ --&gt; &lt;script charset=&quot;utf-8&quot; type=&quot;text/javascript&quot; src=&quot;https://g.alicdn.com/de/prismplayer/2.8.1/aliplayer-min.js&quot; /&gt; &lt;!-- å®šä¹‰æ’­æ”¾å™¨dom --&gt; &lt;div id=&quot;J_prismPlayer&quot; class=&quot;prism-player&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import vod from &#x27;@/api/vod&#x27;export default &#123; layout: &#x27;video&#x27;,//åº”ç”¨videoå¸ƒå±€ asyncData(&#123; params, error &#125;) &#123; return vod.getPlayAuth(params.vid) .then(response =&gt; &#123; return &#123; playAuth: response.data.data.playAuth, vid: params.vid &#125; &#125;) &#125;, mounted() &#123; //é¡µé¢æ¸²æŸ“ä¹‹å created new Aliplayer(&#123; id: &#x27;J_prismPlayer&#x27;, vid: this.vid, // è§†é¢‘id playauth: this.playAuth, // æ’­æ”¾å‡­è¯ encryptType: &#x27;1&#x27;, // å¦‚æœæ’­æ”¾åŠ å¯†è§†é¢‘ï¼Œåˆ™éœ€è®¾ç½®encryptType=1ï¼ŒéåŠ å¯†è§†é¢‘æ— éœ€è®¾ç½®æ­¤é¡¹ width: &#x27;100%&#x27;, height: &#x27;500px&#x27;, // ä»¥ä¸‹å¯é€‰è®¾ç½® cover: &#x27;http://guli.shop/photo/banner/1525939573202.jpg&#x27;, // å°é¢ qualitySort: &#x27;asc&#x27;, // æ¸…æ™°åº¦æ’åº mediaType: &#x27;video&#x27;, // è¿”å›éŸ³é¢‘è¿˜æ˜¯è§†é¢‘ autoplay: false, // è‡ªåŠ¨æ’­æ”¾ isLive: false, // ç›´æ’­ rePlay: false, // å¾ªç¯æ’­æ”¾ preload: true, controlBarVisibility: &#x27;hover&#x27;, // æ§åˆ¶æ¡çš„æ˜¾ç¤ºæ–¹å¼ï¼šé¼ æ ‡æ‚¬åœ useH5Prism: true, // æ’­æ”¾å™¨ç±»å‹ï¼šhtml5 &#125;, function(player) &#123; console.log(&#x27;æ’­æ”¾å™¨åˆ›å»ºæˆåŠŸ&#x27;) &#125;) &#125;&#125;&lt;/script&gt; æ›´å¤šåŠŸèƒ½ é˜¿é‡Œäº‘Aliplayeræ’­æ”¾å™¨ (alicdn.com) è¯¦è§æ–‡æ¡£ è§†é¢‘è¯„è®ºï¼ˆåç«¯+å‰ç«¯ï¼‰ å…·ä½“å®ç°åˆ†æï¼š åˆ›å»ºè¯¾ç¨‹è¯„è®ºè¡¨ åˆ›å»ºåç«¯æ¥å£ åˆ†é¡µæŸ¥è¯¢å¯¹åº”è¯¾ç¨‹è¯„è®º æ·»åŠ è¯„è®º è¯¾ç¨‹è¯„è®ºå†…å®¹ï¼šè¾“å…¥ï¼Œè°ƒç”¨æ¥å£ è¯¾ç¨‹idï¼šè¿›å…¥è¯¦æƒ…é¡µé¢å°±å¯ä»¥æŸ¥è¯¢åˆ°è¯¾ç¨‹id ç”¨æˆ·idï¼šæ ¹æ®cookieä¸­çš„tokenæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ è¿œç¨‹è°ƒç”¨ï¼ˆedu -&gt; ucenterï¼‰ è®¢å•ä¸æ”¯ä»˜ï¼ˆåç«¯+å‰ç«¯ï¼‰ åˆ›å»ºå­æ¨¡å—service_order, application.proertiesé‡Œå¤§å·®ä¸å·® ä»£ç ç”Ÿæˆå™¨å¸¸è§„æ“ä½œ åç«¯åŸºç¡€æ­å»ºå¯åŠ¨ç±» è¿™ä¸ªæ¨¡å—éœ€è¦è°ƒç”¨eduå’ŒUCenteræ¨¡å—ä¸­çš„æ–¹æ³•æŸ¥è¯¢è¯¾ç¨‹å’Œç”¨æˆ·ä¿¡æ¯ 12345678910@SpringBootApplication@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)@MapperScan(&quot;com.atguigu.eduorder.mapper&quot;)@EnableDiscoveryClient // nacosæ³¨å†Œ@EnableFeignClients // ä½¿ç”¨Feignpublic class OrderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(OrderApplication.class, args); &#125;&#125; ä¾èµ– å¾®ä¿¡æ”¯ä»˜æ¥å£çš„ä¾èµ– 123456789101112&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.wxpay&lt;/groupId&gt; &lt;artifactId&gt;wxpay-sdk&lt;/artifactId&gt; &lt;version&gt;0.0.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ç”Ÿæˆè®¢å•ï¼ˆåç«¯ï¼‰OrderController1234567891011121314151617@RestController@RequestMapping(&quot;/eduorder/order&quot;)@CrossOriginpublic class OrderController &#123; @Autowired private OrderService orderService; // ç”Ÿæˆè®¢å•æ–¹æ³• @PostMapping(&quot;createOrder/&#123;courseId&#125;&quot;) public R createOrder(@PathVariable String courseId, HttpServletRequest request) &#123; // åˆ›å»ºè®¢å•è¿”å›è®¢å•å· String memberId = JwtUtils.getMemberIdByJwtToken(request); String orderNo = orderService.createOrder(courseId, memberId); return R.ok().data(&quot;orderNo&quot;, orderNo); &#125; &#125; å®ä½“ç±» æ³¨æ„è¿™é‡Œè¦é¢å¤–å†™ä¸€ä¸ªvoç±»ç”¨äºè¿œç¨‹è°ƒç”¨çš„æ—¶å€™è¿”å› 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@Data@EqualsAndHashCode(callSuper = false)@Accessors(chain = true)@ApiModel(value = &quot;UcenterMemberå¯¹è±¡&quot;, description = &quot;ä¼šå‘˜è¡¨&quot;)public class UcenterMemberForOrder implements Serializable &#123; private static final long serialVersionUID = 1L; @ApiModelProperty(value = &quot;ä¼šå‘˜id&quot;) @TableId(value = &quot;id&quot;, type = IdType.ID_WORKER_STR) private String id; @ApiModelProperty(value = &quot;å¾®ä¿¡openid&quot;) private String openid; @ApiModelProperty(value = &quot;æ‰‹æœºå·&quot;) private String mobile; @ApiModelProperty(value = &quot;å¯†ç &quot;) private String password; @ApiModelProperty(value = &quot;æ˜µç§°&quot;) private String nickname; @ApiModelProperty(value = &quot;æ€§åˆ« 1 å¥³ï¼Œ2 ç”·&quot;) private Integer sex; @ApiModelProperty(value = &quot;å¹´é¾„&quot;) private Integer age; @ApiModelProperty(value = &quot;ç”¨æˆ·å¤´åƒ&quot;) private String avatar; @ApiModelProperty(value = &quot;ç”¨æˆ·ç­¾å&quot;) private String sign; @ApiModelProperty(value = &quot;æ˜¯å¦ç¦ç”¨ 1ï¼ˆtrueï¼‰å·²ç¦ç”¨ï¼Œ 0ï¼ˆfalseï¼‰æœªç¦ç”¨&quot;) private Boolean isDisabled; @ApiModelProperty(value = &quot;é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤&quot;) @TableLogic private Boolean isDeleted; @ApiModelProperty(value = &quot;åˆ›å»ºæ—¶é—´&quot;) @TableField(fill = FieldFill.INSERT) private Date gmtCreate; @ApiModelProperty(value = &quot;æ›´æ–°æ—¶é—´&quot;) @TableField(fill = FieldFill.INSERT_UPDATE) private Date gmtModified;&#125; è¿™ä¸ªå®ä½“ç±»å’ŒUCenterMemberæ— å·®åˆ«ï¼Œä½†æ˜¯æ”¾åœ¨äº†commonæ¨¡å—å½“ä¸­ï¼Œæ‰€ä»¥ä¸åŒæ¨¡å—ä¸­çš„controlleréƒ½å¯ä»¥ä½¿ç”¨è¯¥ç±» å¦ä¸€ä¸ªè¯¾ç¨‹ç›¸å…³å®ä½“ç±»ä¸è¿™ä¸ªç±»ä¼¼ï¼Œæ”¾åœ¨commonæ¨¡å—ä¸­å³å¯ UcenterMemberController ç¼–å†™ä¸€ä¸ªè¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•ï¼Œé€šè¿‡idè·å–ç”¨æˆ·ä¿¡æ¯ 12345678910111213141516@RestController@RequestMapping(&quot;/educenter/member&quot;)@CrossOriginpublic class UcenterMemberController &#123; @Autowired private UcenterMemberService memberService; // æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯ @GetMapping(&quot;getUserInfoOrder/&#123;id&#125;&quot;) public UcenterMemberForOrder getUserInfoOrder(@PathVariable String id) &#123; // æ³¨æ„è¿™é‡Œçš„è¿”å›ç±»å‹ä¸è¦Rï¼Œè€Œæ˜¯å¦ä¸€ä¸ªç»Ÿä¸€ç±»å‹ UcenterMember member = memberService.getById(id); UcenterMemberForOrder memberForOrder = new UcenterMemberForOrder(); BeanUtils.copyProperties(member, memberForOrder); return memberForOrder; &#125;&#125; CourseFrontController123456789101112131415@RestController@CrossOrigin@RequestMapping(&quot;/eduservice/coursefront&quot;)public class CourseController &#123; @Autowired private EduCourseService courseService; // æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯ @GetMapping(&quot;getCourseInfoOrder/&#123;id&#125;&quot;) public CourseForOrder getCourseInfoOrder(@PathVariable String id) &#123; CourseInfoVo course = courseService.getCourseInfoById(id); CourseForOrder courseForOrder = new CourseForOrder(); BeanUtils.copyProperties(course, courseForOrder); return courseForOrder; &#125;&#125; è¿œç¨‹è°ƒç”¨é…ç½®æ¥å£1234567@Component@FeignClient(&quot;service-edu&quot;)public interface EduClient &#123; // æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯ @GetMapping(&quot;/eduservice/coursefront/getCourseInfoOrder/&#123;id&#125;&quot;) public CourseForOrder getCourseInfoOrder(@PathVariable(&quot;id&quot;) String id);&#125; 1234567@Component@FeignClient(&quot;service-ucenter&quot;)public interface UcenterClient &#123; // æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯ @GetMapping(&quot;/educenter/member/getUserInfoOrder/&#123;id&#125;&quot;) public UcenterMemberForOrder getUserInfoOrder(@PathVariable(&quot;id&quot;) String id);&#125; OrderService1234567891011121314151617181920212223242526272829303132@Servicepublic class OrderServiceImpl extends ServiceImpl&lt;OrderMapper, Order&gt; implements OrderService &#123; @Autowired private EduClient eduClient; @Autowired private UcenterClient ucenterClient; // ç”Ÿæˆè®¢å• @Override public String createOrder(String courseId, String memberId) &#123; // è¿œç¨‹è°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯ UcenterMemberForOrder userInfoOrder = ucenterClient.getUserInfoOrder(memberId); // è¿œç¨‹è°ƒç”¨è·å–è¯¾ç¨‹ä¿¡æ¯ CourseForOrder courseInfoOrder = eduClient.getCourseInfoOrder(courseId); // æ·»åŠ åˆ°æ•°æ®åº“ Order order = new Order(); order.setOrderNo(OrderNoUtil.getOrderNo());//è®¢å•å· order.setCourseId(courseId); //è¯¾ç¨‹id order.setCourseTitle(courseInfoOrder.getTitle()); order.setCourseCover(courseInfoOrder.getCover()); order.setTeacherName(courseInfoOrder.getTeacherName()); order.setTotalFee(courseInfoOrder.getPrice()); order.setMemberId(memberId); order.setMobile(userInfoOrder.getMobile()); order.setNickname(userInfoOrder.getNickname()); order.setStatus(0); //è®¢å•çŠ¶æ€ï¼ˆ0ï¼šæœªæ”¯ä»˜ 1ï¼šå·²æ”¯ä»˜ï¼‰ order.setPayType(1); //æ”¯ä»˜ç±»å‹ ï¼Œå¾®ä¿¡1 baseMapper.insert(order); //è¿”å›è®¢å•å· return order.getOrderNo(); &#125;&#125; æŸ¥è¯¢è®¢å•ï¼ˆåç«¯ï¼‰12345678// æ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•ä¿¡æ¯@GetMapping(&quot;getOrderInfo/&#123;orderNo&#125;&quot;)public R getOrderInfo(@PathVariable String orderNo) &#123; QueryWrapper&lt;Order&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;order_no&quot;, orderNo); Order order = orderService.getOne(wrapper); return R.ok().data(&quot;orderInfo&quot;, order);&#125; ç”Ÿæˆè®¢å•ï¼ˆå‰ç«¯ï¼‰api123456789101112131415161718import request from &#x27;@/utils/request&#x27;export default &#123; // ç”Ÿæˆè®¢å• createOrder(courseId) &#123; return request(&#123; url: `/eduorder/order/createOrder/$&#123;courseId&#125;`, method: &#x27;get&#x27;, &#125;) &#125;, // æŸ¥è¯¢è®¢å•ä¿¡æ¯ getOrderInfo(orderNo) &#123; return request(&#123; url: `/eduorder/order/getOrderInfo/$&#123;orderNo&#125;`, method: &#x27;get&#x27;, &#125;) &#125;&#125; è¯¾ç¨‹è¯¦æƒ…é¡µé¢è·³è½¬123456789methods: &#123; // åˆ›å»ºè®¢å• createOrder() &#123; orderApi.createOrder(this.courseId).then(result =&gt; &#123; // è¿”å›è®¢å•å· è·³è½¬é¡µé¢ this.$router.push(&#123; path: &#x27;/order/&#x27; + result.data.data.orderNo &#125;) &#125;) &#125;&#125; åŠ¨æ€è·¯ç”±é¡µé¢æ¨¡æ¿ åˆ›å»ºä¸€ä¸ªåŠ¨æ€è·¯ç”±é¡µé¢ï¼Œ_ono.vue 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105&lt;template&gt; &lt;div class=&quot;Page Confirm&quot;&gt; &lt;div class=&quot;Title&quot;&gt; &lt;h1 class=&quot;fl f18&quot;&gt;è®¢å•ç¡®è®¤&lt;/h1&gt; &lt;img src=&quot;~/assets/img/cart_setp2.png&quot; class=&quot;fr&quot; /&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;form name=&quot;flowForm&quot; id=&quot;flowForm&quot; method=&quot;post&quot; action=&quot;&quot;&gt; &lt;table class=&quot;GoodList&quot;&gt; &lt;tbody&gt; &lt;tr&gt; &lt;th class=&quot;name&quot;&gt;å•†å“&lt;/th&gt; &lt;th class=&quot;price&quot;&gt;åŸä»·&lt;/th&gt; &lt;th class=&quot;priceNew&quot;&gt;ä»·æ ¼&lt;/th&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;tbody&gt; &lt;!-- &lt;tr&gt; &lt;td colspan=&quot;3&quot; class=&quot;Title red f18 fb&quot;&gt;&lt;p&gt;é™æ—¶æŠ˜æ‰£&lt;/p&gt;&lt;/td&gt; &lt;/tr&gt; --&gt; &lt;tr&gt; &lt;td colspan=&quot;3&quot; class=&quot;teacher&quot;&gt;è®²å¸ˆï¼š&#123;&#123; order.teacherName &#125;&#125;&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;good&quot;&gt; &lt;td class=&quot;name First&quot;&gt; &lt;a target=&quot;_blank&quot; :href=&quot;&#x27;https://localhost:3000/course/&#x27; + order.courseId&quot; &gt; &lt;img :src=&quot;order.courseCover&quot; /&gt;&lt;/a&gt; &lt;div class=&quot;goodInfo&quot;&gt; &lt;input type=&quot;hidden&quot; class=&quot;ids ids_14502&quot; value=&quot;14502&quot; /&gt; &lt;a target=&quot;_blank&quot; :href=&quot;&#x27;https://localhost:3000/course/&#x27; + order.courseId&quot; &gt;&#123;&#123; order.courseTitle &#125;&#125;&lt;/a &gt; &lt;/div&gt; &lt;/td&gt; &lt;td class=&quot;price&quot;&gt; &lt;p&gt; ï¿¥&lt;strong&gt;&#123;&#123; order.totalFee &#125;&#125;&lt;/strong&gt; &lt;/p&gt; &lt;!-- &lt;span class=&quot;discName red&quot;&gt;é™æ—¶8æŠ˜&lt;/span&gt; --&gt; &lt;/td&gt; &lt;td class=&quot;red priceNew Last&quot;&gt; ï¿¥&lt;strong&gt;&#123;&#123; order.totalFee &#125;&#125;&lt;/strong&gt; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td class=&quot;Billing tr&quot; colspan=&quot;3&quot;&gt; &lt;div class=&quot;tr&quot;&gt; &lt;p&gt; å…± &lt;strong class=&quot;red&quot;&gt;1&lt;/strong&gt; ä»¶å•†å“ï¼Œåˆè®¡&lt;span class=&quot;red f20&quot; &gt;ï¿¥&lt;strong&gt;&#123;&#123; order.totalFee &#125;&#125;&lt;/strong&gt;&lt;/span &gt; &lt;/p&gt; &lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;div class=&quot;Finish&quot;&gt; &lt;div class=&quot;fr&quot; id=&quot;AgreeDiv&quot;&gt; &lt;label for=&quot;Agree&quot; &gt;&lt;p class=&quot;on&quot;&gt; &lt;input type=&quot;checkbox&quot; checked=&quot;checked&quot; /&gt;æˆ‘å·²é˜…è¯»å¹¶åŒæ„&lt;a href=&quot;javascript:&quot; target=&quot;_blank&quot; &gt;ã€Šè°·ç²’å­¦é™¢è´­ä¹°åè®®ã€‹&lt;/a &gt; &lt;/p&gt;&lt;/label &gt; &lt;/div&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;div class=&quot;Main fl&quot;&gt; &lt;div class=&quot;fl&quot;&gt; &lt;a :href=&quot;&#x27;/course/&#x27; + order.courseId&quot;&gt;è¿”å›è¯¾ç¨‹è¯¦æƒ…é¡µ&lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;fr&quot;&gt; &lt;p&gt; å…± &lt;strong class=&quot;red&quot;&gt;1&lt;/strong&gt; ä»¶å•†å“ï¼Œåˆè®¡&lt;span class=&quot;red f20&quot; &gt;ï¿¥&lt;strong id=&quot;AllPrice&quot;&gt;&#123;&#123; order.totalFee &#125;&#125;&lt;/strong&gt;&lt;/span &gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;input name=&quot;score&quot; value=&quot;0&quot; type=&quot;hidden&quot; id=&quot;usedScore&quot; /&gt; &lt;button class=&quot;fr redb&quot; type=&quot;button&quot; id=&quot;submitPay&quot; @click=&quot;toPay()&quot;&gt; å»æ”¯ä»˜ &lt;/button&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import ordersApi from &#x27;@/api/order&#x27; export default &#123; methods: &#123;&#125; &#125;&lt;/script&gt; æ–¹æ³•12345678asyncData(&#123; params, error &#125;) &#123; return ordersApi.getOrderInfo(params.ono) .then(response =&gt; &#123; return &#123; orderInfo: response.data.data.orderInfo &#125; &#125;) &#125;, æµ‹è¯• è¿™é‡Œä¸€ç›´åœ¨è°ƒè¯•ï¼Œå‘ç°æˆ‘çš„courseInfoå¯¹è±¡ä¸ºnullï¼Œdebugäº†ä¸€ä¼šå‘ç°æ˜¯courseControllerå½“ä¸­çš„è¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•ä¸­ï¼Œè¿”å›çš„å¯¹è±¡voç±»å†…çš„å€¼ä¸ä¸€è‡´ï¼Œå¯¼è‡´BeanUtilsèµ‹å€¼çš„æ—¶å€™èµ‹å€¼ä¸äº†ï¼Œç„¶åæ”¹ä¸€ä¸‹é‡å¯å°±è¡Œ ç”Ÿæˆæ”¯ä»˜äºŒç»´ç ï¼ˆåç«¯ï¼‰ å¥½å®¶ä¼™åˆè¦ä¼ä¸šè®¤è¯ controller1234567891011121314@RestController@RequestMapping(&quot;/eduorder/pay-log&quot;)public class PayLogController &#123; @Autowired private PayLogService logService; // ç”Ÿæˆå¾®ä¿¡æ”¯ä»˜äºŒç»´ç  @GetMapping(&quot;createNative/&#123;orderNo&#125;&quot;) public R createNative(@PathVariable String orderNo) &#123; Map&lt;String, Object&gt; map = logService.createNative(orderNo); return R.ok().data(map); &#125; &#125; serviceä¸»è¦ä¸šåŠ¡é€»è¾‘123456789101112131415161718192021222324252627282930313233343536373839404142434445464748@Servicepublic class PayLogServiceImpl extends ServiceImpl&lt;PayLogMapper, PayLog&gt; implements PayLogService &#123; @Autowired private OrderService orderService; // ç”Ÿæˆå¾®ä¿¡æ”¯ä»˜äºŒç»´ç  @Override public Map&lt;String, Object&gt; createNative(String orderNo) &#123; try &#123; // æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•ä¿¡æ¯ QueryWrapper&lt;Order&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;order_no&quot;, orderNo); Order order = orderService.getOne(wrapper); // ä½¿ç”¨mapè®¾ç½®ç”ŸæˆäºŒç»´ç æ‰€éœ€çš„å‚æ•° Map&lt;String, String&gt; m = new HashMap(); m.put(&quot;appid&quot;, &quot;wx74862e0dfcf69954&quot;); m.put(&quot;mch_id&quot;, &quot;1558950191&quot;); m.put(&quot;nonce_str&quot;, WXPayUtil.generateNonceStr()); m.put(&quot;body&quot;, order.getCourseTitle()); //è¯¾ç¨‹æ ‡é¢˜ m.put(&quot;out_trade_no&quot;, orderNo); //è®¢å•å· m.put(&quot;total_fee&quot;, order.getTotalFee().multiply(new BigDecimal(&quot;100&quot;)).longValue() + &quot;&quot;); m.put(&quot;spbill_create_ip&quot;, &quot;127.0.0.1&quot;); m.put(&quot;notify_url&quot;, &quot;http://guli.shop/api/order/weixinPay/weixinNotify\\n&quot;); m.put(&quot;trade_type&quot;, &quot;NATIVE&quot;); // å‘é€httpclientè¯·æ±‚ï¼Œä¼ é€’å‚æ•°xmlæ ¼å¼ HttpClient client = new HttpClient(&quot;https://api.mch.weixin.qq.com/pay/unifiedorder&quot;); //è®¾ç½®xmlæ ¼å¼çš„å‚æ•° client.setXmlParam(WXPayUtil.generateSignedXml(m, &quot;T6m9iK73b0kn9g5v426MKfHQH7X8rKwb&quot;)); client.setHttps(true); //æ‰§è¡Œpostè¯·æ±‚å‘é€ client.post(); // å¾—åˆ°è¯·æ±‚è¿”å›ç»“æœ String xml = client.getContent(); Map&lt;String, String&gt; resultMap = WXPayUtil.xmlToMap(xml); //æœ€ç»ˆè¿”å›æ•°æ® çš„å°è£… Map map = new HashMap(); map.put(&quot;out_trade_no&quot;, orderNo); map.put(&quot;course_id&quot;, order.getCourseId()); map.put(&quot;total_fee&quot;, order.getTotalFee()); map.put(&quot;result_code&quot;, resultMap.get(&quot;result_code&quot;)); //è¿”å›äºŒç»´ç æ“ä½œçŠ¶æ€ç  map.put(&quot;code_url&quot;, resultMap.get(&quot;code_url&quot;)); //äºŒç»´ç åœ°å€ return map; &#125; catch (Exception e) &#123; throw new GuliException(20001, &quot;ç”ŸæˆäºŒç»´ç å¤±è´¥&quot;); &#125; &#125;&#125; æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ï¼ˆåç«¯ï¼‰controller123456789101112131415// æŸ¥è¯¢è®¢å•æ”¯ä»˜çŠ¶æ€@GetMapping(&quot;getPayStatus/&#123;orderNo&#125;&quot;)public R getPayStatus(@PathVariable String orderNo) &#123; Map&lt;String, String&gt; map = logService.getPayStatus(orderNo); if (map == null) &#123; return R.error().message(&quot;æ”¯ä»˜å‡ºé”™äº†&quot;); &#125; if (map.get(&quot;trade_state&quot;).equals(&quot;SUCCESS&quot;)) &#123; logService.updateOrderStatus(map); return R.ok(); &#125; // ç‰¹å®šè¿”å›ç ï¼Œå‰ç«¯æœ‰æ‹¦æˆªå™¨åˆ¤æ–­ return R.ok().code(25000).message(&quot;æ”¯ä»˜ä¸­â€¦â€¦&quot;);&#125; service12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// æŸ¥è¯¢è®¢å•æ”¯ä»˜çŠ¶æ€@Overridepublic Map&lt;String, String&gt; getPayStatus(String orderNo) &#123; try &#123; //1ã€å°è£…å‚æ•° Map&lt;String, String&gt; m = new HashMap&lt;&gt;(); m.put(&quot;appid&quot;, &quot;wx74862e0dfcf69954&quot;); m.put(&quot;mch_id&quot;, &quot;1558950191&quot;); m.put(&quot;out_trade_no&quot;, orderNo); m.put(&quot;nonce_str&quot;, WXPayUtil.generateNonceStr()); //2 å‘é€httpclient HttpClient client = new HttpClient(&quot;https://api.mch.weixin.qq.com/pay/orderquery&quot;); client.setXmlParam(WXPayUtil.generateSignedXml(m, &quot;T6m9iK73b0kn9g5v426MKfHQH7X8rKwb&quot;)); client.setHttps(true); client.post(); //3 å¾—åˆ°è¯·æ±‚è¿”å›å†…å®¹ String xml = client.getContent(); //6ã€è½¬æˆMapå†è¿”å› return WXPayUtil.xmlToMap(xml); &#125; catch (Exception e) &#123; e.printStackTrace(); return null; &#125;&#125;//æ·»åŠ æ”¯ä»˜è®°å½•å’Œæ›´æ–°è®¢å•çŠ¶æ€@Overridepublic void updateOrderStatus(Map&lt;String, String&gt; map) &#123; //ä»mapè·å–è®¢å•å· String orderNo = map.get(&quot;out_trade_no&quot;); //æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•ä¿¡æ¯ QueryWrapper&lt;Order&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;order_no&quot;, orderNo); Order order = orderService.getOne(wrapper); //æ›´æ–°è®¢å•è¡¨è®¢å•çŠ¶æ€ if (order.getStatus().intValue() == 1) &#123; // å·²ç»æ”¯ä»˜è¿‡äº† return; &#125; order.setStatus(1);//1ä»£è¡¨å·²ç»æ”¯ä»˜ orderService.updateById(order); //å‘æ”¯ä»˜è¡¨æ·»åŠ æ”¯ä»˜è®°å½• PayLog payLog = new PayLog(); payLog.setOrderNo(orderNo); //è®¢å•å· payLog.setPayTime(new Date()); //è®¢å•å®Œæˆæ—¶é—´ payLog.setPayType(1);//æ”¯ä»˜ç±»å‹ 1å¾®ä¿¡ payLog.setTotalFee(order.getTotalFee());//æ€»é‡‘é¢(åˆ†) payLog.setTradeState(map.get(&quot;trade_state&quot;));//æ”¯ä»˜çŠ¶æ€ payLog.setTransactionId(map.get(&quot;transaction_id&quot;)); //æµæ°´å· payLog.setAttr(JSONObject.toJSONString(map)); baseMapper.insert(payLog);&#125; æ”¯ä»˜ï¼ˆå‰ç«¯ï¼‰api1234567891011121314// ç”ŸæˆäºŒç»´ç  createNative(orderNo) &#123; return request(&#123; url: `/eduorder/paylog/createNative/$&#123;orderNo&#125;`, method: &#x27;get&#x27;, &#125;) &#125;, // æŸ¥è¯¢è®¢å•çŠ¶æ€ getPayStatus(orderNo) &#123; return request(&#123; url: `/eduorder/paylog/getPayStatus/$&#123;orderNo&#125;`, method: &#x27;get&#x27;, &#125;) &#125;, è·³è½¬è‡³é¡µé¢æ–¹æ³•1234// å»æ”¯ä»˜toPay() &#123; this.$router.push(&#123; path: &#x27;/pay/&#x27; + this.orderInfo.orderNo &#125;)&#125; åŠ¨æ€è·¯ç”±æ¨¡æ¿12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;template&gt; &lt;div class=&quot;cart py-container&quot;&gt; &lt;!--ä¸»å†…å®¹--&gt; &lt;div class=&quot;checkout py-container pay&quot;&gt; &lt;div class=&quot;checkout-tit&quot;&gt; &lt;h4 class=&quot;fl tit-txt&quot;&gt; &lt;span class=&quot;success-icon&quot;&gt;&lt;/span &gt;&lt;span class=&quot;success-info&quot; &gt;è®¢å•æäº¤æˆåŠŸï¼Œè¯·æ‚¨åŠæ—¶ä»˜æ¬¾ï¼è®¢å•å·ï¼š&#123;&#123; payObj.out_trade_no &#125;&#125;&lt;/span &gt; &lt;/h4&gt; &lt;span class=&quot;fr&quot; &gt;&lt;em class=&quot;sui-lead&quot;&gt;åº”ä»˜é‡‘é¢ï¼š&lt;/em &gt;&lt;em class=&quot;orange money&quot;&gt;ï¿¥&#123;&#123; payObj.total_fee &#125;&#125;&lt;/em&gt;&lt;/span &gt; &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;checkout-steps&quot;&gt; &lt;div class=&quot;fl weixin&quot;&gt;å¾®ä¿¡æ”¯ä»˜&lt;/div&gt; &lt;div class=&quot;fl sao&quot;&gt; &lt;p class=&quot;red&quot;&gt;è¯·ä½¿ç”¨å¾®ä¿¡æ‰«ä¸€æ‰«ã€‚&lt;/p&gt; &lt;div class=&quot;fl code&quot;&gt; &lt;!-- &lt;img id=&quot;qrious&quot; src=&quot;~/assets/img/erweima.png&quot; alt=&quot;&quot;&gt; --&gt; &lt;!-- &lt;qriously value=&quot;weixin://wxpay/bizpayurl?pr=R7tnDpZ&quot; :size=&quot;338&quot;/&gt; --&gt; &lt;qriously :value=&quot;payObj.code_url&quot; :size=&quot;338&quot; /&gt; &lt;div class=&quot;saosao&quot;&gt; &lt;p&gt;è¯·ä½¿ç”¨å¾®ä¿¡æ‰«ä¸€æ‰«&lt;/p&gt; &lt;p&gt;æ‰«æäºŒç»´ç æ”¯ä»˜&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt; &lt;!-- &lt;p&gt;&lt;a href=&quot;pay.html&quot; target=&quot;_blank&quot;&gt;&gt; å…¶ä»–æ”¯ä»˜æ–¹å¼&lt;/a&gt;&lt;/p&gt; --&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import orderApi from &#x27;@/api/order&#x27; export default &#123; asyncData(&#123; params, error &#125;) &#123; return orderApi.createNatvie(params.pid).then(response =&gt; &#123; return &#123; payObj: response.data.data &#125; &#125;) &#125;, data() &#123; return &#123; timer1: &#x27;&#x27; &#125; &#125;, methods: &#123;&#125; &#125;&lt;/script&gt; æ³¨æ„è¿™é‡Œéœ€è¦å®‰è£…vue-qriouslyç»„ä»¶ responseæ‹¦æˆªå™¨12345678910111213141516171819202122232425262728// http response æ‹¦æˆªå™¨service.interceptors.response.use( response =&gt; &#123; //debugger if (response.data.code == 28004) &#123; console.log(&quot;response.data.resultCodeæ˜¯28004&quot;) // è¿”å› é”™è¯¯ä»£ç -1 æ¸…é™¤ticketä¿¡æ¯å¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢ //debugger window.location.href=&quot;/login&quot; return &#125;else&#123; if (response.data.code !== 20000) &#123; //25000ï¼šè®¢å•æ”¯ä»˜ä¸­ï¼Œä¸åšä»»ä½•æç¤º if(response.data.code != 25000) &#123; Message(&#123; message: response.data.message || &#x27;error&#x27;, type: &#x27;error&#x27;, duration: 5 * 1000 &#125;) &#125; &#125; else &#123; return response; &#125; &#125; &#125;, error =&gt; &#123; return Promise.reject(error.response) // è¿”å›æ¥å£è¿”å›çš„é”™è¯¯ä¿¡æ¯&#125;); è°ƒç”¨æ–¹æ³• è¿™é‡Œéœ€è¦ç”¨åˆ°responseæ‹¦æˆªå™¨ï¼Œåç«¯æ”¯ä»˜ä¸­çš„è¿”å›ç ä¸º25000ï¼Œéœ€è¦æ ¹æ®è¿”å›ç åˆ¤æ–­æ˜¯å¦æ”¯ä»˜æˆåŠŸ 1234567891011121314151617181920212223242526272829data() &#123; return &#123; timer1: &#x27;&#x27; &#125;&#125;,// æ³¨æ„è¿™é‡Œä¸é€‚ç”¨createdï¼Œå› ä¸ºä½¿ç”¨äº†å¼‚æ­¥åˆå§‹åŒ–æ•°æ®ï¼Œmountedåœ¨é¡µé¢æ¸²æŸ“å®Œæˆåæ‰§è¡Œmounted() &#123; this.timer1 = setInterval(() =&gt; &#123; this.getPayStatus(this.payObj.out_trade_no) &#125;, 3000)&#125;,methods: &#123; // æ¯éš”ä¸€æ®µæ—¶é—´æŸ¥è¯¢è®¢å•çŠ¶æ€ getPayStatus(orderNo) &#123; orderApi.getPayStatus(this.orderNo).then(result =&gt; &#123; if (result.data.success) &#123; // æ¸…é™¤å®šæ—¶å™¨ clearInterval(this.timer1) // æç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ”¯ä»˜æˆåŠŸ!&#x27; &#125;) // è·³è½¬è‡³è¯¾ç¨‹è¯¦æƒ…é¡µé¢ this.$router.push(&#123; path: &#x27;/course/&#x27; + this.payObj.course_id &#125;) &#125; &#125;) &#125;&#125; æµ‹è¯• æµ‹äº†ä¸€æ¬¡ï¼Œæ²¡è·³è½¬ä½†æ˜¯çŠ¶æ€æ”¹äº†ï¼Œæ‡’å¾—æµ‹äº†ï¼Œä¸æƒ³èŠ±é’± debugäº†ä¸€ä¸‹ï¼Œå‘ç°åç«¯æ²¡å•¥é—®é¢˜ï¼Œä¹Ÿæ‰§è¡Œäº†ï¼Œä»˜é’±äº†ä¹‹åä¹Ÿè¿”å›äº†R.okï¼Œä½†æ˜¯å‰ç«¯å°±æ˜¯æ˜¾ç¤ºresultä¸ºundefinedï¼Œä¸ç†è§£ è¯¾ç¨‹ä¿¡æ¯æ˜¾ç¤ºå®Œå–„ å…è´¹å’Œä¸å…è´¹ï¼Œæ˜¯å¦è´­ä¹°ç­‰é¡µé¢æ˜¾ç¤ºéœ€è¦åŒºåˆ« æŸ¥è¯¢ç”¨æˆ·è´­ä¹°è¯¾ç¨‹ä¿¡æ¯æ–¹æ³•1234567891011// æ ¹ç»ç”¨æˆ·idå’Œè¯¾ç¨‹idæŸ¥è¯¢ ç”¨æˆ·è¯¾ç¨‹æ”¯ä»˜æƒ…å†µ@GetMapping(&quot;getUserCourseStatus/&#123;cid&#125;/&#123;uid&#125;&quot;)public boolean getUserCourseStatus(@PathVariable String cid, @PathVariable String uid) &#123; QueryWrapper&lt;Order&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;course_id&quot;, cid); wrapper.eq(&quot;member_id&quot;, uid); wrapper.eq(&quot;status&quot;, 1); int count = orderService.count(wrapper); // å·²ç»æ”¯ä»˜å®Œæˆ return count &gt; 0;&#125; éœ€è¦ä¿®æ”¹è¯¾ç¨‹è¯¦æƒ…æ¥å£çš„è¿”å›å€¼ï¼ŒåŠ ä¸Šè¯¾ç¨‹çš„æ”¯ä»˜çŠ¶æ€ï¼ˆè¿œç¨‹è°ƒç”¨ä¸Šè¿°æ–¹æ³•ï¼‰ é…ç½®æ¥å£123456789// fallback = &quot;å®ç°ç±»çš„class&quot;ï¼Œç†”æ–­å™¨@FeignClient(name = &quot;service-order&quot;)// è°ƒç”¨æœåŠ¡ï¼ˆæœåŠ¡åï¼‰ï¼Œè¿™é‡Œçš„æœåŠ¡åè¦å’Œå¯¹åº”æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­çš„spring.application.nameå¯¹åº”@Componentpublic interface orderClient &#123; // æ ¹ç»ç”¨æˆ·idå’Œè¯¾ç¨‹idæŸ¥è¯¢ ç”¨æˆ·è¯¾ç¨‹æ”¯ä»˜æƒ…å†µ @GetMapping(&quot;/eduorder/order/getUserCourseStatus/&#123;cid&#125;/&#123;uid&#125;&quot;) public boolean getUserCourseStatus(@PathVariable(&quot;cid&quot;) String cid, @PathVariable(&quot;uid&quot;) String uid);&#125; è¿œç¨‹è°ƒç”¨123456789101112131415161718@RestController@CrossOrigin@RequestMapping(&quot;/eduservice/coursefront&quot;)public class CourseController &#123; @Autowired private EduCourseService courseService; @Autowired private OrderClient orderClient; // è¯¾ç¨‹è¯¦æƒ…ä¿¡æ¯+è¯¾ç¨‹æ”¯ä»˜çŠ¶æ€ï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰ @GetMapping(&quot;getCourseInfo/&#123;courseId&#125;&quot;) public R getCourseInfo(@PathVariable String courseId, HttpServletRequest request) &#123; CourseFrontInfoVo courseInfo = courseService.getBaseCourseInfo(courseId); List&lt;ChapterVo&gt; chapterList = chapterService.getChapterVideoByCourseId(courseId); // æ ¹æ®è¯¾ç¨‹ç”¨æˆ·idæŸ¥è¯¢è®¢å•çŠ¶æ€ boolean status = orderClient.getUserCourseStatus(courseId, JwtUtils.getMemberIdByJwtToken(request)); return R.ok().data(&quot;courseInfo&quot;, courseInfo).data(&quot;chapterList&quot;, chapterList).data(&quot;isBuy&quot;, status); &#125;&#125; å‰ç«¯12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;template&gt; &lt;div id=&quot;aCoursesList&quot; class=&quot;bg-fa of&quot;&gt; &lt;section class=&quot;c-attr-mt&quot; v-if=&quot;isBuy || Number(courseInfo.price === 0)&quot; &gt; &lt;a href=&quot;#&quot; title=&quot;ç«‹å³è§‚çœ‹&quot; class=&quot;comm-btn c-btn-3&quot; @click=&quot;createOrder()&quot; &gt;ç«‹å³è§‚çœ‹&lt;/a &gt; &lt;/section&gt; &lt;section class=&quot;c-attr-mt&quot; v-else&gt; &lt;a href=&quot;#&quot; title=&quot;ç«‹å³è´­ä¹°&quot; class=&quot;comm-btn c-btn-3&quot; @click=&quot;createOrder()&quot; &gt;ç«‹å³è´­ä¹°&lt;/a &gt; &lt;/section&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import courseApi from &#x27;@/api/course&#x27; import orderApi from &#x27;@/api/order&#x27; export default &#123; // asyncData(&#123; params, error &#125;) &#123; // return courseApi.getCourseInfo(params.id).then(result =&gt; &#123; // return &#123; // courseInfo: result.data.data.courseInfo, // chapterList: result.data.data.chapterList, // courseId: params.id // &#125; // &#125;) // &#125;, asyncData(&#123; params, error &#125;) &#123; return &#123; courseId: params.id &#125; &#125;, data() &#123; return &#123; courseInfo: &#123;&#125;, chapterList: [], isBuy: false &#125; &#125;, created() &#123; // è¿™é‡Œä¸é€‚ç”¨å¼‚æ­¥è°ƒç”¨ï¼Œè€Œæ˜¯created this.initCourseInfo() &#125;, methods: &#123; // æŸ¥è¯¢è¯¾ç¨‹è¯¦æƒ…ä¿¡æ¯ initCourseInfo() &#123; courseApi.getCourseInfo(this.courseId).then(result =&gt; &#123; (this.courseInfo = result.data.data.courseInfo), (this.chapterList = result.data.data.chapterList), (this.isBuy = result.data.data.isBuy) &#125;) &#125; &#125; &#125;&lt;/script&gt;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜5","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜5","date":"2021-09-28T09:24:35.305Z","updated":"2021-10-02T04:40:15.713Z","comments":true,"path":"2021/09/28/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-5/","link":"","permalink":"http://example.com/2021/09/28/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-5/","excerpt":"","text":"è¿™é‡Œå¼€å§‹æ˜¯å‰å°éƒ¨åˆ† æ­å»ºé¡¹ç›®å‰å°ç¯å¢ƒ ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“æŠ€æœ¯NuxtJSæ¡†æ¶ ![02 æ­å»ºé¡¹ç›®å‰å°ç¯å¢ƒï¼ˆnuxtï¼‰](https://gitee.com/ReRia/images/raw/master/img/02 æ­å»ºé¡¹ç›®å‰å°ç¯å¢ƒï¼ˆnuxtï¼‰.png) æ­å»ºNuxtJS å…ˆèµ‹å€¼templateè‡³å·¥ä½œåŒº ä¿®æ”¹.eslintrc.jsï¼ˆå¤åˆ¶åå°çš„å³å¯ï¼‰ ä¿®æ”¹package.jsonï¼Œå¿…é¡»ä¿®æ”¹å…¶ä¸­çš„name,version,decription,authorç­‰ ä¿®æ”¹nuxt.config.js å®‰è£…ä¾èµ–npm install æµ‹è¯•è¿è¡Œnpm run dev NUXTç›®å½•ç»“æ„ èµ„æºç›®å½• assetsç”¨äºç»„ç»‡æœªç¼–è¯‘çš„é™æ€èµ„æºå¦‚ LESSã€SASS æˆ– JavaScriptã€‚ ç»„ä»¶ç›®å½• componentsç”¨äºç»„ç»‡åº”ç”¨çš„ Vue.js ç»„ä»¶ã€‚Nuxt.js ä¸ä¼šæ‰©å±•å¢å¼ºè¯¥ç›®å½•ä¸‹ Vue.js ç»„ä»¶ï¼Œå³è¿™äº›ç»„ä»¶ä¸ä¼šåƒé¡µé¢ç»„ä»¶é‚£æ ·æœ‰ asyncData æ–¹æ³•çš„ç‰¹æ€§ã€‚ å¸ƒå±€ç›®å½• layoutsç”¨äºç»„ç»‡åº”ç”¨çš„å¸ƒå±€ç»„ä»¶ã€‚ default.vueï¼šè®¾ç½®å¤´å°¾ä¿¡æ¯ é¡µé¢ç›®å½• pagesç”¨äºç»„ç»‡åº”ç”¨çš„è·¯ç”±åŠè§†å›¾ã€‚Nuxt.js æ¡†æ¶è¯»å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„ .vue æ–‡ä»¶å¹¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„è·¯ç”±é…ç½®ã€‚ æ’ä»¶ç›®å½• pluginsç”¨äºç»„ç»‡é‚£äº›éœ€è¦åœ¨ æ ¹vue.jsåº”ç”¨ å®ä¾‹åŒ–ä¹‹å‰éœ€è¦è¿è¡Œçš„ Javascript æ’ä»¶ã€‚ nuxt.config.js æ–‡ä»¶nuxt.config.js æ–‡ä»¶ç”¨äºç»„ç»‡Nuxt.js åº”ç”¨çš„ä¸ªæ€§åŒ–é…ç½®ï¼Œä»¥ä¾¿è¦†ç›–é»˜è®¤é…ç½®ã€‚ å¼•å…¥åŸºç¡€èµ„æºå’Œé»˜è®¤å¤´å°¾è§†å›¾ Nuxtæœ¬èº«åŸºäºvueï¼Œä½†æ˜¯æ²¡æœ‰å¼•å…¥element-uiï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ è¿™é‡Œè¿˜å¼•å…¥äº†å…¶ä»–éœ€è¦çš„èµ„æºï¼Œç›´æ¥cvå³å¯ assets layout -&gt; default.vue pages -&gt; index.vue default.vue123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155&lt;template&gt; &lt;div class=&quot;in-wrap&quot;&gt; &lt;!-- å…¬å…±å¤´å¼•å…¥ --&gt; &lt;header id=&quot;header&quot;&gt; &lt;section class=&quot;container&quot;&gt; &lt;h1 id=&quot;logo&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;è°·ç²’å­¦é™¢&quot;&gt; &lt;img src=&quot;~/assets/img/logo.png&quot; width=&quot;100%&quot; alt=&quot;è°·ç²’å­¦é™¢&quot; /&gt; &lt;/a&gt; &lt;/h1&gt; &lt;div class=&quot;h-r-nsl&quot;&gt; &lt;ul class=&quot;nav&quot;&gt; &lt;!-- å›ºå®šè·¯ç”± --&gt; &lt;router-link to=&quot;/&quot; tag=&quot;li&quot; active-class=&quot;current&quot; exact&gt; &lt;a&gt;é¦–é¡µ&lt;/a&gt; &lt;/router-link&gt; &lt;router-link to=&quot;/course&quot; tag=&quot;li&quot; active-class=&quot;current&quot;&gt; &lt;a&gt;è¯¾ç¨‹&lt;/a&gt; &lt;/router-link&gt; &lt;router-link to=&quot;/teacher&quot; tag=&quot;li&quot; active-class=&quot;current&quot;&gt; &lt;a&gt;åå¸ˆ&lt;/a&gt; &lt;/router-link&gt; &lt;router-link to=&quot;/article&quot; tag=&quot;li&quot; active-class=&quot;current&quot;&gt; &lt;a&gt;æ–‡ç« &lt;/a&gt; &lt;/router-link&gt; &lt;router-link to=&quot;/qa&quot; tag=&quot;li&quot; active-class=&quot;current&quot;&gt; &lt;a&gt;é—®ç­”&lt;/a&gt; &lt;/router-link&gt; &lt;/ul&gt; &lt;!-- / nav --&gt; &lt;ul class=&quot;h-r-login&quot;&gt; &lt;li v-if=&quot;!loginInfo.id&quot; id=&quot;no-login&quot;&gt; &lt;a href=&quot;/login&quot; title=&quot;ç™»å½•&quot;&gt; &lt;em class=&quot;icon18 login-icon&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;span class=&quot;vam ml5&quot;&gt;ç™»å½•&lt;/span&gt; &lt;/a&gt; | &lt;a href=&quot;/register&quot; title=&quot;æ³¨å†Œ&quot;&gt; &lt;span class=&quot;vam ml5&quot;&gt;æ³¨å†Œ&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li v-if=&quot;loginInfo.id&quot; id=&quot;is-login-one&quot; class=&quot;mr10&quot;&gt; &lt;a id=&quot;headerMsgCountId&quot; href=&quot;#&quot; title=&quot;æ¶ˆæ¯&quot;&gt; &lt;em class=&quot;icon18 news-icon&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;/a&gt; &lt;q class=&quot;red-point&quot; style=&quot;display: none&quot;&gt;&amp;nbsp;&lt;/q&gt; &lt;/li&gt; &lt;li v-if=&quot;loginInfo.id&quot; id=&quot;is-login-two&quot; class=&quot;h-r-user&quot;&gt; &lt;a href=&quot;/ucenter&quot; title&gt; &lt;img :src=&quot;loginInfo.avatar&quot; width=&quot;30&quot; height=&quot;30&quot; class=&quot;vam picImg&quot; alt /&gt; &lt;span id=&quot;userName&quot; class=&quot;vam disIb&quot;&gt;&#123;&#123; loginInfo.nickname &#125;&#125;&lt;/span&gt; &lt;/a&gt; &lt;a href=&quot;javascript:void(0);&quot; title=&quot;é€€å‡º&quot; @click=&quot;logout()&quot; class=&quot;ml5&quot; &gt;é€€å‡º&lt;/a &gt; &lt;/li&gt; &lt;!-- /æœªç™»å½•æ˜¾ç¤ºç¬¬1 liï¼›ç™»å½•åæ˜¾ç¤ºç¬¬2ï¼Œ3 li --&gt; &lt;/ul&gt; &lt;aside class=&quot;h-r-search&quot;&gt; &lt;form action=&quot;#&quot; method=&quot;post&quot;&gt; &lt;label class=&quot;h-r-s-box&quot;&gt; &lt;input type=&quot;text&quot; placeholder=&quot;è¾“å…¥ä½ æƒ³å­¦çš„è¯¾ç¨‹&quot; name=&quot;queryCourse.courseName&quot; value /&gt; &lt;button type=&quot;submit&quot; class=&quot;s-btn&quot;&gt; &lt;em class=&quot;icon18&quot;&gt;&amp;nbsp;&lt;/em&gt; &lt;/button&gt; &lt;/label&gt; &lt;/form&gt; &lt;/aside&gt; &lt;/div&gt; &lt;aside class=&quot;mw-nav-btn&quot;&gt; &lt;div class=&quot;mw-nav-icon&quot;&gt;&lt;/div&gt; &lt;/aside&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/section&gt; &lt;/header&gt; &lt;!-- /å…¬å…±å¤´å¼•å…¥ --&gt; &lt;nuxt /&gt; &lt;!-- å…¬å…±åº•å¼•å…¥ --&gt; &lt;footer id=&quot;footer&quot;&gt; &lt;section class=&quot;container&quot;&gt; &lt;div class&gt; &lt;h4 class=&quot;hLh30&quot;&gt; &lt;span class=&quot;fsize18 f-fM c-999&quot;&gt;å‹æƒ…é“¾æ¥&lt;/span&gt; &lt;/h4&gt; &lt;ul class=&quot;of flink-list&quot;&gt; &lt;li&gt; &lt;a href=&quot;http://www.atguigu.com/&quot; title=&quot;å°šç¡…è°·&quot; target=&quot;_blank&quot; &gt;å°šç¡…è°·&lt;/a &gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;b-foot&quot;&gt; &lt;section class=&quot;fl col-7&quot;&gt; &lt;section class=&quot;mr20&quot;&gt; &lt;section class=&quot;b-f-link&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å…³äºæˆ‘ä»¬&quot; target=&quot;_blank&quot;&gt;å…³äºæˆ‘ä»¬&lt;/a&gt;| &lt;a href=&quot;#&quot; title=&quot;è”ç³»æˆ‘ä»¬&quot; target=&quot;_blank&quot;&gt;è”ç³»æˆ‘ä»¬&lt;/a&gt;| &lt;a href=&quot;#&quot; title=&quot;å¸®åŠ©ä¸­å¿ƒ&quot; target=&quot;_blank&quot;&gt;å¸®åŠ©ä¸­å¿ƒ&lt;/a&gt;| &lt;a href=&quot;#&quot; title=&quot;èµ„æºä¸‹è½½&quot; target=&quot;_blank&quot;&gt;èµ„æºä¸‹è½½&lt;/a&gt;| &lt;span&gt;æœåŠ¡çƒ­çº¿ï¼š010-56253825(åŒ—äº¬) 0755-85293825(æ·±åœ³)&lt;/span&gt; &lt;span&gt;Emailï¼šinfo@atguigu.com&lt;/span&gt; &lt;/section&gt; &lt;section class=&quot;b-f-link mt10&quot;&gt; &lt;span&gt;Â©2018è¯¾ç¨‹ç‰ˆæƒå‡å½’è°·ç²’å­¦é™¢æ‰€æœ‰ äº¬ICPå¤‡17055252å·&lt;/span&gt; &lt;/section&gt; &lt;/section&gt; &lt;/section&gt; &lt;aside class=&quot;fl col-3 tac mt15&quot;&gt; &lt;section class=&quot;gf-tx&quot;&gt; &lt;span&gt; &lt;img src=&quot;~/assets/img/wx-icon.png&quot; alt /&gt; &lt;/span&gt; &lt;/section&gt; &lt;section class=&quot;gf-tx&quot;&gt; &lt;span&gt; &lt;img src=&quot;~/assets/img/wb-icon.png&quot; alt /&gt; &lt;/span&gt; &lt;/section&gt; &lt;/aside&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/section&gt; &lt;/footer&gt; &lt;!-- /å…¬å…±åº•å¼•å…¥ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import &#x27;~/assets/css/reset.css&#x27; import &#x27;~/assets/css/theme.css&#x27; import &#x27;~/assets/css/global.css&#x27; import &#x27;~/assets/css/web.css&#x27; export default &#123; &#125;&lt;/script&gt; index.vue123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136&lt;template&gt; &lt;div&gt; &lt;!-- å¹»ç¯ç‰‡ å¼€å§‹ --&gt; &lt;div v-swiper:mySwiper=&quot;swiperOption&quot;&gt; &lt;div class=&quot;swiper-wrapper&quot;&gt; &lt;div v-for=&quot;banner in bannerList&quot; :key=&quot;banner.id&quot; class=&quot;swiper-slide&quot; style=&quot;background: #040b1b&quot; &gt; &lt;a target=&quot;_blank&quot; :href=&quot;banner.linkUrl&quot;&gt; &lt;img :src=&quot;banner.imageUrl&quot; :alt=&quot;banner.title&quot; /&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;swiper-pagination swiper-pagination-white&quot;&gt;&lt;/div&gt; &lt;div class=&quot;swiper-button-prev swiper-button-white&quot; slot=&quot;button-prev&quot; &gt;&lt;/div&gt; &lt;div class=&quot;swiper-button-next swiper-button-white&quot; slot=&quot;button-next&quot; &gt;&lt;/div&gt; &lt;/div&gt; &lt;!-- å¹»ç¯ç‰‡ ç»“æŸ --&gt; &lt;div id=&quot;aCoursesList&quot;&gt; &lt;!-- ç½‘æ ¡è¯¾ç¨‹ å¼€å§‹ --&gt; &lt;div&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;çƒ­é—¨è¯¾ç¨‹&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;div&gt; &lt;article class=&quot;comm-course-list&quot;&gt; &lt;ul class=&quot;of&quot; id=&quot;bna&quot;&gt; &lt;li v-for=&quot;course in courseList&quot; :key=&quot;course.id&quot;&gt; &lt;div class=&quot;cc-l-wrap&quot;&gt; &lt;section class=&quot;course-img&quot;&gt; &lt;img :src=&quot;course.cover&quot; class=&quot;img-responsive&quot; :alt=&quot;course.title&quot; /&gt; &lt;div class=&quot;cc-mask&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å¼€å§‹å­¦ä¹ &quot; class=&quot;comm-btn c-btn-1&quot; &gt;å¼€å§‹å­¦ä¹ &lt;/a &gt; &lt;/div&gt; &lt;/section&gt; &lt;h3 class=&quot;hLh30 txtOf mt10&quot;&gt; &lt;a href=&quot;#&quot; :title=&quot;course.title&quot; class=&quot;course-title fsize18 c-333&quot; &gt;&#123;&#123; course.title &#125;&#125;&lt;/a &gt; &lt;/h3&gt; &lt;section class=&quot;mt10 hLh20 of&quot;&gt; &lt;span class=&quot;fr jgTag bg-green&quot; v-if=&quot;Number(course.price) === 0&quot; &gt; &lt;i class=&quot;c-fff fsize12 f-fA&quot;&gt;å…è´¹&lt;/i&gt; &lt;/span&gt; &lt;span class=&quot;fl jgAttr c-ccc f-fA&quot;&gt; &lt;i class=&quot;c-999 f-fA&quot;&gt;9634äººå­¦ä¹ &lt;/i&gt; | &lt;i class=&quot;c-999 f-fA&quot;&gt;9634è¯„è®º&lt;/i&gt; &lt;/span&gt; &lt;/section&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;section class=&quot;tac pt20&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å…¨éƒ¨è¯¾ç¨‹&quot; class=&quot;comm-btn c-btn-2&quot;&gt;å…¨éƒ¨è¯¾ç¨‹&lt;/a&gt; &lt;/section&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt; &lt;!-- /ç½‘æ ¡è¯¾ç¨‹ ç»“æŸ --&gt; &lt;!-- ç½‘æ ¡åå¸ˆ å¼€å§‹ --&gt; &lt;div&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;åå¸ˆå¤§å’–&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;div&gt; &lt;article class=&quot;i-teacher-list&quot;&gt; &lt;ul class=&quot;of&quot;&gt; &lt;li v-for=&quot;teacher in teacherList&quot; :key=&quot;teacher.id&quot;&gt; &lt;section class=&quot;i-teach-wrap&quot;&gt; &lt;div class=&quot;i-teach-pic&quot;&gt; &lt;a href=&quot;/teacher/1&quot; :title=&quot;teacher.name&quot;&gt; &lt;img :alt=&quot;teacher.name&quot; :src=&quot;teacher.avatar&quot; /&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;mt10 hLh30 txtOf tac&quot;&gt; &lt;a href=&quot;/teacher/1&quot; :title=&quot;teacher.name&quot; class=&quot;fsize18 c-666&quot; &gt;&#123;&#123; teacher.name &#125;&#125; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;hLh30 txtOf tac&quot;&gt; &lt;span class=&quot;fsize14 c-999&quot;&gt;&#123;&#123; teacher.career &#125;&#125;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;mt15 i-q-txt&quot;&gt; &lt;p class=&quot;c-999 f-fA&quot;&gt; &#123;&#123; teacher.intro &#125;&#125; &lt;/p&gt; &lt;/div&gt; &lt;/section&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;section class=&quot;tac pt20&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å…¨éƒ¨è®²å¸ˆ&quot; class=&quot;comm-btn c-btn-2&quot;&gt;å…¨éƒ¨è®²å¸ˆ&lt;/a&gt; &lt;/section&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt; &lt;!-- /ç½‘æ ¡åå¸ˆ ç»“æŸ --&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt; è½®æ’­å›¾ç»„ä»¶ æœ¬é¡¹ç›®éœ€è¦ç”¨åˆ°ä¸€ä¸ªè½®æ’­å›¾ç»„ä»¶awesome-swiperï¼ˆè¿™é‡Œä½¿ç”¨3.1.3ç‰ˆæœ¬ï¼‰ å®‰è£… npm install vue-awesome-swiper@3.1.3 é…ç½® åœ¨ plugins æ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶ nuxt-swiper-plugin.js 123import Vue from &#x27;vue&#x27;import VueAwesomeSwiper from &#x27;vue-awesome-swiper/dist/ssr&#x27;Vue.use(VueAwesomeSwiper) åœ¨ nuxt.config.js æ–‡ä»¶ä¸­é…ç½®æ’ä»¶ 12345678910module.exports = &#123; // some nuxt config... // awesome-swiperæ’ä»¶é…ç½®å¼•å…¥ plugins: [ &#123; src: &#x27;~/plugins/nuxt-swiper-plugin.js&#x27;, ssr: false &#125; ], css: [ &#x27;swiper/dist/css/swiper.css&#x27; ]&#125; axiosä¾èµ–ä¸å°è£… npm install axios åˆ›å»ºutils -&gt; request.js æ³¨æ„è¿™é‡Œçš„baseURLè¦ä¸nginxå¯¹åº” 1234567import axios from &#x27;axios&#x27;// åˆ›å»ºaxioså®ä¾‹const service = axios.create(&#123; baseURL: &#x27;http://localhost:9001&#x27;, // apiçš„base_url timeout: 20000 // è¯·æ±‚è¶…æ—¶æ—¶é—´&#125;)export default service element-uiå®‰è£… npm install element-ui é…ç½® plugins -&gt; nuxt-swiper-plugin.js 12345678import Vue from &#x27;vue&#x27;import VueAwesomeSwiper from &#x27;vue-awesome-swiper/dist/ssr&#x27;import VueQriously from &#x27;vue-qriously&#x27;import ElementUI from &#x27;element-ui&#x27; //element-uiçš„å…¨éƒ¨ç»„ä»¶import &#x27;element-ui/lib/theme-chalk/index.css&#x27;//element-uiçš„cssVue.use(ElementUI) //ä½¿ç”¨elementUIVue.use(VueQriously)Vue.use(VueAwesomeSwiper) æµ‹è¯• å¿…çœ‹æ³¨æ„ï¼Œç›´æ¥å¯åŠ¨çš„è¯eslintè¯­æ³•æ£€æŸ¥ååˆ†ä¸¥æ ¼ï¼Œç±»ä¼¼äºç©ºæ ¼æ˜¯2ä¸ªå°±ä¸èƒ½æ˜¯4ä¸ªï¼Œæ‰€ä»¥è¦æŠŠä¸¥æ ¼æ£€æŸ¥å…³é—­ è§£å†³vue/cli3.0 è¯­æ³•éªŒè¯è§„åˆ™ ESLint: Expected indentation of 2 spaces but found 4. (indent) - èµ°çœ‹çœ‹ (zoukankan.com) ä»”ç»†å‚è€ƒä¸Šè¿°æ–‡ç« å†…å®¹ï¼Œæ³¨æ„ä¸¤ä¸ªæ­¥éª¤éƒ½è¦æ‰§è¡Œæ‰è¡Œï¼ˆå¼„äº†æˆ‘åå‡ åˆ†é’Ÿæœ‰ç‚¹çƒ¦èºï¼Œå¥½åœ¨è§£å†³äº†ï¼‰ é¦–é¡µåŸºç¡€æ­å»ºè®²å¸ˆå’Œè¯¾ç¨‹è§†å›¾æ¨¡æ¿æ­å»ºå›ºå®šè·¯ç”± æ³¨æ„default.jsä¸­è®¾ç½®äº†å¤´å¯¼èˆªçš„å›ºå®šè·¯ç”±ï¼Œæ‰€ä»¥éœ€è¦åœ¨pagesæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå¯¹åº”çš„è§†å›¾ æ³¨æ„å…¶ä¸­çš„router-linkï¼ˆå³è·¯ç”±å¯¼èˆªï¼‰ï¼Œå…¶ä¸­çš„toå¯¹åº”çš„åœ°å€å°±æ˜¯è§†å›¾çš„åœ°å€ï¼Œå€¼ä¸ºæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œtoä¼šè‡ªåŠ¨æ‰¾åˆ°pagesæ–‡ä»¶å¤¹ä¸‹å¯¹åº”åå­—çš„æ–‡ä»¶å¤¹ä¸­çš„index.vue æŒ‰ç…§è¿™ä¸ªæ€è·¯åˆ›å»ºå¯¹åº”è§†å›¾å³å¯ï¼Œç„¶åå¤åˆ¶èµ„æ–™ä¸­å·²ç»æœ‰çš„è§†å›¾æ¨¡æ¿ åŠ¨æ€è·¯ç”± åŠ¨æ€è·¯ç”±ç¼–å†™æœ‰ä¸€å®šçš„è§„èŒƒ ä¾‹å¦‚éœ€è¦æ ¹æ®idæŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œéœ€è¦åœ¨å¯¹åº”pagesçš„æ–‡ä»¶å¤¹ä¸‹åˆ›å»º_id.vueæ–‡ä»¶ï¼Œï¼ˆå¿…é¡»æ˜¯ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œå‚æ•°åä¸ºä¸‹åˆ’çº¿åé¢çš„æ–‡ä»¶åï¼‰ åˆ›å»ºè§†å›¾ æ ¹æ®ä¸Šè¿°æ¡ä»¶åˆ›å»ºå³å¯ï¼Œç„¶åå†…å®¹æ¨¡æ¿cvå³å¯ å½“å‰é¡¹ç›®ç»“æ„ åç«¯ç¯å¢ƒæ­å»ºåˆ›å»ºå­æ¨¡å— service_cms åˆ›å»ºå¹¶ç¼–å†™é…ç½®æ–‡ä»¶application.properties æ³¨æ„è¿™é‡Œçš„DataSourceé…ç½®ï¼Œå¦‚æœä¸å¯¹å¯èƒ½ä¼šæŠ¥springbootæ‰¾ä¸åˆ°beançš„é”™è¯¯ 123456789101112131415161718192021222324252627# æœåŠ¡ç«¯å£server.port=8004# æœåŠ¡åspring.application.name=service-cms# mysqlæ•°æ®åº“è¿æ¥spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789#è¿”å›jsonçš„å…¨å±€æ—¶é—´æ ¼å¼spring.jackson.date-format=yyyy-MM-dd HH:mm:ssspring.jackson.time-zone=GMT+8#é…ç½®mapper xmlæ–‡ä»¶çš„è·¯å¾„mybatis-plus.mapper-locations=classpath:com/atguigu/educms/mapper/xml/*.xmlspring.redis.host=192.168.44.132spring.redis.port=6379spring.redis.database=0spring.redis.timeout=1800000spring.redis.lettuce.pool.max-active=20spring.redis.lettuce.pool.max-wait=-1#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)spring.redis.lettuce.pool.max-idle=5spring.redis.lettuce.pool.min-idle=0#mybatisæ—¥å¿—mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl# nacosæœåŠ¡åœ°å€spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848 è¿™é‡Œè®°å¾—å»nginx.confé‡Œé…ç½®ä¸€ä¸‹ åˆ›å»ºæ•°æ®åº“è¡¨ å¯¼å…¥èµ„æ–™çš„sqlæ–‡ä»¶å³å¯ ç¼–å†™å¯åŠ¨ç±»123456789@SpringBootApplication@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)@MapperScan(&quot;com.atguigu.educms.mapper&quot;)@EnableDiscoveryClient // nacosæ³¨å†Œpublic class CmsApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(CmsApplication.class, args); &#125;&#125; ä»£ç ç”Ÿæˆå™¨ è€æ ·å­æ”¹ä¸€ä¸‹å°±è¡Œ ç”Ÿæˆä¹‹åè·¨åŸŸæ³¨é‡ŠåŠ ä¸€ä¸‹ã€mapperscanåŠ ä¸€ä¸‹ã€é…ç½®æ–‡ä»¶ä¸­æ‰«æmapper.xmlè·¯å¾„åŠ ä¸€ä¸‹ ä¸€äº›å®ä½“ç±»å­—æ®µçš„æ³¨é‡Šä¹Ÿè¦åŠ ä¸€ä¸‹ï¼Œæ¯”å¦‚è¯´è‡ªåŠ¨æ·»åŠ å’Œé€»è¾‘åˆ é™¤ 123@MapperScan(&quot;com.atguigu.educms.mapper&quot;)public class CmsApplication &#123;&#125; 1234@CrossOriginpublic class CrmBannerController &#123;&#125; 12#é…ç½®mapper xmlæ–‡ä»¶çš„è·¯å¾„mybatis-plus.mapper-locations=classpath:com/atguigu/educms/mapper/xml/*.xml å½“å‰é¡¹ç›®ç»“æ„ é¦–é¡µè½®æ’­å›¾ï¼ˆåç«¯ï¼‰ åå°åº”è¯¥ä¹Ÿæœ‰è½®æ’­å›¾çš„ç®¡ç†æ¨¡å—ï¼Œæ‰€ä»¥éœ€è¦ä¸¤ä¸ªbannerController ç¼–å†™BannerAdminController ç”¨äºåå°çš„bannerç®¡ç†æ¥å£ï¼ŒTODOï¼šå‰ç«¯é¡µé¢è‡ªå·±å†™ï¼ˆæˆ‘é€‰æ‹©ä¸å†™ä½¿ç”¨swaggeræµ‹è¯•å˜¿å˜¿ğŸ˜™ï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738@RestController@RequestMapping(&quot;/educms/banneradmin&quot;)@CrossOriginpublic class BannerAdminController &#123; @Autowired private CrmBannerService bannerService; // åˆ†é¡µæŸ¥è¯¢ @GetMapping(&quot;pageBanner/&#123;pageNo&#125;/&#123;limit&#125;&quot;) public R pageBanner(@PathVariable Long limit, @PathVariable Long pageNo) &#123; Page&lt;CrmBanner&gt; pageBanner = new Page&lt;&gt;(pageNo, limit); bannerService.page(pageBanner, null); return R.ok().data(&quot;records&quot;, pageBanner.getRecords()).data(&quot;total&quot;, pageBanner.getTotal()); &#125; //2 æ·»åŠ banner @PostMapping(&quot;addBanner&quot;) public R addBanner(@RequestBody CrmBanner crmBanner) &#123; bannerService.save(crmBanner); return R.ok(); &#125; @ApiOperation(value = &quot;è·å–Banner&quot;) @GetMapping(&quot;get/&#123;id&#125;&quot;) public R get(@PathVariable String id) &#123; CrmBanner banner = bannerService.getById(id); return R.ok().data(&quot;item&quot;, banner); &#125; @ApiOperation(value = &quot;ä¿®æ”¹Banner&quot;) @PutMapping(&quot;update&quot;) public R updateById(@RequestBody CrmBanner banner) &#123; bannerService.updateById(banner); return R.ok(); &#125; @ApiOperation(value = &quot;åˆ é™¤Banner&quot;) @DeleteMapping(&quot;remove/&#123;id&#125;&quot;) public R remove(@PathVariable String id) &#123; bannerService.removeById(id); return R.ok(); &#125;&#125; ç¼–å†™BannerFrontController ç”¨äºå‰å°çš„banneræ¥å£ï¼Œä¸»è¦ç”¨äºæ˜¾ç¤ºbanner 12345678910111213@RestController@RequestMapping(&quot;/educms/bannerfront&quot;)@CrossOriginpublic class BannerFrontController &#123; @Autowired private CrmBannerService bannerService; //æŸ¥è¯¢bannerä¿¡æ¯ @GetMapping(&quot;getBannerList&quot;) public R getBannerList() &#123; List&lt;CrmBanner&gt; list = bannerService.selectAllBanner(); return R.ok().data(&quot;list&quot;, list); &#125;&#125; ç¼–å†™Service è¿™é‡Œè‡ªå·±å†™äº†ä¸ªserviceï¼Œç»“æœå•¥ä¹Ÿæ²¡å®ç°ï¼Œçº¯å±è„±è£¤å­æ”¾å±ï¼Œæˆ‘æ”¹äº† æˆ‘å‘ç°æˆ‘é”™äº†ï¼Œæˆ‘åº”è¯¥çœ‹å®Œæ•´ä¸ªè§†é¢‘æ‰è¯´è¯ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†åé¢çš„Redisåšå‡†å¤‡çš„ å†™Mapperé‡Œæœ€å¥½ï¼ˆå¼¹å¹•ï¼šæ„Ÿè°¢è¿™æ®µä»£ç ï¼Œæ˜¨å¤©å†™äº†ï¼Œä»Šå¤©è€æ¿è®©æˆ‘èµ°ï¼‰ 123456789101112131415@Servicepublic class CrmBannerServiceImpl extends ServiceImpl&lt;CrmBannerMapper, CrmBanner&gt; implements CrmBannerService &#123; // æŸ¥è¯¢æ‰€æœ‰banner @Override public List&lt;CrmBanner&gt; selectAllBanner() &#123; // æ ¹æ®idé™åºæ’åºï¼Œæ˜¾ç¤ºæ’åºåçš„å‰ä¸¤æ¡è®°å½• QueryWrapper&lt;CrmBanner&gt; wrapper = new QueryWrapper&lt;&gt;(); // è®¾ç½®æ’åºæ¡ä»¶ wrapper.orderByDesc(&quot;id&quot;); // è®¾ç½®æ˜¾ç¤ºæ•°é‡ï¼Œlastæ‹¼æ¥sqlè¯­å¥ wrapper.last(&quot;limit 2&quot;); List&lt;CrmBanner&gt; crmBanners = baseMapper.selectList(wrapper); return crmBanners; &#125;&#125; é¦–é¡µçƒ­é—¨è¯¾ç¨‹å’Œåå¸ˆï¼ˆåç«¯ï¼‰ æ³¨æ„è¿™é‡Œï¼Œcontrollerè¿™äº›åˆå†™åˆ°service_eduæ¨¡å—ä¸­äº† ç¼–å†™Mapper éœ€æ±‚ï¼šæ ¹æ®idè¿›è¡Œé™åºæ’åºï¼ˆæˆ–è€…æ ¹æ®è¡¨ä¸­ä¸“é—¨çš„çƒ­åº¦æ’åºï¼‰ï¼Œæ˜¾ç¤ºæ’åºä¹‹åçš„å‰8æ¡æ•°æ® EduTeacherMapper123456&lt;select id=&quot;selectIndexList&quot; resultType=&quot;com.atguigu.eduservice.entity.EduTeacher&quot;&gt; select * from edu_teacher order by id desc limit 4&lt;/select&gt; EduCourseMapper123456&lt;select id=&quot;selectIndexList&quot; resultType=&quot;com.atguigu.eduservice.entity.EduCourse&quot;&gt; select * from edu_course order by id desc limit 8&lt;/select&gt; ç¼–å†™service å°±ç›´æ¥è°ƒç”¨baseMapperä¸­çš„æ¥å£å³å¯ ç¼–å†™controller123456789101112131415161718@RestController@RequestMapping(&quot;/eduservice/index&quot;)@CrossOriginpublic class IndexController &#123; @Autowired private EduCourseService courseService; @Autowired private EduTeacherService teacherService; // æŸ¥è¯¢çƒ­é—¨è¯¾ç¨‹å’Œè®²å¸ˆ @GetMapping(&quot;index&quot;) public R getIndex() &#123; List&lt;EduCourse&gt; courseList = courseService.getIndexList(); List&lt;EduTeacher&gt; teacherList = teacherService.getIndexList(); return R.ok().data(&quot;courseList&quot;, courseList).data(&quot;teacherList&quot;, teacherList); &#125;&#125; é¦–é¡µè½®æ’­å›¾å’Œçƒ­é—¨è®²å¸ˆè¯¾ç¨‹ï¼ˆå‰ç«¯ï¼‰API api -&gt; banner.js api -&gt; index.js banner.js1234567891011import request from &#x27;@/utils/request&#x27;export default &#123; //æŸ¥è¯¢å‰ä¸¤æ¡banneræ•°æ® getBannerList() &#123; return request(&#123; url: &#x27;/educms/bannerfront/getBannerList&#x27;, method: &#x27;get&#x27; &#125;) &#125;&#125; index.js1234567891011import request from &#x27;@/utils/request&#x27;export default &#123; //æŸ¥è¯¢çƒ­é—¨è¯¾ç¨‹å’Œåå¸ˆ getIndexList() &#123; return request(&#123; url: &#x27;/eduservice/index/getIndexList&#x27;, method: &#x27;get&#x27; &#125;) &#125;&#125; è°ƒç”¨æ¥å£ æ³¨æ„è¿™é‡Œçš„responseéœ€è¦ä¸¤ä¸ªdataï¼Œåº”ä¸ºè¿™ä¸ªæ¨¡æ¿æ²¡æœ‰å¸®å¿™å°è£…responseçš„ä¸€äº›ä¸œè¥¿ï¼Œä¹‹å‰çš„ç›´æ¥è·å¾—çš„æ˜¯response.data è½®æ’­å›¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;template&gt; &lt;div&gt; &lt;!-- å¹»ç¯ç‰‡ å¼€å§‹ --&gt; &lt;div v-swiper:mySwiper=&quot;swiperOption&quot;&gt; &lt;div class=&quot;swiper-wrapper&quot;&gt; &lt;div v-for=&quot;banner in bannerList&quot; :key=&quot;banner.id&quot; class=&quot;swiper-slide&quot; style=&quot;background: #040b1b&quot; &gt; &lt;a target=&quot;_blank&quot; :href=&quot;banner.linkUrl&quot;&gt; &lt;img :src=&quot;banner.imageUrl&quot; :alt=&quot;banner.title&quot; /&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;swiper-pagination swiper-pagination-white&quot;&gt;&lt;/div&gt; &lt;div class=&quot;swiper-button-prev swiper-button-white&quot; slot=&quot;button-prev&quot; &gt;&lt;/div&gt; &lt;div class=&quot;swiper-button-next swiper-button-white&quot; slot=&quot;button-next&quot; &gt;&lt;/div&gt; &lt;/div&gt; &lt;!-- å¹»ç¯ç‰‡ ç»“æŸ --&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import bannerApi from &#x27;@/api/banner&#x27; export default &#123; data() &#123; return &#123; swiperOption: &#123; // é…ç½®åˆ†é¡µ pagination: &#123; el: &#x27;.swiper-pagination&#x27; // åˆ†é¡µçš„domèŠ‚ç‚¹ &#125;, // é…ç½®å¯¼èˆª navigation: &#123; nextEl: &#x27;.swiper-button-next&#x27;, // ä¸‹ä¸€é¡µdomèŠ‚ç‚¹ prevEl: &#x27;.swiper-button-prev&#x27; // å‰ä¸€é¡µdomèŠ‚ç‚¹ &#125; &#125;, // æ•°ç»„ bannerList: [], courseList: [], teacherList: [] &#125; &#125;, created() &#123; // åˆå§‹åŒ–æ•°æ® this.getBannerList() &#125;, methods: &#123; // åˆå§‹åŒ–é¦–é¡µè½®æ’­å›¾è¯¾ç¨‹è®²å¸ˆåˆ—è¡¨ getBannerList() &#123; bannerApi.getBannerList().then(result =&gt; &#123; this.bannerList = result.data.data.list &#125;) &#125; &#125; &#125;&lt;/script&gt; çƒ­é—¨è¯¾ç¨‹è®²å¸ˆ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189&lt;template&gt; &lt;div&gt; &lt;div id=&quot;aCoursesList&quot;&gt; &lt;!-- ç½‘æ ¡è¯¾ç¨‹ å¼€å§‹ --&gt; &lt;div&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;çƒ­é—¨è¯¾ç¨‹&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;div&gt; &lt;article class=&quot;comm-course-list&quot;&gt; &lt;ul class=&quot;of&quot; id=&quot;bna&quot;&gt; &lt;li v-for=&quot;course in courseList&quot; :key=&quot;course.id&quot; &gt; &lt;div class=&quot;cc-l-wrap&quot;&gt; &lt;section class=&quot;course-img&quot;&gt; &lt;img :src=&quot;course.cover&quot; class=&quot;img-responsive&quot; :alt=&quot;course.title&quot; /&gt; &lt;div class=&quot;cc-mask&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å¼€å§‹å­¦ä¹ &quot; class=&quot;comm-btn c-btn-1&quot; &gt;å¼€å§‹å­¦ä¹ &lt;/a &gt; &lt;/div&gt; &lt;/section&gt; &lt;h3 class=&quot;hLh30 txtOf mt10&quot;&gt; &lt;a href=&quot;#&quot; :title=&quot;course.title&quot; class=&quot; course-title fsize18 c-333 &quot; &gt;&#123;&#123; course.title &#125;&#125;&lt;/a &gt; &lt;/h3&gt; &lt;section class=&quot;mt10 hLh20 of&quot;&gt; &lt;span class=&quot;fr jgTag bg-green&quot; v-if=&quot; Number(course.price) === 0 &quot; &gt; &lt;i class=&quot;c-fff fsize12 f-fA&quot; &gt;å…è´¹&lt;/i &gt; &lt;/span&gt; &lt;span class=&quot;fl jgAttr c-ccc f-fA&quot;&gt; &lt;i class=&quot;c-999 f-fA&quot; &gt;9634äººå­¦ä¹ &lt;/i &gt; | &lt;i class=&quot;c-999 f-fA&quot; &gt;9634è¯„è®º&lt;/i &gt; &lt;/span&gt; &lt;/section&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;section class=&quot;tac pt20&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å…¨éƒ¨è¯¾ç¨‹&quot; class=&quot;comm-btn c-btn-2&quot; &gt;å…¨éƒ¨è¯¾ç¨‹&lt;/a &gt; &lt;/section&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt; &lt;!-- /ç½‘æ ¡è¯¾ç¨‹ ç»“æŸ --&gt; &lt;!-- ç½‘æ ¡åå¸ˆ å¼€å§‹ --&gt; &lt;div&gt; &lt;section class=&quot;container&quot;&gt; &lt;header class=&quot;comm-title&quot;&gt; &lt;h2 class=&quot;tac&quot;&gt; &lt;span class=&quot;c-333&quot;&gt;åå¸ˆå¤§å’–&lt;/span&gt; &lt;/h2&gt; &lt;/header&gt; &lt;div&gt; &lt;article class=&quot;i-teacher-list&quot;&gt; &lt;ul class=&quot;of&quot;&gt; &lt;li v-for=&quot;teacher in teacherList&quot; :key=&quot;teacher.id&quot; &gt; &lt;section class=&quot;i-teach-wrap&quot;&gt; &lt;div class=&quot;i-teach-pic&quot;&gt; &lt;a href=&quot;/teacher/1&quot; :title=&quot;teacher.name&quot; &gt; &lt;img :alt=&quot;teacher.name&quot; :src=&quot;teacher.avatar&quot; /&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;mt10 hLh30 txtOf tac&quot;&gt; &lt;a href=&quot;/teacher/1&quot; :title=&quot;teacher.name&quot; class=&quot;fsize18 c-666&quot; &gt;&#123;&#123; teacher.name &#125;&#125;&lt;/a &gt; &lt;/div&gt; &lt;div class=&quot;hLh30 txtOf tac&quot;&gt; &lt;span class=&quot;fsize14 c-999&quot;&gt;&#123;&#123; teacher.career &#125;&#125;&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;mt15 i-q-txt&quot;&gt; &lt;p class=&quot;c-999 f-fA&quot;&gt; &#123;&#123; teacher.intro &#125;&#125; &lt;/p&gt; &lt;/div&gt; &lt;/section&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt; &lt;/article&gt; &lt;section class=&quot;tac pt20&quot;&gt; &lt;a href=&quot;#&quot; title=&quot;å…¨éƒ¨è®²å¸ˆ&quot; class=&quot;comm-btn c-btn-2&quot; &gt;å…¨éƒ¨è®²å¸ˆ&lt;/a &gt; &lt;/section&gt; &lt;/div&gt; &lt;/section&gt; &lt;/div&gt; &lt;!-- /ç½‘æ ¡åå¸ˆ ç»“æŸ --&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import bannerApi from &#x27;@/api/banner&#x27; import indexApi from &#x27;@/api/index&#x27; export default &#123; data() &#123; return &#123; swiperOption: &#123; // é…ç½®åˆ†é¡µ pagination: &#123; el: &#x27;.swiper-pagination&#x27; // åˆ†é¡µçš„domèŠ‚ç‚¹ &#125;, // é…ç½®å¯¼èˆª navigation: &#123; nextEl: &#x27;.swiper-button-next&#x27;, // ä¸‹ä¸€é¡µdomèŠ‚ç‚¹ prevEl: &#x27;.swiper-button-prev&#x27; // å‰ä¸€é¡µdomèŠ‚ç‚¹ &#125; &#125;, // æ•°ç»„ bannerList: [], courseList: [], teacherList: [] &#125; &#125;, created() &#123; // åˆå§‹åŒ–æ•°æ® this.getBannerList() this.getCourseTeacher() &#125;, methods: &#123; // åˆå§‹åŒ–é¦–é¡µè¯¾ç¨‹è®²å¸ˆåˆ—è¡¨ getCourseTeacher() &#123; indexApi.getIndexList().then(result =&gt; &#123; this.courseList = result.data.data.courseList this.teacherList = result.data.data.teacherList &#125;) &#125; &#125; &#125;&lt;/script&gt; æµ‹è¯• è¿™é‡Œæˆ‘æ²¡æœ‰æŠŠurlå¯¹åº”èµ·æ¥ï¼Œæ‰€ä»¥æŠ¥äº†Access to XMLHttpRequest at &#39;http://localhost:9001/educms/bannerfront/getBannerList&#39; from origin &#39;http://localhost:3000&#39; has been blocked by CORS policy: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource.çš„é”™è¯¯ è¿™ä¸ªé”™è¯¯è¿˜æœ‰å¯èƒ½æ˜¯nginxæ²¡æœ‰é…ç½®ï¼Œæˆ–è€…è·¨åŸŸæ³¨è§£æ²¡æœ‰åŠ  å•ç‚¹ç™»å½•SSO![02 å•ç‚¹ç™»å½•ä¸‰ç§æ–¹å¼ä»‹ç»](https://gitee.com/ReRia/images/raw/master/img/02 å•ç‚¹ç™»å½•ä¸‰ç§æ–¹å¼ä»‹ç».png) Redisä»‹ç» æ•´åˆ è¯¥é¡¹ç›®åœ¨commonæ¨¡å—ä¸­é…ç½® ä¾èµ–123456789101112&lt;!-- redis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- spring2.Xé›†æˆredisæ‰€éœ€common-pool2--&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt; &lt;version&gt;2.6.0&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºé…ç½®ç±»123456789101112131415161718192021222324252627282930313233343536373839404142@Configuration // é…ç½®ç±»@EnableCaching // å¼€å¯casheç¼“å­˜public class RedisConfig extends CachingConfigurerSupport &#123; @Bean public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory factory) &#123; RedisTemplate&lt;String, Object&gt; template = new RedisTemplate&lt;&gt;(); RedisSerializer&lt;String&gt; redisSerializer = new StringRedisSerializer(); Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class); ObjectMapper om = new ObjectMapper(); om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL); jackson2JsonRedisSerializer.setObjectMapper(om); template.setConnectionFactory(factory); //keyåºåˆ—åŒ–æ–¹å¼ template.setKeySerializer(redisSerializer); //valueåºåˆ—åŒ– template.setValueSerializer(jackson2JsonRedisSerializer); //value hashmapåºåˆ—åŒ– template.setHashValueSerializer(jackson2JsonRedisSerializer); return template; &#125; @Bean public CacheManager cacheManager(RedisConnectionFactory factory) &#123; RedisSerializer&lt;String&gt; redisSerializer = new StringRedisSerializer(); Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class); //è§£å†³æŸ¥è¯¢ç¼“å­˜è½¬æ¢å¼‚å¸¸çš„é—®é¢˜ ObjectMapper om = new ObjectMapper(); om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL); jackson2JsonRedisSerializer.setObjectMapper(om); // é…ç½®åºåˆ—åŒ–ï¼ˆè§£å†³ä¹±ç çš„é—®é¢˜ï¼‰,è¿‡æœŸæ—¶é—´600ç§’ RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig() .entryTtl(Duration.ofSeconds(600)) .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer)) .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer)) .disableCachingNullValues(); RedisCacheManager cacheManager = RedisCacheManager.builder(factory) .cacheDefaults(config) .build(); return cacheManager; &#125;&#125; springbootç¼“å­˜æ³¨è§£ åœ¨ç›¸å¯¹åº”æ¥å£ä¸­æ·»åŠ Redisç¼“å­˜ä½¿ç”¨æ³¨è§£å³å¯ä½¿ç”¨Redisç¼“å­˜ @Cacheableï¼šä¸€èˆ¬ç”¨åœ¨æŸ¥è¯¢æ–¹æ³•ä¸Šï¼Œæ ¹æ®æ–¹æ³•å¯¹å…¶è¿”å›ç»“æœè¿›è¡Œç¼“å­˜ï¼Œä¸‹æ¬¡è¯·æ±‚æ—¶å¦‚æœç¼“å­˜å­˜åœ¨ï¼Œnameç›´æ¥è¯»å–ç¼“å­˜æ•°æ®è¿”å› @CachePutï¼šä¸€èˆ¬ç”¨åœ¨æ–°å¢æ–¹æ³•ä¸Šï¼Œä½¿ç”¨è¯¥æ³¨è§£çš„æ–¹æ³•æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œï¼Œå¹¶å°†ç»“æœå­˜å…¥æŒ‡å®šçš„ç¼“å­˜ä¸­ @CacheEvictï¼šä¸€èˆ¬ç”¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ–¹æ³•ä¸Šï¼Œä¼šæ¸…ç©ºæŒ‡å®šçš„ç¼“å­˜ ä½¿ç”¨RedisæœåŠ¡å®‰è£…Rediså¹¶å¯åŠ¨ è¿™é‡Œæˆ‘å»è°·ç²’å•†åŸçœ‹äº† é…ç½®æ–‡ä»¶ åœ¨éœ€è¦ä½¿ç”¨redisçš„æ¨¡å—çš„é…ç½®æ–‡ä»¶application.propertiesä¸­æ·»åŠ é…ç½® 12345678#redisé…ç½®#æ³¨æ„è¿™é‡Œçš„hostå’Œportè¦å’Œè™šæ‹Ÿæœºçš„å¯¹åº”spring.redis.host=192.168.128.129spring.redis.port=6379spring.redis.database=0spring.redis.timeout=1800000spring.redis.lettuce.pool.max-active=20spring.redis.lettuce.pool.max-wait=-1 é¦–é¡µç¼“å­˜ åœ¨ç›¸å…³çš„serviceæ–¹æ³•ä¸Šæ·»åŠ æ³¨é‡Šï¼ˆæ³¨æ„è¿™é‡Œä¸ºä»€ä¹ˆè¦åœ¨serviceä¸­åŠ ï¼Œå› ä¸ºæ³¨é‡Šè‡ªåŠ¨æ·»åŠ åˆ°redisçš„è¯ï¼Œæ˜¯ä»è¿”å›å€¼è·å–çš„ï¼Œcontrollerä¸­å®šä¹‰äº†ç»Ÿä¸€è¿”å›æ ¼å¼ï¼Œä¸é€‚ç”¨ï¼‰ 12345678@Servicepublic class CrmBannerServiceImpl extends ServiceImpl&lt;CrmBannerMapper, CrmBanner&gt; implements CrmBannerService &#123; // æŸ¥è¯¢æ‰€æœ‰banner @Override @Cacheable(key = &quot;&#x27;selectIndexList&#x27;&quot;, value = &quot;banner&quot;) // Redisç¼“å­˜,æ³¨æ„è¿™é‡Œkeyä¸­è¦åŠ å•å¼•å· public List&lt;CrmBanner&gt; selectAllBanner() &#123; &#125;&#125; redisç›¸å…³å‘½ä»¤ ä½¿ç”¨rootæƒé™ï¼šsu root æŸ¥çœ‹VMwarehostï¼šifconfig ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼švi /mydata/redis/conf/redis.conf å¯åŠ¨redisï¼šdocker start redis è¿›å…¥redisï¼šdocker exec -it redis redis-cli æŸ¥çœ‹æ‰€æœ‰keyvalueï¼škeys * è®¾ç½®æŸ¥çœ‹ï¼šset/get xxx JWT(Json Web Token) ä¾èµ– å…ˆå¼•å…¥ä¾èµ–ï¼Œcommon_utilsæ¨¡å—å³å¯ 1234567&lt;dependencies&gt; &lt;!-- JWT--&gt; &lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; utilsç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071import io.jsonwebtoken.Claims;import io.jsonwebtoken.Jws;import io.jsonwebtoken.Jwts;import io.jsonwebtoken.SignatureAlgorithm;import org.springframework.util.StringUtils;import javax.servlet.http.HttpServletRequest;import java.util.Date;public class JwtUtils &#123; public static final long EXPIRE = 1000 * 60 * 60 * 24; public static final String APP_SECRET = &quot;ukc8BDbRigUDaY6pZFfWus2jZWLPHO&quot;; public static String getJwtToken(String id, String nickname) &#123; String JwtToken = Jwts.builder() .setHeaderParam(&quot;typ&quot;, &quot;JWT&quot;) .setHeaderParam(&quot;alg&quot;, &quot;HS256&quot;) .setSubject(&quot;guli-user&quot;) .setIssuedAt(new Date()) .setExpiration(new Date(System.currentTimeMillis() + EXPIRE)) .claim(&quot;id&quot;, id) .claim(&quot;nickname&quot;, nickname) .signWith(SignatureAlgorithm.HS256, APP_SECRET) .compact(); return JwtToken; &#125; /** * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ * * @param jwtToken * @return */ public static boolean checkToken(String jwtToken) &#123; if (StringUtils.isEmpty(jwtToken)) return false; try &#123; Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken); &#125; catch (Exception e) &#123; e.printStackTrace(); return false; &#125; return true; &#125; /** * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ * * @param request * @return */ public static boolean checkToken(HttpServletRequest request) &#123; try &#123; String jwtToken = request.getHeader(&quot;token&quot;); if (StringUtils.isEmpty(jwtToken)) return false; Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken); &#125; catch (Exception e) &#123; e.printStackTrace(); return false; &#125; return true; &#125; /** * æ ¹æ®tokenè·å–ä¼šå‘˜id * * @param request * @return */ public static String getMemberIdByJwtToken(HttpServletRequest request) &#123; String jwtToken = request.getHeader(&quot;token&quot;); if (StringUtils.isEmpty(jwtToken)) return &quot;&quot;; Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken); Claims claims = claimsJws.getBody(); return (String) claims.get(&quot;id&quot;); &#125;&#125; çŸ­ä¿¡å¾®æœåŠ¡é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ å¼€å¯ä¹‹åï¼Œç”³è¯·ç­¾åç®¡ç†å’Œæ¨¡æ¿ç®¡ç† ï¼Ÿï¼Ÿï¼Ÿå¿…é¡»è¦å¤‡æ¡ˆç½‘ç«™å¥½å®¶ä¼™muaçš„ TODOï¼Œæ²¡æœ‰åŸŸåä¸‹æ¬¡å†è¯´å§ åˆ›å»ºå­æ¨¡å— service_msmæ¨¡å— é…ç½®æ–‡ä»¶application.properties åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€æ ·çš„å†™æ³• 1234567891011121314151617181920212223242526272829# æœåŠ¡ç«¯å£server.port=8005# æœåŠ¡åspring.application.name=service-msm# mysqlæ•°æ®åº“è¿æ¥spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789#redisé…ç½®spring.redis.host=192.168.128.129spring.redis.port=6379spring.redis.database=0spring.redis.timeout=1800000spring.redis.lettuce.pool.max-active=20spring.redis.lettuce.pool.max-wait=-1#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)spring.redis.lettuce.pool.max-idle=5spring.redis.lettuce.pool.min-idle=0#æœ€å°ç©ºé—²#è¿”å›jsonçš„å…¨å±€æ—¶é—´æ ¼å¼spring.jackson.date-format=yyyy-MM-dd HH:mm:ssspring.jackson.time-zone=GMT+8#mybatisæ—¥å¿—mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl# nacosæœåŠ¡åœ°å€spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848#é…ç½®mapper xmlæ–‡ä»¶çš„è·¯å¾„mybatis-plus.mapper-locations=classpath:com/atguigu/educms/mapper/xml/*.xml å¯åŠ¨ç±»1234567@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)public class MsmApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(MsmApplication.class, args); &#125;&#125; controller TODO service TODO ç™»å½•æ³¨å†Œï¼ˆåç«¯ï¼‰åŸºç¡€å·¥ä½œåˆ›å»ºæ¨¡å— service_ucenter æ•°æ®åº“ ucenter_member ä»£ç ç”Ÿæˆå™¨ è€æ ·å­ é…ç½®æ–‡ä»¶ è€æ ·å­ 1234567891011121314151617181920212223242526272829# æœåŠ¡ç«¯å£server.port=8006# æœåŠ¡åspring.application.name=service-ucenter# mysqlæ•°æ®åº“è¿æ¥spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789#redisé…ç½®spring.redis.host=192.168.128.129spring.redis.port=6379spring.redis.database=0spring.redis.timeout=1800000spring.redis.lettuce.pool.max-active=20spring.redis.lettuce.pool.max-wait=-1#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)spring.redis.lettuce.pool.max-idle=5spring.redis.lettuce.pool.min-idle=0#æœ€å°ç©ºé—²#è¿”å›jsonçš„å…¨å±€æ—¶é—´æ ¼å¼spring.jackson.date-format=yyyy-MM-dd HH:mm:ssspring.jackson.time-zone=GMT+8#mybatisæ—¥å¿—mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl# nacosæœåŠ¡åœ°å€spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848#é…ç½®mapper xmlæ–‡ä»¶çš„è·¯å¾„mybatis-plus.mapper-locations=classpath:com/atguigu/educenter/mapper/xml/*.xml å¯åŠ¨ç±»12345678@SpringBootApplication@ComponentScan(&#123;&quot;com.atguigu&quot;&#125;)@MapperScan(&quot;com.atguigu.educenter.mapper&quot;)public class UcenterApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(UcenterApplication.class, args); &#125;&#125; è¿˜æœ‰nginxé…ç½®ï¼Œè·¨åŸŸé…ç½®ç­‰ ç™»å½•MD5Utils åŠ å¯†å·¥å…· 12345678910111213141516171819202122232425262728293031package com.atguigu.educenter.utils;import java.security.MessageDigest;import java.security.NoSuchAlgorithmException;public final class MD5 &#123; public static String encrypt(String strSrc) &#123; try &#123; char hexChars[] = &#123; &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27; &#125;; byte[] bytes = strSrc.getBytes(); MessageDigest md = MessageDigest.getInstance(&quot;MD5&quot;); md.update(bytes); bytes = md.digest(); int j = bytes.length; char[] chars = new char[j * 2]; int k = 0; for (int i = 0; i &lt; bytes.length; i++) &#123; byte b = bytes[i]; chars[k++] = hexChars[b &gt;&gt;&gt; 4 &amp; 0xf]; chars[k++] = hexChars[b &amp; 0xf]; &#125; return new String(chars); &#125; catch (NoSuchAlgorithmException e) &#123; e.printStackTrace(); throw new RuntimeException(&quot;MD5åŠ å¯†å‡ºé”™ï¼ï¼+&quot; + e); &#125; &#125; public static void main(String[] args) &#123; System.out.println(MD5.encrypt(&quot;111111&quot;)); &#125;&#125; controller1234567891011121314@RestController@RequestMapping(&quot;/educenter/member&quot;)@CrossOriginpublic class UcenterMemberController &#123; @Autowired private UcenterMemberService memberService; // ç™»å½• @PostMapping(&quot;login&quot;) public R loginUser(@RequestBody UcenterMember member) &#123; // è°ƒç”¨serviceæ–¹æ³•,å¹¶ä¸”è¿”å›token String token = memberService.login(member); return R.ok().data(&quot;token&quot;, token); &#125;&#125; service æ³¨æ„ä½¿ç”¨MD5å·¥å…·åŠ å¯†å†æ¯”è¾ƒå¯†ç  12345678910111213141516171819202122232425262728293031323334@Servicepublic class UcenterMemberServiceImpl extends ServiceImpl&lt;UcenterMemberMapper, UcenterMember&gt; implements UcenterMemberService &#123; // ç™»å½• @Override public String login(UcenterMember member) &#123; // è·å¾—æ‰‹æœºå·å’Œå¯†ç  String mobile = member.getMobile(); String password = member.getPassword(); // éç©ºåˆ¤æ–­ if (StringUtils.isEmpty(mobile) || StringUtils.isEmpty(password)) &#123; throw new GuliException(20001, &quot;æ‰‹æœºæˆ–å¯†ç ä¸ºç©º&quot;); &#125; // æŸ¥è¯¢æ•°æ®åº“ QueryWrapper&lt;UcenterMember&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;mobile&quot;, mobile); UcenterMember mmember = baseMapper.selectOne(wrapper); if (mmember == null) &#123; throw new GuliException(20001, &quot;è¯¥è´¦å·ä¸å­˜åœ¨&quot;); &#125; // åˆ¤æ–­å¯†ç æ˜¯å¦æ­£ç¡® // æ•°æ®åº“å¯†ç ä¸ºåŠ å¯†åçš„å¯†ç ï¼Œæ‰€ä»¥éœ€è¦è½¬æ¢ // ä½¿ç”¨åŠ å¯†æ–¹å¼MD5ï¼ˆåªèƒ½åŠ å¯†ï¼‰ if (!mmember.getPassword().equals(MD5.encrypt(password))) &#123; throw new GuliException(20001, &quot;å¯†ç é”™è¯¯&quot;); &#125; // åˆ¤æ–­æ˜¯å¦ç¦ç”¨ if (mmember.getIsDisabled()) &#123; throw new GuliException(20001, &quot;è´¦å·ç¦ç”¨&quot;); &#125; // ç”Ÿæˆtokenå­—ç¬¦ä¸² String token = JwtUtils.getJwtToken(mmember.getId(), mmember.getNickname()); return token; &#125;&#125; swaggeræµ‹è¯• åˆå§‹å€¼éšä¾¿å¤åˆ¶ä¸€ä¸ªmobileï¼Œå¯†ç ç»Ÿä¸€ä¸º111111 æ³¨å†Œvoå®ä½“ç±»1234567891011@Datapublic class RegisterVo &#123; @ApiModelProperty(value = &quot;æ˜µç§°&quot;) private String nickname; @ApiModelProperty(value = &quot;æ‰‹æœºå·&quot;) private String mobile; @ApiModelProperty(value = &quot;å¯†ç &quot;) private String password; //@ApiModelProperty(value = &quot;éªŒè¯ç &quot;) //private String code;&#125; controller123456// æ³¨å†Œ@PostMapping(&quot;register&quot;)public R registerUser(@RequestBody RegisterVo registerVo) &#123; memberService.register(registerVo); return R.ok();&#125; service12345678910111213141516171819202122232425262728// æ³¨å†Œ@Overridepublic void register(RegisterVo registerVo) &#123; // TODO éªŒè¯ç åˆ¤æ–­ï¼ˆæš‚æ—¶ä¸å†™ï¼‰ //è·å–æ³¨å†Œçš„æ•°æ® String mobile = registerVo.getMobile(); //æ‰‹æœºå· String nickname = registerVo.getNickname(); //æ˜µç§° String password = registerVo.getPassword(); //å¯†ç  //éç©ºåˆ¤æ–­ if (StringUtils.isEmpty(mobile) || StringUtils.isEmpty(password) || StringUtils.isEmpty(nickname)) &#123; throw new GuliException(20001, &quot;è¾“å…¥ä¸ºç©º&quot;); &#125; //åˆ¤æ–­æ‰‹æœºå·æ˜¯å¦é‡å¤ï¼Œè¡¨é‡Œé¢å­˜åœ¨ç›¸åŒæ‰‹æœºå·ä¸è¿›è¡Œæ·»åŠ  QueryWrapper&lt;UcenterMember&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;mobile&quot;, mobile); Integer count = baseMapper.selectCount(wrapper); if (count &gt; 0) &#123; throw new GuliException(20001, &quot;æ‰‹æœºå·é‡å¤&quot;); &#125; //æ•°æ®æ·»åŠ æ•°æ®åº“ä¸­ UcenterMember member = new UcenterMember(); member.setMobile(mobile); member.setNickname(nickname); member.setPassword(MD5.encrypt(password));//å¯†ç éœ€è¦åŠ å¯†çš„ member.setIsDisabled(false);//ç”¨æˆ·ä¸ç¦ç”¨ member.setAvatar(&quot;http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoj0hHXhgJNOTSOFsS4uZs8x1ConecaVOB8eIl115xmJZcT4oCicvia7wMEufibKtTLqiaJeanU2Lpg3w/132&quot;); baseMapper.insert(member);&#125; å›æ˜¾æ•°æ® æ ¹æ®tokenè·å¾—ç”¨æˆ·ä¿¡æ¯ controller12345678910// æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯@GetMapping(&quot;getMemberInfo&quot;)public R getMemberInfo(HttpServletRequest request) &#123; // è°ƒç”¨jwtå·¥å…·ç±»æ–¹æ³•è·å–requestå¯¹è±¡çš„å¤´ä¿¡æ¯ï¼Œè·å¾—id String memberId = JwtUtils.getMemberIdByJwtToken(request); // è·å¾—ç”¨æˆ·ä¿¡æ¯ UcenterMember member = memberService.getById(memberId); // è¿™é‡Œæœ€å¥½é¢å¤–ä½¿ç”¨voå®ä½“ç±» return R.ok().data(&quot;member&quot;, member);&#125; ç™»å½•æ³¨å†Œï¼ˆå‰ç«¯ï¼‰æ³¨å†Œlayout åˆ›å»ºsign.vueç„¶åcv è¿™ä¸ªæ˜¯ä¸“é—¨çš„æ³¨å†Œç™»å½•é¡µé¢çš„å¸ƒå±€ api apiä¸­åˆ›å»ºå¯¹åº”jså³å¯ 1234567891011import request from &#x27;@/utils/request&#x27;export default &#123; // æ³¨å†Œ register(registerVo) &#123; return request(&#123; url: &#x27;/educenter/member/register&#x27;, method: &#x27;post&#x27;, data: registerVo &#125;) &#125;&#125; vueé¡µé¢ å…ˆå»layout -&gt; default.vueä¸­çš„åœ°å€è¯¥ä¸ºç™»å½•æ³¨å†Œé¡µé¢çš„åœ°å€ ç„¶ååœ¨pagesé‡Œåˆ›å»ºvueè§†å›¾ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150&lt;template&gt; &lt;div class=&quot;main&quot;&gt; &lt;div class=&quot;title&quot;&gt; &lt;a href=&quot;/login&quot;&gt;ç™»å½•&lt;/a&gt; &lt;span&gt;Â·&lt;/span&gt; &lt;a class=&quot;active&quot; href=&quot;/register&quot;&gt;æ³¨å†Œ&lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;sign-up-container&quot;&gt; &lt;el-form ref=&quot;userForm&quot; :model=&quot;params&quot;&gt; &lt;el-form-item class=&quot;input-prepend restyle&quot; prop=&quot;nickname&quot; :rules=&quot;[ &#123; required: true, message: &#x27;è¯·è¾“å…¥ä½ çš„æ˜µç§°&#x27;, trigger: &#x27;blur&#x27; &#125;, ]&quot; &gt; &lt;div&gt; &lt;el-input type=&quot;text&quot; placeholder=&quot;ä½ çš„æ˜µç§°&quot; v-model=&quot;params.nickname&quot; /&gt; &lt;i class=&quot;iconfont icon-user&quot; /&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;el-form-item class=&quot;input-prepend restyle no-radius&quot; prop=&quot;mobile&quot; :rules=&quot;[ &#123; required: true, message: &#x27;è¯·è¾“å…¥æ‰‹æœºå·ç &#x27;, trigger: &#x27;blur&#x27; &#125;, &#123; validator: checkPhone, trigger: &#x27;blur&#x27; &#125;, ]&quot; &gt; &lt;div&gt; &lt;el-input type=&quot;text&quot; placeholder=&quot;æ‰‹æœºå·&quot; v-model=&quot;params.mobile&quot; /&gt; &lt;i class=&quot;iconfont icon-phone&quot; /&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;el-form-item class=&quot;input-prepend restyle no-radius&quot; prop=&quot;code&quot; :rules=&quot;[ &#123; required: true, message: &#x27;è¯·è¾“å…¥éªŒè¯ç &#x27;, trigger: &#x27;blur&#x27; &#125;, ]&quot; &gt; &lt;div style=&quot;width: 100%; display: block; float: left; position: relative&quot; &gt; &lt;el-input type=&quot;text&quot; placeholder=&quot;éªŒè¯ç &quot; v-model=&quot;params.code&quot; /&gt; &lt;i class=&quot;iconfont icon-phone&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;btn&quot; style=&quot;position: absolute; right: 0; top: 6px; width: 40%&quot; &gt; &lt;a href=&quot;javascript:&quot; type=&quot;button&quot; @click=&quot;getCodeFun()&quot; :value=&quot;codeTest&quot; style=&quot;border: none; background-color: none&quot; &gt;&#123;&#123; codeTest &#125;&#125;&lt;/a &gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;el-form-item class=&quot;input-prepend&quot; prop=&quot;password&quot; :rules=&quot;[&#123; required: true, message: &#x27;è¯·è¾“å…¥å¯†ç &#x27;, trigger: &#x27;blur&#x27; &#125;]&quot; &gt; &lt;div&gt; &lt;el-input type=&quot;password&quot; placeholder=&quot;è®¾ç½®å¯†ç &quot; v-model=&quot;params.password&quot; /&gt; &lt;i class=&quot;iconfont icon-password&quot; /&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;div class=&quot;btn&quot;&gt; &lt;input type=&quot;button&quot; class=&quot;sign-up-button&quot; value=&quot;æ³¨å†Œ&quot; @click=&quot;submitRegister()&quot; /&gt; &lt;/div&gt; &lt;p class=&quot;sign-up-msg&quot;&gt; ç‚¹å‡» â€œæ³¨å†Œâ€ å³è¡¨ç¤ºæ‚¨åŒæ„å¹¶æ„¿æ„éµå®ˆç®€ä¹¦ &lt;br /&gt; &lt;a target=&quot;_blank&quot; href=&quot;http://www.jianshu.com/p/c44d171298ce&quot; &gt;ç”¨æˆ·åè®®&lt;/a &gt; å’Œ &lt;a target=&quot;_blank&quot; href=&quot;http://www.jianshu.com/p/2ov8x3&quot;&gt;éšç§æ”¿ç­–&lt;/a&gt; ã€‚ &lt;/p&gt; &lt;/el-form&gt; &lt;!-- æ›´å¤šæ³¨å†Œæ–¹å¼ --&gt; &lt;div class=&quot;more-sign&quot;&gt; &lt;h6&gt;ç¤¾äº¤å¸å·ç›´æ¥æ³¨å†Œ&lt;/h6&gt; &lt;ul&gt; &lt;li&gt; &lt;a id=&quot;weixin&quot; class=&quot;weixin&quot; target=&quot;_blank&quot; href=&quot;http://huaan.free.idcfengye.com/api/ucenter/wx/login&quot; &gt;&lt;i class=&quot;iconfont icon-weixin&quot; /&gt;&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a id=&quot;qq&quot; class=&quot;qq&quot; target=&quot;_blank&quot; href=&quot;#&quot; &gt;&lt;i class=&quot;iconfont icon-qq&quot; /&gt;&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import &#x27;~/assets/css/sign.css&#x27; import &#x27;~/assets/css/iconfont.css&#x27; export default &#123; layout: &#x27;sign&#x27;, data() &#123; return &#123; params: &#123; // å°è£…æ³¨å†Œè¾“å…¥æ•°æ® mobile: &#x27;&#x27;, code: &#x27;&#x27;, // éªŒè¯ç  nickname: &#x27;&#x27;, password: &#x27;&#x27; &#125;, sending: true, // æ˜¯å¦å‘é€éªŒè¯ç  second: 60, // å€’è®¡æ—¶é—´ codeTest: &#x27;è·å–éªŒè¯ç &#x27; &#125; &#125;, methods: &#123;&#125; &#125;&lt;/script&gt; vueæ–¹æ³•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// æ³¨å†Œæäº¤submitRegister() &#123; registerApi.register(this.params).then(result =&gt; &#123; // æç¤ºæ³¨å†ŒæˆåŠŸ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ³¨å†ŒæˆåŠŸ&#x27; &#125;) // è·³è½¬ç™»å½•é¡µé¢ this.$router.push(&#123; path: &#x27;/login&#x27; &#125;) &#125;)&#125;,// å‘é€éªŒè¯ç getCodeFun() &#123; if ((this.sending = false)) &#123; this.$message(&#123; type: &#x27;error&#x27;, message: &#x27;è¯·å‹¿é¢‘ç¹ç‚¹å‡»&#x27; &#125;) return &#125; // ç”±äºé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ä¸èƒ½ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œå†™å‡éªŒè¯ this.sending = false // è°ƒç”¨å€’è®¡æ—¶çš„æ–¹æ³• this.timeDown()&#125;,// éªŒè¯æ‰‹æœºå·æ ¼å¼checkPhone(rule, value, callback) &#123; // debugger if (!/^1[34578]\\d&#123;9&#125;$/.test(value)) &#123; return callback(new Error(&#x27;æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®&#x27;)) &#125; return callback()&#125;,// å€’è®¡æ—¶timeDown() &#123; const result = setInterval(() =&gt; &#123; --this.second this.codeTest = this.second if (this.second &lt; 1) &#123; clearInterval(result) this.sending = true this.second = 60 this.codeTest = &#x27;è·å–éªŒè¯ç &#x27; &#125; &#125;, 1000)&#125; TODOï¼šè¿™é‡Œæœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦å®Œå–„ï¼šæ¯”å¦‚ç‚¹å‡»éªŒè¯ç ä¹‹åå†æ¬¡ç‚¹å‡»æ•°å­—éœ€è¦å¼¹çª—è­¦å‘Šï¼Œä½†æ˜¯ç°åœ¨ä¸ä¼šè€Œä¸”è¿˜ä¼šåŠ é€Ÿè®¡æ—¶å™¨ ç™»å½•cookieæ’ä»¶ è¿™é‡Œéœ€è¦ç”¨åˆ°cookieï¼Œéœ€è¦ä¸‹è½½ npm install js-cookie api12345678910111213141516171819import request from &#x27;@/utils/request&#x27;export default &#123; // ç™»å½• login(member) &#123; return request(&#123; url: &#x27;/educenter/member/login&#x27;, method: &#x27;post&#x27;, data: member &#125;) &#125;, // æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯ getLoginMemberInfo() &#123; return request(&#123; url: &#x27;/educenter/member/getMemberInfo&#x27;, method: &#x27;get&#x27; &#125;) &#125;&#125; vueè§†å›¾1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192&lt;template&gt; &lt;div class=&quot;main&quot;&gt; &lt;div class=&quot;title&quot;&gt; &lt;a class=&quot;active&quot; href=&quot;/login&quot;&gt;ç™»å½•&lt;/a&gt; &lt;span&gt;Â·&lt;/span&gt; &lt;a href=&quot;/register&quot;&gt;æ³¨å†Œ&lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;sign-up-container&quot;&gt; &lt;el-form ref=&quot;userForm&quot; :model=&quot;user&quot;&gt; &lt;el-form-item class=&quot;input-prepend restyle&quot; prop=&quot;mobile&quot; :rules=&quot;[ &#123; required: true, message: &#x27;è¯·è¾“å…¥æ‰‹æœºå·ç &#x27;, trigger: &#x27;blur&#x27; &#125;, &#123; validator: checkPhone, trigger: &#x27;blur&#x27; &#125;, ]&quot; &gt; &lt;div&gt; &lt;el-input type=&quot;text&quot; placeholder=&quot;æ‰‹æœºå·&quot; v-model=&quot;user.mobile&quot; /&gt; &lt;i class=&quot;iconfont icon-phone&quot; /&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;el-form-item class=&quot;input-prepend&quot; prop=&quot;password&quot; :rules=&quot;[&#123; required: true, message: &#x27;è¯·è¾“å…¥å¯†ç &#x27;, trigger: &#x27;blur&#x27; &#125;]&quot; &gt; &lt;div&gt; &lt;el-input type=&quot;password&quot; placeholder=&quot;å¯†ç &quot; v-model=&quot;user.password&quot; /&gt; &lt;i class=&quot;iconfont icon-password&quot; /&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;div class=&quot;btn&quot;&gt; &lt;input type=&quot;button&quot; class=&quot;sign-in-button&quot; value=&quot;ç™»å½•&quot; @click=&quot;submitLogin()&quot; /&gt; &lt;/div&gt; &lt;/el-form&gt; &lt;!-- æ›´å¤šç™»å½•æ–¹å¼ --&gt; &lt;div class=&quot;more-sign&quot;&gt; &lt;h6&gt;ç¤¾äº¤å¸å·ç™»å½•&lt;/h6&gt; &lt;ul&gt; &lt;li&gt; &lt;a id=&quot;weixin&quot; class=&quot;weixin&quot; target=&quot;_blank&quot; href=&quot;http://qy.free.idcfengye.com/api/ucenter/weixinLogin/login&quot; &gt;&lt;i class=&quot;iconfont icon-weixin&quot; /&gt;&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a id=&quot;qq&quot; class=&quot;qq&quot; target=&quot;_blank&quot; href=&quot;#&quot; &gt;&lt;i class=&quot;iconfont icon-qq&quot; /&gt;&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import &#x27;~/assets/css/sign.css&#x27; import &#x27;~/assets/css/iconfont.css&#x27; export default &#123; layout: &#x27;sign&#x27;, data() &#123; return &#123; user: &#123; mobile: &#x27;&#x27;, password: &#x27;&#x27; &#125;, loginInfo: &#123;&#125; &#125; &#125;, methods: &#123;&#125; &#125;&lt;/script&gt;&lt;style&gt; .el-form-item__error &#123; z-index: 9999999; &#125;&lt;/style&gt; æ‹¦æˆªå™¨ åœ¨ä¸‹é¢çš„æ–¹æ³•ä¸­æœ‰è¯´æ˜ç™»å½•tokençš„æ­¥éª¤ï¼Œå…¶ä¸­éœ€è¦ç”¨åˆ°æ‹¦æˆªå™¨ æ‹¦æˆªå™¨å†™åœ¨utilsæ–‡ä»¶å¤¹ä¸‹çš„request.jsæ–‡ä»¶ä¸­ 123456789101112131415import cookie from &#x27;js-cookie&#x27;// æ¯æ¬¡è¯·æ±‚ä¸­ä½¿ç”¨æ‹¦æˆªå™¨service.interceptors.request.use( config =&gt; &#123; if (cookie.get(&#x27;guli_token&#x27;)) &#123; // ä»cookieä¸­è·å¾—tokenå¹¶ä¸”æ”¾å…¥headerä¸­ config.headers[&#x27;token&#x27;] = cookie.get(&#x27;guli_token&#x27;); &#125; return config &#125;, err =&gt; &#123; return Promise.reject(err) &#125;) vueæ–¹æ³• è°ƒç”¨æ¥å£ç™»å½•è·å–token å°†tokenæ”¾å…¥cookie å‰ç«¯æ‹¦æˆªå™¨ï¼šåˆ¤æ–­cookieé‡Œæ˜¯å¦æœ‰tokenï¼Œå¦‚æœæœ‰åˆ™æ”¾åˆ°headerä¸­ æ ¹æ®headerä¸­çš„tokenè°ƒç”¨æ¥å£è·å–ç”¨æˆ·ä¿¡æ¯ æŠŠè·å–çš„ç”¨æˆ·ä¿¡æ¯æ”¾å…¥cookie login.vueä¸­ æ³¨æ„è¿™é‡ŒæŠŠå¯¹è±¡æ”¾å…¥cookieä¸­æ˜¯è¦ä½¿ç”¨JSON.stringifyè½¬æ¢ä¸ºå­—ç¬¦ä¸²æ‰è¡Œï¼Œè¦ä¸ç„¶å°±æ˜¯objectï¼Œå›æŠ¥é”™ï¼ˆcookieè·å¾—çš„jsonå¯¹è±¡ä¸ºundefinedï¼‰ 12345678910111213141516171819202122232425262728// ç™»å½•çš„æ–¹æ³•submitLogin() &#123; // 1ã€è°ƒç”¨æ¥å£è¿›è¡Œç™»å½•ï¼Œè¿”å›tokenå­—ç¬¦ä¸² loginApi.login(this.user).then(result =&gt; &#123; // 2ã€è·å¾—token,å¹¶æ”¾å…¥cookie // ç¬¬ä¸€ä¸ªå‚æ•°cookieåç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä½œç”¨èŒƒå›´ cookieApi.set(&#x27;guli_token&#x27;, result.data.data.token, &#123; domain: &#x27;localhost&#x27; &#125;) // 4ã€è°ƒç”¨æ¥å£è·å–headerä¸­çš„token loginApi.getLoginMemberInfo().then(result =&gt; &#123; // 5ã€æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯æ”¾å…¥cookieä¸­ console.log(response.data.data.member) cookieApi.set(&#x27;guli_ucenter&#x27;, JSON.stringify(result.data.data.member), &#123; domain: &#x27;localhost&#x27; &#125;) &#125;) // è·³è½¬é¡µé¢ this.$router.push(&#123; path: &#x27;/&#x27; &#125;) &#125;)&#125;,// éªŒè¯æ‰‹æœºå·æ ¼å¼checkPhone(rule, value, callback) &#123; if (!/^1[34578]\\d&#123;9&#125;$/.test(value)) &#123; return callback(new Error(&#x27;æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®&#x27;)) &#125; return callback()&#125; default.vueä¸­ç¼–å†™æ ¹æ®tokenè·å¾—ç”¨æˆ·ä¿¡æ¯ 123456789101112131415161718192021222324252627created() &#123; this.showInfo() &#125;, methods: &#123; // ä»cookieä¸­è·å–ç”¨æˆ·ä¿¡æ¯ showInfo() &#123; // æ³¨æ„è¿™é‡Œéœ€è¦è½¬æ¢ console.log(&#x27;ä»cookieä¸­è·å¾—ç”¨æˆ·ä¿¡æ¯ï¼š&#x27; + cookieApi.get(&#x27;guli_ucenter&#x27;)) var loginInfoStr = cookieApi.get(&#x27;guli_ucenter&#x27;) console.log(cookieApi.get(&#x27;guli_ucenter&#x27;)) // æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºJSONæ ¼å¼ if (loginInfoStr) &#123; this.loginInfo = JSON.parse(loginInfoStr) &#125; &#125;, // é€€å‡ºç™»å½• logout() &#123; // æ¸…é™¤cookie cookieApi.set(&#x27;guli_token&#x27;, &#x27;&#x27;, &#123; domain: &#x27;localhost&#x27; &#125;) cookieApi.set(&#x27;guli_ucenter&#x27;, &#x27;&#x27;, &#123; domain: &#x27;localhost&#x27; &#125;) // æ¸…é™¤æ•°æ® this.token = &#x27;&#x27; this.loginInfo = &#123;&#125; // è·³è½¬è‡³é¦–é¡µ this.$router.push(&#123; path: &#x27;/&#x27; &#125;) &#125; &#125; TODOï¼šè¿™é‡Œéœ€è¦å®Œå–„çš„åœ°æ–¹æœ‰å¾ˆå¤šï¼Œç™»å½•æ ¡éªŒï¼ˆJWT strings must contain exactly 2 period characters. Found: 0ï¼‰å¦‚æœè¾“å…¥é”™è¯¯é¡µé¢ç«Ÿç„¶æ˜¾ç¤ºcookie undefinedï¼Œè€Œä¸”é‡æ–°ç™»å½•ä¹Ÿä¸è¡Œï¼Œè¿˜æœ‰å‰ç«¯çš„ä¿¡æ¯æç¤º å¾®ä¿¡æ‰«ç ç™»å½•ï¼ˆåç«¯+å‰ç«¯ï¼‰OAuth2 ä¸€ç§æ–¹æ¡ˆï¼Œè§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š å¼€æ”¾ç³»ç»Ÿé—´æˆæƒ åˆ†å¸ƒå¼è®¿é—®é—®é¢˜ ![03 OAuth2ä»‹ç»](https://gitee.com/ReRia/images/raw/master/img/03 OAuth2ä»‹ç».png) å¾®ä¿¡ç™»å½•å‡†å¤‡å·¥ä½œ æ²¡äº‹äº†è¦ä»˜é’±ï¼Œé¹…è‚ çœŸæœ‰ä½ çš„ æ²¡äº‹äº†è€å¸ˆå…±äº«è´¦å·ï¼Œå¥½è€¶ï¼ é…ç½®æ–‡ä»¶ service_ucenteræ¨¡å—çš„é…ç½®æ–‡ä»¶å³å¯ï¼ˆåªç”¨äºç™»å½•æ³¨å†Œï¼‰ 123456# å¾®ä¿¡å¼€æ”¾å¹³å° appidwx.open.app_id=wxed9954c01bb89b47# å¾®ä¿¡å¼€æ”¾å¹³å° appsecretwx.open.app_secret=a7482517235173ddb4083788de60b90e# å¾®ä¿¡å¼€æ”¾å¹³å° é‡å®šå‘urlwx.open.redirect_url=http://localhost:8160/api/ucenter/wx/callback å¸¸é‡ç±»12345678910111213141516171819202122package com.atguigu.educenter.utils;import org.springframework.beans.factory.InitializingBean;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Component;@Componentpublic class ConstantWxUtils implements InitializingBean &#123; @Value(&quot;$&#123;wx.open.app_id&#125;&quot;) private String appId; @Value(&quot;$&#123;wx.open.app_secret&#125;&quot;) private String appSecret; @Value(&quot;$&#123;wx.open.redirect_url&#125;&quot;) private String redirectUrl; public static String WX_OPEN_APP_ID; public static String WX_OPEN_APP_SECRET; public static String WX_OPEN_REDIRECT_URL; @Override public void afterPropertiesSet() throws Exception &#123; WX_OPEN_APP_ID = appId; WX_OPEN_APP_SECRET = appSecret; WX_OPEN_REDIRECT_URL = redirectUrl; &#125;&#125; ç”ŸæˆäºŒç»´ç controller1234567891011121314151617181920212223@Controller@CrossOrigin@RequestMapping(&quot;/api/ucenter/wx&quot;)public class WxApiController &#123; // ç”Ÿæˆæ‰«æäºŒç»´ç  @GetMapping(&quot;login&quot;) public String getWxCode() throws UnsupportedEncodingException &#123; // å‚æ•°ä½ç½®éƒ½æ˜¯ç”¨%sæ¥ä»£æ›¿ï¼Œç„¶åä½¿ç”¨String.format String baseUrl = &quot;https://open.weixin.qq.com/connect/qrconnect&quot; + &quot;?appid=%s&quot; + &quot;&amp;redirect_uri=%s&quot; + &quot;&amp;response_type=code&quot; + &quot;&amp;scope=snsapi_login&quot; + &quot;&amp;state=%s&quot; + &quot;#wechat_redirect&quot;; // éœ€è¦è¿›è¡Œurlç¼–ç  String redirectUrl = URLEncoder.encode(ConstantWxUtils.WX_OPEN_REDIRECT_URL, &quot;UTF-8&quot;); // ä¼ å…¥urlä¸­çš„å‚æ•°è·å¾—æœ€ç»ˆçš„url String url = String.format(baseUrl, ConstantWxUtils.WX_OPEN_APP_ID, redirectUrl, &quot;atguigu&quot;); // é‡å®šå‘åˆ°å¾®ä¿¡åœ°å€ return &quot;redirect:&quot; + url; &#125;&#125; æ³¨æ„è¿™é‡Œéœ€è¦ä¿®æ”¹ç«¯å£å·ï¼Œå› ä¸ºç”¨çš„æ˜¯è€å¸ˆçš„urlï¼Œæ‰€ä»¥è¦å¯¹åº”ï¼Œnginxé‡Œä¹Ÿè¦æ”¹ è¿™é‡Œæˆ‘æ˜ç™½äº†ä¸€ç‚¹nginxçš„ä½œç”¨ï¼Œå‰ç«¯åªéœ€è¦è®¿é—®nginxæä¾›çš„9001ç«¯å£å·ï¼Œè€Œ9001èƒ½å¤Ÿè½¬å‘åˆ°8001ç­‰å…¶ä»–ç«¯å£å·ï¼Œæ‰€ä»¥åç«¯ç«¯å£å·æ”¹äº†åªè¦è¯¥nginxå°±è¡Œï¼Œç¥å¥‡ï¼ è·å–æ‰«æäººä¿¡æ¯ä¾èµ–1234567891011121314151617 &lt;dependencies&gt; &lt;!--httpclient--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--commons-io--&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--gson--&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; HttpClientUtils å¤ªé•¿ä¸å¤åˆ¶äº† controller123456789101112131415161718192021222324252627282930313233343536373839404142434445464748@Autowiredprivate UcenterMemberService memberService;// è·å–æ‰«æäººçš„ä¿¡æ¯ï¼Œæ·»åŠ æ•°æ®@GetMapping(&quot;callback&quot;)public String callback(String code, String status) throws Exception &#123; // 1ã€è·å–codeï¼Œç±»ä¼¼äºéªŒè¯ç  // 2ã€è¯·æ±‚å¾®ä¿¡apiå¾—åˆ°access_tokenå’Œopenid String baseAccessTokenUrl = &quot;https://api.weixin.qq.com/sns/oauth2/access_token&quot; + &quot;?appid=%s&quot; + &quot;&amp;secret=%s&quot; + &quot;&amp;code=%s&quot; + &quot;&amp;grant_type=authorization_code&quot;; // æ‹¼æ¥å‚æ•°ï¼Œå‘é€è¯·æ±‚ String accessTokenUrl = String.format(baseAccessTokenUrl, ConstantWxUtils.WX_OPEN_APP_ID, ConstantWxUtils.WX_OPEN_APP_SECRET, code); String accessTokenInfo = HttpClientUtils.get(accessTokenUrl); // è½¬æ¢json-&gt;mapé›†åˆ,è·å–å…¶ä¸­çš„ä¸¤ä¸ªå‚æ•°,ä½¿ç”¨jsonè½¬æ¢å·¥å…· Gson Gson gson = new Gson(); HashMap accessTokenMap = gson.fromJson(accessTokenInfo, HashMap.class); String access_token = (String) accessTokenMap.get(&quot;access_token&quot;); String openid = (String) accessTokenMap.get(&quot;openid&quot;); // æŠŠæ‰«æäººä¿¡æ¯æ·»åŠ æ•°æ®åº“é‡Œé¢ // åˆ¤æ–­æ•°æ®è¡¨é‡Œé¢æ˜¯å¦å­˜åœ¨ç›¸åŒå¾®ä¿¡ä¿¡æ¯ï¼Œæ ¹æ®openidåˆ¤æ–­ UcenterMember member = memberService.getOpenIdMember(openid); if (member == null) &#123; // 3ã€æ‹¿ç€å¾—åˆ°accsess_token å’Œ openidï¼Œå†å»è¯·æ±‚å¾®ä¿¡æä¾›å›ºå®šçš„åœ°å€ï¼Œè·å–åˆ°æ‰«æäººä¿¡æ¯ // è®¿é—®å¾®ä¿¡çš„èµ„æºæœåŠ¡å™¨ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ String baseUserInfoUrl = &quot;https://api.weixin.qq.com/sns/userinfo&quot; + &quot;?access_token=%s&quot; + &quot;&amp;openid=%s&quot;; // æ‹¼æ¥å‚æ•°ï¼Œå‘é€è¯·æ±‚ String userInfoUrl = String.format(baseUserInfoUrl, access_token, openid); String userInfo = HttpClientUtils.get(userInfoUrl); //è½¬æ¢å¹¶è·å–è¿”å›userinfoå­—ç¬¦ä¸²æ‰«æäººä¿¡æ¯ HashMap userInfoMap = gson.fromJson(userInfo, HashMap.class); String nickname = (String) userInfoMap.get(&quot;nickname&quot;);//æ˜µç§° String headimgurl = (String) userInfoMap.get(&quot;headimgurl&quot;);//å¤´åƒ // åˆ›å»ºæ‰«æmemberå¯¹è±¡ member = new UcenterMember(); member.setOpenid(openid); member.setNickname(nickname); member.setAvatar(headimgurl); memberService.save(member); &#125; // 4ã€ä½¿ç”¨jwtæ ¹æ®memberå¯¹è±¡ç”Ÿæˆtokenå­—ç¬¦ä¸² String jwtToken = JwtUtils.getJwtToken(member.getId(), member.getNickname()); // 5ã€æœ€åï¼šè¿”å›é¦–é¡µé¢ï¼Œé€šè¿‡è·¯å¾„ä¼ é€’tokenå­—ç¬¦ä¸² return &quot;redirect:http://localhost:3000?token=&quot; + jwtToken;&#125; service12345678// æ ¹æ®openidæŸ¥è¯¢@Overridepublic UcenterMember getOpenIdMember(String openid) &#123; QueryWrapper&lt;UcenterMember&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;openid&quot;, openid); UcenterMember member = baseMapper.selectOne(wrapper); return member;&#125; å‰ç«¯ å–åœ°å€æ ä¸­çš„å¸¦åç§°çš„å‚æ•°å€¼ï¼ˆè€Œä¸æ˜¯xx/xx/xxè¿™ç§ä½¿ç”¨this.$route.params.xxï¼‰ä½¿ç”¨this.$route.query.xxx 1234567891011121314151617181920212223242526272829303132created() &#123; // è·å–urlä¸­çš„token this.token = this.$route.query.token if (this.token) &#123; this.wxLogin() &#125; this.showInfo()&#125;,methods: &#123; // å¾®ä¿¡ç™»å½•åæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ wxLogin() &#123; // æŠŠtokenæ”¾å…¥cookie cookieApi.set(&#x27;guli_token&#x27;, this.token, &#123; domain: &#x27;localhost&#x27; &#125;) // è°ƒç”¨æ¥å£è·å–headerä¸­çš„token loginApi.getLoginMemberInfo().then(result =&gt; &#123; // 5ã€æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯æ”¾å…¥cookieä¸­ cookieApi.set(&#x27;guli_ucenter&#x27;, JSON.stringify(result.data.data.member), &#123; domain: &#x27;localhost&#x27; &#125;) &#125;) // è·³è½¬é¡µé¢ this.$router.push(&#123; path: &#x27;/&#x27; &#125;) &#125;, // ä»cookieä¸­è·å–ç”¨æˆ·ä¿¡æ¯ showInfo() &#123; var loginInfoStr = cookieApi.get(&#x27;guli_ucenter&#x27;) // æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºJSONæ ¼å¼ if (loginInfoStr) &#123; this.loginInfo = JSON.parse(loginInfoStr) &#125; &#125;&#125; æ³¨æ„æŠŠè¿›å…¥å¾®ä¿¡æ‰«ç çš„hrefæ”¹ä¸ºhttp://localhost:8160/api/ucenter/wx/loginå³å¯","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜4","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜4","date":"2021-09-25T05:55:19.301Z","updated":"2021-10-05T07:31:31.097Z","comments":true,"path":"2021/09/25/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-4/","link":"","permalink":"http://example.com/2021/09/25/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-4/","excerpt":"","text":"å¤šè¡¨è¿æ¥æŸ¥è¯¢ æ–¹å¼å¦‚ä¸‹ å†…è¿æ¥ å·¦å¤–è¿æ¥ å³å¤–è¿æ¥ è¯¾ç¨‹å…¨éƒ¨ä¿¡æ¯æŸ¥è¯¢ï¼ˆåç«¯ï¼‰åˆ›å»ºå€¼å°è£…å¯¹è±¡ç±»1234567891011@Datapublic class CoursePublishVo &#123; private String id; private String title; private String cover; private Integer lessonNum; private String subjectLevelOne; private String subjectLevelTwo; private String teacherName; private String price;//åªç”¨äºæ˜¾ç¤º&#125; ç¼–å†™å¯¹åº”mapperæ¥å£123public interface EduCourseMapper extends BaseMapper&lt;EduCourse&gt; &#123; CoursePublishVo getCoursePublishInfo(String courseId);&#125; ç¼–å†™å¯¹åº”mapperä¸­sqlè¯­å¥ å…ˆæŸ¥è¯¢å®Œäº†ä¹‹åå†è´´ä¸Šæ¥ï¼Œå‡ºé”™ç‡å¾ˆé«˜ 1234567891011121314151617181920&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.atguigu.eduservice.mapper.EduCourseMapper&quot;&gt; &lt;select id=&quot;getCoursePublishInfo&quot; resultType=&quot;com.atguigu.eduservice.entity.vo.CoursePublishVo&quot;&gt; select ec.id, ec.title, ec.price, ec.lesson_num AS lessonNum, ec.cover, et.name AS teacherName, es1.title AS subjectLevelOne, es2.title AS subjectLevelTwo from edu_course ec left join edu_course_description ecd on ec.id = ecd.id left join edu_teacher et on ec.teacher_id = et.id left join edu_subject es1 on ec.subject_parent_id = es1.id left join edu_subject es2 on ec.subject_id = es2.id where ec.id = #&#123;courseId&#125; &lt;/select&gt;&lt;/mapper&gt; ç¼–å†™controller123456// æ ¹æ®idæŸ¥è¯¢è¯¾ç¨‹å…¨éƒ¨ä¿¡æ¯@PostMapping(&quot;getCoursePublishInfo/&#123;courseId&#125;&quot;)public R getCoursePublishInfo(@PathVariable String courseId) &#123; CoursePublishVo coursePublishInfo = courseService.getCoursePublishInfo(courseId); return R.ok().data(&quot;coursePublishInfo&quot;, coursePublishInfo);&#125; ç¼–å†™service åŒç†ï¼Œç›´æ¥å¿«æ·é”®å°±è¡Œ 12345// æ ¹æ®idæŸ¥è¯¢è¯¾ç¨‹å…¨éƒ¨ä¿¡æ¯@Overridepublic CoursePublishVo getCoursePublishInfo(String courseId) &#123; return baseMapper.getCoursePublishInfo(courseId);&#125; è°ƒè¯• Invalid bound statement (not found): com.atguigu.eduservice.mapper.EduCourseMapper.getCoursePublishInfo æŠ¥é”™å¦‚ä¸Šï¼Œè§£å†³å¦‚ä¸‹ï¼ˆè¯¦è§p130ï¼‰ mapperæœ‰æ²¡æœ‰å†™é”™ åœ¨targetæ–‡ä»¶å¤¹ä¸­xmlé…ç½®æ–‡ä»¶æœ‰æ²¡æœ‰è¢«å¼•å…¥ å¯ä»¥æŠŠmapper.xmlæ”¾åœ¨resourceä¸‹ é…ç½®pom.xmlå’Œapplication.propertiesï¼ˆå­æ¨¡å—çš„pom.xmlï¼‰ 1mybatis-plus.mapper-locations=classpath:com/atguigu/eduservice/mapper/xml/*.xml 123456789101112&lt;!-- è§£å†³mavenæ²¡æœ‰å¯¼å…¥xmlæ–‡ä»¶ --&gt;&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;false&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt;&lt;/build&gt; è¯¾ç¨‹å…¨éƒ¨ä¿¡æ¯æŸ¥è¯¢ï¼ˆå‰ç«¯ï¼‰api1234567// è¯¾ç¨‹å…¨éƒ¨ä¿¡æ¯ getCoursePublishInfo(courseId) &#123; return request(&#123; url: `/eduservice/course/getCoursePublishInfo/` + courseId, method: &#x27;get&#x27;, &#125;) &#125; vueæ¨¡æ¿å’Œæ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;h2 style=&quot;text-align: center&quot;&gt;å‘å¸ƒæ–°è¯¾ç¨‹&lt;/h2&gt; &lt;el-steps :active=&quot;3&quot; process-status=&quot;wait&quot; align-center style=&quot;margin-bottom: 40px&quot; &gt; &lt;el-step title=&quot;å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot; /&gt; &lt;el-step title=&quot;åˆ›å»ºè¯¾ç¨‹å¤§çº²&quot; /&gt; &lt;el-step title=&quot;æœ€ç»ˆå‘å¸ƒ&quot; /&gt; &lt;/el-steps&gt; &lt;div class=&quot;ccInfo&quot;&gt; &lt;img :src=&quot;coursePublishInfo.cover&quot; /&gt; &lt;div class=&quot;main&quot;&gt; &lt;h2&gt;&#123;&#123; coursePublishInfo.title &#125;&#125;&lt;/h2&gt; &lt;p class=&quot;gray&quot;&gt; &lt;span&gt;å…±&#123;&#123; coursePublishInfo.lessonNum &#125;&#125;è¯¾æ—¶&lt;/span&gt; &lt;/p&gt; &lt;p&gt; &lt;span &gt;æ‰€å±åˆ†ç±»ï¼š&#123;&#123; coursePublishInfo.subjectLevelOne &#125;&#125; â€” &#123;&#123; coursePublishInfo.subjectLevelTwo &#125;&#125;&lt;/span &gt; &lt;/p&gt; &lt;p&gt;è¯¾ç¨‹è®²å¸ˆï¼š&#123;&#123; coursePublishInfo.teacherName &#125;&#125;&lt;/p&gt; &lt;h3 class=&quot;red&quot;&gt;ï¿¥&#123;&#123; coursePublishInfo.price &#125;&#125;&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt; &lt;div&gt; &lt;el-button @click=&quot;previous&quot;&gt;è¿”å›ä¿®æ”¹&lt;/el-button&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;publish&quot; &gt;å‘å¸ƒè¯¾ç¨‹&lt;/el-button &gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import courseApi from &#x27;@/api/edu/course.js&#x27; export default &#123; data() &#123; return &#123; saveBtnDisabled: false, // ä¿å­˜æŒ‰é’®æ˜¯å¦ç¦ç”¨ courseId: &#x27;&#x27;, // è¯¾ç¨‹id coursePublishInfo: &#123;&#125; &#125; &#125;, created() &#123; // è·å–åˆ°è·¯ç”±ä¸­çš„idå€¼ if (this.$route.params &amp;&amp; this.$route.params.id) &#123; this.courseId = this.$route.params.id this.getCoursePublishInfo(this.courseId) &#125; console.log(this.coursePublishInfo) &#125;, methods: &#123; getCoursePublishInfo(id) &#123; // è°ƒç”¨api courseApi.getCoursePublishInfo(id).then(result =&gt; &#123; console.log this.coursePublishInfo = result.data.coursePublishInfo &#125;) &#125;, previous() &#123; console.log(&#x27;previous&#x27;) this.$router.push(&#123; path: &#x27;/course/chapter/&#x27; + this.courseId &#125;) &#125;, publish() &#123; console.log(&#x27;publish&#x27;) this.$router.push(&#123; path: &#x27;/course/list&#x27; &#125;) &#125; &#125; &#125;&lt;/script&gt; è¯¾ç¨‹å‘å¸ƒï¼ˆåç«¯+å‰ç«¯ï¼‰åç«¯ å‘å¸ƒå°±æ˜¯ä¿®æ”¹è¡¨ä¸­ä¸€ä¸ªå­—æ®µå€¼å°±è¡Œ 12345678// å‘å¸ƒè¯¾ç¨‹ï¼ˆä¿®æ”¹statuså­—æ®µå€¼ï¼‰@PostMapping(&quot;publishCourse/&#123;courseId&#125;&quot;)public R publishCourse(@PathVariable String courseId) &#123; EduCourse eduCourse = courseService.getById(courseId); eduCourse.setStatus(&quot;Normal&quot;); courseService.updateById(eduCourse); return R.ok();&#125; å‰ç«¯ api 1234567 // å‘å¸ƒè¯¾ç¨‹publishCourse(courseId) &#123; return request(&#123; url: `/eduservice/course/publishCourse/` + courseId, method: &#x27;post&#x27;, &#125;)&#125; method 12345 publish() &#123; courseApi.publishCourse(this.courseId).then(result =&gt; &#123; this.$router.push(&#123; path: &#x27;/course/list&#x27; &#125;) &#125;)&#125; è¯¾ç¨‹åˆ—è¡¨ï¼ˆåç«¯+å‰ç«¯ï¼‰åç«¯ï¼ˆå¾…å®Œå–„ï¼‰123456// TODO å®Œå–„æ¡ä»¶æŸ¥è¯¢å¸¦åˆ†é¡µ@GetMapping(&quot;getCourseList&quot;)public R getCourseList() &#123; List&lt;EduCourse&gt; list = courseService.list(null); return R.ok().data(&quot;courseList&quot;, list);&#125; å‰ç«¯api1234567// è·å¾—è¯¾ç¨‹åˆ—è¡¨ getCourseList() &#123; return request(&#123; url: `/eduservice/course/getCourseList`, method: &#x27;get&#x27;, &#125;) &#125; vue123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; è¯¾ç¨‹åˆ—è¡¨ &lt;!--æŸ¥è¯¢è¡¨å•--&gt; &lt;el-form :inline=&quot;true&quot; class=&quot;demo-form-inline&quot;&gt; &lt;el-form-item&gt; &lt;el-input v-model=&quot;courseQuery.title&quot; placeholder=&quot;è¯¾ç¨‹åç§°&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-select v-model=&quot;courseQuery.status&quot; clearable placeholder=&quot;è¯¾ç¨‹çŠ¶æ€&quot; &gt; &lt;el-option value=&quot;Normal&quot; label=&quot;å·²å‘å¸ƒ&quot; /&gt; &lt;el-option value=&quot;Draft&quot; label=&quot;æœªå‘å¸ƒ&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;el-button type=&quot;primary&quot; icon=&quot;el-icon-search&quot; @click=&quot;getList()&quot; &gt;æŸ¥è¯¢&lt;/el-button &gt; &lt;el-button type=&quot;default&quot; @click=&quot;resetData()&quot;&gt;æ¸…ç©º&lt;/el-button&gt; &lt;/el-form&gt; &lt;!-- è¡¨æ ¼ --&gt; &lt;el-table :data=&quot;list&quot; border fit highlight-current-row&gt; &lt;el-table-column label=&quot;åºå·&quot; width=&quot;70&quot; align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; (page - 1) * limit + scope.$index + 1 &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column prop=&quot;title&quot; label=&quot;è¯¾ç¨‹åç§°&quot; width=&quot;80&quot; /&gt; &lt;el-table-column label=&quot;è¯¾ç¨‹çŠ¶æ€&quot; width=&quot;80&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; scope.row.status === &quot;Normal&quot; ? &quot;å·²å‘å¸ƒ&quot; : &quot;æœªå‘å¸ƒ&quot; &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column prop=&quot;lessonNum&quot; label=&quot;è¯¾æ—¶æ•°&quot; /&gt; &lt;el-table-column prop=&quot;gmtCreate&quot; label=&quot;æ·»åŠ æ—¶é—´&quot; width=&quot;160&quot; /&gt; &lt;el-table-column prop=&quot;viewCount&quot; label=&quot;æµè§ˆæ•°é‡&quot; width=&quot;60&quot; /&gt; &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;200&quot; align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;router-link :to=&quot;&#x27;/teacher/edit/&#x27; + scope.row.id&quot;&gt; &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; &gt;ç¼–è¾‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&lt;/el-button &gt; &lt;/router-link&gt; &lt;router-link :to=&quot;&#x27;/teacher/edit/&#x27; + scope.row.id&quot;&gt; &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; &gt;ç¼–è¾‘è¯¾ç¨‹å¤§çº²æ¯&lt;/el-button &gt; &lt;/router-link&gt; &lt;el-button type=&quot;danger&quot; size=&quot;mini&quot; icon=&quot;el-icon-delete&quot; @click=&quot;removeDataById(scope.row.id)&quot; &gt;åˆ é™¤è¯¾ç¨‹ä¿¡æ¯&lt;/el-button &gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;/el-table&gt; &lt;!-- åˆ†é¡µ --&gt; &lt;el-pagination :current-page=&quot;page&quot; :page-size=&quot;limit&quot; :total=&quot;total&quot; style=&quot;padding: 30px 0; text-align: center&quot; layout=&quot;total, prev, pager, next, jumper&quot; @current-change=&quot;getList&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨teacher.jsæ–‡ä»¶ import courseApi from &#x27;@/api/edu/course&#x27; export default &#123; data() &#123; return &#123; list: null, // æŸ¥è¯¢ä¹‹åæ¥å£è¿”å›é›†åˆ(æ³¨æ„è¿™é‡Œæ˜¯æ•°ç»„ç”¨null) page: 1, // å½“å‰é¡µ limit: 10, // æ¯é¡µè®°å½•æ•° total: 0, // æ€»è®°å½•æ•° courseQuery: &#123;&#125; // æ¡ä»¶å°è£…å¯¹è±¡ &#125; &#125;, created() &#123; // é¡µé¢æ¸²æŸ“ä¹‹å‰æ‰§è¡Œï¼Œä¸€èˆ¬è°ƒç”¨methodså®šä¹‰çš„æ–¹æ³• // è°ƒç”¨ this.getList() &#125;, methods: &#123; getList() &#123; courseApi.getCourseList().then(response =&gt; &#123; // è¯·æ±‚æˆåŠŸ // responseæ¥å£è¿”å›çš„æ•°æ® this.list = response.data.courseList &#125;) &#125;, resetData() &#123; // è¡¨å•è¾“å…¥é¡¹æ•°æ®æ¸…ç©º this.courseQuery = &#123;&#125; this.getList() &#125; &#125; &#125;&lt;/script&gt; è¯¾ç¨‹åˆ é™¤ï¼ˆåç«¯+å‰ç«¯ï¼‰ åˆ é™¤è¯¾ç¨‹ï¼šæ‰€æœ‰ç« èŠ‚ä¹Ÿä¼šè¢«åˆ é™¤ åç«¯controller123456// åˆ é™¤è¯¾ç¨‹@DeleteMapping(&quot;&#123;courseId&#125;&quot;)public R deleteCourse(@PathVariable String courseId) &#123; courseService.deleteCourse(courseId); return R.ok();&#125; service123456789101112131415// æ ¹æ®è¯¾ç¨‹idåˆ é™¤è¯¾ç¨‹åŠå…¶æè¿°å’Œç« èŠ‚@Overridepublic void deleteCourse(String courseId) &#123; // 1ã€åˆ é™¤å°èŠ‚ videoService.removeByCourseId(courseId); // 2ã€åˆ é™¤ç« èŠ‚ chapterService.removeByCourseId(courseId); // 3ã€åˆ é™¤æè¿° descriptionService.removeById(courseId); // 4ã€åˆ é™¤è¯¾ç¨‹ int row = baseMapper.deleteById(courseId); if (row == 0) &#123; throw new GuliException(20001, &quot;åˆ é™¤è¯¾ç¨‹å¤±è´¥&quot;); &#125;&#125; 1234567// æ ¹æ®è¯¾ç¨‹idåˆ é™¤ç« èŠ‚@Overridepublic void removeByCourseId(String courseId) &#123; QueryWrapper&lt;EduChapter&gt; queryWrapper = new QueryWrapper&lt;&gt;(); queryWrapper.eq(&quot;course_id&quot;, courseId); baseMapper.delete(queryWrapper);&#125; å‰ç«¯api1234567// åˆ é™¤è¯¾ç¨‹ deleteCourse(courseId) &#123; return request(&#123; url: `/eduservice/course/` + courseId, method: &#x27;delete&#x27;, &#125;) &#125;, vue123456789101112131415161718192021// åˆ é™¤è¯¾ç¨‹deleteCourse(courseId) &#123; courseApi .deleteCourse(courseId) .then(result =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;åˆ é™¤æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getList() &#125;) .catch(err =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;error&#x27;, message: &#x27;åˆ é™¤å¤±è´¥!&#x27; &#125;) &#125;)&#125; é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­ è§†é¢‘ç‚¹æ’­_éŸ³è§†é¢‘ç‚¹æ’­è§£å†³æ–¹æ¡ˆ_è§†é¢‘è½¬ç _åª’ä½“èµ„æºç®¡ç†ç³»ç»Ÿ-é˜¿é‡Œäº‘ (aliyun.com) è§†é¢‘ç‚¹æ’­ (aliyun.com) ç¯å¢ƒæ­å»º ä¾èµ–è§å®˜ç½‘ï¼ˆé¡¹ç›®ç¯å¢ƒæ­å»ºçš„æ—¶å€™å·²ç»å¼•å…¥äº†ï¼‰ åˆ›å»ºæ¨¡å— å­å­æ¨¡å—service_vod å¼•å…¥ä¾èµ– æ³¨æ„è¿™ä¸ªaliyun-java-vod-upload.versionä¾èµ–æœªå¼€æºï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½jaråŒ…ï¼Œç„¶åä½¿ç”¨å‘½ä»¤è¡Œå®‰è£… mvn install:install-file -DgroupId=com.aliyun -DartifactId=aliyun-java-vod-upload -Dversion=1.4.11 -Dpackaging=jar -Dfile=aliyun-java-vod-upload-1.4.14.jar æ³¨æ„è¿™é‡Œçš„ç‰ˆæœ¬è¦å’Œä¸‹è½½çš„jaråŒ…å¯¹åº”ï¼Œè¿˜æœ‰åŒ…åaliyun-java-vod-upload 123456789101112131415161718192021222324252627282930313233343536&lt;!-- é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æ‰€éœ€ä¾èµ– --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-sdk-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-sdk-vod&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-vod-upload&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.json&lt;/groupId&gt; &lt;artifactId&gt;json&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;joda-time&lt;/groupId&gt; &lt;artifactId&gt;joda-time&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; æµ‹è¯•æ ¹æ®è§†é¢‘idè·å–è§†é¢‘æ’­æ”¾åœ°å€123456789101112131415161718192021222324public class TestVod &#123; public static void main(String[] args) throws ClientException &#123; // 1ã€æ ¹æ®è§†é¢‘idè·å–è§†é¢‘æ’­æ”¾åœ°å€ // åˆ›å»ºåˆå§‹åŒ–å¯¹è±¡(ä¼ å…¥ossçš„idå’Œç§˜é’¥) DefaultAcsClient client = InitObject.initVodClient(&quot;&quot;, &quot;&quot;); // åˆ›å»ºè·å–è§†é¢‘åœ°å€çš„request GetPlayInfoRequest request = new GetPlayInfoRequest(); // å‘requestä¸­è®¾ç½®id request.setVideoId(&quot;&quot;); // è°ƒç”¨åˆå§‹åŒ–å¯¹è±¡çš„æ–¹æ³•ï¼Œä¼ é€’requestï¼Œè·å–response GetPlayInfoResponse acsResponse = client.getAcsResponse(request); // è·å–responseä¸­çš„ä¿¡æ¯ List&lt;GetPlayInfoResponse.PlayInfo&gt; playInfoList = acsResponse.getPlayInfoList(); //æ’­æ”¾åœ°å€ for (GetPlayInfoResponse.PlayInfo playInfo : playInfoList) &#123; System.out.print(&quot;PlayInfo.PlayURL = &quot; + playInfo.getPlayURL() + &quot;\\n&quot;); &#125; //Baseä¿¡æ¯ System.out.print(&quot;VideoBase.Title = &quot; + acsResponse.getVideoBase().getTitle() + &quot;\\n&quot;); System.out.println(acsResponse); &#125;&#125; æ ¹æ®è§†é¢‘idè·å–è§†é¢‘æ’­æ”¾å‡­è¯123456789101112public static void main(String[] args) throws ClientException &#123; // æ ¹æ®è§†é¢‘idè·å¾—è§†é¢‘å‡­è¯ // åˆ›å»ºåˆå§‹åŒ–å¯¹è±¡(ä¼ å…¥ossçš„idå’Œç§˜é’¥) DefaultAcsClient client = InitObject.initVodClient(&quot;&quot;, &quot;&quot;); // åˆ›å»ºè·å–è§†é¢‘åœ°å€çš„request GetVideoPlayAuthRequest request = new GetVideoPlayAuthRequest(); // å‘requestä¸­è®¾ç½®id request.setVideoId(&quot;&quot;); // è°ƒç”¨åˆå§‹åŒ–å¯¹è±¡çš„æ–¹æ³•ï¼Œä¼ é€’requestï¼Œè·å–response GetVideoPlayAuthResponse acsResponse = client.getAcsResponse(request); System.out.println(&quot;è§†é¢‘å‡­è¯: &quot; + acsResponse.getPlayAuth());&#125; ä¸Šä¼ è§†é¢‘ è¿™é‡Œæ³¨æ„ï¼Œå¦‚æœä½¿ç”¨uploadçš„ç‰ˆæœ¬ä¸º1.4.14ï¼Œé‚£ä¹ˆæ ¹æ®å®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼Œoss-sdkçš„ç‰ˆæœ¬å¿…é¡»ä¸º3.9åŠä»¥ä¸Šï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºä¸€ç›´ä¸Šä¼ ä¸­ 12345678910111213141516171819202122232425public static void main(String[] args) throws ClientException &#123; String accessKeyId = &quot;&quot;; String accessKeySecret = &quot;&quot;; String title = &quot;6 - What If I Want to Move Faster - upload by sdk&quot;; //ä¸Šä¼ ä¹‹åæ–‡ä»¶åç§° String fileName = &quot;D:/MyProject/6 - What If I Want to Move Faster.mp4&quot;; //æœ¬åœ°æ–‡ä»¶è·¯å¾„å’Œåç§° //ä¸Šä¼ è§†é¢‘çš„æ–¹æ³• UploadVideoRequest request = new UploadVideoRequest(accessKeyId, accessKeySecret, title, fileName); /* å¯æŒ‡å®šåˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ï¼Œé»˜è®¤ä¸º2Må­—èŠ‚ */ request.setPartSize(2 * 1024 * 1024L); /* å¯æŒ‡å®šåˆ†ç‰‡ä¸Šä¼ æ—¶çš„å¹¶å‘çº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º1ï¼Œ(æ³¨ï¼šè¯¥é…ç½®ä¼šå ç”¨æœåŠ¡å™¨CPUèµ„æºï¼Œéœ€æ ¹æ®æœåŠ¡å™¨æƒ…å†µæŒ‡å®šï¼‰*/ request.setTaskNum(1); UploadVideoImpl uploader = new UploadVideoImpl(); UploadVideoResponse response = uploader.uploadVideo(request); if (response.isSuccess()) &#123; System.out.print(&quot;VideoId=&quot; + response.getVideoId() + &quot;\\n&quot;); &#125; else &#123; /* å¦‚æœè®¾ç½®å›è°ƒURLæ— æ•ˆï¼Œä¸å½±å“è§†é¢‘ä¸Šä¼ ï¼Œå¯ä»¥è¿”å›VideoIdåŒæ—¶ä¼šè¿”å›é”™è¯¯ç ã€‚å…¶ä»–æƒ…å†µä¸Šä¼ å¤±è´¥æ—¶ï¼ŒVideoIdä¸ºç©ºï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®è¿”å›é”™è¯¯ç åˆ†æå…·ä½“é”™è¯¯åŸå›  */ System.out.print(&quot;VideoId=&quot; + response.getVideoId() + &quot;\\n&quot;); System.out.print(&quot;ErrorCode=&quot; + response.getCode() + &quot;\\n&quot;); System.out.print(&quot;ErrorMessage=&quot; + response.getMessage() + &quot;\\n&quot;); &#125;&#125; è¯¾ç¨‹å¢åŠ ã€åˆ é™¤å°èŠ‚ï¼ˆè§†é¢‘ï¼‰åŠŸèƒ½ï¼ˆå®Œå–„ï¼‰åç«¯é…ç½®æ–‡ä»¶application.properties1234567891011121314# æœåŠ¡ç«¯å£server.port=8003# æœåŠ¡åspring.application.name=service-vod# ç¯å¢ƒè®¾ç½®ï¼šdevã€testã€prodspring.profiles.active=dev#é˜¿é‡Œäº‘ vod#ä¸åŒçš„æœåŠ¡å™¨ï¼Œåœ°å€ä¸åŒaliyun.vod.file.keyid=aliyun.vod.file.keysecret=# æœ€å¤§ä¸Šä¼ å•ä¸ªæ–‡ä»¶å¤§å°ï¼šé»˜è®¤1Mspring.servlet.multipart.max-file-size=1024MB# æœ€å¤§ç½®æ€»ä¸Šä¼ çš„æ•°æ®å¤§å° ï¼šé»˜è®¤10Mspring.servlet.multipart.max-request-size=1024MB ç¼–å†™å¸¸é‡ç±»1234567891011121314151617181920// ç±»å­˜å‚¨é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ä»¥ä¾¿è°ƒç”¨@Componentpublic class ConstantVodUtils implements InitializingBean &#123; @Value(&quot;$&#123;aliyun.vod.file.keyid&#125;&quot;) private String keyid; @Value(&quot;$&#123;aliyun.vod.file.keysecret&#125;&quot;) private String keysecret; public static String ACCESS_KEY_SECRET; public static String ACCESS_KEY_ID; @Override public void afterPropertiesSet() throws Exception &#123; ACCESS_KEY_ID = keyid; ACCESS_KEY_SECRET = keysecret; &#125; &#125; ç¼–å†™åˆå§‹åŒ–VodClient1234567891011@Componentpublic class InitVodClient &#123; public static DefaultAcsClient initVodClient(String accessKeyId, String accessKeySecret) throws ClientException &#123; String regionId = &quot;cn-shanghai&quot;; // ç‚¹æ’­æœåŠ¡æ¥å…¥åŒºåŸŸ DefaultProfile profile = DefaultProfile.getProfile(regionId, accessKeyId, accessKeySecret); DefaultAcsClient client = new DefaultAcsClient(profile); return client; &#125;&#125; åˆ›å»ºå¯åŠ¨ç±»1234567@SpringBootApplication(exclude = DataSourceAutoConfiguration.class) // ä¸éœ€è¦å¼•å…¥æ•°æ®åº“çš„é…ç½®@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)public class VodApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(VodApplication.class, args); &#125;&#125; ç¼–å†™controller123456789101112131415161718192021@RestController@RequestMapping(&quot;/eduvod/video&quot;)@CrossOriginpublic class VodController &#123; @Autowired private VodService vodService; // ä¸Šä¼ è§†é¢‘è‡³é˜¿é‡Œäº‘ @PostMapping(&quot;uploadVideo&quot;) public R uploadVideo(MultipartFile file) &#123; String videoId = vodService.uploadVideo(file); return R.ok(); &#125; // æ ¹æ®idåˆ é™¤è§†é¢‘ @DeleteMapping(&quot;removeVideo/&#123;videoId&#125;&quot;) public R removeVideo(@PathVariable String videoId) &#123; vodService.removeVideo(videoId); return R.ok(); &#125;&#125; ç¼–å†™service1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950@Servicepublic class VodServiceImpl implements VodService &#123; // ä¸Šä¼ è§†é¢‘è‡³é˜¿é‡Œäº‘ @Override public String uploadVideo(MultipartFile file) &#123; try &#123; //fileNameï¼šä¸Šä¼ æ–‡ä»¶åŸå§‹åç§° String fileName = file.getOriginalFilename(); //titleï¼šä¸Šä¼ ä¹‹åæ˜¾ç¤ºåç§° String title = fileName.substring(0, fileName.lastIndexOf(&quot;.&quot;)); //inputStreamï¼šä¸Šä¼ æ–‡ä»¶è¾“å…¥æµ InputStream inputStream = file.getInputStream(); //accessKeyId, accessKeySecret UploadStreamRequest request = new UploadStreamRequest(ConstantVodUtils.ACCESS_KEY_ID, ConstantVodUtils.ACCESS_KEY_SECRET, title, fileName, inputStream); UploadVideoImpl uploader = new UploadVideoImpl(); UploadStreamResponse response = uploader.uploadStream(request); String videoId = null; if (response.isSuccess()) &#123; videoId = response.getVideoId(); &#125; else &#123; //å¦‚æœè®¾ç½®å›è°ƒURLæ— æ•ˆï¼Œä¸å½±å“è§†é¢‘ä¸Šä¼ ï¼Œå¯ä»¥è¿”å›VideoIdåŒæ—¶ä¼šè¿”å›é”™è¯¯ç ã€‚å…¶ä»–æƒ…å†µä¸Šä¼ å¤±è´¥æ—¶ï¼ŒVideoIdä¸ºç©ºï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®è¿”å›é”™è¯¯ç åˆ†æå…·ä½“é”™è¯¯åŸå›  System.out.print(&quot;VideoId=&quot; + response.getVideoId() + &quot;\\n&quot;); System.out.print(&quot;ErrorCode=&quot; + response.getCode() + &quot;\\n&quot;); System.out.print(&quot;ErrorMessage=&quot; + response.getMessage() + &quot;\\n&quot;); &#125; return videoId; &#125; catch (Exception e) &#123; e.printStackTrace(); return null; &#125; &#125; // æ ¹æ®idåˆ é™¤è§†é¢‘ @Override public void removeVideo(String videoId) &#123; try &#123; // åˆå§‹åŒ–å¯¹è±¡ DefaultAcsClient client = InitVodClient.initVodClient(ConstantVodUtils.ACCESS_KEY_ID, ConstantVodUtils.ACCESS_KEY_SECRET); // åˆ›å»ºåˆ é™¤videoçš„requestå¯¹è±¡,å¹¶è®¾ç½®id DeleteVideoRequest request = new DeleteVideoRequest(); request.setVideoIds(videoId); // è°ƒç”¨åˆå§‹åŒ–å¯¹è±¡æ–¹æ³• DeleteVideoResponse acsResponse = client.getAcsResponse(request); &#125; catch (Exception e) &#123; e.printStackTrace(); throw new GuliException(20001, &quot;åˆ é™¤è§†é¢‘å¤±è´¥&quot;); &#125; &#125;&#125; å‰ç«¯api1234567// åˆ é™¤å°èŠ‚è§†é¢‘ deleteVideoAli(videoId) &#123; return request(&#123; url: `/eduvod/video/removeVideo/` + videoId, method: &#x27;delete&#x27;, &#125;) &#125; vueæ¨¡æ¿12345678910111213141516171819&lt;el-upload :on-success=&quot;handleVodUploadSuccess&quot; :on-remove=&quot;handleVodRemove&quot; :before-remove=&quot;beforeVodRemove&quot; :on-exceed=&quot;handleUploadExceed&quot; :file-list=&quot;fileList&quot; :action=&quot;BASE_API+&#x27;/eduvod/video/uploadVideo&#x27;&quot; :limit=&quot;1&quot; class=&quot;upload-demo&quot;&gt;&lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;ä¸Šä¼ è§†é¢‘&lt;/el-button&gt;&lt;el-tooltip placement=&quot;right-end&quot;&gt; &lt;div slot=&quot;content&quot;&gt;æœ€å¤§æ”¯æŒ1Gï¼Œ&lt;br&gt; æ”¯æŒ3GPã€ASFã€AVIã€DATã€DVã€FLVã€F4Vã€&lt;br&gt; GIFã€M2Tã€M4Vã€MJ2ã€MJPEGã€MKVã€MOVã€MP4ã€&lt;br&gt; MPEã€MPGã€MPEGã€MTSã€OGGã€QTã€RMã€RMVBã€&lt;br&gt; SWFã€TSã€VOBã€WMVã€WEBM ç­‰è§†é¢‘æ ¼å¼ä¸Šä¼ &lt;/div&gt; &lt;i class=&quot;el-icon-question&quot;/&gt;&lt;/el-tooltip&gt;&lt;/el-upload&gt; è°ƒç”¨æ–¹æ³•1234567891011121314151617181920212223242526// åˆ é™¤ä¹‹å‰beforeVodRemove(file, fileList) &#123; return this.$confirm(`ç¡®å®šç§»é™¤$&#123;file.name&#125;?`)&#125;,// åˆ é™¤ä¸Šä¼ è§†é¢‘handleVodRemove() &#123; // è°ƒç”¨æ¥å£ videoApi.deleteVideoAli(this.video.videoSourceId).then(result =&gt; &#123; // æç¤º this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;åˆ é™¤æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°fileList å’Œ resourceId this.fileList = [] this.video.videoSourceId = &#x27;&#x27; &#125;)&#125;,// ä¸Šä¼ vodæˆåŠŸhandleVodUploadSuccess(response, file, fileList) &#123; this.video.videoSourceId = response.data.videoId&#125;,// é‡æ–°ä¸Šä¼ æç¤ºhandleUploadExceed() &#123; this.$message.warning(&#x27;æƒ³è¦é‡æ–°ä¸Šä¼ è§†é¢‘ï¼Œè¯·å…ˆåˆ é™¤å·²ä¸Šä¼ çš„è§†é¢‘&#x27;)&#125;, æµ‹è¯• æ³¨æ„è¿™é‡Œï¼Œè¦ä¿®æ”¹nginxçš„ä¸Šä¼ æ–‡ä»¶å¤§å° 12345http &#123; include mime.types; default_type application/octet-stream; client_max_body_size 1024m;&#125; ç”±äºcontrollerä¸­è¿”å›dataåªæœ‰videoIdï¼Œæ‰€ä»¥ä»åç«¯æ‹¿ä¸åˆ°åŸå§‹æ–‡ä»¶å—ï¼Œæ‰€ä»¥ä»å‰ç«¯èµ‹å€¼å³å¯ åˆ é™¤è§†é¢‘åè¦æ¸…ç©ºsourceIdï¼Œè¦ä¸ç„¶ä¸ä¸Šä¼ è§†é¢‘ä¹Ÿæœ‰idå­˜ç•™ springcloudå¾®æœåŠ¡ï¼ˆåˆ é™¤å°èŠ‚åŠŸèƒ½å®Œå–„ï¼‰springcloud æœåŠ¡é›†åˆï¼ŒTODO springcloudè°ƒç”¨æ¥å£è¿‡ç¨‹ NacosæœåŠ¡æ³¨å†Œ æ³¨å†Œä¸­å¿ƒ home (nacos.io) å¯åŠ¨ ä¸‹è½½å¹¶è§£å‹ï¼Œç„¶åå¯åŠ¨startup.cmdå³å¯ï¼Œå¯èƒ½ä¼šå¯åŠ¨å¤±è´¥ï¼Œéœ€è¦ä¿®æ”¹MODEä¸ºstandalone Nacos å¯åŠ¨å¤±è´¥_RookieMZL çš„åšå®¢-CSDNåšå®¢_nacoså¯åŠ¨å¤±è´¥ ä¾èµ– å…ˆå¼•å…¥ä¾èµ– 12345&lt;!--æœåŠ¡æ³¨å†Œ--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½® åœ¨è¦æ³¨å†Œçš„æœåŠ¡çš„é…ç½®æ–‡ä»¶application.propertiesä¸­é…ç½® 12# nacosæœåŠ¡åœ°å€spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848 æ³¨è§£ åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ 123456@EnableDiscoveryClient // nacosæ³¨å†Œpublic class EduApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(EduApplication.class, args); &#125;&#125; æµ‹è¯• è‡´å‘½bugï¼Œspringbootçš„ç‰ˆæœ¬è¦2.2.xæ‰è¡Œï¼Œè¦ä¸ç„¶applicationå¯åŠ¨ä¸èµ·æ¥ http://localhost:8848/nacos FeignæœåŠ¡è°ƒç”¨ å‰ææ¡ä»¶ï¼šå°†äº’ç›¸è°ƒç”¨çš„æœåŠ¡åœ¨nacosæ³¨å†Œå®Œæ¯• ä¾èµ–12345&lt;!--æœåŠ¡è°ƒç”¨--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ æ³¨è§£ åœ¨éœ€è¦è°ƒç”¨æœåŠ¡çš„å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£å¦‚ä¸‹ 123456789@SpringBootApplication@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)@EnableDiscoveryClient // nacosæ³¨å†Œ@EnableFeignClients // ä½¿ç”¨Feignpublic class EduApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(EduApplication.class, args); &#125;&#125; åˆ›å»ºæ¥å£ åœ¨è°ƒç”¨ç«¯åˆ›å»ºæ¥å£ï¼Œä½¿ç”¨æ³¨è§£æŒ‡å®šéœ€è¦è°ƒç”¨å“ªä¸€ä¸ªæœåŠ¡ï¼Œå¹¶å®šä¹‰è°ƒç”¨çš„æ–¹æ³•å’Œè·¯å¾„ æ³¨æ„ç»“æ„ï¼ˆservice_eduè¦è°ƒç”¨service_vodçš„åŠŸèƒ½ï¼‰ @ Feignclientæ³¨è§£ç”¨äºæŒ‡å®šä»å“ªä¸ªæœåŠ¡ä¸­è°ƒç”¨åŠŸèƒ½,åç§°ä¸è¢«è°ƒç”¨çš„æœåŠ¡åä¿æŒè‡´ã€‚@ GetMappingæ³¨è§£ç”¨äºå¯¹è¢«è°ƒç”¨çš„å¾®æœåŠ¡è¿›è¡Œåœ°å€æ˜ å°„@ PathVariableæ³¨è§£å®šè¦æŒ‡å®šå‚æ•°åç§°,å¦åˆ™å‡ºé”™@ Componentæ³¨è§£é˜²æ­¢,åœ¨å…¶ä»–ä½ç½®æ³¨å…¥ Codclientæ—¶ideaæŠ¥é”™ 12345678@FeignClient(&quot;service-vod&quot;) // è°ƒç”¨æœåŠ¡ï¼ˆæœåŠ¡åï¼‰ï¼Œè¿™é‡Œçš„æœåŠ¡åè¦å’Œå¯¹åº”æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­çš„spring.application.nameå¯¹åº”@Componentpublic interface VodClient &#123; // å®šä¹‰è¦è°ƒç”¨çš„æ–¹æ³•çš„è·¯å¾„ï¼ˆæ³¨æ„è¦å®Œå…¨è·¯å¾„ï¼‰ // æ ¹æ®idåˆ é™¤è§†é¢‘ @DeleteMapping(&quot;/eduvod/video/removeVideo/&#123;videoId&#125;&quot;) public R removeVideo(@PathVariable(&quot;videoId&quot;) String videoId);&#125; æ³¨æ„è¿™é‡Œçš„@FeignClient(â€œservice-vodâ€)ï¼ŒæœåŠ¡åä¸èƒ½ä½¿ç”¨ä¸‹åˆ’çº¿ å®ç°è°ƒç”¨ï¼ˆåˆ é™¤å°èŠ‚ï¼‰ æ³¨å…¥æ¥å£ï¼Œè°ƒç”¨æ¥å£æ–¹æ³•å³å¯ 123456789101112131415161718@RestController@RequestMapping(&quot;/eduservice/video&quot;)@CrossOrigin // è·¨åŸŸpublic class EduVideoController &#123; @Autowired private VodClient vodClient; // æ³¨å…¥æ¥å£è°ƒç”¨å…¶ä»–æœåŠ¡ // TODO åˆ é™¤å°èŠ‚ @DeleteMapping(&quot;&#123;videoId&#125;&quot;) public R deleteVideo(@PathVariable(&quot;videoId&quot;) String videoId) &#123; // å®ç°è°ƒç”¨åˆ é™¤é˜¿é‡Œäº‘è§†é¢‘ï¼Œè¿™é‡Œéœ€è¦çš„æ˜¯sourceID EduVideo eduVideo = videoService.getById(videoId); String videoSourceId = eduVideo.getVideoSourceId(); vodClient.removeVideo(videoSourceId); // åˆ é™¤æ•°æ®åº“è§†é¢‘ videoService.removeById(videoId); return R.ok(); &#125;&#125; å¦‚æœä¸æˆåŠŸrerunä¸€ä¸‹å°±è¡Œäº† Hystrixç†”æ–­å™¨ æä¾›å»¶è¿Ÿä¸å®¹é”™åŠŸèƒ½ æ·»åŠ ä¾èµ–1234567891011&lt;!-- ribbnè´Ÿè½½å‡è¡¡ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!--hystrixä¾èµ–ï¼Œä¸»è¦æ˜¯ç”¨ @HystrixCommand --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;&lt;/dependency&gt; è°ƒç”¨ç«¯é…ç½® æ³¨æ„æ˜¯åœ¨è°ƒç”¨ç«¯ï¼Œå¼€å¯ç†”æ–­å™¨é…ç½®ï¼Œä¹Ÿå¯ä½¿è®¾ç½®è¶…æ—¶æ—¶é—´ 12# hytrixå¼€å¯ç†”æ–­æœºåˆ¶feign.hystrix.enabled=true åˆ›å»ºæ¥å£å¯¹åº”å®ç°ç±» ç¼–å†™å‡ºé”™æ—¶çš„è¾“å‡ºä¿¡æ¯ï¼Œå®ç°FeignClientæ¥å£ 123456789101112@Componentpublic class VodFileDegradeFeignClient implements VodClient &#123; @Override public R removeVideo(String videoId) &#123; return R.error().message(&quot;å‡ºé”™äº†&quot;); &#125; @Override public R deleteVideoBatch(List&lt;String&gt; videoIdList) &#123; return R.error().message(&quot;å‡ºé”™äº†&quot;); &#125;&#125; æ¥å£æ·»åŠ å±æ€§ feignClientæ·»åŠ æ³¨è§£å’Œå±æ€§ 123456// fallback = &quot;å®ç°ç±»çš„class&quot;ï¼Œç†”æ–­å™¨@FeignClient(name = &quot;service-vod&quot;, fallback = VodFileDegradeFeignClient.class)// è°ƒç”¨æœåŠ¡ï¼ˆæœåŠ¡åï¼‰ï¼Œè¿™é‡Œçš„æœåŠ¡åè¦å’Œå¯¹åº”æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­çš„spring.application.nameå¯¹åº”@Componentpublic interface VodClient &#123;&#125; åˆ é™¤è¯¾ç¨‹ï¼ˆåŠŸèƒ½å®Œå–„ï¼‰ åˆ é™¤è§†é¢‘ï¼Œåˆ é™¤è§†é¢‘ä¸‹çš„ç« èŠ‚å’Œå°èŠ‚ åç«¯ videoä¸­çš„åˆ é™¤å°èŠ‚åŠŸèƒ½éœ€è¦è°ƒç”¨vodä¸­çš„åˆ é™¤ VodController123456// åˆ é™¤å¤šä¸ªé˜¿é‡Œäº‘è§†é¢‘@DeleteMapping(&quot;deleteVideoBatch&quot;)public R deleteVideoBatch(@RequestParam(&quot;videoIdList&quot;) List&lt;String&gt; videoIdList) &#123; vodService.removeBatch(videoIdList); return R.ok();&#125; VodService1234567891011121314151617181920// åˆ é™¤å¤šä¸ªé˜¿é‡Œäº‘è§†é¢‘@Overridepublic void removeVideoBatch(List&lt;String&gt; videoIdList) &#123; try &#123; // åˆå§‹åŒ–å¯¹è±¡ DefaultAcsClient client = InitVodClient.initVodClient(ConstantVodUtils.ACCESS_KEY_ID, ConstantVodUtils.ACCESS_KEY_SECRET); // åˆ›å»ºåˆ é™¤videoçš„requestå¯¹è±¡,å¹¶è®¾ç½®id DeleteVideoRequest request = new DeleteVideoRequest(); // å°†listè½¬åŒ–æˆ1,2,3çš„æ ¼å¼ String list = StringUtils.join(videoIdList.toArray(), &quot;,&quot;); request.setVideoIds(list); // è°ƒç”¨åˆå§‹åŒ–å¯¹è±¡æ–¹æ³• DeleteVideoResponse acsResponse = client.getAcsResponse(request); &#125; catch (Exception e) &#123; e.printStackTrace(); throw new GuliException(20001, &quot;åˆ é™¤è§†é¢‘å¤±è´¥&quot;); &#125;&#125; Feignè°ƒç”¨æ¥å£ è¿™æ˜¯service_eduä¸­çš„ 123456789101112@FeignClient(&quot;service-vod&quot;) // è°ƒç”¨æœåŠ¡ï¼ˆæœåŠ¡åï¼‰ï¼Œè¿™é‡Œçš„æœåŠ¡åè¦å’Œå¯¹åº”æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­çš„spring.application.nameå¯¹åº”@Componentpublic interface VodClient &#123; // å®šä¹‰è¦è°ƒç”¨çš„æ–¹æ³•çš„è·¯å¾„ï¼ˆæ³¨æ„è¦å®Œå…¨è·¯å¾„ï¼‰ // æ ¹æ®idåˆ é™¤è§†é¢‘ @DeleteMapping(&quot;/eduvod/video/removeVideo/&#123;videoId&#125;&quot;) public R removeVideo(@PathVariable(&quot;videoId&quot;) String videoId); // åˆ é™¤å¤šä¸ªé˜¿é‡Œäº‘è§†é¢‘ @DeleteMapping(&quot;/eduvod/video/deleteVideoBatch&quot;) public R deleteVideoBatch(@RequestParam(&quot;videoIdList&quot;) List&lt;String&gt; videoIdList);&#125; videoMapper123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.atguigu.eduservice.mapper.EduVideoMapper&quot;&gt; &lt;select id=&quot;getVideoIdListByCourse&quot; resultType=&quot;java.lang.String&quot;&gt; SELECT video_source_id FROM `edu_video` WHERE course_id = #&#123;courseId&#125; AND video_source_id IS NOT NULL AND video_source_id != &#x27;&#x27;; &lt;/select&gt;&lt;/mapper&gt; videoService123456789101112131415161718@Servicepublic class EduVideoServiceImpl extends ServiceImpl&lt;EduVideoMapper, EduVideo&gt; implements EduVideoService &#123; @Autowired private VodClient vodClient; // æ ¹æ®è¯¾ç¨‹idåˆ é™¤å°èŠ‚ @Override public void removeByCourseId(String courseId) &#123; // åˆ é™¤è¯¥è¯¾ç¨‹ä¸‹çš„æ‰€æœ‰è§†é¢‘ï¼ˆé˜¿é‡Œäº‘ï¼‰ List&lt;String&gt; idList = baseMapper.getVideoIdListByCourse(courseId); vodClient.deleteVideoBatch(idList); // åˆ é™¤å°èŠ‚ï¼ˆæ•°æ®åº“ï¼‰ QueryWrapper wrapper = new QueryWrapper(); wrapper.eq(&quot;course_id&quot;, courseId); baseMapper.delete(wrapper); &#125;&#125; æµ‹è¯• OK å‰ç«¯ TODO æ³¨æ„è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œç”±äºæˆ‘ç¡®å®šæŒ‰é’®æ²¡æœ‰ç»‘å®šæ˜¯å¦èƒ½å¤ŸæŒ‰ä¸‹çš„booleanå€¼ï¼Œæ‰€æœ‰åœ¨æ–‡ä»¶ä¸Šä¼ å®Œæˆä¹‹å‰æŒ‰ä¸‹ä¼šæ²¡æœ‰sourceIdï¼Œä¹‹åå†æ”¹ å¾…ç»­ åå°è¿˜æœ‰å¥½å¤šTODOå’Œå®Œå–„ï¼Œç«Ÿç„¶å°±ç›´æ¥è¿›å…¥å‰å°äº†ï¼Œå¥½å§è¿˜å¾—é è‡ªå·±","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜3","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜3","date":"2021-09-24T02:43:17.317Z","updated":"2021-09-26T09:03:30.866Z","comments":true,"path":"2021/09/24/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-3/","link":"","permalink":"http://example.com/2021/09/24/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-3/","excerpt":"","text":"è¯¾ç¨‹ç®¡ç†æ¨¡å— æ•°æ®åº“è¡¨å…³ç³» courseç›¸å…³è¡¨ã€chapterã€videoã€teacherã€subjectâ€¦â€¦è¿™äº›è¡¨éƒ½éœ€è¦ ä»£ç ç”Ÿæˆå™¨ ç†Ÿæ‚‰çš„æ“ä½œï¼Œrunå°±å®Œäº‹äº† è´´ä¸€ä¸‹é¡¹ç›®ç»“æ„ controllerè®°å¾—åŠ ä¸‹è·¨åŸŸæ³¨é‡Šï¼Œentityè®°å¾—åŠ ä¸‹è‡ªåŠ¨å¡«å……æ³¨é‡Šâ€¦â€¦ æ·»åŠ è¯¾ç¨‹ä¿¡æ¯ï¼ˆåç«¯ï¼‰voè¡¨å•æ•°æ®å°è£…ç±» éœ€è¦ç”¨åˆ°è¡¨å•æäº¤æ•°æ®ï¼Œæ‰€ä»¥å†™ä¸€ä¸ªvoç±»å°è£… 1234567891011121314151617181920212223242526272829303132333435package com.atguigu.eduservice.entity.vo;import io.swagger.annotations.ApiModelProperty;import lombok.Data;import java.math.BigDecimal;// è¡¨å•æäº¤æ•°æ®å°è£…å¯¹è±¡@Datapublic class CourseInfoVo &#123; @ApiModelProperty(value = &quot;è¯¾ç¨‹ID&quot;) private String id; @ApiModelProperty(value = &quot;è¯¾ç¨‹è®²å¸ˆID&quot;) private String teacherId; @ApiModelProperty(value = &quot;è¯¾ç¨‹ä¸“ä¸šID&quot;) private String subjectId; @ApiModelProperty(value = &quot;è¯¾ç¨‹æ ‡é¢˜&quot;) private String title; @ApiModelProperty(value = &quot;è¯¾ç¨‹é”€å”®ä»·æ ¼ï¼Œè®¾ç½®ä¸º0åˆ™å¯å…è´¹è§‚çœ‹&quot;) // 0.01 private BigDecimal price; @ApiModelProperty(value = &quot;æ€»è¯¾æ—¶&quot;) private Integer lessonNum; @ApiModelProperty(value = &quot;è¯¾ç¨‹å°é¢å›¾ç‰‡è·¯å¾„&quot;) private String cover; @ApiModelProperty(value = &quot;è¯¾ç¨‹ç®€ä»‹&quot;) private String description;&#125; ç¼–å†™controller12345678910111213141516@RestController@RequestMapping(&quot;/eduservice/course&quot;)@CrossOrigin // è·¨åŸŸpublic class EduCourseController &#123; @Autowired private EduCourseService courseService; // æ·»åŠ è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ @PostMapping(&quot;addCourseInfo&quot;) public R addCourseInfo(@RequestBody CourseInfoVo courseInfoVo) &#123; courseService.saveCourseInfo(courseInfoVo); return R.ok(); &#125;&#125; ç¼–å†™service123456789101112131415161718192021222324@Servicepublic class EduCourseServiceImpl extends ServiceImpl&lt;EduCourseMapper, EduCourse&gt; implements EduCourseService &#123; @Autowired private EduCourseDescriptionService courseDescriptionService; // æ·»åŠ è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ @Override public void saveCourseInfo(CourseInfoVo courseInfoVo) &#123; // å‘è¯¾ç¨‹è¡¨ä¸­æ·»åŠ è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ EduCourse eduCourse = new EduCourse(); BeanUtils.copyProperties(courseInfoVo, eduCourse); int affectRow = baseMapper.insert(eduCourse); if (affectRow &lt;= 0) &#123; throw new GuliException(20001, &quot;æ·»åŠ è¯¾ç¨‹å¤±è´¥&quot;); &#125; // å‘è¯¾ç¨‹ç®€ä»‹è¡¨ä¸­æ·»åŠ è¯¾ç¨‹ç®€ä»‹ä¿¡æ¯ // æ³¨æ„baseMapperæ·»åŠ çš„æ˜¯å½“å‰serviceå¯¹åº”çš„è¡¨,ä½¿ç”¨å¯¹åº”çš„serviceå³å¯ EduCourseDescription courseDescription = new EduCourseDescription(); courseDescription.setId(eduCourse.getId()); // è¿™é‡Œè¦ä¿è¯ä¸¤å¼ è¡¨idç›¸åŒï¼ˆ1-1å…³ç³»ï¼‰ courseDescription.setDescription(courseInfoVo.getDescription()); courseDescriptionService.save(courseDescription); &#125;&#125; åŒæ—¶éœ€è¦å®ä½“ç±»ä¸­çš„idå±æ€§ä¸ºæ‰‹åŠ¨è¾“å…¥ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨ç”Ÿæˆ 123456789public class EduCourseDescription implements Serializable &#123; private static final long serialVersionUID = 1L; @ApiModelProperty(value = &quot;è¯¾ç¨‹ID&quot;) @TableId(value = &quot;id&quot;, type = IdType.INPUT) private String id; &#125; æµ‹è¯• courseå’Œdescriptionè¡¨ä¸­idä¸€æ · æ·»åŠ è¯¾ç¨‹ä¿¡æ¯ï¼ˆå‰ç«¯ï¼‰æ·»åŠ router1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// è¯¾ç¨‹ä¿¡æ¯ç®¡ç†æ¨¡å—è·¯ç”±&#123; path: &#x27;/course&#x27;, component: Layout, redirect: &#x27;/course/list&#x27;, name: &#x27;è¯¾ç¨‹ç®¡ç†&#x27;, meta: &#123; title: &#x27;è¯¾ç¨‹ç®¡ç†&#x27;, icon: &#x27;example&#x27; &#125;, children: [ &#123; path: &#x27;list&#x27;, name: &#x27;è¯¾ç¨‹åˆ—è¡¨&#x27;, component: () =&gt; import(&#x27;@/views/edu/course/list&#x27;), meta: &#123; title: &#x27;è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨&#x27;, icon: &#x27;tree&#x27; &#125; &#125;, &#123; path: &#x27;info&#x27;, name: &#x27;æ·»åŠ è¯¾ç¨‹&#x27;, component: () =&gt; import(&#x27;@/views/edu/course/info&#x27;), meta: &#123; title: &#x27;æ·»åŠ è¯¾ç¨‹&#x27;, icon: &#x27;table&#x27; &#125; &#125;, &#123; path: &#x27;info/:id&#x27;, name: &#x27;EduCourseInfoEdit&#x27;, component: () =&gt; import(&#x27;@/views/edu/course/info&#x27;), meta: &#123; title: &#x27;ç¼–è¾‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&#x27;, icon: &#x27;table&#x27; &#125;, // ä¸æ˜¾ç¤ºè¯¥è·¯ç”±(éšè—è·¯ç”±) hidden: true &#125;, &#123; path: &#x27;chapter/:id&#x27;, name: &#x27;EduCourseChapterEdit&#x27;, component: () =&gt; import(&#x27;@/views/edu/course/chapter&#x27;), meta: &#123; title: &#x27;ç¼–è¾‘è¯¾ç¨‹å¤§çº²&#x27;, icon: &#x27;table&#x27; &#125;, // ä¸æ˜¾ç¤ºè¯¥è·¯ç”±(éšè—è·¯ç”±) hidden: true &#125;, &#123; path: &#x27;publish/:id&#x27;, name: &#x27;EduCoursePublishEdit&#x27;, component: () =&gt; import(&#x27;@/views/edu/course/publish&#x27;), meta: &#123; title: &#x27;å‘å¸ƒè¯¾ç¨‹&#x27;, icon: &#x27;table&#x27; &#125;, // ä¸æ˜¾ç¤ºè¯¥è·¯ç”±(éšè—è·¯ç”±) hidden: true &#125; ]&#125;, åˆ›å»ºvueè§†å›¾æ¨¡æ¿ ä½¿ç”¨element-uiçš„æ­¥éª¤æ¡å’Œè¡¨å•å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;h2 style=&quot;text-align: center&quot;&gt;å‘å¸ƒæ–°è¯¾ç¨‹&lt;/h2&gt; &lt;el-steps :active=&quot;1&quot; process-status=&quot;wait&quot; align-center style=&quot;margin-bottom: 40px&quot; &gt; &lt;el-step title=&quot;å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot; /&gt; &lt;el-step title=&quot;åˆ›å»ºè¯¾ç¨‹å¤§çº²&quot; /&gt; &lt;el-step title=&quot;æœ€ç»ˆå‘å¸ƒ&quot; /&gt; &lt;/el-steps&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹æ ‡é¢˜&quot;&gt; &lt;el-input v-model=&quot;courseInfo.title&quot; placeholder=&quot; ç¤ºä¾‹ï¼šæœºå™¨å­¦ä¹ é¡¹ç›®è¯¾ï¼šä»åŸºç¡€åˆ°æ­å»ºé¡¹ç›®è§†é¢‘è¯¾ç¨‹ã€‚ä¸“ä¸šåç§°æ³¨æ„å¤§å°å†™&quot; /&gt; &lt;/el-form-item&gt; &lt;!-- æ‰€å±åˆ†ç±» TODO --&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹åˆ†ç±»&quot;&gt; &lt;el-select v-model=&quot;courseInfo.subjectParentId&quot; placeholder=&quot;ä¸€çº§åˆ†ç±»&quot; @change=&quot;subjectLevelOneChanged&quot; &gt; &lt;el-option v-for=&quot;subject in subjectOneList&quot; :key=&quot;subject.id&quot; :label=&quot;subject.title&quot; :value=&quot;subject.id&quot; /&gt; &lt;/el-select&gt; &lt;!-- äºŒçº§åˆ†ç±» --&gt; &lt;el-select v-model=&quot;courseInfo.subjectId&quot; placeholder=&quot;äºŒçº§åˆ†ç±»&quot; &gt; &lt;el-option v-for=&quot;subject in subjectTwoList&quot; :key=&quot;subject.id&quot; :label=&quot;subject.title&quot; :value=&quot;subject.id&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;!-- è¯¾ç¨‹è®²å¸ˆ TODO --&gt; &lt;!-- è¯¾ç¨‹è®²å¸ˆ --&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹è®²å¸ˆ&quot;&gt; &lt;el-select v-model=&quot;courseInfo.teacherId&quot; placeholder=&quot;è¯·é€‰æ‹©&quot;&gt; &lt;el-option v-for=&quot;teacher in teacherList&quot; :key=&quot;teacher.id&quot; :label=&quot;teacher.name&quot; :value=&quot;teacher.id&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ€»è¯¾æ—¶&quot;&gt; &lt;el-input-number :min=&quot;0&quot; v-model=&quot;courseInfo.lessonNum&quot; controls-position=&quot;right&quot; placeholder=&quot;è¯·å¡«å†™è¯¾ç¨‹çš„æ€»è¯¾æ—¶æ•°&quot; /&gt; &lt;/el-form-item&gt; &lt;!-- è¯¾ç¨‹ç®€ä»‹ TODO --&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹ç®€ä»‹&quot;&gt; &lt;el-input v-model=&quot;courseInfo.description&quot; placeholder=&quot; &quot; /&gt; &lt;/el-form-item&gt; &lt;!-- è¯¾ç¨‹å°é¢ TODO --&gt; &lt;!-- è¯¾ç¨‹å°é¢--&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹å°é¢&quot;&gt; &lt;el-upload :show-file-list=&quot;false&quot; :on-success=&quot;handleAvatarSuccess&quot; :before-upload=&quot;beforeAvatarUpload&quot; :action=&quot;BASE_API + &#x27;/eduoss/fileoss&#x27;&quot; class=&quot;avatar-uploader&quot; &gt; &lt;img :src=&quot;courseInfo.cover&quot; /&gt; &lt;/el-upload&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è¯¾ç¨‹ä»·æ ¼&quot;&gt; &lt;el-input-number :min=&quot;0&quot; v-model=&quot;courseInfo.price&quot; controls-position=&quot;right&quot; placeholder=&quot;å…è´¹è¯¾ç¨‹è¯·è®¾ç½®ä¸º0å…ƒ&quot; /&gt; å…ƒ &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;saveOrUpdate&quot; &gt;ä¿å­˜å¹¶ä¸‹ä¸€æ­¥&lt;/el-button &gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // import course from &#x27;@/api/edu/course&#x27; import subject from &#x27;@/api/edu/subject&#x27; export default &#123; data() &#123; return &#123; saveBtnDisabled: false, courseInfo: &#123; title: &#x27;&#x27;, subjectId: &#x27;&#x27;, // äºŒçº§åˆ†ç±»id subjectParentId: &#x27;&#x27;, // ä¸€çº§åˆ†ç±»id teacherId: &#x27;&#x27;, lessonNum: 0, description: &#x27;&#x27;, cover: &#x27;/static/01.jpg&#x27;, price: 0 &#125;, BASE_API: process.env.BASE_API, // æ¥å£APIåœ°å€ teacherList: [], // å°è£…æ‰€æœ‰çš„è®²å¸ˆ subjectOneList: [], // ä¸€çº§åˆ†ç±» subjectTwoList: [] // äºŒçº§åˆ†ç±» &#125; &#125;, created() &#123;&#125;, methods: &#123;&#125; &#125;&lt;/script&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;h2 style=&quot;text-align: center;&quot;&gt;å‘å¸ƒæ–°è¯¾ç¨‹&lt;/h2&gt; &lt;el-steps :active=&quot;2&quot; process-status=&quot;wait&quot; align-center style=&quot;margin-bottom: 40px;&quot;&gt; &lt;el-step title=&quot;å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot;/&gt; &lt;el-step title=&quot;åˆ›å»ºè¯¾ç¨‹å¤§çº²&quot;/&gt; &lt;el-step title=&quot;æœ€ç»ˆå‘å¸ƒ&quot;/&gt; &lt;/el-steps&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item&gt; &lt;el-button @click=&quot;previous&quot;&gt;ä¸Šä¸€æ­¥&lt;/el-button&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;next&quot;&gt;ä¸‹ä¸€æ­¥&lt;/el-button&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; data() &#123; return &#123; saveBtnDisabled:false &#125; &#125;, created() &#123; &#125;, methods:&#123; previous() &#123; this.$router.push(&#123;path:&#x27;/course/info/1&#x27;&#125;) &#125;, next() &#123; //è·³è½¬åˆ°ç¬¬äºŒæ­¥ this.$router.push(&#123;path:&#x27;/course/publish/1&#x27;&#125;) &#125; &#125;&#125;&lt;/script&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;h2 style=&quot;text-align: center&quot;&gt;å‘å¸ƒæ–°è¯¾ç¨‹&lt;/h2&gt; &lt;el-steps :active=&quot;3&quot; process-status=&quot;wait&quot; align-center style=&quot;margin-bottom: 40px&quot; &gt; &lt;el-step title=&quot;å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot; /&gt; &lt;el-step title=&quot;åˆ›å»ºè¯¾ç¨‹å¤§çº²&quot; /&gt; &lt;el-step title=&quot;æœ€ç»ˆå‘å¸ƒ&quot; /&gt; &lt;/el-steps&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item&gt; &lt;el-button @click=&quot;previous&quot;&gt;è¿”å›ä¿®æ”¹&lt;/el-button&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;publish&quot; &gt;å‘å¸ƒè¯¾ç¨‹&lt;/el-button &gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default &#123; data() &#123; return &#123; saveBtnDisabled: false // ä¿å­˜æŒ‰é’®æ˜¯å¦ç¦ç”¨ &#125; &#125;, created() &#123; console.log(&#x27;publish created&#x27;) &#125;, methods: &#123; previous() &#123; console.log(&#x27;previous&#x27;) this.$router.push(&#123; path: &#x27;/course/chapter/1&#x27; &#125;) &#125;, publish() &#123; console.log(&#x27;publish&#x27;) this.$router.push(&#123; path: &#x27;/course/list&#x27; &#125;) &#125; &#125; &#125;&lt;/script&gt; åˆ›å»ºè¯¾ç¨‹ç›¸å…³æ¥å£ api -&gt; edu -&gt; course.js 12345678910111213import request from &#x27;@/utils/request&#x27;export default &#123; // æ–°å¢è¯¾ç¨‹ä¿¡æ¯ addCourseInfo(courseInfo) &#123; return request(&#123; url: `/eduservice/course/addCourseInfo`, method: &#x27;post&#x27;, data: courseInfo &#125;) &#125; &#125; æ³¨æ„è¿™é‡Œåœ¨åç«¯æŠŠä¹‹å‰çš„ä»£ç ä¿®æ”¹ä¸€ä¸‹ï¼Œè¿”å›æ–°å¢è¯¾ç¨‹çš„idï¼Œç„¶åé‡å¯ ç¼–å†™æŒ‰é’®æ–¹æ³•ï¼ˆç®€å•ç¼–å†™æœªå®ç°åŠŸèƒ½ï¼‰ ç”±äºè¡¨å•ä¸­æ˜¾ç¤ºè¯¾ç¨‹åˆ†ç±»å’Œè®²å¸ˆè¿˜æ²¡æœ‰å†™ï¼Œæ‰€ä»¥å…ˆç®€å•å†™ä¸€ä¸‹æ–¹æ³• 123456789101112next() &#123; // è°ƒç”¨åç«¯æ¥å£ä¼ å…¥æ•°æ® courseApi.addCourseInfo(this.courseInfo).then(result =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ æˆåŠŸ!&#x27; &#125;) // è·³è½¬åˆ°ç¬¬äºŒæ­¥ï¼ŒåŒæ—¶ä¼ é€’idå€¼ this.$router.push(&#123; path: &#x27;/course/chapter/&#x27; + result.data.courseId &#125;) &#125;)&#125; æ·»åŠ è¯¾ç¨‹ä¿¡æ¯ï¼ˆæ›´å¤šå®Œå–„ï¼‰æ˜¾ç¤ºè®²å¸ˆä¸‹æ‹‰åˆ—è¡¨ï¼ˆåç«¯ï¼‰ è®²å¸ˆæ¨¡å—å†™è¿‡äº†ï¼Œä¸å¸¦åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰è®²å¸ˆ æ˜¾ç¤ºè®²å¸ˆä¸‹æ‹‰åˆ—è¡¨ï¼ˆå‰ç«¯ï¼‰ æ³¨æ„è¿™é‡Œè¦ç°åœ¨apiä¸­åˆ›å»ºæ‰€å¾—æ‰€æœ‰è®²å¸ˆçš„æ¥å£ï¼ˆå¦‚æœä¹‹å‰è®²å¸ˆæ¨¡å—æ²¡å†™çš„è¯ï¼‰ 1234567// æŸ¥è¯¢æ‰€æœ‰è®²å¸ˆï¼ˆä¸å¸¦åˆ†é¡µï¼‰ getTeacherList() &#123; return request(&#123; url: `/eduservice/teacher/findAll`, method: &#x27;get&#x27; &#125;) &#125;, ä¸‹æ‹‰åˆ—è¡¨æ¨¡æ¿ï¼Œä½¿ç”¨å¾ªç¯çš„æ–¹æ³• 123456789101112&lt;!-- è¯¾ç¨‹è®²å¸ˆ TODO --&gt;&lt;!-- è¯¾ç¨‹è®²å¸ˆ --&gt;&lt;el-form-item label=&quot;è¯¾ç¨‹è®²å¸ˆ&quot;&gt; &lt;el-select v-model=&quot;courseInfo.teacherId&quot; placeholder=&quot;è¯·é€‰æ‹©&quot;&gt; &lt;el-option v-for=&quot;teacher in teacherList&quot; :key=&quot;teacher.id&quot; :label=&quot;teacher.name&quot; :value=&quot;teacher.id&quot; /&gt; &lt;/el-select&gt;&lt;/el-form-item&gt; ç„¶åç¼–å†™vueä¸­å¯¹åº”æ–¹æ³•å³å¯ 12345getListTeacher() &#123; teacherApi.getTeacherList().then(result =&gt; &#123; this.teacherList = result.data.teacherList &#125;)&#125;, æ˜¾ç¤ºäºŒçº§è”åŠ¨ä¸‹æ‹‰åˆ—è¡¨ï¼ˆå‰ç«¯ï¼‰ åç«¯è¯¾ç¨‹åˆ†ç±»æ¨¡å—å†™å¥½äº†ï¼Œä½¿ç”¨ä¹‹å‰çš„å³å¯ å…ˆè·å¾—å¹¶ä¿å­˜å¹¶åˆå§‹åŒ–æ˜¾ç¤ºæ‰€æœ‰ä¸€çº§åˆ†ç±» 12345getOneSubject() &#123; subjectApi.getSubjectList().then(result =&gt; &#123; this.subjectOneList = result.data.list &#125;)&#125;, å®ç°äºŒçº§è”åŠ¨ï¼Œä¸ºä¸€çº§åˆ†ç±»ä¸‹æ‹‰åˆ—è¡¨æ·»åŠ @changeå¯¹åº”æ–¹æ³• æ³¨æ„æ­¤å¤„el-optionç»‘å®šäº†valueå€¼èµ‹å€¼ä¸ºidï¼Œæ‰€ä»¥ç›´æ¥è·å–å³å¯ 12345678910111213// äºŒçº§è”åŠ¨,valueä¸ºç»‘å®šçš„æ•°æ®ï¼ˆ:value=&quot;subject.id&quot;ï¼‰subjectLevelOneChanged(value) &#123; // æ ¹æ®idä¾¿åˆ©subjectOneListè·å¾—å…¶childrenèµ‹å€¼ç»™äºŒçº§åˆ†ç±» for (var i = 0; i &lt; this.subjectOneList.length; i++) &#123; // åˆ¤æ–­ï¼šæ‰€æœ‰ä¸€çº§åˆ†ç±»id å’Œ ç‚¹å‡»ä¸€çº§åˆ†ç±»idæ˜¯å¦ä¸€æ · if (value === this.subjectOneList[i].id) &#123; // ä»ä¸€çº§åˆ†ç±»è·å–é‡Œé¢æ‰€æœ‰çš„äºŒçº§åˆ†ç±» this.subjectTwoList = this.subjectOneList[i].children // æŠŠäºŒçº§åˆ†ç±»idå€¼æ¸…ç©º this.courseInfo.subjectId = &#x27;&#x27; &#125; &#125;&#125;, æµ‹è¯•æ˜¯æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œcourseè¡¨ä¸Šæ·»åŠ çš„æ•°æ®æ²¡æœ‰çˆ¶åˆ†ç±»idï¼Œçœ‹äº†ä¸‹æ˜¯æˆ‘åœ¨voå¯¹è±¡æŠŠè¿™ä¸ªå±æ€§æ³¨é‡Šäº†ï¼ˆå› ä¸ºä¹‹å‰æœ‰nullé”™è¯¯ï¼‰ï¼Œè®°å¾—é‡å¯ å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ ç›´æ¥æ•´åˆï¼ŒæŒ‡cv å¤åˆ¶ç»„ä»¶å’Œé™æ€èµ„æº å­—é¢æ„æ€ é…ç½®å˜é‡ å†é…ç½®htmlå˜é‡ï¼Œbuild -&gt; webpack.dev.conf.js ä¸­å¦‚ä¸‹æ·»åŠ ï¼ˆæ³¨æ„æ‰€åœ¨ä½ç½®ï¼Œå…¶ä»–ä¸è¦å˜ï¼‰ 12345678910111213141516171819 plugins: [ new webpack.DefinePlugin(&#123; &#x27;process.env&#x27;: require(&#x27;../config/dev.env&#x27;) &#125;), new webpack.HotModuleReplacementPlugin(), // https://github.com/ampedandwired/html-webpack-plugin new HtmlWebpackPlugin(&#123; filename: &#x27;index.html&#x27;, template: &#x27;index.html&#x27;, inject: true, favicon: resolve(&#x27;favicon.ico&#x27;), title: &#x27;vue-admin-template&#x27;, // ä¿®æ”¹é…ç½® templateParameters: &#123; BASE_URL: config.dev.assetsPublicPath + config.dev.assetsSubDirectory &#125; &#125;) ]&#125;) å¼•å…¥è„šæœ¬æ–‡ä»¶ åœ¨index.htmlå¼•å…¥è„šæœ¬æ–‡ä»¶ï¼ŒæŠ¥é”™æ˜¯æ‰¾ä¸åˆ°BASE_URLï¼Œä¹‹å‰æ”¹äº†é…ç½®é‡å¯å°±è¡Œ 12&lt;script src=&lt;%=BASE_URL %&gt;/tinymce4.7.5/tinymce.min.js &gt;&lt;/script&gt;&lt;script src=&lt;%=BASE_URL %&gt;/tinymce4.7.5/langs/zh_CN.js &gt;&lt;/script&gt; å¼•å…¥å£°æ˜ç»„ä»¶12345import Tinymce from &#x27;@/components/Tinymce&#x27; //å¼•å…¥ç»„ä»¶ export default &#123; // å£°æ˜ç»„ä»¶ components: &#123; Tinymce &#125;, &#125; ä½¿ç”¨ç»„ä»¶1&lt;tinymce :height=&quot;300&quot; v-model=&quot;courseInfo.description&quot; /&gt; æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ³¨æ„æ•°æ®åº“ä¸­çš„å­—æ®µå±æ€§æ”¹ä¸ºlongtextï¼Œè¦ä¸ç„¶å›¾ç‰‡ä¼ ä¸Šå»åç«¯æŠ¥é”™Data truncation: Data too long for column &#39;description&#39; æ˜¾ç¤ºè¯¾ç¨‹ç« èŠ‚ï¼ˆåç«¯ï¼‰åˆ›å»ºç« èŠ‚å®ä½“ç±» ç±»ä¼¼äºä¸€çº§äºŒçº§åˆ†ç±»å³å¯ ç¼–å†™controller12345678910111213141516@RestController@RequestMapping(&quot;/eduservice/chapter&quot;)@CrossOrigin // è·¨åŸŸpublic class EduChapterController &#123; @Autowired private EduChapterService chapterService; // è·å¾—è¯¾ç¨‹å¤§çº²åˆ—è¡¨(æ ¹æ®id @GetMapping(&quot;getChapterVideo/&#123;courseId&#125;&quot;) public R getChapterVideo(@PathVariable(&quot;courseId&quot;) String courseId) &#123; List&lt;ChapterVo&gt; list = chapterService.getChapterVideoByCourseId(courseId); return R.ok().data(&quot;chapterVideoList&quot;, list); &#125; &#125; ç¼–å†™service ä¸ä¼˜é›… 12345678910111213141516171819202122232425262728293031323334353637383940@Servicepublic class EduChapterServiceImpl extends ServiceImpl&lt;EduChapterMapper, EduChapter&gt; implements EduChapterService &#123; @Autowired private EduVideoService videoService; @Override public List&lt;ChapterVo&gt; getChapterVideoByCourseId(String courseId) &#123; // è·å¾—å¯¹åº”idè¯¾ç¨‹çš„æ‰€æœ‰ç« èŠ‚ QueryWrapper&lt;EduChapter&gt; chapterWrapper = new QueryWrapper&lt;&gt;(); chapterWrapper.eq(&quot;course_id&quot;, courseId); List&lt;EduChapter&gt; chapterList = baseMapper.selectList(chapterWrapper); // è·å¾—å¯¹åº”idè¯¾ç¨‹çš„æ‰€æœ‰å°èŠ‚ QueryWrapper&lt;EduVideo&gt; videoWrapper = new QueryWrapper&lt;&gt;(); videoWrapper.eq(&quot;course_id&quot;, courseId); List&lt;EduVideo&gt; videoList = videoService.list(videoWrapper); // å°è£… List&lt;ChapterVo&gt; finalList = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; chapterList.size(); i++) &#123; EduChapter eduChapter = chapterList.get(i); ChapterVo chapterVo = new ChapterVo(); BeanUtils.copyProperties(eduChapter, chapterVo); List&lt;VideoVo&gt; children = new ArrayList&lt;&gt;(); for (int j = 0; j &lt; videoList.size(); j++) &#123; EduVideo eduVideo = videoList.get(j); if (eduVideo.getChapterId().equals(chapterVo.getId())) &#123; VideoVo videoVo = new VideoVo(); BeanUtils.copyProperties(eduVideo, videoVo); children.add(videoVo); &#125; &#125; chapterVo.setChildren(children); finalList.add(chapterVo); &#125; return finalList; &#125;&#125; æ˜¾ç¤ºè¯¾ç¨‹ç« èŠ‚ï¼ˆå‰ç«¯ï¼‰api1234567891011import request from &#x27;@/utils/request&#x27;export default &#123; // è·å¾—æ‰€æœ‰ä»¥åŠåˆ†ç±» getChapterVideo(courseId) &#123; return request(&#123; url: `/eduservice/chapter/getChapterVideo/$&#123;courseId&#125;`, method: &#x27;get&#x27;, &#125;) &#125;&#125; vueè§†å›¾æ¨¡æ¿å’Œåˆå§‹åŒ–123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;h2 style=&quot;text-align: center&quot;&gt;å‘å¸ƒæ–°è¯¾ç¨‹&lt;/h2&gt; &lt;!-- æ­¥éª¤æ¡ --&gt; &lt;el-steps :active=&quot;2&quot; process-status=&quot;wait&quot; align-center style=&quot;margin-bottom: 40px&quot; &gt; &lt;el-step title=&quot;å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot; /&gt; &lt;el-step title=&quot;åˆ›å»ºè¯¾ç¨‹å¤§çº²&quot; /&gt; &lt;el-step title=&quot;æœ€ç»ˆå‘å¸ƒ&quot; /&gt; &lt;/el-steps&gt; &lt;el-button type=&quot;text&quot; @click=&quot;openChapterDialog()&quot;&gt;æ·»åŠ ç« èŠ‚&lt;/el-button&gt; &lt;!-- ç« èŠ‚åˆ—è¡¨ --&gt; &lt;ul class=&quot;chapterList&quot;&gt; &lt;li v-for=&quot;chapter in chapterVideoList&quot; :key=&quot;chapter.id&quot;&gt; &lt;p&gt; &#123;&#123; chapter.title &#125;&#125; &lt;span class=&quot;acts&quot;&gt; &lt;el-button style=&quot;&quot; type=&quot;text&quot; @click=&quot;openVideo(chapter.id)&quot; &gt;æ·»åŠ å°èŠ‚&lt;/el-button &gt; &lt;el-button style=&quot;&quot; type=&quot;text&quot; @click=&quot;openEditChatper(chapter.id)&quot; &gt;ç¼–è¾‘&lt;/el-button &gt; &lt;el-button type=&quot;text&quot; @click=&quot;removeChapter(chapter.id)&quot; &gt;åˆ é™¤&lt;/el-button &gt; &lt;/span&gt; &lt;/p&gt; &lt;!-- è§†é¢‘ --&gt; &lt;ul class=&quot;chapterList videoList&quot;&gt; &lt;li v-for=&quot;video in chapter.children&quot; :key=&quot;video.id&quot;&gt; &lt;p&gt; &#123;&#123; video.title &#125;&#125; &lt;span class=&quot;acts&quot;&gt; &lt;el-button style=&quot;&quot; type=&quot;text&quot;&gt;ç¼–è¾‘&lt;/el-button&gt; &lt;el-button type=&quot;text&quot; @click=&quot;removeVideo(video.id)&quot; &gt;åˆ é™¤&lt;/el-button &gt; &lt;/span&gt; &lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;!-- æ“ä½œ --&gt; &lt;div&gt; &lt;el-button @click=&quot;previous&quot;&gt;ä¸Šä¸€æ­¥&lt;/el-button&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;next&quot; &gt;ä¸‹ä¸€æ­¥&lt;/el-button &gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import chapterApi from &#x27;@/api/edu/chapter&#x27; export default &#123; data() &#123; return &#123; saveBtnDisabled: false, courseId: &#x27;&#x27;, // è¯¾ç¨‹id chapterVideoList: [] &#125; &#125;, created() &#123; // è·å–åˆ°è·¯ç”±ä¸­çš„idå€¼ if (this.$route.params &amp;&amp; this.$route.params.id) &#123; this.courseId = this.$route.params.id this.getChapterVideo() &#125; &#125;, methods: &#123; // æ ¹æ®idæŸ¥è¯¢ç« èŠ‚å’Œå°èŠ‚ getChapterVideo() &#123; chapterApi.getChapterVideo(this.courseId).then(result =&gt; &#123; this.chapterVideoList = result.data.chapterVideoList &#125;) &#125;, previous() &#123; this.$router.push(&#123; path: &#x27;/course/info/&#x27; + this.courseId &#125;) &#125;, next() &#123; // è·³è½¬åˆ°ç¬¬äºŒæ­¥ this.$router.push(&#123; path: &#x27;/course/publish/&#x27; + this.courseId &#125;) &#125; &#125; &#125;&lt;/script&gt;&lt;style scoped&gt; .chapterList &#123; position: relative; list-style: none; margin: 0; padding: 0; &#125; .chapterList li &#123; position: relative; &#125; .chapterList p &#123; float: left; font-size: 20px; margin: 10px 0; padding: 10px; height: 70px; line-height: 50px; width: 100%; border: 1px solid #ddd; &#125; .chapterList .acts &#123; float: right; font-size: 14px; &#125; .videoList &#123; padding-left: 50px; &#125; .videoList p &#123; float: left; font-size: 14px; margin: 10px 0; padding: 10px; height: 50px; line-height: 30px; width: 100%; border: 1px dotted #ddd; &#125;&lt;/style&gt; ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ï¼ˆåç«¯ï¼‰ â€œä¸Šä¸€æ­¥â€å›æ˜¾æ–¹æ³•ï¼šæ ¹æ®idæŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ å›æ˜¾è¯¾ç¨‹ä¿¡æ¯ç¼–å†™controller123456// æ ¹æ®idæŸ¥è¯¢åŸºæœ¬ä¿¡æ¯@GetMapping(&quot;getCourseInfo/&#123;courseId&#125;&quot;)public R getCourseInfo(@PathVariable String courseId) &#123; CourseInfoVo courseInfoVo = courseService.getCourseInfoById(courseId); return R.ok().data(&quot;courseInfo&quot;, courseInfoVo);&#125; ç¼–å†™service12345678910111213// æ ¹æ®idè·å¾—è¯¾ç¨‹Vo@Overridepublic CourseInfoVo getCourseInfoById(String courseId) &#123; // å…ˆæŸ¥è¯¾ç¨‹è¡¨ EduCourse eduCourse = baseMapper.selectById(courseId); // å†æŸ¥è¯¾ç¨‹æè¿°è¡¨ EduCourseDescription courseDescription = courseDescriptionService.getById(courseId); // å°è£… CourseInfoVo courseInfoVo = new CourseInfoVo(); BeanUtils.copyProperties(eduCourse, courseInfoVo); courseInfoVo.setDescription(courseDescription.getDescription()); return courseInfoVo;&#125; ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ç¼–å†™controller123456// ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯@PostMapping(&quot;updateCourseInfo&quot;)public R updateCourseInfo(@RequestBody CourseInfoVo courseInfoVo) &#123; courseService.updateCourseInfo(courseInfoVo); return R.ok();&#125; ç¼–å†™service123456789101112131415// ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯@Overridepublic void updateCourseInfo(CourseInfoVo courseInfoVo) &#123; // ä¿®æ”¹è¯¾ç¨‹è¡¨ EduCourse eduCourse = new EduCourse(); BeanUtils.copyProperties(courseInfoVo, eduCourse); int affectRow = baseMapper.updateById(eduCourse); if (affectRow &lt;= 0) &#123; throw new GuliException(20001, &quot;ä¿®æ”¹è¯¾ç¨‹å¤±è´¥&quot;); &#125; // ä¿®æ”¹è¯¾ç¨‹æè¿°è¡¨ EduCourseDescription courseDescription = new EduCourseDescription(); BeanUtils.copyProperties(courseInfoVo, courseDescription); courseDescriptionService.updateById(courseDescription);&#125; ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ï¼ˆå‰ç«¯ï¼‰api src -&gt; api -&gt; edu -&gt; course.js 123456789101112131415// æ ¹æ®idè·å¾—è¯¾ç¨‹ä¿¡æ¯ getCourseInfoById(id) &#123; return request(&#123; url: `/eduservice/course/getCourseInfo/` + id, method: &#x27;get&#x27;, &#125;) &#125;, // ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯ updateCourseInfo(courseInfo) &#123; return request(&#123; url: `/eduservice/course/updateCourseInfo`, method: &#x27;post&#x27;, data: courseInfo &#125;) &#125;, å›æ˜¾vueè§†å›¾å’Œæ–¹æ³•è¡¨å•å›æ˜¾æ•°æ® è®°å¾—åœ¨è·³è½¬åˆ°infoé¡µé¢çš„æŒ‰é’®ä¸Šæ·»åŠ idçš„å€¼ 12345678910111213141516171819202122&lt;script&gt; import courseApi from &#x27;@/api/edu/course&#x27; export default &#123; data() &#123; &#125;, created() &#123; // åˆ¤æ–­æ˜¯å¦éœ€è¦æ•°æ®å›æ˜¾ if (this.$route.params &amp;&amp; this.$route.params.id) &#123; this.courseId = this.$route.params.id this.getCourseInfo() &#125; &#125;, methods: &#123; // æ ¹æ®idè·å¾—è¯¾ç¨‹ä¿¡æ¯ getCourseInfo() &#123; courseApi.getCourseInfoById(this.courseId).then(result =&gt; &#123; this.courseInfo = result.data.courseInfo &#125;) &#125;, &#125; &#125;&lt;/script&gt; è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè¿”å›è¯¥é¡µé¢å›æ˜¾æ•°æ®ä¸­ï¼ŒcourseInfoçš„äºŒçº§åˆ†ç±»åˆ—è¡¨subjectTwoListåªæœ‰åœ¨ä¸€çº§åˆ†ç±»changeçš„æ—¶å€™æ‰ä¼šé‡æ–°æ˜¾ç¤ºï¼Œå¦åˆ™è¯¥åˆ—è¡¨ä¼šæ˜¾ç¤ºç»‘å®šçš„courseInfo.subjectIdï¼Œæ‰€ä»¥éœ€è¦å®Œå–„ ä¸‹æ‹‰åˆ—è¡¨æ•°æ®å›æ˜¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;script&gt; export default &#123; watch: &#123; // ç›‘å¬è·¯ç”±æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœæ˜¯åˆ™æ¸…é™¤å½“å‰é¡µé¢çš„æ•°æ® $route(to, from) &#123; if (!this.$route.params || !this.$route.params.id) &#123; this.courseInfo = &#123;&#125; &#125; &#125; &#125;, created() &#123; // è·å–è·¯ç”±idå€¼ if (this.$route.params &amp;&amp; this.$route.params.id) &#123; this.courseId = this.$route.params.id // è°ƒç”¨æ ¹æ®idæŸ¥è¯¢è¯¾ç¨‹çš„æ–¹æ³• this.getCourseInfo() &#125; else &#123; // åˆå§‹åŒ–æ‰€æœ‰è®²å¸ˆ this.getListTeacher() // åˆå§‹åŒ–ä¸€çº§åˆ†ç±» this.getOneSubject() &#125; &#125;, methods: &#123; // æ ¹æ®idè·å¾—è¯¾ç¨‹ä¿¡æ¯ getCourseInfo() &#123; courseApi.getCourseInfoById(this.courseId).then(response =&gt; &#123; // åœ¨courseInfoè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…å« ä¸€çº§åˆ†ç±»id å’Œ äºŒçº§åˆ†ç±»id this.courseInfo = response.data.courseInfo // 1 æŸ¥è¯¢æ‰€æœ‰çš„åˆ†ç±»ï¼ŒåŒ…å«ä¸€çº§å’ŒäºŒçº§ subjectApi.getSubjectList().then(response =&gt; &#123; // 2 è·å–æ‰€æœ‰ä¸€çº§åˆ†ç±» this.subjectOneList = response.data.list // 3 æŠŠæ‰€æœ‰çš„ä¸€çº§åˆ†ç±»æ•°ç»„è¿›è¡Œéå†ï¼Œ for (var i = 0; i &lt; this.subjectOneList.length; i++) &#123; // è·å–æ¯ä¸ªä¸€çº§åˆ†ç±» var oneSubject = this.subjectOneList[i] // æ¯”è¾ƒå½“å‰courseInfoé‡Œé¢ä¸€çº§åˆ†ç±»idå’Œæ‰€æœ‰çš„ä¸€çº§åˆ†ç±»id if (this.courseInfo.subjectParentId == oneSubject.id) &#123; // è·å–ä¸€çº§åˆ†ç±»æ‰€æœ‰çš„äºŒçº§åˆ†ç±» this.subjectTwoList = oneSubject.children &#125; &#125; &#125;) // åˆå§‹åŒ–æ‰€æœ‰è®²å¸ˆ this.getListTeacher() &#125;) &#125;, &#125; &#125;&lt;/script&gt; æµ‹è¯•ï¼Œè¿™é‡Œå¾ˆå¥‡æ€ªï¼Œæˆ‘æŠŠè·å¾—äºŒçº§åˆ—è¡¨æ–¹æ³•å°è£…äº†å‡ºæ¥ï¼Œç»“æ„é¡ºåºéƒ½ä¸€æ ·çš„ä½†æ˜¯æµ‹è¯•çš„æ—¶å€™ä¸€å¼€å§‹èƒ½æ˜¾ç¤ºï¼Œåé¢åˆä¸è¡Œäº†ï¼Œæˆ‘ä¸ç†è§£ ä¿®æ”¹vueè§†å›¾å’Œæ–¹æ³•12345678910111213141516171819202122232425262728293031323334// ç‚¹å‡»ä¸‹ä¸€æ­¥next() &#123; // åˆ¤æ–­æ˜¯æ·»åŠ è¿˜æ˜¯ä¿®æ”¹ if (this.courseInfo.id) &#123; this.updateCourse() &#125; else &#123; this.addCourse() &#125;&#125;,// æ·»åŠ courseaddCourse() &#123; // è°ƒç”¨åç«¯æ¥å£ä¼ å…¥æ•°æ® courseApi.addCourseInfo(this.courseInfo).then(result =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ æˆåŠŸ!&#x27; &#125;) // è·³è½¬åˆ°ç¬¬äºŒæ­¥ï¼ŒåŒæ—¶ä¼ é€’idå€¼ this.$router.push(&#123; path: &#x27;/course/chapter/&#x27; + result.data.courseId &#125;) &#125;)&#125;,// ä¿®æ”¹courseupdateCourse() &#123; courseApi.updateCourseInfo(this.courseInfo).then(result =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;,s message: &#x27;ä¿®æ”¹æˆåŠŸ!&#x27; &#125;) // è·³è½¬åˆ°ç¬¬äºŒæ­¥ï¼ŒåŒæ—¶ä¼ é€’idå€¼ this.$router.push(&#123; path: &#x27;/course/chapter/&#x27; + this.courseId &#125;) &#125;)&#125; å¢ã€åˆ ã€æ”¹è¯¾ç¨‹ç« èŠ‚ï¼ˆåç«¯ï¼‰ç¼–å†™controller1234567891011121314151617181920212223242526272829303132@RestController@RequestMapping(&quot;/eduservice/chapter&quot;)@CrossOrigin // è·¨åŸŸpublic class EduChapterController &#123; @Autowired private EduChapterService chapterService; // æ ¹æ®ç« èŠ‚idæŸ¥è¯¢ç« èŠ‚ @GetMapping(&quot;getChapterInfo/&#123;chapterId&#125;&quot;) public R getChapterInfo(@PathVariable(&quot;chapterId&quot;) String chapterId) &#123; EduChapter chapter = chapterService.getById(chapterId); return R.ok().data(&quot;chapterInfo&quot;, chapter); &#125; // æ·»åŠ ç« èŠ‚ @PostMapping(&quot;addChapter&quot;) public R addChapter(@RequestBody EduChapter eduChapter) &#123; chapterService.save(eduChapter); return R.ok(); &#125; // ä¿®æ”¹ç« èŠ‚ @PostMapping(&quot;updateChapter&quot;) public R updateChapter(@RequestBody EduChapter eduChapter) &#123; chapterService.updateById(eduChapter); return R.ok(); &#125; // åˆ é™¤ç« èŠ‚ @DeleteMapping(&quot;&#123;chapterId&#125;&quot;) public R deleteChapter(@PathVariable(&quot;chapterId&quot;) String chapterId) &#123; // è‡ªå®šä¹‰æ–¹æ³•ï¼Œå¦‚æœæœ‰å°èŠ‚åˆ™ä¸è®©åˆ  Boolean b = chapterService.deleteChapter(chapterId); return b ? R.ok() : R.error(); &#125;&#125; ç¼–å†™service123456789101112131415// åˆ é™¤ç« èŠ‚@Overridepublic Boolean deleteChapter(String chapterId) &#123; // æ ¹æ®idåˆ¤æ–­æ˜¯å¦æœ‰å°èŠ‚ QueryWrapper&lt;EduVideo&gt; queryWrapper = new QueryWrapper&lt;&gt;(); queryWrapper.eq(&quot;chapter_id&quot;, chapterId); // è·å¾—å°èŠ‚æ•° int count = videoService.count(queryWrapper); if (count &gt; 0) &#123; throw new GuliException(20001, &quot;å«æœ‰å°èŠ‚æ— æ³•åˆ é™¤&quot;); &#125; else &#123; int row = baseMapper.deleteById(chapterId); return row &gt; 0; &#125;&#125; å¢ã€åˆ ã€æ”¹è¯¾ç¨‹ç« èŠ‚ï¼ˆå‰ç«¯ï¼‰api123456789101112131415161718192021222324252627282930313233import request from &#x27;@/utils/request&#x27;export default &#123; // æ·»åŠ ç« èŠ‚ addChapter(chapter) &#123; return request(&#123; url: `/eduservice/chapter/addChapter`, method: &#x27;post&#x27;, data: chapter &#125;) &#125;, // æ ¹æ®idæŸ¥è¯¢ç« èŠ‚ getChapterInfo(chapterId) &#123; return request(&#123; url: `/eduservice/chapter/getChapterInfo/` + chapterId, method: &#x27;get&#x27;, &#125;) &#125;, // ä¿®æ”¹ç« èŠ‚ updateChapter(chapter) &#123; return request(&#123; url: `/eduservice/chapter/updateChapter`, method: &#x27;post&#x27;, data: chapter &#125;) &#125;, // åˆ é™¤ç« èŠ‚ deleteChapter(chapterId) &#123; return request(&#123; url: `/eduservice/chapter/` + chapterId, method: &#x27;delete&#x27;, &#125;) &#125;,&#125; vueè§†å›¾æ¨¡æ¿ element-ui dialog cvå°±å®Œäº‹äº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!-- æ·»åŠ ç« èŠ‚æŒ‰é’® --&gt; &lt;el-button type=&quot;text&quot; @click=&quot;dialogChapterFormVisible = true&quot; &gt;æ·»åŠ ç« èŠ‚&lt;/el-button &gt; &lt;!-- æ·»åŠ å’Œä¿®æ”¹ç« èŠ‚è¡¨å• --&gt; &lt;el-dialog :visible.sync=&quot;dialogChapterFormVisible&quot; title=&quot;æ·»åŠ ç« èŠ‚&quot;&gt; &lt;el-form :model=&quot;chapter&quot; label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;ç« èŠ‚æ ‡é¢˜&quot;&gt; &lt;el-input v-model=&quot;chapter.title&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;ç« èŠ‚æ’åº&quot;&gt; &lt;el-input-number v-model=&quot;chapter.sort&quot; :min=&quot;0&quot; controls-position=&quot;right&quot; /&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;dialogChapterFormVisible = false&quot; &gt;å– æ¶ˆ&lt;/el-button &gt; &lt;el-button type=&quot;primary&quot; @click=&quot;saveOrUpdate&quot; &gt;ç¡® å®š&lt;/el-button &gt; &lt;/div&gt; &lt;/el-dialog&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import chapterApi from &#x27;@/api/edu/chapter&#x27; export default &#123; data() &#123; return &#123; saveBtnDisabled: false, courseId: &#x27;&#x27;, // è¯¾ç¨‹id chapterVideoList: [], chapter: &#123; // å°è£…ç« èŠ‚æ•°æ® title: &#x27;&#x27;, sort: 0 &#125;, video: &#123; title: &#x27;&#x27;, sort: 0, free: 0, videoSourceId: &#x27;&#x27; &#125;, dialogChapterFormVisible: false, // ç« èŠ‚å¼¹æ¡† dialogVideoFormVisible: false // å°èŠ‚å¼¹æ¡† &#125; &#125;, &#125;&lt;/script&gt; vueæ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990saveOrUpdate() &#123; if (this.chapter.id) &#123; this.updateChapter() &#125; else &#123; this.addChapter() &#125;&#125;,// æ·»åŠ ç« èŠ‚addChapter() &#123; // è®°å¾—æ·»åŠ id this.chapter.courseId = this.courseId // è°ƒç”¨api chapterApi.addChapter(this.chapter).then(result =&gt; &#123; // å…³é—­å¼¹æ¡† this.dialogChapterFormVisible = false // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ ç« èŠ‚æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getChapterVideo() // æ¸…ç©ºå¼¹æ¡†è¡¨å•å†…å®¹ this.chapter = &#123; title: &#x27;&#x27;, sort: 0 &#125; &#125;)&#125;,// ä¿®æ”¹ç« èŠ‚,æ˜¾ç¤ºå¼¹æ¡†ï¼Œæ•°æ®å›æ˜¾openEditChatper(chapterId) &#123; // å¼¹æ¡† this.openChapterDialog() // api chapterApi.getChapterInfo(chapterId).then(result =&gt; &#123; this.chapter = result.data.chapterInfo &#125;)&#125;,// ä¿®æ”¹ç« èŠ‚updateChapter() &#123; // è°ƒç”¨api chapterApi.updateChapter(this.chapter).then(result =&gt; &#123; // å…³é—­å¼¹æ¡† this.dialogChapterFormVisible = false // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;ä¿®æ”¹ç« èŠ‚æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getChapterVideo() &#125;)&#125;,// åˆ é™¤ç« èŠ‚removeChapter(chapterId) &#123; this.$confirm(&#x27;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥ç« èŠ‚è®°å½•, æ˜¯å¦ç»§ç»­?&#x27;, &#x27;æç¤º&#x27;, &#123; confirmButtonText: &#x27;ç¡®å®š&#x27;, cancelButtonText: &#x27;å–æ¶ˆ&#x27;, type: &#x27;warning&#x27; &#125;).then(result =&gt; &#123; chapterApi .deleteChapter(chapterId) .then(result =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;åˆ é™¤æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getChapterVideo() &#125;) .catch(err =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;error&#x27;, message: &#x27;åˆ é™¤å¤±è´¥!&#x27; &#125;) &#125;) &#125;)&#125;,// å¼¹å‡ºç« èŠ‚å¼¹æ¡†openChapterDialog() &#123; // å¼¹æ¡† this.dialogChapterFormVisible = true // æ¸…ç©ºå¼¹æ¡†è¡¨å•å†…å®¹ this.chapter = &#123; title: &#x27;&#x27;, sort: 0 &#125;&#125;,// æ ¹æ®idæŸ¥è¯¢ç« èŠ‚å’Œå°èŠ‚getChapterVideo() &#123; chapterApi.getChapterVideo(this.courseId).then(result =&gt; &#123; this.chapterVideoList = result.data.chapterVideoList &#125;)&#125;, å¢ã€åˆ ã€æ”¹å°èŠ‚ï¼ˆåç«¯ï¼‰ï¼ˆå¾…å®Œå–„ï¼‰ å·²å®Œå–„ï¼Œè¯¦è§é¡¹ç›®ç¬”è®°4 controller12345678910111213141516171819202122232425262728293031323334353637@RestController@RequestMapping(&quot;/eduservice/video&quot;)@CrossOrigin // è·¨åŸŸpublic class EduVideoController &#123; @Autowired private EduVideoService videoService; // æ·»åŠ å°èŠ‚ @PostMapping(&quot;addVideo&quot;) public R addVideo(@RequestBody EduVideo eduVideo) &#123; videoService.save(eduVideo); return R.ok(); &#125; // åˆ é™¤å°èŠ‚ @DeleteMapping(&quot;&#123;videoId&#125;&quot;) public R deleteVideo(@PathVariable(&quot;videoId&quot;) String videoId) &#123; videoService.removeById(videoId); return R.ok(); &#125; // ä¿®æ”¹å°èŠ‚ @PostMapping(&quot;updateVideo&quot;) public R updateVideo(@RequestBody EduVideo eduVideo) &#123; videoService.updateById(eduVideo); return R.ok(); &#125; // æ ¹æ®å°èŠ‚idæŸ¥è¯¢å°èŠ‚ @GetMapping(&quot;getVideoInfo/&#123;videoId&#125;&quot;) public R getVideoInfo(@PathVariable(&quot;videoId&quot;) String videoId) &#123; EduVideo video = videoService.getById(videoId); return R.ok().data(&quot;videoInfo&quot;, video); &#125;&#125; å¢ã€åˆ ã€æ”¹å°èŠ‚ï¼ˆå‰ç«¯ï¼‰ï¼ˆå¾…å®Œå–„ï¼‰api123456789101112131415161718192021222324252627282930313233import request from &#x27;@/utils/request&#x27;export default &#123; // æ·»åŠ å°èŠ‚ addVideo(video) &#123; return request(&#123; url: `/eduservice/video/addVideo`, method: &#x27;post&#x27;, data: video &#125;) &#125;, // åˆ é™¤å°èŠ‚ deleteVideo(videoId) &#123; return request(&#123; url: `/eduservice/video/` + videoId, method: &#x27;delete&#x27;, &#125;) &#125;, // ä¿®æ”¹å°èŠ‚ updateVideo(video) &#123; return request(&#123; url: `/eduservice/video/updateVideo`, method: &#x27;post&#x27;, data: video &#125;) &#125;, // æ ¹æ®idè·å¾—å°èŠ‚ä¿¡æ¯ getVideoInfo(videoId) &#123; return request(&#123; url: `/eduservice/video/getVideoInfo/` + videoId, method: &#x27;get&#x27;, &#125;) &#125;&#125; vueæ¨¡æ¿ å’Œç« èŠ‚ç±»ä¼¼ï¼Œæœ‰ä¸€ä¸ªæ·»åŠ æˆ–è€…åˆ é™¤çš„å¼¹çª— 1234567891011121314151617181920212223242526272829303132333435&lt;!-- æ·»åŠ å’Œä¿®æ”¹å°èŠ‚è¡¨å• --&gt;&lt;el-dialog :visible.sync=&quot;dialogVideoFormVisible&quot; title=&quot;æ·»åŠ è¯¾æ—¶&quot;&gt; &lt;el-form :model=&quot;video&quot; label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;è¯¾æ—¶æ ‡é¢˜&quot;&gt; &lt;el-input v-model=&quot;video.title&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è¯¾æ—¶æ’åº&quot;&gt; &lt;el-input-number v-model=&quot;video.sort&quot; :min=&quot;0&quot; controls-position=&quot;right&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ˜¯å¦å…è´¹&quot;&gt; &lt;el-radio-group v-model=&quot;video.free&quot;&gt; &lt;el-radio :label=&quot;true&quot;&gt;å…è´¹&lt;/el-radio&gt; &lt;el-radio :label=&quot;false&quot;&gt;é»˜è®¤&lt;/el-radio&gt; &lt;/el-radio-group&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;ä¸Šä¼ è§†é¢‘&quot;&gt; &lt;!-- TODO --&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt; &lt;el-button @click=&quot;dialogVideoFormVisible = false&quot; &gt;å– æ¶ˆ&lt;/el-button &gt; &lt;el-button :disabled=&quot;saveVideoBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;saveOrUpdateVideo&quot; &gt;ç¡® å®š&lt;/el-button &gt; &lt;/div&gt;&lt;/el-dialog&gt; vueæ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354methods: &#123; // ++++++++++++++++++å°èŠ‚æ“ä½œ+++++++++++++++++++++ // æ‰“å¼€å°èŠ‚ç¼–è¾‘å¼¹æ¡† openEditVideo(id) &#123; // å¼¹æ¡† this.dialogVideoFormVisible = true // è®¾ç½®ç« èŠ‚id this.video.chapterId = id &#125;, // æ·»åŠ å°èŠ‚ addVideo() &#123; // è®¾ç½®è¯¾ç¨‹id this.video.courseId = this.courseId videoApi.addVideo(this.video).then(response =&gt; &#123; // å…³é—­å¼¹æ¡† this.dialogVideoFormVisible = false // æç¤º this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ å°èŠ‚æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getChapterVideo() &#125;) &#125;, // ä¿®æ”¹å°èŠ‚ updateVideo() &#123;&#125;, // åˆ é™¤å°èŠ‚ removeVideo(id) &#123; this.$confirm(&#x27;æ­¤æ“ä½œå°†åˆ é™¤å°èŠ‚, æ˜¯å¦ç»§ç»­?&#x27;, &#x27;æç¤º&#x27;, &#123; confirmButtonText: &#x27;ç¡®å®š&#x27;, cancelButtonText: &#x27;å–æ¶ˆ&#x27;, type: &#x27;warning&#x27; &#125;).then(() =&gt; &#123; // ç‚¹å‡»ç¡®å®šï¼Œæ‰§è¡Œthenæ–¹æ³• // è°ƒç”¨åˆ é™¤çš„æ–¹æ³• videoApi.deleteVideo(id).then(response =&gt; &#123; // åˆ é™¤æˆåŠŸ // æç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;åˆ é™¤å°èŠ‚æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°é¡µé¢ this.getChapterVideo() &#125;) &#125;) // ç‚¹å‡»å–æ¶ˆï¼Œæ‰§è¡Œcatchæ–¹æ³• &#125;, saveOrUpdateVideo() &#123; // å…ˆå†™addï¼Œå­¦äº†è§†é¢‘ä¸Šä¼ åœ¨ä¿®æ”¹ this.addVideo() &#125;, // ++++++++++++++++++å°èŠ‚æ“ä½œ+++++++++++++++++++++&#125;","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜2","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜2","date":"2021-09-21T07:51:30.374Z","updated":"2021-10-08T11:41:58.618Z","comments":true,"path":"2021/09/21/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-2/","link":"","permalink":"http://example.com/2021/09/21/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-2/","excerpt":"","text":"å‰ç«¯æŠ€æœ¯ç‚¹ç®€å•ä»‹ç» ä¸€ä¸‹æŠ€æœ¯ç‚¹è¯¦è§å…¶å®˜æ–¹æ–‡æ¡£æˆ–è€…è¯¾ä»¶ï¼Œæˆ‘å°±ç„äº†å‡ çœ¼ï¼Œä¹‹å‰å¤šå¤šå°‘å°‘ä¹Ÿå­¦è¿‡äº† ES6 Vue axios node.js babel æ¨¡å—åŒ– webpack æ­å»ºå‰ç«¯ç¯å¢ƒä¸æ¡†æ¶å¼€å‘è¿‡ç¨‹vscodeåˆ›å»ºå·¥ä½œåŒº æ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ ç”¨VSCodeæ‰“å¼€è¯¥æ–‡ä»¶å¤¹ é€‰æ‹©èœå•æ  æ–‡ä»¶ -&gt; å°†æ–‡ä»¶å¤¹å¦å­˜ä¸ºå·¥ä½œåŒº å³å¯ æµ‹è¯•è¿è¡Œnpm å¤åˆ¶templateæ–‡ä»¶å¤¹è‡³å·¥ä½œåŒº å®‰è£…ä¾èµ–npm install npm run devæµ‹è¯• config -&gt; index.js -&gt; useEslint = falseå…³é—­ä»£ç æ£€æŸ¥ vueé¡¹ç›®å®ç° src -&gt; router -&gt; index.js æ·»åŠ è·¯ç”± views -&gt; xxx -&gt; xxx.vue åˆ›å»ºvueé¡µé¢ api -&gt; xxx.js å®šä¹‰æ¥å£åœ°å€å’Œå‚æ•° åœ¨vueé¡µé¢å¼•å…¥jsæ–‡ä»¶ï¼Œè°ƒç”¨æ–¹æ³•å®ç°åŠŸèƒ½ ç”¨æˆ·ç™»å½•å’Œè·¨åŸŸï¼ˆåç«¯+å‰ç«¯ï¼‰ä¿®æ”¹BASE_APIï¼ˆè¯·æ±‚è·¯å¾„å‰ç¼€ï¼‰ config -&gt; dev.env.jsæ–‡ä»¶ 123456module.exports = merge(prodEnv, &#123; NODE_ENV: &#x27;&quot;development&quot;&#x27;, // BASE_API: &#x27;&quot;https://easy-mock.com/mock/5950a2419adc231f356a6636/vue-admin&quot;&#x27;, // æ³¨æ„è¿™é‡Œè¦ä½¿ç”¨http BASE_API: &#x27;&quot;http://localhost:8001&quot;&#x27;,&#125;) ç¼–å†™loginController å…ˆè·³è¿‡æ•°æ®åº“éªŒè¯ 12345678910111213141516171819202122232425262728293031package com.atguigu.eduservice.controller;import com.atguigu.commonutils.R;import io.swagger.annotations.Api;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@Api(&quot;åå°ç™»å½•&quot;)@RestController@RequestMapping(&quot;/eduservice/user&quot;)@CrossOrigin // è§£å†³è·¨åŸŸé—®é¢˜public class EduLoginController &#123; // ç™»å½• @PostMapping(&quot;login&quot;) public R login() &#123; // å…ˆè·³è¿‡éªŒè¯ // æ­¤å¤„tokenéœ€è¦ä¸å‰ç«¯å¯¹åº” return R.ok().data(&quot;token&quot;, &quot;admin&quot;); &#125; // è·å¾—ç”¨æˆ·æ•°æ® @GetMapping(&quot;info&quot;) public R info() &#123; return R.ok().data(&quot;roles&quot;, &quot;[admin]&quot;).data(&quot;name&quot;, &quot;admin&quot;).data(&quot;avatar&quot;, &quot;https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif&quot;); &#125; &#125; ä¿®æ”¹å‰ç«¯è®¿é—®è·¯å¾„ ä¿®æ”¹apiæ–‡ä»¶å¤¹ä¸‹çš„login.jsé‡Œçš„æ¥å£è·¯å¾„å³å¯ 123456789101112131415161718export function login(username, password) &#123; return request(&#123; url: &#x27;/eduservice/user/login&#x27;, method: &#x27;post&#x27;, data: &#123; username, password &#125; &#125;)&#125;export function getInfo(token) &#123; return request(&#123; url: &#x27;/eduservice/user/info&#x27;, method: &#x27;get&#x27;, params: &#123; token &#125; &#125;)&#125; è·¨åŸŸé—®é¢˜ è®¿é—®åœ°å€çš„æ—¶å€™ï¼Œä»¥ä¸‹ä»»ä½•ä¸€ä¸ªåœ°æ–¹ä¸åŒï¼Œä¼šäº§ç”Ÿè·¨åŸŸé—®é¢˜ï¼š è®¿é—®åè®® IPåœ°å€ ç«¯å£å· åœ¨åç«¯controlleræ¥å£ä¸Šæ·»åŠ æ³¨è§£@CrossOriginå³å¯ï¼ˆå¸¸ç”¨ï¼‰ ä½¿ç”¨ç½‘å…³è§£å†³ è®²å¸ˆç®¡ç†æ¨¡å—ï¼ˆå‰ç«¯ï¼‰è®²å¸ˆåˆ—è¡¨æ·»åŠ è·¯ç”± src\\router\\index.js -&gt; constantRouterMap -&gt; children -&gt; component 1234567891011121314151617181920212223242526export const constantRouterMap = [ // â€¦â€¦ &#123; path: &#x27;/teacher&#x27;, component: Layout, redirect: &#x27;/teacher/table&#x27;, name: &#x27;è®²å¸ˆç®¡ç†&#x27;, meta: &#123; title: &#x27;è®²å¸ˆç®¡ç†&#x27;, icon: &#x27;example&#x27; &#125;, children: [ &#123; path: &#x27;list&#x27;, name: &#x27;è®²å¸ˆåˆ—è¡¨&#x27;, component: () =&gt; import(&#x27;@/views/edu/teacher/list&#x27;), meta: &#123; title: &#x27;è®²å¸ˆåˆ—è¡¨&#x27;, icon: &#x27;table&#x27; &#125; &#125;, &#123; path: &#x27;save&#x27;, name: &#x27;æ·»åŠ è®²å¸ˆ&#x27;, component: () =&gt; import(&#x27;@/views/edu/teacher/save&#x27;), meta: &#123; title: &#x27;æ·»åŠ è®²å¸ˆ&#x27;, icon: &#x27;tree&#x27; &#125; &#125; ] &#125;, // â€¦â€¦ &#125; åˆ›å»ºå¹¶ç¼–å†™jsæ–‡ä»¶ï¼ˆè°ƒç”¨æ¥å£ï¼‰ src\\api\\edu\\teacher.js 12345678910111213141516import request from &#x27;@/utils/request&#x27;export default &#123; // æŸ¥è¯¢è®²å¸ˆåˆ—è¡¨ï¼ˆå¸¦æ¡ä»¶åˆ†é¡µï¼‰ getTeacherListPage(current, limit, teacherQuery) &#123; return request(&#123; // urlå¯ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½†æ˜¯æœ€å¥½ç”¨åå¼•å· url: `/eduservice/teacher/pageTeacherCondition/$&#123;current&#125;/$&#123;limit&#125;`, method: &#x27;post&#x27;, // åç«¯ä½¿ç”¨requestBodyè·å–teacherQueryï¼Œæ­¤æ—¶éœ€è¦ç”¨dataï¼ˆå°†teacherQueryè½¬æ¢ä¸ºJSONæ ¼å¼ä¼ è¾“ï¼‰ data: teacherQuery &#125;) &#125;&#125; åˆ›å»ºvueé¡µé¢ï¼Œé€šè¿‡æ¥å£è·å–æ•°æ® æ³¨æ„routerMapä¸­çš„å¯¹åº”å¯¹è±¡ï¼ˆå³åˆ›å»ºçš„routerï¼‰ä¸­componentå¯¹åº”çš„åœ°å€ï¼Œå°±æ˜¯vueç»„ä»¶çš„åœ°å€ï¼Œåœ¨è¯¥åœ°å€ä¸‹åˆ›å»ºvueæ–‡ä»¶ src\\views\\edu\\teacher\\list.vue 1234567891011121314151617181920212223242526272829303132333435363738&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt;è®²å¸ˆåˆ—è¡¨&lt;/div&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import teacher from &quot;@/api/edu/teacher.js&quot;; export default &#123; data() &#123; return &#123; list: null, // æŸ¥è¯¢æ¥å£ä¹‹åè·å¾—çš„åˆ—è¡¨ page: 1, // å½“å‰é¡µ limit: 10, // æ¯é¡µè®°å½•æ•° total: 0, // æ€»è®°å½•æ•° teacherQuery: &#123;&#125;, // æ¡ä»¶å€¼å¯¹è±¡ &#125;; &#125;, created() &#123; this.getList(); &#125;, methods: &#123; // è·å¾—è®²å¸ˆåˆ—è¡¨ getList() &#123; teacher .getTeacherListPage(this.page, this.limit, this.teacherQuery) .then((response) =&gt; &#123; // console.log(response); this.list = response.data.records; this.total = response.data.total; &#125;) .catch((error) =&gt; &#123; console.log(error); &#125;); &#125;, &#125;, &#125;;&lt;/script&gt; ç¼–å†™åˆ—è¡¨æ ¼å¼ä»£ç  ä½¿ç”¨element-uiè¡¨æ ¼å³å¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!-- è¡¨æ ¼ --&gt; &lt;el-table :data=&quot;list&quot; border fit highlight-current-row&gt; &lt;el-table-column label=&quot;åºå·&quot; width=&quot;70&quot; header-align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; (page - 1) * limit + scope.$index + 1 &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column prop=&quot;name&quot; label=&quot;åç§°&quot; width=&quot;80&quot; header-align=&quot;center&quot;/&gt; &lt;el-table-column label=&quot;å¤´è¡”&quot; width=&quot;80&quot; header-align=&quot;center&quot;&gt; &lt;!-- ä½¿ç”¨template slot-scope è¿›è¡Œåˆ¤æ–­æ˜¾ç¤º --&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; scope.row.level === 1 ? &quot;é«˜çº§è®²å¸ˆ&quot; : &quot;é¦–å¸­è®²å¸ˆ&quot; &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column prop=&quot;intro&quot; label=&quot;èµ„å†&quot; header-align=&quot;center&quot;/&gt; &lt;el-table-column prop=&quot;gmtCreate&quot; label=&quot;æ·»åŠ æ—¶é—´&quot; width=&quot;160&quot; header-align=&quot;center&quot;/&gt; &lt;el-table-column prop=&quot;sort&quot; label=&quot;æ’åº&quot; width=&quot;60&quot; header-align=&quot;center&quot;/&gt; &lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;200&quot; align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;router-link :to=&quot;&#x27;/teacher/edit/&#x27; + scope.row.id&quot;&gt; &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; &gt;ä¿®æ”¹&lt;/el-button &gt; &lt;/router-link&gt; &lt;el-button type=&quot;danger&quot; size=&quot;mini&quot; icon=&quot;el-icon-delete&quot; @click=&quot;removeDataById(scope.row.id)&quot; &gt;åˆ é™¤&lt;/el-button &gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;/el-table&gt; &lt;/div&gt;&lt;/template&gt; æ·»åŠ åˆ†é¡µæ¡ ä½¿ç”¨element-uiåˆ†é¡µå³å¯ 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!-- è¡¨æ ¼ --&gt; &lt;!-- åˆ†é¡µæ¡ --&gt; &lt;!-- @current-change=&quot;getList&quot; åªéœ€è¦å†™æ–¹æ³•åå³å¯ï¼Œè‡ªåŠ¨ä¼ å…¥éœ€è¦è·³è½¬çš„é¡µæ•° --&gt; &lt;el-pagination :current-page=&quot;page&quot; :page-size=&quot;limit&quot; :total=&quot;total&quot; style=&quot;padding: 30px 0; text-align: center&quot; layout=&quot;total, prev, pager, next, jumper&quot; @current-change=&quot;getList&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import teacher from &quot;@/api/edu/teacher.js&quot;; export default &#123; // â€¦â€¦ methods: &#123; // è·å¾—è®²å¸ˆåˆ—è¡¨ï¼Œpageé»˜è®¤ä¸º1 getList(page = 1) &#123; this.page = page; teacher .getTeacherListPage(this.page, this.limit, this.teacherQuery) .then((response) =&gt; &#123; // console.log(response); this.list = response.data.records; this.total = response.data.total; &#125;) .catch((error) =&gt; &#123; console.log(error); &#125;); &#125;, &#125;, &#125;;&lt;/script&gt; æ¡ä»¶æŸ¥è¯¢åˆ†é¡µ ä½¿ç”¨element-uiè¡¨å•å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!--æŸ¥è¯¢è¡¨å•--&gt; &lt;el-form :inline=&quot;true&quot; class=&quot;demo-form-inline&quot;&gt; &lt;el-form-item&gt; &lt;el-input v-model=&quot;teacherQuery.name&quot; placeholder=&quot;è®²å¸ˆå&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-select v-model=&quot;teacherQuery.level&quot; clearable placeholder=&quot;è®²å¸ˆå¤´è¡”&quot; &gt; &lt;el-option :value=&quot;1&quot; label=&quot;é«˜çº§è®²å¸ˆ&quot; /&gt; &lt;el-option :value=&quot;2&quot; label=&quot;é¦–å¸­è®²å¸ˆ&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ·»åŠ æ—¶é—´&quot;&gt; &lt;el-date-picker v-model=&quot;teacherQuery.begin&quot; type=&quot;datetime&quot; placeholder=&quot;é€‰æ‹©å¼€å§‹æ—¶é—´&quot; value-format=&quot;yyyy-MM-dd HH:mm:ss&quot; default-time=&quot;00:00:00&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item&gt; &lt;el-date-picker v-model=&quot;teacherQuery.end&quot; type=&quot;datetime&quot; placeholder=&quot;é€‰æ‹©æˆªæ­¢æ—¶é—´&quot; value-format=&quot;yyyy-MM-dd HH:mm:ss&quot; default-time=&quot;00:00:00&quot; /&gt; &lt;/el-form-item&gt; &lt;el-button type=&quot;primary&quot; icon=&quot;el-icon-search&quot; @click=&quot;getList()&quot; &gt;æŸ¥è¯¢&lt;/el-button &gt; &lt;el-button type=&quot;default&quot; @click=&quot;resetData()&quot;&gt;æ¸…ç©º&lt;/el-button&gt; &lt;/el-form&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import teacher from &quot;@/api/edu/teacher.js&quot;; export default &#123; methods: &#123; // è·å¾—è®²å¸ˆåˆ—è¡¨ï¼Œpageé»˜è®¤ä¸º1 getList(page = 1) &#123; &#125;, //æ¸…ç©ºè¡¨å•è¾“å…¥é¡¹æ•°æ® resetData() &#123; this.teacherQuery = &#123;&#125;; //æŸ¥è¯¢æ‰€æœ‰è®²å¸ˆæ•°æ® this.getList(); &#125;, &#125;, &#125;;&lt;/script&gt; åˆ é™¤è®²å¸ˆæ·»åŠ é¡µé¢ç»“æ„æŒ‰é’® è®°å¾—ç»‘å®šå¯¹åº”æ–¹æ³•å slotæ’æ§½ï¼ŒVue - slot-scope=â€scopeâ€ çš„æ„ä¹‰ - æ­¦å¡å¡ - åšå®¢å›­ (cnblogs.com) 12345678910111213141516171819&lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;200&quot; align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;router-link :to=&quot;&#x27;/teacher/edit/&#x27; + scope.row.id&quot;&gt; &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; &gt;ä¿®æ”¹&lt;/el-button &gt; &lt;/router-link&gt; &lt;el-button type=&quot;danger&quot; size=&quot;mini&quot; icon=&quot;el-icon-delete&quot; @click=&quot;removeDataById(scope.row.id)&quot; &gt;åˆ é™¤&lt;/el-button &gt; &lt;/template&gt;&lt;/el-table-column&gt; ç¼–å†™æ¥å£è°ƒç”¨æ–¹æ³• å…ˆå»apiæ–‡ä»¶å¤¹ä¸‹ç¼–å†™è°ƒç”¨æ¥å£çš„æ–¹æ³• teacher.js 12345678910111213import request from &#x27;@/utils/request&#x27;export default &#123; // æ ¹æ®idåˆ é™¤è®²å¸ˆ deleteTeacherById(id) &#123; return request(&#123; url: `/eduservice/teacher/$&#123;id&#125;`, method: &#x27;delete&#x27;, &#125;) &#125;&#125; ç¼–å†™æŒ‰é’®å¯¹åº”æ–¹æ³• ç¼–å†™æŒ‰é’®å¯¹åº”æ–¹æ³•ï¼Œè€ƒè™‘åˆ°ç”¨æˆ·ä½“éªŒï¼Œæ·»åŠ element-uiå¼¹æ¡†æç¤º 1234567891011121314151617181920212223242526272829303132removeDataById(id) &#123; this.$confirm(&#x27;æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥è®²å¸ˆè®°å½•, æ˜¯å¦ç»§ç»­?&#x27;, &#x27;æç¤º&#x27;, &#123; confirmButtonText: &#x27;ç¡®å®š&#x27;, cancelButtonText: &#x27;å–æ¶ˆ&#x27;, type: &#x27;warning&#x27; &#125;) .then(() =&gt; &#123; // è°ƒç”¨åˆ é™¤æ¥å£ teacher .deleteTeacherById(id) .then(response =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;åˆ é™¤æˆåŠŸ!&#x27; &#125;) // åˆ·æ–°åˆ—è¡¨ä¿¡æ¯ // å¦‚æœæ˜¯æœ€åä¸€é¡µæœ€åä¸€ä¸ªè®°å½•ï¼ˆtotal-(page-1)*limit == 1ï¼‰ if (this.total - (this.page - 1) * this.limit == 1) &#123; this.getList(this.page - 1) &#125; else &#123; this.getList(this.page) &#125; &#125;) &#125;) .catch(() =&gt; &#123; this.$message(&#123; type: &#x27;info&#x27;, message: &#x27;å·²å–æ¶ˆåˆ é™¤&#x27; &#125;) &#125;)&#125; å½“å‰é¡¹ç›®ç»“æ„ æ·»åŠ è®²å¸ˆæ·»åŠ é¡µé¢ç»“æ„ src\\views\\edu\\teacher\\save.vue 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;è®²å¸ˆåç§°&quot;&gt; &lt;el-input v-model=&quot;teacher.name&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®²å¸ˆæ’åº&quot;&gt; &lt;el-input-number v-model=&quot;teacher.sort&quot; controls-position=&quot;right&quot; min=&quot;0&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®²å¸ˆå¤´è¡”&quot;&gt; &lt;el-select v-model=&quot;teacher.level&quot; clearable placeholder=&quot;è¯·é€‰æ‹©&quot; &gt; &lt;el-option :value=&quot;1&quot; label=&quot;é«˜çº§è®²å¸ˆ&quot; /&gt; &lt;el-option :value=&quot;2&quot; label=&quot;é¦–å¸­è®²å¸ˆ&quot; /&gt; &lt;/el-select&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®²å¸ˆèµ„å†&quot;&gt; &lt;el-input v-model=&quot;teacher.career&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;è®²å¸ˆç®€ä»‹&quot;&gt; &lt;el-input v-model=&quot;teacher.intro&quot; :rows=&quot;10&quot; type=&quot;textarea&quot; /&gt; &lt;/el-form-item&gt; &lt;!-- è®²å¸ˆå¤´åƒï¼šTODO --&gt; &lt;el-form-item&gt; &lt;el-button :disabled=&quot;saveBtnDisabled&quot; type=&quot;primary&quot; @click=&quot;saveOrUpdate&quot; &gt;ä¿å­˜&lt;/el-button &gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import teacherApi from &#x27;@/api/edu/teacher.js&#x27; export default &#123; data() &#123; return &#123; teacher: &#123; name: &#x27;&#x27;, sort: 0, level: 1, career: &#x27;&#x27;, intro: &#x27;&#x27;, avatar: &#x27;&#x27; &#125;, saveBtnDisabled: false &#125; &#125;, created() &#123;&#125;, methods: &#123;&#125; &#125;&lt;/script&gt; ç¼–å†™æ¥å£è°ƒç”¨æ–¹æ³•12345678// æ·»åŠ è®²å¸ˆaddTeacher(teacher) &#123; return request(&#123; url: `/eduservice/teacher/addTeacher`, method: &#x27;post&#x27;, data: teacher &#125;)&#125; ç¼–å†™æŒ‰é’®å¯¹åº”æ–¹æ³•1234567891011121314151617181920212223242526272829303132333435363738&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import teacherApi from &#x27;@/api/edu/teacher.js&#x27; export default &#123; data() &#123; return &#123; teacher: &#123; name: &#x27;&#x27;, sort: 0, level: 1, career: &#x27;&#x27;, intro: &#x27;&#x27;, avatar: &#x27;&#x27; &#125;, saveBtnDisabled: false &#125; &#125;, created() &#123;&#125;, methods: &#123; // æ·»åŠ å’Œä¿®æ”¹ä½¿ç”¨åŒä¸€ä¸ªé¡µé¢ saveOrUpdate() &#123; this.saveTeacher() &#125;, saveTeacher() &#123; teacherApi.addTeacher(this.teacher).then(response =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ æˆåŠŸ!&#x27; &#125;) // è·¯ç”±è·³è½¬åˆ°åˆ—è¡¨é¡µé¢ this.$router.push(&#123; path: &#x27;/teacher/list&#x27; &#125;) &#125;) &#125; &#125; &#125;&lt;/script&gt; ä¼˜åŒ–è®²å¸ˆåˆ—è¡¨æ’åº æ ¹æ®æ·»åŠ æ—¶é—´é™åº 123456789101112131415@ApiOperation(&quot;å¤šæ¡ä»¶ç»„åˆåˆ†é¡µ&quot;)@PostMapping(&quot;pageTeacherCondition/&#123;current&#125;/&#123;limit&#125;&quot;)public R pageListTeacherCondition(@PathVariable long current, @PathVariable long limit, @RequestBody(required = false) TeacherQuery teacherQuery) &#123; // â€¦â€¦ // æ·»åŠ æ’åºæ¡ä»¶ wrapper.orderByDesc(&quot;gmt_create&quot;); // è°ƒç”¨serviceæ–¹æ³•å°†pageå¯¹è±¡æ ¹æ®æ¡ä»¶åˆ†é¡µ teacherService.page(pageTeacher, wrapper); // â€¦â€¦&#125; ä¿®æ”¹è®²å¸ˆç¼–å†™é¡µé¢ç»“æ„1234567891011121314151617181920&lt;el-table-column label=&quot;æ“ä½œ&quot; width=&quot;200&quot; align=&quot;center&quot;&gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;!-- routerè·³è½¬ --&gt; &lt;router-link :to=&quot;&#x27;/teacher/edit/&#x27; + scope.row.id&quot;&gt; &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; &gt;ä¿®æ”¹&lt;/el-button &gt; &lt;/router-link&gt; &lt;el-button type=&quot;danger&quot; size=&quot;mini&quot; icon=&quot;el-icon-delete&quot; @click=&quot;removeDataById(scope.row.id)&quot; &gt;åˆ é™¤&lt;/el-button &gt; &lt;/template&gt;&lt;/el-table-column&gt; éšè—è·¯ç”± æ­¤å¤„éœ€è¦é¢å¤–æ·»åŠ routerï¼Œä¸”ä¸æ˜¾ç¤º 123456789101112131415161718192021222324252627282930313233export const constantRouterMap = [&#123; path: &#x27;/teacher&#x27;, component: Layout, redirect: &#x27;/teacher/table&#x27;, name: &#x27;è®²å¸ˆç®¡ç†&#x27;, meta: &#123; title: &#x27;è®²å¸ˆç®¡ç†&#x27;, icon: &#x27;example&#x27; &#125;, children: [ &#123; path: &#x27;list&#x27;, name: &#x27;è®²å¸ˆåˆ—è¡¨&#x27;, component: () =&gt; import(&#x27;@/views/edu/teacher/list&#x27;), meta: &#123; title: &#x27;è®²å¸ˆåˆ—è¡¨&#x27;, icon: &#x27;table&#x27; &#125; &#125;, &#123; path: &#x27;save&#x27;, name: &#x27;æ·»åŠ è®²å¸ˆ&#x27;, component: () =&gt; import(&#x27;@/views/edu/teacher/save&#x27;), meta: &#123; title: &#x27;æ·»åŠ è®²å¸ˆ&#x27;, icon: &#x27;tree&#x27; &#125; &#125;, &#123; // å¸¦æœ‰idå‚æ•°ï¼Œï¼šä¸ºå ä½ç¬¦ path: &#x27;edit/:id&#x27;, name: &#x27;EduTeacherEdit&#x27;, // æ­¤å¤„è¿›å…¥çš„vueç»„ä»¶ä¸ºsave.vue component: () =&gt; import(&#x27;@/views/edu/teacher/save&#x27;), meta: &#123; title: &#x27;ç¼–è¾‘è®²å¸ˆ&#x27;, icon: &#x27;tree&#x27; &#125;, // ä¸æ˜¾ç¤ºè¯¥è·¯ç”± hidden: true &#125; ] &#125;,] æ•°æ®å›æ˜¾ ç¼–å†™åç«¯æ¥å£è°ƒç”¨æ–¹æ³• 1234567// æ ¹æ®idè·å–è®²å¸ˆä¿¡æ¯getTeacherInfo(id) &#123; return request(&#123; url: `/eduservice/teacher/getTeacher/$&#123;id&#125;`, method: &#x27;get&#x27;, &#125;)&#125; ç¼–å†™è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ³¨æ„è¦åœ¨éœ€è¦æ˜¾ç¤ºè¯¥ä¿¡æ¯çš„ç»„ä»¶ä¸­è°ƒç”¨è¯¥æ–¹æ³• 1234567891011121314151617181920&lt;script&gt;export default &#123; created() &#123; // åˆ¤æ–­å½“å‰è·¯å¾„æ˜¯å¦å«æœ‰idï¼Œæœ‰åˆ™ä¸ºä¿®æ”¹ï¼Œå¦åˆ™ä¸ºæ·»åŠ  if (this.$route.params &amp;&amp; this.$route.params.id) &#123; // ä»è·¯å¾„ä¸­è·å–å‚æ•°å€¼ const id = this.$route.params.id this.getTeacherInfo(id) &#125; &#125;, methods: &#123; // æ ¹æ®idè·å¾—è®²å¸ˆä¿¡æ¯ getTeacherInfo(id) &#123; teacherApi.getTeacherInfo(id).then(response =&gt; &#123; this.teacher = response.data.teacher &#125;) &#125; &#125;&#125;&lt;/script&gt; ä¿å­˜ä¿®æ”¹ ç¼–å†™åç«¯æ¥å£è°ƒç”¨æ–¹æ³• 12345678// ä¿®æ”¹è®²å¸ˆä¿¡æ¯updateTeacher(teacher) &#123; return request(&#123; url: `/eduservice/teacher/updateTeacher`, method: &#x27;post&#x27;, data: teacher &#125;)&#125; é¡µé¢è°ƒç”¨è¯¥æ–¹æ³•ï¼Œéœ€è¦åˆ¤æ–­æ˜¯ä¿®æ”¹è¿˜æ˜¯æ·»åŠ  123456789101112131415161718192021222324252627&lt;script&gt; export default &#123; methods: &#123; // æ·»åŠ å’Œä¿®æ”¹ä½¿ç”¨åŒä¸€ä¸ªé¡µé¢ saveOrUpdate() &#123; // åˆ¤æ–­æ˜¯å¦æœ‰id if (this.teacher.id) &#123; this.updateTeacher() &#125; else &#123; this.saveTeacher() &#125; &#125;, // ä¿®æ”¹è®²å¸ˆä¿¡æ¯ updateTeacher() &#123; teacherApi.updateTeacher(this.teacher).then(response =&gt; &#123; // æ˜¾ç¤ºæç¤ºä¿¡æ¯ this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;ä¿®æ”¹æˆåŠŸ!&#x27; &#125;) // è·¯ç”±è·³è½¬åˆ°åˆ—è¡¨é¡µé¢ this.$router.push(&#123; path: &#x27;/teacher/list&#x27; &#125;) &#125;) &#125; &#125; &#125;&lt;/script&gt; è·¯ç”±åˆ‡æ¢å­˜ç•™ä¿¡æ¯é—®é¢˜ æ„Ÿè°¢å¼¹å¹•æé†’ï¼Œä½¿ç”¨ç›‘å¬è·¯ç”±çš„æ–¹æ³•ï¼Œå¯ä»¥é˜²æ­¢å½“ç‚¹å‡»ä¿®æ”¹ååœ¨edité¡µé¢å†æ¬¡ç‚¹å‡»æ·»åŠ è®²å¸ˆï¼Œæ˜¾ç¤ºåçš„é¡µé¢ä»ç„¶ç•™å­˜è®²å¸ˆä¿¡æ¯çš„å°é—®é¢˜ 1234567891011121314151617181920212223242526&lt;script&gt; export default &#123; // ç›‘å¬ watch: &#123; // ç›‘å¬è·¯ç”±æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœæ˜¯åˆ™æ¸…é™¤å½“å‰é¡µé¢çš„æ•°æ® $route: &#123; handler: function(val, oldVal) &#123; this.resetData() &#125; &#125; &#125;, methods: &#123; // æ¸…ç©ºæ•°æ® resetData() &#123; this.teacher = &#123; name: &#x27;&#x27;, sort: 0, level: 1, career: &#x27;&#x27;, intro: &#x27;&#x27;, avatar: &#x27;&#x27; &#125; &#125; &#125; &#125;&lt;/script&gt; å¥½å§åŸæ¥ä¸‹ä¸€é›†å°±æŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼ŒåŸå› æ˜¯å¤šæ¬¡è·³è½¬è‡³åŒä¸€ä¸ªé¡µé¢createdé’©å­å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ ä»¥ä¸‹æ˜¯è€å¸ˆçš„æ–¹æ¡ˆ 1234567891011121314151617181920212223242526272829303132333435&lt;script&gt; export default &#123; // ç›‘å¬ watch: &#123; // ç›‘å¬è·¯ç”±æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœæ˜¯åˆ™æ¸…é™¤å½“å‰é¡µé¢çš„æ•°æ® $route(to, from) &#123; this.init() &#125; &#125;, created() &#123; // è¿™é‡Œå¯ä»¥ä¸ç”¨è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼Œå·²ç»è®¾ç½®äº†ç›‘å¬ this.init() &#125;, methods: &#123; // åˆå§‹åŒ– init() &#123; // åˆ¤æ–­å½“å‰è·¯å¾„æ˜¯å¦å«æœ‰idï¼Œæœ‰åˆ™ä¸ºä¿®æ”¹ï¼Œå¦åˆ™ä¸ºæ·»åŠ  if (this.$route.params &amp;&amp; this.$route.params.id) &#123; // ä»è·¯å¾„ä¸­è·å–å‚æ•°å€¼ const id = this.$route.params.id this.getTeacherInfo(id) &#125; else &#123; this.teacher = &#123; name: &#x27;&#x27;, sort: 0, level: 1, career: &#x27;&#x27;, intro: &#x27;&#x27;, avatar: &#x27;&#x27; &#125; &#125; &#125; &#125; &#125;&lt;/script&gt; nginx åå‘ä»£ç†æœåŠ¡å™¨ï¼ŒåŠŸèƒ½å¦‚ä¸‹ï¼š è¯·æ±‚è½¬å‘ è´Ÿè½½å‡è¡¡ åŠ¨é™åˆ†ç¦» åŸºç¡€å‘½ä»¤ å¯åŠ¨ï¼šnginx.exe å…³é—­ï¼šnginx.exe -s stop é‡å¯ï¼šnginx.exe -s reload é…ç½® nginx.confæ–‡ä»¶ä¸­é…ç½® ä¿®æ”¹ç¬¬ä¸€ä¸ªserverä¸‹çš„listenç«¯å£å· -&gt; 81 ï¼ˆæœ€å¥½æ”¹ä¸€ä¸‹ï¼‰ æ·»åŠ è‡ªå·±çš„serverï¼Œå…¶ä¸­listenç›‘å¬çš„ç«¯å£å·è¦å’Œå‰ç«¯configä¸­çš„ç«¯å£å·(BASE_PATH)å¯¹åº” ä¾‹å¦‚ç›¸å½“äºè®¿é—®9001ä¸‹çš„xxxï¼Œå°±ä¼šè½¬å‘åˆ°8001ä¸‹çš„xxxæˆ–è€…å…¶ä»– 1234567891011121314server &#123; listen 9001; server_name localhost; location ~ /eduservice/ &#123; proxy_pass http://localhost:8001; &#125; location ~ /eduoss/ &#123; proxy_pass http://localhost:8002; &#125; location ~ /eduvod/ &#123; proxy_pass http://localhost:8003; &#125;&#125; è®°å¾—ä¿®æ”¹å‰ç«¯ä¸­çš„BASE_PATHå’Œç›‘å¬ç«¯å£ä¸€è‡´ æµ‹è¯• applicationå’Œnpméƒ½æ‰“å¼€ï¼Œå‰ç«¯æµ‹è¯•ä¸€ä¸‹ï¼ŒæŸ¥çœ‹networkä¸­çš„headeræ˜¯å¦ä¸ºnginxä¸­çš„ç›‘å¬ç«¯å£å· ä¸Šä¼ å¤´åƒåŠŸèƒ½ï¼ˆåç«¯+å‰ç«¯ï¼‰é˜¿é‡Œäº‘OSS ç®€å•æ¥è¯´ï¼šè§£å†³æµ·é‡æ•°æ®å­˜å‚¨ä¸å¼¹æ€§æ‰©å®¹ ç®€å•å…¥é—¨ å¼€é€šå°±èƒ½è¿›æ§åˆ¶å°äº† åˆ›å»ºbucket æ–‡ä»¶ç®¡ç†ä¸­å¯ä»¥è¿›è¡Œä¸Šä¼ æ–‡ä»¶ç­‰æ“ä½œ åˆ›å»ºaccess keyè·å¾—idå’Œç§˜é’¥ å°å°çš„åæ§½ï¼šå½“å¤©ç»™æˆ‘çš„è´¦æˆ·é‡Œå……äº†1rmbï¼ˆå·¨é¢ï¼Œç¡®ä¿¡ï¼‰ï¼Œé…ç½®äº†ä¸€äº›OSSçš„ä¸œè¥¿ï¼Œç¬¬äºŒå¤©å°±æ¥äº†ä¸ªä¸“å±å®¢æœæ‰“ç”µè¯ç»™æˆ‘ï¼Œå‘æˆ‘ä»‹ç»å„ç§äº§å“ï¼ˆä¸Šæ¬¡åˆšæ³¨å†Œçš„æ—¶å€™ä¹Ÿç»™æˆ‘æ‰“äº†ç”µè¯ï¼Œé‡Œé¢çš„å°å§å§è¯´è¯éƒ½å¥½å¥½å¬ï¼‰æœåŠ¡å¤ªçƒ­æƒ…äº†ï¼ åç«¯é˜¿é‡Œäº‘OSSæ­å»º å»å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹è¯¦ç»†ä»‹ç» å¿«é€Ÿå…¥é—¨ (aliyun.com) åˆ›å»ºå¯¹åº”å­æ¨¡å— serviceæ¨¡å— -&gt; service_osså­æ¨¡å—å³å¯ å¼•å…¥ä¾èµ–12345678910111213&lt;dependencies&gt; &lt;!-- é˜¿é‡Œäº‘ossä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- æ—¥æœŸå·¥å…·æ ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;joda-time&lt;/groupId&gt; &lt;artifactId&gt;joda-time&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½®application.properties aliyun.oss.fileåé…ç½®é˜¿é‡Œäº‘OSSå’ŒAccessKeyç›¸å…³ä¿¡æ¯ 1234567server.port=8002spring.application.name=service-ossspring.profiles.active=devaliyun.oss.file.endpoint=oss-cn-beijing.aliyuncs.comaliyun.oss.file.keyid=aliyun.oss.file.keysecret=aliyun.oss.file.bucketname=demo-edu-guli åˆ›å»ºå¯åŠ¨ç±»12345678910111213package com.atguigu.oss;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.context.annotation.ComponentScan;@SpringBootApplication@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)public class OssApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(OssApplication.class, args); &#125;&#125; ç”±äºåªä½¿ç”¨ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸éœ€è¦æ“ä½œæ•°æ®åº“ï¼Œéœ€è¦é…ç½®é»˜è®¤ä¸åŠ è½½æ•°æ®åº“ï¼ˆå¦åˆ™ä¼šæŠ¥é”™ï¼‰ 1@SpringBootApplication(exclude = DataSourceAutoConfiguration.class) // excludeæ’é™¤è¿™ä¸ªæ•°æ®æºé…ç½®ç±» ç¼–å†™å¸¸é‡ç±» ç”¨äºè·å–é…ç½®æ–‡ä»¶ä¸­çš„å¸¸é‡ 123456789101112131415161718192021222324252627282930313233package com.atguigu.oss.utils;import org.springframework.beans.factory.InitializingBean;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Component;@Componentpublic class ConstantPropertiesUtils implements InitializingBean &#123; // è¯»å–é…ç½®æ–‡ä»¶å†…å®¹ @Value(&quot;$&#123;aliyun.oss.file.endpoint&#125;&quot;) // è‡ªåŠ¨å±æ€§æ³¨å…¥(æ³¨æ„æ­¤å¤„å±æ€§åè¦ä¸propertiesæ–‡ä»¶ä¸­çš„åå­—å¯¹åº”) private String endpoint; @Value(&quot;$&#123;aliyun.oss.file.keyid&#125;&quot;) private String keyid; @Value(&quot;$&#123;aliyun.oss.file.keysecret&#125;&quot;) private String keysecret; @Value(&quot;$&#123;aliyun.oss.file.bucketname&#125;&quot;) private String bucketname; // å®šä¹‰å…¬å¼€é™æ€å¸¸é‡ public static String END_POINT; public static String ACCESS_KEY_ID; public static String ACCESS_KEY_SECRET; public static String BUCKET_NAME; // å½“åˆå§‹åŒ–propertieså®Œæˆåè¯¥æ–¹æ³•ä¼šæ‰§è¡Œ @Override public void afterPropertiesSet() throws Exception &#123; END_POINT = endpoint; ACCESS_KEY_ID = keyid; ACCESS_KEY_SECRET = keysecret; BUCKET_NAME = bucketname; &#125;&#125; ç¼–å†™Controller å®ç°æ–‡ä»¶è·å–å’Œå›ä¼ urlå’Œé¡µé¢è·³è½¬ 123456789101112131415161718192021222324252627package com.atguigu.oss.controller;import com.atguigu.commonutils.R;import com.atguigu.oss.service.OssService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import org.springframework.web.multipart.MultipartFile;@RestController@RequestMapping(&quot;/eduoss/fileoss&quot;)@CrossOrigin // è§£å†³è·¨åŸŸpublic class OssController &#123; @Autowired private OssService ossService; // ä¸Šä¼ å¤´åƒ @PostMapping() public R uploadOssFile(MultipartFile file) &#123; // è·å–åˆ°ä¸Šä¼ çš„æ–‡ä»¶(MultipartFile) String url = ossService.uploadFileAvatar(file); return R.ok().data(&quot;url&quot;, url); &#125; &#125; ä¸»è¦ä¸šåŠ¡é€»è¾‘ç¼–å†™ç¼–å†™Serviceå®ç°ç±» å…ˆåˆ›å»ºæ¥å£å’Œå®ç°ç±»ï¼Œå®ç°ç±»ä¸­å®ç°ä¸Šä¼ ä¸šåŠ¡ 1234567891011121314151617181920212223242526272829303132333435363738394041package com.atguigu.oss.service.impl;import com.aliyun.oss.OSS;import com.aliyun.oss.OSSClientBuilder;import com.atguigu.oss.service.OssService;import com.atguigu.oss.utils.ConstantPropertiesUtils;import org.springframework.stereotype.Service;import org.springframework.web.multipart.MultipartFile;import java.io.IOException;@Servicepublic class OssServiceImpl implements OssService &#123; @Override public String uploadFileAvatar(MultipartFile file) &#123; // ç®€å•ä¸Šä¼ æ–‡ä»¶æ ¼å¼ï¼ˆossæ–‡æ¡£ä¿®æ”¹å³å¯ï¼‰ String endpoint = ConstantPropertiesUtils.END_POINT; String accessKeyId = ConstantPropertiesUtils.ACCESS_KEY_ID; String accessKeySecret = ConstantPropertiesUtils.ACCESS_KEY_SECRET; String bucketName = ConstantPropertiesUtils.BUCKET_NAME; String fileName = file.getOriginalFilename(); // åˆ›å»ºOSSClientå®ä¾‹ã€‚ OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret); // ä¸Šä¼ æ–‡ä»¶ try &#123; //ä¾æ¬¡å¡«å†™Bucketåç§°ã€Objectå®Œæ•´è·¯å¾„ï¼ˆæ–‡ä»¶è·¯å¾„+æ–‡ä»¶åç§°ï¼‰ã€æ–‡ä»¶æµã€‚Objectå®Œæ•´è·¯å¾„ä¸­ä¸èƒ½åŒ…å«Bucketåç§°ã€‚ ossClient.putObject(bucketName, fileName, file.getInputStream()); // æ‹¼æ¥ossä¸­æ–‡ä»¶è·¯å¾„ String url = &quot;https://&quot; + bucketName + &quot;.&quot; + endpoint + &quot;/&quot; + fileName; return url; &#125; catch (IOException e) &#123; e.printStackTrace(); return null; &#125; finally &#123; // å…³é—­OSSClientã€‚ ossClient.shutdown(); &#125; &#125;&#125; å®Œå–„Service é˜²æ­¢æ–‡ä»¶åé‡å¤ 123456// ä¸ºæ–‡ä»¶åæ·»åŠ å”¯ä¸€çš„å€¼String uuid = UUID.randomUUID().toString().replaceAll(&quot;-&quot;, &quot;&quot;);fileName = uuid + fileName;// å°†æ–‡ä»¶è¿›è¡Œåˆ†ç±»ç®¡ç†,æŒ‰ç…§æ—¥æœŸåˆ†ç±»ï¼Œä½¿ç”¨å·¥å…·ç±»String datePath = new DateTime().toString(&quot;yyyy/MM/dd&quot;);fileName = datePath + &quot;/&quot; + fileName; ä¸Šä¼ å¤´åƒåŠŸèƒ½ï¼ˆå‰ç«¯ï¼‰æ·»åŠ é¡µé¢ç»“æ„ element-UIé‡Œæœ‰ç›¸å…³ç»„ä»¶ï¼ˆImageCropperã€PanThumbï¼‰ï¼Œcvå³å¯ æ³¨æ„è¦æŠŠç»„ä»¶å¤åˆ¶åˆ°conponentsé‡Œ æ³¨æ„ä¿®æ”¹image-cropperä¸­ç»‘å®šçš„urlã€filedä¸­å±æ€§å€¼è¦ä¸åç«¯æ¥å£æ–¹æ³•ä¸­å‚æ•°åå¯¹åº” åœ¨æ·»åŠ è®²å¸ˆçš„é¡µé¢æ·»åŠ å¦‚ä¸‹æ ‡ç­¾åŠä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;!-- è®²å¸ˆå¤´åƒ --&gt; &lt;el-form-item label=&quot;è®²å¸ˆå¤´åƒ&quot;&gt; &lt;!-- å¤´è¡”ç¼©ç•¥å›¾ --&gt; &lt;pan-thumb :image=&quot;teacher.avatar&quot; /&gt; &lt;!-- æ–‡ä»¶ä¸Šä¼ æŒ‰é’® --&gt; &lt;el-button type=&quot;primary&quot; icon=&quot;el-icon-upload&quot; @click=&quot;imagecropperShow = true&quot; &gt;æ›´æ¢å¤´åƒ &lt;/el-button&gt; &lt;!-- v-showï¼šæ˜¯å¦æ˜¾ç¤ºä¸Šä¼ ç»„ä»¶ :keyï¼šç±»ä¼¼äºidï¼Œå¦‚æœä¸€ä¸ªé¡µé¢å¤šä¸ªå›¾ç‰‡ä¸Šä¼ æ§ä»¶ï¼Œå¯ä»¥åšåŒºåˆ† :urlï¼šåå°ä¸Šä¼ çš„urlåœ°å€ @closeï¼šå…³é—­ä¸Šä¼ ç»„ä»¶ @crop-upload-successï¼šä¸Šä¼ æˆåŠŸåçš„å›è°ƒ &lt;input type=&quot;file&quot; name=&quot;file&quot;/&gt; --&gt; &lt;image-cropper v-show=&quot;imagecropperShow&quot; :width=&quot;300&quot; :height=&quot;300&quot; :key=&quot;imagecropperKey&quot; :url=&quot;BASE_API + &#x27;/eduoss/fileoss&#x27;&quot; field=&quot;file&quot; @close=&quot;close&quot; @crop-upload-success=&quot;cropSuccess&quot; /&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // ä¸Šä¼ å¤´åƒæ‰€éœ€ç»„ä»¶ import ImageCropper from &#x27;@/components/ImageCropper&#x27; import PanThumb from &#x27;@/components/PanThumb&#x27; export default &#123; // å£°æ˜ç»„ä»¶ components: &#123; ImageCropper, PanThumb &#125;, data() &#123; return &#123; // ä¸Šä¼ å¼¹æ¡†ç»„ä»¶æ˜¯å¦æ˜¾ç¤º imagecropperShow: false, // ä¸Šä¼ ç»„ä»¶keyå€¼ imagecropperKey: 0, // è·å–æ¥å£APIï¼Œå›ºå®šå†™æ³• BASE_API: process.env.BASE_API &#125; &#125;, methods: &#123; // å…³é—­ä¸Šä¼ å¼¹æ¡† close() &#123;&#125;, // ä¸Šä¼ æˆåŠŸ cropSuccess() &#123;&#125; &#125; &#125;&lt;/script&gt; ä½¿ç”¨ç»„ä»¶ importä»¥åŠå£°æ˜å³å¯ 123456789&lt;script&gt; // ä¸Šä¼ å¤´åƒæ‰€éœ€ç»„ä»¶ import ImageCropper from &#x27;@/components/ImageCropper&#x27; import PanThumb from &#x27;@/components/PanThumb&#x27; export default &#123; // å£°æ˜ç»„ä»¶ components: &#123; ImageCropper, PanThumb &#125;, &#125;&lt;/script&gt; ç¼–å†™æŒ‰é’®æ–¹æ³•1234567891011// å…³é—­ä¸Šä¼ å¼¹æ¡†close() &#123; this.imagecropperShow = false // ä¸Šä¼ ç»„ä»¶åˆå§‹åŒ– this.imagecropperKey = this.imagecropperKey + 1&#125;,// ä¸Šä¼ æˆåŠŸ(è·å¾—å¤´åƒurlå¹¶æ˜¾ç¤º)cropSuccess(data) &#123; this.teacher.avatar = data.url this.close()&#125; æµ‹è¯•ï¼ŒæŠ¥é”™ä¸è§£å†³âœ… æŠ¥äº†ä¸€ä¸ªé”™ï¼Œæ˜¾ç¤ºä¸Šä¼ å¤±è´¥ï¼Œå»çœ‹networké‡Œçš„è¯·æ±‚URLé‡Œçš„åœ°å€ä¸å¯¹ï¼Œä¸­é—´å¤šäº†ä¸€ä¸ªundefinedï¼Œæƒ³åˆ°å¯èƒ½å˜é‡åå†™é”™äº†ï¼Œç¨å¾®å¯¹æ¯”äº†ä¸€ä¸‹ï¼ŒBASE_APIå†™æˆBASE_PATHäº†ï¼Œæ”¹äº†å°±å¯ä»¥äº† è¯¾ç¨‹åˆ†ç±»ç®¡ç†æ¨¡å—ï¼ˆåç«¯+å‰ç«¯ï¼‰ è®°å¾—å…ˆå¯¼å…¥æ•°æ®åº“ æ·»åŠ ä½¿ç”¨ä¸Šä¼ excelæ–‡ä»¶çš„å½¢å¼ EasyExcelå…¥é—¨ EasyExcel Â· è¯­é›€ (yuque.com) è®°å¾—å¼•å…¥ä¾èµ–åæ ‡ï¼ŒåŒæ—¶éœ€è¦poiçš„ï¼Œä¸è¿‡çˆ¶æ¨¡å—å·²ç»å¼•å…¥äº† 1234567891011121314151617181920212223242526&lt;!-- EasyExcelä¾èµ– --&gt;&lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/com.alibaba/easyexcel --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;easyexcel&lt;/artifactId&gt; &lt;version&gt;2.1.1&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; &lt;!--ä»¥ä¸‹æ˜¯çˆ¶æ¨¡å—ä¸­çš„ç›¸å…³ä¾èµ–--&gt; &lt;!--xls--&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;&lt;/dependency&gt; å†™Excel å…ˆåˆ›å»ºå®ä½“ç±»ï¼ˆä¸€çº§åˆ†ç±»ã€äºŒçº§åˆ†ç±»ï¼‰ å±æ€§éœ€è¦å…¨å°å†™ 12345678@Datapublic class DemoData &#123; // å®ä½“ç±»ï¼Œå…¶ä¸­å±æ€§å’ŒExcelè¡¨æ ¼å¯¹åº” @ExcelProperty(&quot;å­¦ç”Ÿç¼–å·&quot;) // è¯¥æ³¨é‡Šç”¨äºå®šä¹‰è¡¨å¤´ private Integer sno; @ExcelProperty(&quot;å­¦ç”Ÿå§“å&quot;) private String sname;&#125; æµ‹è¯•ä»£ç  12345678910111213141516171819202122public class TestEasyExcel &#123; public static void main(String[] args) &#123; // å†™Excel // 1ã€è®¾ç½®æ–‡ä»¶åœ°å€å’Œåç§° String filename = &quot;D:\\\\MyProject\\\\excel\\\\test.xlsx&quot;; // è°ƒç”¨easyExcelæ–¹æ³•å†™å…¥, å¯ä»¥è®¾ç½®sheet, æ‰§è¡ŒdoWriteä¼ å…¥æ•°æ® EasyExcel.write(filename, DemoData.class).sheet(&quot;å­¦ç”Ÿåˆ—è¡¨&quot;).doWrite(getData()); &#125; private static List&lt;DemoData&gt; getData() &#123; List&lt;DemoData&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) &#123; DemoData data = new DemoData(); data.setSname(&quot;aaa&quot; + i); data.setSno(i); list.add(data); &#125; return list; &#125;&#125; è¯»Excel ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å®ä½“ç±» 12345678@Datapublic class DemoData &#123; // å®ä½“ç±»ï¼Œå…¶ä¸­å±æ€§å’ŒExcelè¡¨æ ¼å¯¹åº” @ExcelProperty(value = &quot;å­¦ç”Ÿç¼–å·&quot;, index = 0) // è¯¥æ³¨é‡Šç”¨äºå®šä¹‰è¡¨å¤´ private Integer sno; @ExcelProperty(value = &quot;å­¦ç”Ÿå§“å&quot;, index = 1) // indexæ ‡è®°ç¬¬å‡ åˆ—ï¼Œè¯»æ“ä½œéœ€è¦ private String sname;&#125; åˆ›å»ºç›‘å¬å™¨å¯¹excelæ–‡ä»¶çš„è¯»å–ï¼ˆä¸€è¡Œä¸€è¡Œçš„è¯»å–éœ€è¦ï¼‰ 1234567891011121314151617181920// ç›‘å¬å™¨public class ExcelListener extends AnalysisEventListener&lt;DemoData&gt; &#123; // è¯»å–è¡Œæ•°æ®åˆ°å®ä½“ç±»å¯¹è±¡ä¸­ @Override public void invoke(DemoData demoData, AnalysisContext analysisContext) &#123; System.out.println(&quot;*****&quot; + demoData + &quot;*****&quot;); &#125; // è¯»å–å®Œæˆä¹‹åæ‰§è¡Œ @Override public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123; &#125; // è¯»å–è¡¨å¤´å†…å®¹ @Override public void invokeHeadMap(Map&lt;Integer, String&gt; headMap, AnalysisContext context) &#123; System.out.println(&quot;è¡¨å¤´ï¼š&quot; + headMap); &#125;&#125; æµ‹è¯•ä»£ç  12String filename = &quot;D:\\\\MyProject\\\\excel\\\\test.xlsx&quot;;EasyExcel.read(filename, DemoData.class, new ExcelListener()).sheet().doRead(); ä»£ç ç”Ÿæˆå™¨ å…ˆç”Ÿæˆentityã€serviceã€mapperã€controllerå†è¯´ æ“ä½œè¿˜æ˜¯ä¸€æ ·ï¼Œè¯¦ç»†ä»£ç è§1ï¼Œåªéœ€è¦ä¿®æ”¹è¡¨åè¿è¡Œå³å¯ 12// ä¸€åŠä¸åŒæ¨¡å—éœ€è¦ä¿®æ”¹çš„åœ°æ–¹å°±æ˜¯è¡¨åstrategy.setInclude(&quot;edu_subject&quot;); //åŠ è½½è¡¨ è®°å¾—ä¸ºè‡ªåŠ¨ç”Ÿæˆçš„å®ä½“ç±»æ·»åŠ è‡ªåŠ¨å¡«å……ï¼ˆ@TableField(fill = FieldFill.INSERT)ç­‰ï¼‰çš„æ³¨è§£ æ³¨æ„controlleræ·»åŠ æ³¨é‡Š@CrossOriginè§£å†³è·¨åŸŸ æ·»åŠ è¯¾ç¨‹åˆ†ç±»ï¼ˆåç«¯ï¼‰åˆ›å»ºè¡¨æ ¼å®ä½“ç±»12345678910111213/** * subjectè¡¨æ ¼å®ä½“ç±» */@Datapublic class SubjectData &#123; @ExcelProperty(index = 0) private String oneSubjectName; @ExcelProperty(index = 1) private String twoSubjectName;&#125; ç¼–å†™service123456789101112131415@Servicepublic class EduSubjectServiceImpl extends ServiceImpl&lt;EduSubjectMapper, EduSubject&gt; implements EduSubjectService &#123; @Override public void saveSubject(MultipartFile file) &#123; try &#123; // è·å¾—æ–‡ä»¶è¾“å…¥æµ InputStream inputStream = file.getInputStream(); // è°ƒç”¨æ–¹æ³•è¯»å– EasyExcel.read(inputStream, SubjectData.class, new SubjectExcelListener()).sheet().doRead(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; ç¼–å†™ç›‘å¬å™¨ æ³¨æ„DataListener ä¸èƒ½è¢«springç®¡ç†ï¼ˆå®˜æ–¹è¯´çš„ï¼‰ï¼Œå¦‚æœä½¿ç”¨springéœ€è¦ä½¿ç”¨ç‰¹å®šæ„é€ å™¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465package com.atguigu.eduservice.listener;import com.alibaba.excel.context.AnalysisContext;import com.alibaba.excel.event.AnalysisEventListener;import com.atguigu.eduservice.entity.EduSubject;import com.atguigu.eduservice.entity.excel.SubjectData;import com.atguigu.eduservice.service.EduSubjectService;import com.atguigu.servicebase.ExceptionHandler.GuliException;import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;public class SubjectExcelListener extends AnalysisEventListener&lt;SubjectData&gt; &#123; public EduSubjectService subjectService; public SubjectExcelListener() &#123; &#125; // å½“newå½“å‰å¯¹è±¡çš„æ—¶å€™åŒæ—¶æ³¨å…¥service public SubjectExcelListener(EduSubjectService subjectService) &#123; this.subjectService = subjectService; &#125; // è¯»å–excelå†…å®¹ï¼Œå†™å…¥æ•°æ®åº“ @Override public void invoke(SubjectData subjectData, AnalysisContext analysisContext) &#123; if (subjectData == null) &#123; throw new GuliException(20001, &quot;æ–‡ä»¶æ•°æ®ä¸ºç©º&quot;); &#125; // æ·»åŠ ä¸€çº§åˆ†ç±»ï¼Œå…ˆåˆ¤æ–­ä¸€çº§åˆ†ç±»æ˜¯å¦å·²ç»å­˜åœ¨ EduSubject existOneSubject = this.existSubject(subjectData.getOneSubjectName(), &quot;0&quot;); if (existOneSubject == null) &#123; // æ­¤æ—¶æ²¡æœ‰ç›¸åŒçš„ä¸€çº§åˆ†ç±»ï¼Œéœ€è¦æ·»åŠ  EduSubject eduSubject = new EduSubject(); eduSubject.setParentId(&quot;0&quot;); eduSubject.setTitle(subjectData.getOneSubjectName()); subjectService.save(eduSubject); &#125; else &#123; //æ·»åŠ äºŒçº§åˆ†ç±»ï¼Œå…ˆåˆ¤æ–­ EduSubject eduTwoSubject = this.existSubject(subjectData.getTwoSubjectName(), existOneSubject.getId()); if (eduTwoSubject == null) &#123; // æ­¤æ—¶æ²¡æœ‰ç›¸åŒçš„ä¸€çº§åˆ†ç±»ï¼Œéœ€è¦æ·»åŠ  EduSubject eduSubject = new EduSubject(); eduSubject.setParentId(existOneSubject.getId()); eduSubject.setTitle(subjectData.getTwoSubjectName()); subjectService.save(eduSubject); &#125; &#125; &#125; @Override public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123; &#125; // ç”¨äºåˆ¤æ–­åˆ†ç±»æ˜¯å¦å­˜åœ¨ public EduSubject existSubject(String title, String pid) &#123; // æ·»åŠ æŸ¥è¯¢æ¡ä»¶ QueryWrapper&lt;EduSubject&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq(&quot;title&quot;, title); // pid=0ä¸ºä¸€çº§åˆ†ç±» wrapper.eq(&quot;parent_id&quot;, pid); return subjectService.getOne(wrapper); &#125;&#125; åŒæ—¶ä¿®æ”¹ä¸€ä¸‹serviceä¸­æ–¹æ³•çš„å‚æ•° å…¶å®è¿™é‡Œæœ‰ç‚¹å¥‡æ€ªï¼Œlisteneråšäº†ä¸»è¦ä¸šåŠ¡é€»è¾‘ï¼Œç­‰åšå®Œäº†å†è¯•è¯•åˆ«çš„æ–¹æ³• ç¼–å†™controller1234567891011121314151617@RestController@RequestMapping(&quot;/eduservice/subject&quot;)@CrossOriginpublic class EduSubjectController &#123; @Autowired private EduSubjectService subjectService; // æ·»åŠ è¯¾ç¨‹åˆ†ç±» // è·å–ä¸Šä¼ è¿‡æ¥çš„æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶å†…å®¹è¯»å–å‡ºæ¥å³å¯ @PostMapping(&quot;addSubject&quot;) public R addSubject(MultipartFile file) &#123; // è·å¾—ä¸Šä¼ è¿‡æ¥çš„excelæ–‡ä»¶ subjectService.saveSubject(file, subjectService); return R.ok(); &#125;&#125; æµ‹è¯•ï¼ŒæŠ¥é”™ä¸è§£å†³âœ… swaggeræˆåŠŸï¼Œåå°æŠ¥é”™ï¼Œçœ‹äº†ä¸‹è¯´gtm_timeæ²¡æœ‰é»˜è®¤å€¼ï¼Œç„¶åæƒ³åˆ°è‡ªåŠ¨æ³¨å…¥å¯èƒ½æ²¡åŠ ï¼Œæœç„¶ã€‚ ç„¶åæ˜¯èƒ½å¤Ÿå†™å…¥æ•°æ®åº“äº†ä½†æ˜¯ä¸€çº§å†™åˆ°äºŒçº§å»äº†ï¼Œçœ‹äº†ä¸‹æ˜¯æ·»åŠ äºŒçº§åˆ†ç±»çš„æ—¶å€™çš„getæ–¹æ³•æˆgetOneSubjectNameè€Œä¸æ˜¯getTwoSubjectNameï¼Œæ”¹ä¸€ä¸‹å°±è§£å†³äº† æ·»åŠ è¯¾ç¨‹åˆ†ç±»ï¼ˆå‰ç«¯ï¼‰é…ç½®router src -&gt; router -&gt; index.js å½“ä¸­æ·»åŠ å³å¯ 12345678910111213141516171819202122// è¯¾ç¨‹ç®¡ç†æ¨¡å—è·¯ç”± &#123; path: &#x27;/subject&#x27;, component: Layout, redirect: &#x27;/subject/list&#x27;, name: &#x27;è¯¾ç¨‹åˆ†ç±»ç®¡ç†&#x27;, meta: &#123; title: &#x27;è¯¾ç¨‹åˆ†ç±»ç®¡ç†&#x27;, icon: &#x27;example&#x27; &#125;, children: [ &#123; path: &#x27;list&#x27;, name: &#x27;è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨&#x27;, component: () =&gt; import(&#x27;@/views/edu/subject/list&#x27;), meta: &#123; title: &#x27;è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨&#x27;, icon: &#x27;tree&#x27; &#125; &#125;, &#123; path: &#x27;save&#x27;, name: &#x27;æ·»åŠ è¯¾ç¨‹åˆ†ç±»&#x27;, component: () =&gt; import(&#x27;@/views/edu/subject/add&#x27;), meta: &#123; title: &#x27;æ·»åŠ è¯¾ç¨‹åˆ†ç±»&#x27;, icon: &#x27;table&#x27; &#125; &#125;, ] &#125;, ç¼–å†™æ·»åŠ è¯¾ç¨‹åˆ†ç±»è§†å›¾ element-ui ä¸­ cvä¸€ä¸‹ï¼ˆæ–‡ä»¶ä¸Šä¼ ç›¸å…³ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;ä¿¡æ¯æè¿°&quot;&gt; &lt;el-tag type=&quot;info&quot;&gt;excelæ¨¡ç‰ˆè¯´æ˜&lt;/el-tag&gt; &lt;el-tag&gt; &lt;i class=&quot;el-icon-download&quot; /&gt; &lt;!-- è¿™é‡Œæ¨¡æ¿æ”¾åœ¨äº†æœ¬åœ°staticæ–‡ä»¶å¤¹é‡Œï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨OSSå½“ä¸­ --&gt; &lt;a :href=&quot;&#x27;/static/demo.xlsx&#x27;&quot;&gt;ç‚¹å‡»ä¸‹è½½æ¨¡ç‰ˆ&lt;/a&gt; &lt;/el-tag&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;é€‰æ‹©Excel&quot;&gt; &lt;el-upload ref=&quot;upload&quot; :auto-upload=&quot;false&quot; :on-success=&quot;fileUploadSuccess&quot; :on-error=&quot;fileUploadError&quot; :disabled=&quot;importBtnDisabled&quot; :limit=&quot;1&quot; :action=&quot;BASE_API + &#x27;/eduservice/subject/addSubject&#x27;&quot; name=&quot;file&quot; accept=&quot;application/vnd.ms-excel&quot; &gt; &lt;el-button slot=&quot;trigger&quot; size=&quot;small&quot; type=&quot;primary&quot; &gt;é€‰å–æ–‡ä»¶&lt;/el-button &gt; &lt;el-button :loading=&quot;loading&quot; style=&quot;margin-left: 10px&quot; size=&quot;small&quot; type=&quot;success&quot; @click=&quot;submitUpload&quot; &gt;ä¸Šä¼ åˆ°æœåŠ¡å™¨&lt;/el-button &gt; &lt;/el-upload&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default &#123; data() &#123; return &#123; BASE_API: process.env.BASE_API, // æ¥å£APIåœ°å€ OSS_PATH: process.env.OSS_PATH, // é˜¿é‡Œäº‘OSSåœ°å€ importBtnDisabled: false, // æŒ‰é’®æ˜¯å¦ç¦ç”¨, loading: false &#125; &#125;, created() &#123;&#125;, methods: &#123;&#125; &#125;&lt;/script&gt; ç¼–å†™è°ƒç”¨æ–¹æ³•12345678910111213141516171819202122232425methods: &#123; // ä¸Šä¼ æ–‡ä»¶ submitUpload() &#123; this.importBtnDisabled = true this.loading = true // ä½¿ç”¨vueçš„æäº¤ï¼Œè€Œä¸æ˜¯Ajaxè¯·æ±‚ this.$refs.upload.submit() &#125;, // ä¸Šä¼ æˆåŠŸ fileUploadSuccess() &#123; this.loading = false this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ è¯¾ç¨‹åˆ†ç±»æˆåŠŸï¼&#x27; &#125;) &#125;, // ä¸Šä¼ å¤±è´¥ fileUploadError() &#123; this.loading = false this.$message(&#123; type: &#x27;success&#x27;, message: &#x27;æ·»åŠ è¯¾ç¨‹åˆ†ç±»å¤±è´¥ï¼&#x27; &#125;) &#125;&#125; å®Œå–„ el-uploadæ·»åŠ ä¸€ä¸ª :before-upload=â€beforeUploadâ€ï¼Œç”¨äºä¸Šä¼ å‰åˆ¤æ–­æ–‡ä»¶åç¼€æ ¼å¼ ä¸Šä¼ æ–‡ä»¶æ—¶åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºç©º 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;el-form label-width=&quot;120px&quot;&gt; &lt;el-form-item label=&quot;é€‰æ‹©Excel&quot;&gt; &lt;el-upload ref=&quot;upload&quot; :auto-upload=&quot;true&quot; :before-upload=&quot;beforeUpload&quot; :on-success=&quot;fileUploadSuccess&quot; :on-error=&quot;fileUploadError&quot; :disabled=&quot;importBtnDisabled&quot; :limit=&quot;1&quot; :action=&quot;BASE_API + &#x27;/eduservice/subject/addSubject&#x27;&quot; name=&quot;file&quot; accept=&quot;application.xlsx&quot; &gt; &lt;el-button slot=&quot;trigger&quot; size=&quot;small&quot; type=&quot;primary&quot; &gt;é€‰å–æ–‡ä»¶&lt;/el-button &gt; &lt;el-button :loading=&quot;loading&quot; style=&quot;margin-left: 10px&quot; size=&quot;small&quot; type=&quot;success&quot; @click=&quot;submitUpload&quot; &gt;ä¸Šä¼ åˆ°æœåŠ¡å™¨&lt;/el-button &gt; &lt;/el-upload&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default &#123; methods: &#123; // ä¸Šä¼ å‰åˆ¤æ–­æ ¼å¼ beforeUpload() &#123; const fileName = this.$refs.upload.uploadFiles[0].name const suffix = fileName.substring(fileName.lastIndexOf(&#x27;.&#x27;) + 1) if (suffix != &#x27;xlsx&#x27;) &#123; this.fileSuffixError() return false &#125; &#125;, // ä¸Šä¼ æ–‡ä»¶ submitUpload() &#123; if (this.$refs.upload.uploadFiles.length == 0) &#123; this.fileUploadError() return &#125; this.importBtnDisabled = true this.loading = true // ä½¿ç”¨vueçš„æäº¤ï¼Œè€Œä¸æ˜¯Ajaxè¯·æ±‚ this.$refs.upload.submit() &#125;, // æ–‡ä»¶æ ¼å¼é”™è¯¯å¤±è´¥ fileSuffixError() &#123; this.loading = false this.$message(&#123; type: &#x27;error&#x27;, message: &#x27;æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼&#x27; &#125;) &#125; &#125; &#125;&lt;/script&gt; è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨ï¼ˆåç«¯ï¼‰é’ˆå¯¹è¿”å›çš„æ•°æ®åˆ›å»ºå¯¹åº”å®ä½“ç±» ä¸€çº§åˆ†ç±»ã€äºŒçº§åˆ†ç±»éƒ½è¦åˆ›å»ºå¯¹åº”å®ä½“ç±» 1234567// ä¸€çº§åˆ†ç±»@Datapublic class OneSubject &#123; private String id; private String title; private List&lt;TwoSubject&gt; children = new ArrayList&lt;&gt;();&#125; 123456// äºŒçº§åˆ†ç±»@Datapublic class TwoSubject &#123; private String id; private String title;&#125; ç¼–å†™controller123456// è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨ï¼ˆæ ‘å½¢ï¼‰@GetMapping(&quot;getAllSubjects&quot;)public R getAllSubjects() &#123; List&lt;OneSubject&gt; list = subjectService.getAllSubjects(); return R.ok().data(&quot;list&quot;, &quot;list&quot;);&#125; ç¼–å†™service serviceç»§æ‰¿çš„ServiceImplå·²ç»è‡ªåŠ¨æ³¨å…¥äº†baseMapper è¿™é‡Œçš„ä»£ç ä¸å¤Ÿä¼˜é›… 1234567891011121314151617181920212223242526272829303132333435363738394041@Overridepublic List&lt;OneSubject&gt; getAllSubjects() &#123; // æŸ¥è¯¢æ‰€æœ‰ä¸€çº§åˆ†ç±» QueryWrapper&lt;EduSubject&gt; wrapperOne = new QueryWrapper&lt;&gt;(); wrapperOne.eq(&quot;parent_id&quot;, &quot;0&quot;); List&lt;EduSubject&gt; oneSubjectList = baseMapper.selectList(wrapperOne); // æŸ¥è¯¢æ‰€æœ‰äºŒçº§åˆ†ç±» QueryWrapper&lt;EduSubject&gt; wrapperTwo = new QueryWrapper&lt;&gt;(); wrapperTwo.ne(&quot;parent_id&quot;, &quot;0&quot;); List&lt;EduSubject&gt; twoSubjectList = baseMapper.selectList(wrapperTwo); List&lt;OneSubject&gt; finalList = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; oneSubjectList.size(); i++) &#123; // å°è£…ä¸€çº§ EduSubject eduSubjectOne = oneSubjectList.get(i); OneSubject oneSubject = new OneSubject(); BeanUtils.copyProperties(eduSubjectOne, oneSubject); finalList.add(oneSubject); //å°è£…äºŒçº§åˆ†ç±» List&lt;TwoSubject&gt; childrenList = new ArrayList&lt;&gt;(); //éå†äºŒçº§åˆ†ç±»listé›†åˆ for (int m = 0; m &lt; twoSubjectList.size(); m++) &#123; //è·å–æ¯ä¸ªäºŒçº§åˆ†ç±» EduSubject eduSubjectTwo = twoSubjectList.get(m); //åˆ¤æ–­äºŒçº§åˆ†ç±»parentidå’Œä¸€çº§åˆ†ç±»idæ˜¯å¦ä¸€æ · if (eduSubjectTwo.getParentId().equals(eduSubjectOne.getId())) &#123; //æŠŠtSubjectå€¼å¤åˆ¶åˆ°TwoSubjecté‡Œé¢ï¼Œæ”¾åˆ°twoFinalSubjectListé‡Œé¢ TwoSubject twoSubject = new TwoSubject(); BeanUtils.copyProperties(eduSubjectTwo, twoSubject); childrenList.add(twoSubject); &#125; &#125; //æŠŠä¸€çº§ä¸‹é¢æ‰€æœ‰äºŒçº§åˆ†ç±»æ”¾åˆ°ä¸€çº§åˆ†ç±»é‡Œé¢ oneSubject.setChildren(childrenList); &#125; return finalList;&#125; è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨ï¼ˆå‰ç«¯ï¼‰æ ‘å½¢ç»“æ„æ¨¡æ¿1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!-- æ£€ç´¢ --&gt; &lt;el-input v-model=&quot;filterText&quot; placeholder=&quot;Filter keyword&quot; style=&quot;margin-bottom: 30px&quot; /&gt; &lt;!-- æ ‘å½¢ç»“æ„ --&gt; &lt;el-tree ref=&quot;tree2&quot; :data=&quot;data2&quot; :props=&quot;defaultProps&quot; :filter-node-method=&quot;filterNode&quot; class=&quot;filter-tree&quot; default-expand-all /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default &#123; data() &#123; return &#123; filterText: &#x27;&#x27;, data2: [ &#123; id: 1, label: &#x27;Level one 1&#x27;, children: [ &#123; id: 4, label: &#x27;Level two 1-1&#x27;, children: [ &#123; id: 9, label: &#x27;Level three 1-1-1&#x27; &#125;, &#123; id: 10, label: &#x27;Level three 1-1-2&#x27; &#125; ] &#125; ] &#125;, &#123; id: 2, label: &#x27;Level one 2&#x27;, children: [ &#123; id: 5, label: &#x27;Level two 2-1&#x27; &#125;, &#123; id: 6, label: &#x27;Level two 2-2&#x27; &#125; ] &#125;, &#123; id: 3, label: &#x27;Level one 3&#x27;, children: [ &#123; id: 7, label: &#x27;Level two 3-1&#x27; &#125;, &#123; id: 8, label: &#x27;Level two 3-2&#x27; &#125; ] &#125; ], defaultProps: &#123; children: &#x27;children&#x27;, label: &#x27;label&#x27; &#125; &#125; &#125;, watch: &#123; filterText(val) &#123; this.$refs.tree2.filter(val) &#125; &#125;, methods: &#123; filterNode(value, data) &#123; if (!value) return true return data.label.indexOf(value) !== -1 &#125; &#125; &#125;&lt;/script&gt; éœ€è¦ç¨å¾®ä¿®æ”¹ åç«¯æ¥å£è°ƒç”¨ api -&gt; edu -&gt; subject.js 12345678910111213import request from &#x27;@/utils/request&#x27;export default &#123; // è¯¾ç¨‹åˆ†ç±»åˆ—è¡¨ getSubjectList() &#123; return request(&#123; url: `/eduservice/subject/getAllSubjects`, method: &#x27;get&#x27; &#125;) &#125;&#125; è®°å¾—åœ¨vueè§†å›¾ä¸­å¼•å…¥ vueè§†å›¾å’Œæ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;template&gt; &lt;div class=&quot;app-container&quot;&gt; &lt;!-- æ£€ç´¢ --&gt; &lt;el-input v-model=&quot;filterText&quot; placeholder=&quot;Filter keyword&quot; style=&quot;margin-bottom: 30px&quot; /&gt; &lt;!-- æ ‘å½¢ç»“æ„ --&gt; &lt;el-tree ref=&quot;tree2&quot; :data=&quot;list&quot; :props=&quot;defaultProps&quot; :filter-node-method=&quot;filterNode&quot; class=&quot;filter-tree&quot; default-expand-all /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; // å¼•å…¥è°ƒç”¨æ¥å£çš„jsæ–‡ä»¶ import subjectApi from &#x27;@/api/edu/subject.js&#x27; export default &#123; data() &#123; return &#123; // ç´¢å¼•æ–‡æœ¬ filterText: &#x27;&#x27;, list: [], defaultProps: &#123; children: &#x27;children&#x27;, label: &#x27;title&#x27; &#125; &#125; &#125;, watch: &#123; filterText(val) &#123; this.$refs.tree2.filter(val) &#125; &#125;, created() &#123; this.getAllSubjectList() &#125;, methods: &#123; // è·å¾—æ‰€æœ‰subject getAllSubjectList() &#123; subjectApi.getSubjectList().then(result =&gt; &#123; this.list = result.data.list &#125;) &#125;, // è¿‡æ»¤æ–‡æœ¬ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ filterNode(value, data) &#123; if (!value) return true return data.title.toLowerCase().indexOf(value.toLowerCase()) !== -1 &#125; &#125; &#125;&lt;/script&gt; æµ‹è¯• è®°å¾—å¼€nginx å¾…ç»­ è¿›åº¦1/3","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘MyBatisPlus","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘MyBatisPlus","date":"2021-09-20T03:38:01.615Z","updated":"2021-09-23T09:58:17.229Z","comments":true,"path":"2021/09/20/xue-xi-bi-ji-mybatisplus/","link":"","permalink":"http://example.com/2021/09/20/xue-xi-bi-ji-mybatisplus/","excerpt":"","text":"å®˜ç½‘MyBatis-Plus (baomidou.com) åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°æ®åº“è§è¯¾ä»¶ å¿«é€Ÿåˆ›å»ºå·¥ç¨‹åˆ›å»ºspringbootå·¥ç¨‹ new project -&gt; spring Initializr mybatisplusä¾èµ–1234567891011&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.4.3.3&lt;/version&gt;&lt;/dependency&gt;&lt;!-- velocity æ¨¡æ¿å¼•æ“, Mybatis Plus ä»£ç ç”Ÿæˆå™¨éœ€è¦ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt; &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®application.properties123456spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/mybatis_plus?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789# mybatisæ—¥å¿—ï¼Œå¯ä»¥æŸ¥çœ‹æ›´å¤šè¯¦ç»†ä¿¡æ¯mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl åˆ›å»ºå®ä½“ç±»123456789101112131415package com.example.mybatisplus_demo.entity;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;@Data@NoArgsConstructor@AllArgsConstructorpublic class User &#123; private Long id; private String name; private Integer age; private String email;&#125; åˆ›å»ºMapepræ¥å£123456789package com.example.mybatisplus_demo.mapper;import com.baomidou.mybatisplus.core.mapper.BaseMapper;import com.example.mybatisplus_demo.entity.User;@Repositorypublic interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; mapperæ‰«æ æ³¨æ„è¿™é‡Œæœ‰ä¸ªæ˜“é”™ç‚¹ï¼Œmappersanå†…å¡«å†™åˆ°Mapperæ–‡ä»¶å­˜æ”¾çš„æ–‡ä»¶å¤¹ï¼Œè€Œä¸æ˜¯mapperæ–‡ä»¶ 123456789@SpringBootApplication@MapperScan(&quot;com.example.mybatisplus_demo.mapper&quot;)public class MybatisplusDemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(MybatisplusDemoApplication.class, args); &#125;&#125; å•å…ƒæµ‹è¯•12345678910111213141516171819package com.example.mybatisplus_demo;import com.example.mybatisplus_demo.mapper.UserMapper;import org.junit.jupiter.api.Test;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.test.context.SpringBootTest;@SpringBootTestclass MybatisplusDemoApplicationTests &#123; @Autowired private UserMapper userMapper; // æ­¤å¤„å¦‚æœæŠ¥é”™ï¼Œåˆ™åœ¨UserMapperæ¥å£å¤„æ·»åŠ æ³¨é‡Š@Repositoryå³å¯ @Test void contextLoads() &#123; &#125;&#125; å½“å‰é¡¹ç›®ç»“æ„ åŸºç¡€CRUDæ¥å£æ·»åŠ  ä¸éœ€è¦è®¾ç½®idä¸»é”®çš„å€¼ï¼Œmybatisplusè‡ªåŠ¨ç”Ÿæˆ19ä½id 12345@Testvoid addUser() &#123; int insert = userMapper.insert(new User(null, &quot;çˆ±ä¸½ä¸&quot;, 12, &quot;Alice@qq.com&quot;)); System.out.println(&quot;insert: &quot; + insert);&#125; ä¸»é”®ç”Ÿæˆç­–ç•¥åˆ†å¸ƒå¼ç³»ç»Ÿå”¯ä¸€IDç”Ÿæˆæ–¹æ¡ˆæ±‡æ€» - nick hao - åšå®¢å›­ (cnblogs.com) è‡ªåŠ¨å¢é•¿ UUID Redisç”Ÿæˆ snowflakeé›ªèŠ±ç®—æ³• mybatisplusä¸­æŒ‡å®šç­–ç•¥å¦‚ä¸‹ 12@TableId(type = IdType.AUTO)private Long id; ä¿®æ”¹1234@Testvoid updateUser() &#123; userMapper.updateById(new User(2L, &quot;Jacks&quot;, 11, &quot;Jacks@qq.com&quot;));&#125; è‡ªåŠ¨å¡«å…… ä¸ºå®ä½“ç±»æ·»åŠ å¸¦æœ‰æ³¨è§£çš„å±æ€§ 1234567//create_time@TableField(fill = FieldFill.INSERT)private Date createTime;//update_time æ³¨æ„è¿™é‡Œæ˜¯INSERT_UPDATE@TableField(fill = FieldFill.INSERT_UPDATE)private Date updateTime; åˆ›å»ºhandlerç±»ï¼Œå¹¶å®ç°æ¥å£MetaObjectHandlerçš„æ–¹æ³• 123456789101112131415161718192021222324package com.example.mybatisplus_demo.handler;import com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;import org.apache.ibatis.reflection.MetaObject;import org.springframework.stereotype.Component;import java.util.Date;// éœ€è¦äº¤ç»™spring@Componentpublic class MyMetaObjectHandler implements MetaObjectHandler &#123; // å½“ä½¿ç”¨mpå®ç°æ·»åŠ æ“ä½œæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæ‰§è¡Œ @Override public void insertFill(MetaObject metaObject) &#123; this.setFieldValByName(&quot;createTime&quot;, new Date(), metaObject); this.setFieldValByName(&quot;updateTime&quot;, new Date(), metaObject); &#125; @Override public void updateFill(MetaObject metaObject) &#123; this.setFieldValByName(&quot;updateTime&quot;, new Date(), metaObject); &#125;&#125; æµ‹è¯• 123456789101112131415161718192021222324 @Test void addUser() &#123; User user = new User(); user.setName(&quot;å²³ä¸ç¾¤1&quot;); user.setAge(70); user.setEmail(&quot;lucy@qq.com&quot;);// user.setCreateTime(new Date());// user.setUpdateTime(new Date()); int insert = userMapper.insert(user); System.out.println(&quot;insert:&quot; + insert); &#125; @Test void updateUser() &#123; User user = new User(); user.setId(1439818355027558402L); user.setAge(120); int row = userMapper.updateById(user); System.out.println(row); &#125; ä¹è§‚é” ä¸»è¦è§£å†³ï¼šä¸¢å¤±æ›´æ–° ä¸ºå®ä½“ç±»æ·»åŠ å¸¦æ³¨è§£çš„å±æ€§ 123@Version@TableField(fill = FieldFill.INSERT)private Integer version; é…ç½®ä¹è§‚é”æ’ä»¶ï¼Œå¯ä»¥å†™åœ¨ç‹¬ç«‹çš„é…ç½®ç±»ä¸­ï¼ˆMapperScanä¹Ÿå¯ä»¥å†™åœ¨è¯¥é…ç½®ç±»ä¸­ï¼‰ 12345678910111213@Configuration@MapperScan(&quot;com.example.mybatisplus_demo.mapper&quot;)public class MpConfig &#123; /** * ä¹è§‚é”æ’ä»¶ */ @Bean public MybatisPlusInterceptor mybatisPlusInterceptor() &#123; MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor(); interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor()); return interceptor; &#125;&#125; ç¼–å†™handlerç±» 1234567@Overridepublic void insertFill(MetaObject metaObject) &#123; this.setFieldValByName(&quot;createTime&quot;, new Date(), metaObject); this.setFieldValByName(&quot;updateTime&quot;, new Date(), metaObject); // é»˜è®¤åˆå§‹å€¼1 this.setFieldValByName(&quot;version&quot;, 1, metaObject);&#125; æµ‹è¯• 12345678@Testvoid testOptimisticLockerInnerInterceptor() &#123; // å…ˆæŸ¥ User user = userMapper.selectById(1439842460539846658L); // åæ”¹ user.setAge(44); userMapper.updateById(user);&#125; æŸ¥è¯¢æ‰¹é‡æŸ¥è¯¢12345@Testvoid testSelect() &#123; List&lt;User&gt; users = userMapper.selectBatchIds(Arrays.asList(1L, 2L, 3L)); System.out.println(users);&#125; åˆ†é¡µæŸ¥è¯¢ åœ¨é…ç½®ç±»ä¸­é…ç½®åˆ†é¡µæ’ä»¶ 123456789101112131415@Configuration@MapperScan(&quot;com.example.mybatisplus_demo.mapper&quot;)public class MpConfig &#123; /** * æ’ä»¶ */ @Bean public MybatisPlusInterceptor mybatisPlusInterceptor() &#123; MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor(); interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor()); // åˆ†é¡µæ’ä»¶ interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL)); return interceptor; &#125;&#125; æµ‹è¯• 123456789@Testvoid testPage() &#123; // åˆ›å»ºpageå¯¹è±¡ Page&lt;User&gt; page = new Page&lt;&gt;(1, 2); // æŸ¥è¯¢ Page&lt;User&gt; page1 = userMapper.selectPage(page, null); System.out.println(page1); // è·å¾—çš„pageå¯¹è±¡æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥è·å¾—å¯¹åº”å€¼&#125; åˆ é™¤ ç‰©ç†åˆ é™¤ï¼šçœŸå®åˆ é™¤ï¼Œå°†æ•°æ®ä»æ•°æ®åº“ä¸­åˆ é™¤é€»è¾‘åˆ é™¤ï¼šå‡åˆ é™¤ï¼Œæ ¹æ®å­—æ®µçŠ¶æ€åˆ¤æ–­ æ‰¹é‡åˆ é™¤ï¼ˆç‰©ç†åˆ é™¤ï¼‰1234@Testvoid testDelete() &#123; userMapper.deleteBatchIds(Arrays.asList(1L, 2L));&#125; é€»è¾‘åˆ é™¤ åœ¨å®ä½“ç±»ä¸­æ·»åŠ å¸¦æ³¨é‡Šçš„å±æ€§ï¼ˆå¯ä»¥å†åŠ ä¸ŠTableFieldè®¾ç½®é»˜è®¤å€¼ç­‰ï¼‰ 12@TableLogicprivate Integer deleted; é«˜ç‰ˆæœ¬å·²ä¸éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ’ä»¶ æµ‹è¯• 1234@Testvoid testDelete() &#123; userMapper.deleteBatchIds(Arrays.asList(1L, 2L));&#125; é€»è¾‘åˆ é™¤ä¹‹åçš„æ•°æ®åœ¨æŸ¥è¯¢çš„æ—¶å€™ä¸ä¼šè¢«æŸ¥è¯¢åˆ°ï¼ˆæ·»åŠ äº†é¢å¤–çš„æ¡ä»¶deleted=0ï¼‰ æ¡ä»¶æ„é€ å™¨123456789@Testvoid testWrapper() &#123; // åˆ›å»ºå¯¹è±¡ QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;(); // è®¾ç½®æ¡ä»¶(æ›´å¤šæ¡ä»¶è¯¦è§å®˜ç½‘) wrapper.ge(&quot;age&quot;, 20).le(&quot;age&quot;, 40); List&lt;User&gt; users = userMapper.selectList(wrapper); System.out.println(users);&#125; ä»£ç ç”Ÿæˆå™¨","categories":[],"tags":[{"name":"MyBatisPlus","slug":"MyBatisPlus","permalink":"http://example.com/tags/MyBatisPlus/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜1","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘åœ¨çº¿æ•™è‚²é¡¹ç›®å®æˆ˜1","date":"2021-09-19T13:01:14.432Z","updated":"2021-09-23T08:05:54.517Z","comments":true,"path":"2021/09/19/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-1/","link":"","permalink":"http://example.com/2021/09/19/xiang-mu-bi-ji-zai-xian-jiao-yu-xiang-mu-shi-zhan-1/","excerpt":"","text":"èƒŒæ™¯â€‹ ä»Šå¤©å‡†å¤‡å†™ä¸€ä¸ªssmæ•´åˆçš„crudç®€å•é¡¹ç›®ï¼Œç„¶åé¡ºä¾¿åº”ä»˜ä¸€ä¸‹å­¦æ ¡è¯¾ç¨‹ï¼Œç„¶åè¢«springçš„æ³¨é‡Šæ°”åˆ°äº†ï¼ˆæ³¨é‡Šä»£ç ä»€ä¹ˆéƒ½å†™å¾—ä¸€æ¨¡ä¸€æ ·ï¼Œå°±æ˜¯ideaæŠ¥æ‰¾ä¸åˆ°beanï¼Œç»“æœæˆ‘é‡å†™äº†å‡ éä¹‹åè«åçš„å¥½äº†ï¼Œç¦»è°±ï¼ï¼‰ï¼Œè¢«jspæ°”åˆ°äº†ï¼ˆè¿™ä¸ªé”™è¯¯ä¹‹å‰é‡åˆ°å¥½å‡ æ¬¡äº†ï¼Œä¹Ÿæ˜¯ä»£ç ä¸€æ¨¡ä¸€æ ·ï¼Œå°±æ˜¯æŠ¥404ï¼Œç¦»è°±ï¼ï¼‰ï¼Œå®åœ¨æ˜¯ä¸æƒ³åœ¨è¿™äº›ä¸Šé¢æŠ˜è…¾äº†ï¼Œä»Šå¤©åœ¨å®éªŒå®¤æœ‰ä¸€åŠçš„æ—¶é—´éƒ½åœ¨å¹æ°”ï¼Œäºæ˜¯æœæ–­æ”¾å¼ƒäº†å®ƒï¼ŒæŠ•å…¥äº†springboot+vueçš„æ€€æŠ±ã€‚ é¡¹ç›®ç®€ä»‹é¡¹ç›®å•†ä¸šæ¨¡å¼B2Cï¼ˆå½“å‰é¡¹ç›®ï¼‰ Business To Customers ä¸¤ä¸ªè§’è‰²ï¼š ç®¡ç†å‘˜ï¼šæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤ æ™®é€šç”¨æˆ·ï¼šæŸ¥è¯¢ B2B2C Business To Business To Customers ä¾‹å­ï¼šæ·˜å® é¡¹ç›®å®ç°åŠŸèƒ½æ¨¡å—åå°ï¼ˆç®¡ç†å‘˜ï¼‰ è®²å¸ˆç®¡ç† è¯¾ç¨‹åˆ†ç±»ç®¡ç† è¯¾ç¨‹ç®¡ç† è§†é¢‘ ç»Ÿè®¡åˆ†æ è¯¾ç¨‹ç›¸å…³ è®¢å•ç®¡ç† bannerï¼ˆè½®æ’­å›¾ï¼‰ç®¡ç† æƒé™ç®¡ç† å‰å°ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ é¦–é¡µæ•°æ®æ˜¾ç¤º è®²å¸ˆåˆ—è¡¨å’Œè¯¦æƒ… è¯¾ç¨‹åˆ—è¡¨å’Œè¯¦æƒ… è§†é¢‘åœ¨çº¿æ’­æ”¾ ç™»å½•å’Œæ³¨å†Œ å¾®ä¿¡æ‰«ç ç™»å½• å¾®ä¿¡æ”¯ä»˜ é¡¹ç›®ä½¿ç”¨çš„æŠ€æœ¯ç‚¹åç«¯æŠ€æœ¯ SpringBoot SpringCloud MyBatisPlus SpringSecurity redisï¼Œmavenï¼ŒeasyExcelï¼Œjwtï¼ŒOAuth2 â€¦â€¦ å‰ç«¯æŠ€æœ¯ vue element-ui axios node.js â€¦â€¦ å…¶ä»–æŠ€æœ¯ é˜¿é‡Œäº‘oss é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æœåŠ¡ é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ å¾®ä¿¡æ”¯ä»˜å’Œç™»å½• dockerï¼Œgitï¼ŒJenkins â€¦â€¦ MyBatisPlusä»‹ç» è¯¦è§å•ç‹¬çš„æ–‡æ¡£è¯´æ˜ æ­å»ºé¡¹ç›®ç¯å¢ƒæ•°æ®åº“ è¯¦è§èµ„æ–™ é¡¹ç›®ç»“æ„ çˆ¶å·¥ç¨‹ï¼špomç±»å‹ï¼Œç”¨äºç®¡ç†ä»¥æ¥ç‰ˆæœ¬å’Œæ”¾å…¬å…±ä¾èµ– å­æ¨¡å—nï¼šå®ç°å„ä¸ªæ¨¡å— åˆ›å»ºspringbootçˆ¶é¡¹ç›®é…ç½®çˆ¶é¡¹ç›®çš„pom.xml é…ç½®æ‰“åŒ…æ–¹å¼ã€åˆ é™¤dependenciesã€æ·»åŠ propertieså’ŒdependencyManagementã€åˆ é™¤srcæ–‡ä»¶å¤¹ç­‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.5.4&lt;/version&gt; &lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;artifactId&gt;guli_parent&lt;/artifactId&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;guli_parent&lt;/name&gt; &lt;description&gt;guli_parent&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;guli.version&gt;0.0.1-SNAPSHOT&lt;/guli.version&gt; &lt;mybatis-plus.version&gt;3.0.5&lt;/mybatis-plus.version&gt; &lt;velocity.version&gt;2.0&lt;/velocity.version&gt; &lt;swagger.version&gt;2.7.0&lt;/swagger.version&gt; &lt;aliyun.oss.version&gt;2.8.3&lt;/aliyun.oss.version&gt; &lt;jodatime.version&gt;2.10.1&lt;/jodatime.version&gt; &lt;poi.version&gt;3.17&lt;/poi.version&gt; &lt;commons-fileupload.version&gt;1.3.1&lt;/commons-fileupload.version&gt; &lt;commons-io.version&gt;2.6&lt;/commons-io.version&gt; &lt;httpclient.version&gt;4.5.1&lt;/httpclient.version&gt; &lt;jwt.version&gt;0.7.0&lt;/jwt.version&gt; &lt;aliyun-java-sdk-core.version&gt;4.3.3&lt;/aliyun-java-sdk-core.version&gt; &lt;aliyun-sdk-oss.version&gt;3.1.0&lt;/aliyun-sdk-oss.version&gt; &lt;aliyun-java-sdk-vod.version&gt;2.15.2&lt;/aliyun-java-sdk-vod.version&gt; &lt;aliyun-java-vod-upload.version&gt;1.4.11&lt;/aliyun-java-vod-upload.version&gt; &lt;aliyun-sdk-vod-upload.version&gt;1.4.11&lt;/aliyun-sdk-vod-upload.version&gt; &lt;fastjson.version&gt;1.2.28&lt;/fastjson.version&gt; &lt;gson.version&gt;2.8.2&lt;/gson.version&gt; &lt;json.version&gt;20170516&lt;/json.version&gt; &lt;commons-dbutils.version&gt;1.7&lt;/commons-dbutils.version&gt; &lt;canal.client.version&gt;1.1.0&lt;/canal.client.version&gt; &lt;docker.image.prefix&gt;zx&lt;/docker.image.prefix&gt; &lt;cloud-alibaba.version&gt;0.2.2.RELEASE&lt;/cloud-alibaba.version&gt; &lt;/properties&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;!--Spring Cloud--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Hoxton.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;cloud-alibaba.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--mybatis-plus æŒä¹…å±‚--&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;$&#123;mybatis-plus.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!-- velocity æ¨¡æ¿å¼•æ“, Mybatis Plus ä»£ç ç”Ÿæˆå™¨éœ€è¦ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt; &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt; &lt;version&gt;$&#123;velocity.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--swagger--&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;$&#123;swagger.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--swagger ui--&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;$&#123;swagger.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--aliyunOSS--&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun.oss.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--æ—¥æœŸæ—¶é—´å·¥å…·--&gt; &lt;dependency&gt; &lt;groupId&gt;joda-time&lt;/groupId&gt; &lt;artifactId&gt;joda-time&lt;/artifactId&gt; &lt;version&gt;$&#123;jodatime.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--xls--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;$&#123;poi.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--xlsx--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt; &lt;version&gt;$&#123;poi.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--æ–‡ä»¶ä¸Šä¼ --&gt; &lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;version&gt;$&#123;commons-fileupload.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--commons-io--&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;$&#123;commons-io.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--httpclient--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt; &lt;version&gt;$&#123;httpclient.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;version&gt;$&#123;gson.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!-- JWT --&gt; &lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;version&gt;$&#123;jwt.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;!--aliyun--&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-sdk-core&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun-java-sdk-core.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun-sdk-oss.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-sdk-vod&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun-java-sdk-vod.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-java-vod-upload&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun-java-vod-upload.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.aliyun&lt;/groupId&gt; &lt;artifactId&gt;aliyun-sdk-vod-upload&lt;/artifactId&gt; &lt;version&gt;$&#123;aliyun-sdk-vod-upload.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;$&#123;fastjson.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.json&lt;/groupId&gt; &lt;artifactId&gt;json&lt;/artifactId&gt; &lt;version&gt;$&#123;json.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-dbutils&lt;/groupId&gt; &lt;artifactId&gt;commons-dbutils&lt;/artifactId&gt; &lt;version&gt;$&#123;commons-dbutils.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.otter&lt;/groupId&gt; &lt;artifactId&gt;canal.client&lt;/artifactId&gt; &lt;version&gt;$&#123;canal.client.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; åˆ›å»ºå­æ¨¡å— å³é”®new modelåˆ›å»ºå³å¯ï¼Œå­é¡¹ç›®serviceç­‰ é…ç½®pom.xml123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107&lt;dependencies&gt; &lt;!-- &lt;dependency&gt;--&gt;&lt;!-- &lt;groupId&gt;com.atguigu&lt;/groupId&gt;--&gt;&lt;!-- &lt;artifactId&gt;service_base&lt;/artifactId&gt;--&gt;&lt;!-- &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;--&gt;&lt;!-- &lt;/dependency&gt;--&gt; &lt;!--&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt; &lt;/dependency&gt;--&gt; &lt;!--hystrixä¾èµ–ï¼Œä¸»è¦æ˜¯ç”¨ @HystrixCommand --&gt; &lt;!--&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt;--&gt; &lt;!--æœåŠ¡æ³¨å†Œ--&gt; &lt;!-- &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;--&gt; &lt;!--æœåŠ¡è°ƒç”¨--&gt; &lt;!-- &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt;--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mybatis-plus--&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- velocity æ¨¡æ¿å¼•æ“, Mybatis Plus ä»£ç ç”Ÿæˆå™¨éœ€è¦ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt; &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--swagger--&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--lombokç”¨æ¥ç®€åŒ–å®ä½“ç±»ï¼šéœ€è¦å®‰è£…lombokæ’ä»¶--&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--xls--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--httpclient--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--commons-io--&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--gson--&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; åˆ›å»ºå­å­æ¨¡å— service_eduã€service_vod å½“å‰é¡¹ç›®ç»“æ„ commonæ¨¡å—swaggerå·¥å…·åˆ›å»ºå­æ¨¡å— å‘½åä¸ºcommonï¼Œè¯¥æ¨¡å—ä¸éœ€è¦srcæ–‡ä»¶å¤¹ é…ç½®ä¾èµ–12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;parent&gt; &lt;artifactId&gt;guli_parent&lt;/artifactId&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;common&lt;/artifactId&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!--mybatis-plus--&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!--lombokç”¨æ¥ç®€åŒ–å®ä½“ç±»ï¼šéœ€è¦å®‰è£…lombokæ’ä»¶--&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!--swagger--&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- redis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- spring2.Xé›†æˆredisæ‰€éœ€common-pool2 &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt; &lt;version&gt;2.6.0&lt;/version&gt; &lt;/dependency&gt;--&gt; &lt;/dependencies&gt;&lt;/project&gt; åˆ›å»ºå­å­æ¨¡å— service_base åˆ›å»ºSwaggerConfig.javaé…ç½®ç±»12345678910111213141516171819202122232425262728293031323334353637383940package com.atguigu.servicebase;import com.google.common.base.Predicates;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.service.ApiInfo;import springfox.documentation.service.Contact;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2;@Configuration@EnableSwagger2 // swaggeræ³¨è§£public class SwaggerConfig &#123; // ä¸€äº›å›ºå®šé…ç½® @Bean public Docket webApiConfig() &#123; return new Docket(DocumentationType.SWAGGER_2) .groupName(&quot;webApi&quot;) .apiInfo(webApiInfo()) .select() .paths(Predicates.not(PathSelectors.regex(&quot;/admin/.*&quot;))) .paths(Predicates.not(PathSelectors.regex(&quot;/error.*&quot;))) .build(); &#125; // æ–‡æ¡£æç¤ºä¿¡æ¯ private ApiInfo webApiInfo() &#123; return new ApiInfoBuilder() .title(&quot;ç½‘ç«™-è¯¾ç¨‹ä¸­å¿ƒAPIæ–‡æ¡£&quot;) .description(&quot;æœ¬æ–‡æ¡£æè¿°äº†è¯¾ç¨‹ä¸­å¿ƒå¾®æœåŠ¡æ¥å£å®šä¹‰&quot;) .version(&quot;1.0&quot;) .contact(new Contact(&quot;java&quot;, &quot;http://atguigu.com&quot;, &quot;1123@qq.com&quot;)) .build(); &#125;&#125; å¼•å…¥swaggerå­æ¨¡å— éœ€è¦åœ¨serviceæ¨¡å—ä¸­å¼•å…¥swaggeræ¨¡å—çš„å­æ¨¡å—servicebaseæ¨¡å—ï¼Œå³åœ¨serviceæ¨¡å—çš„pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–å³å¯ï¼ˆå› ä¸ºæƒ³è¦åœ¨serviceæ¨¡å—çš„å­æ¨¡å—ä¸­ä½¿ç”¨ï¼Œä¸”éƒ½å†™ä¸Šäº†pomæ‰“åŒ…ï¼Œæ‰€ä»¥åªè¦åœ¨serviceæ¨¡å—çš„pom.xmlä¸­æ·»åŠ å³å¯ï¼‰ 12345&lt;dependency&gt; &lt;groupId&gt;com.atguigu&lt;/groupId&gt; &lt;artifactId&gt;service_base&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; å¯åŠ¨ç±»æ·»åŠ ç»„ä»¶æ‰«æ EduApplicationæ˜¯service_eduæ¨¡å—ä¸‹çš„å¯åŠ¨ç±»ï¼Œç”±äºservice_baseæ¨¡å—ä¸­çš„swaggerconfigé…ç½®ç±»æ‰€åœ¨åŒ…åœ°å€ä¹Ÿæ˜¯com.atguigu.xxxï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªæ‰«æåˆ°ï¼Œå¦åˆ™åªä¼šæ‰«æå¯åŠ¨ç±»æ‰€åœ¨åŠå­åŒ…ä¸‹çš„ç±»ï¼ˆæ‰€ä»¥å¯åŠ¨ç±»è¦æ”¾åœ¨æ‰€æœ‰packageçš„åŒçº§ï¼‰ï¼Œå¦‚æœæ˜¯åˆ«çš„åœ°å€å†é¢å¤–æ·»åŠ å³å¯ï¼ˆ{â€œcom.atguiguâ€,â€com.xxxâ€}ï¼‰ 123456789@SpringBootApplication@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)public class EduApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(EduApplication.class, args); &#125;&#125; æµ‹è¯•ï¼ˆè®¿é—®ï¼‰swagger å¯åŠ¨xxxApplicationå¯åŠ¨ç±» http://localhost:8001/swagger-ui.html APIæ–‡æ¡£æç¤ºç¼–å†™ ä¸€ä¸‹ä»¥controllerä¸ºä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748package com.atguigu.eduservice.controller;import com.atguigu.eduservice.entity.EduTeacher;import com.atguigu.eduservice.service.EduTeacherService;import io.swagger.annotations.Api;import io.swagger.annotations.ApiOperation;import io.swagger.annotations.ApiParam;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import java.util.List;/** * &lt;p&gt; * è®²å¸ˆ å‰ç«¯æ§åˆ¶å™¨ * &lt;/p&gt; * * @author testjava * @since 2021-09-20 */@Api(tags = &#123;&quot;è®²å¸ˆç®¡ç†&quot;&#125;)@RestController@RequestMapping(&quot;/eduservice/edu-teacher&quot;)public class EduTeacherController &#123; @Autowired private EduTeacherService teacherService; // RESTé£æ ¼ // 1ã€æŸ¥è¯¢è®²å¸ˆè¡¨çš„æ‰€æœ‰æ•°æ® // åœ°å€ï¼šlocalhost:8001//eduservice/edu-teacher/findAll @ApiOperation(value = &quot;æ‰€æœ‰è®²å¸ˆåˆ—è¡¨&quot;) @GetMapping(&quot;findAll&quot;) public List&lt;EduTeacher&gt; findAllTeacher() &#123; // è°ƒç”¨Serviceçš„æ–¹æ³• List&lt;EduTeacher&gt; list = teacherService.list(null); return list; &#125; // 2ã€é€»è¾‘åˆ é™¤è®²å¸ˆ @ApiOperation(value = &quot;æ ¹æ®idé€»è¾‘åˆ é™¤è®²å¸ˆ&quot;) @DeleteMapping(&quot;&#123;id&#125;&quot;) public boolean removeTeacher(@ApiParam(name = &quot;id&quot;, value = &quot;è®²å¸ˆID&quot;, required = true) @PathVariable(&quot;id&quot;) String id) &#123; boolean flag = teacherService.removeById(id); return flag; &#125;&#125; å½“å‰é¡¹ç›®ç»“æ„ ç»Ÿä¸€ç»“æœè¿”å›æ ¼å¼ç»Ÿä¸€ç»“æœçš„æ ¼å¼123456&#123; &quot;success&quot;: å¸ƒå°”, //å“åº”æ˜¯å¦æˆåŠŸ &quot;code&quot;: æ•°å­—, //å“åº”ç  &quot;message&quot;: å­—ç¬¦ä¸², //è¿”å›æ¶ˆæ¯ &quot;data&quot;: HashMap //è¿”å›æ•°æ®ï¼Œæ”¾åœ¨é”®å€¼å¯¹ä¸­&#125; åˆ›å»ºå­æ¨¡å— commonæ¨¡å—ä¸‹åˆ›å»ºcommon_utilsæ¨¡å— è®¾å®šçŠ¶æ€ç  å¯ä»¥å†™æˆæ¥å£ï¼Œæˆ–è€…å…¶ä»–å½¢å¼ 1234567package com.atguigu.commonutils;public interface ResultCode &#123; // çŠ¶æ€ç  public static Integer SUCCESS = 20000; //æˆåŠŸ public static Integer ERROR = 20001; //å¤±è´¥&#125; å®šä¹‰è¿”å›æ•°æ®æ ¼å¼ åˆ›å»ºä¸€ä¸ªç»Ÿä¸€è¿”å›ç»“æœç±» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475package com.atguigu.commonutils;import io.swagger.annotations.ApiModelProperty;import lombok.Data;import java.util.HashMap;import java.util.Map;//ç»Ÿä¸€è¿”å›ç»“æœçš„ç±»@Datapublic class R &#123; // ä»¥ä¸‹å±æ€§ä¸ºè¿”å›å†…å®¹key @ApiModelProperty(value = &quot;æ˜¯å¦æˆåŠŸ&quot;) private Boolean success; @ApiModelProperty(value = &quot;è¿”å›ç &quot;) private Integer code; @ApiModelProperty(value = &quot;è¿”å›æ¶ˆæ¯&quot;) private String message; @ApiModelProperty(value = &quot;è¿”å›æ•°æ®&quot;) private Map&lt;String, Object&gt; data = new HashMap&lt;String, Object&gt;(); //æŠŠæ„é€ æ–¹æ³•ç§æœ‰ private R() &#123; &#125; //æˆåŠŸé™æ€æ–¹æ³• public static R ok() &#123; R r = new R(); r.setSuccess(true); r.setCode(ResultCode.SUCCESS); r.setMessage(&quot;æˆåŠŸ&quot;); return r; &#125; //å¤±è´¥é™æ€æ–¹æ³• public static R error() &#123; R r = new R(); r.setSuccess(false); r.setCode(ResultCode.ERROR); r.setMessage(&quot;å¤±è´¥&quot;); return r; &#125; // ä»¥ä¸‹çš„return thisè¿”å›çš„æ˜¯r // å¯ä»¥å®ç°é“¾å¼ç¼–ç¨‹ï¼ˆR.success().message().â€¦â€¦ï¼‰ public R success(Boolean success) &#123; this.setSuccess(success); return this; &#125; public R message(String message) &#123; this.setMessage(message); return this; &#125; public R code(Integer code) &#123; this.setCode(code); return this; &#125; public R data(String key, Object value) &#123; this.data.put(key, value); return this; &#125; public R data(Map&lt;String, Object&gt; map) &#123; this.setData(map); return this; &#125;&#125; ä½¿ç”¨ç»Ÿä¸€è¿”å›ç»“æœæ ¼å¼ å…ˆåœ¨æ¨¡å—çš„pom.xmlä¸­å¼•å…¥å·²ç»å®šä¹‰å¥½çš„ç»Ÿä¸€è¿”å›ç»“æœç±»æ‰€åœ¨ å°†æ¥å£æ–¹æ³•ï¼ˆcontrollerä¸­çš„æ–¹æ³•ï¼‰è¿”å›ç»“æœæ”¹ä¸ºRå³å¯ 12345678910111213141516171819202122232425262728// æœªä½¿ç”¨ç»Ÿä¸€ç»“æœæ ¼å¼@Api(tags = &#123;&quot;è®²å¸ˆç®¡ç†&quot;&#125;)@RestController@RequestMapping(&quot;/eduservice/edu-teacher&quot;)public class EduTeacherController &#123; @Autowired private EduTeacherService teacherService; // RESTé£æ ¼ // 1ã€æŸ¥è¯¢è®²å¸ˆè¡¨çš„æ‰€æœ‰æ•°æ® // åœ°å€ï¼šlocalhost:8001//eduservice/edu-teacher/findAll @ApiOperation(value = &quot;æ‰€æœ‰è®²å¸ˆåˆ—è¡¨&quot;) @GetMapping(&quot;findAll&quot;) public List&lt;EduTeacher&gt; findAllTeacher() &#123; // è°ƒç”¨Serviceçš„æ–¹æ³• List&lt;EduTeacher&gt; list = teacherService.list(null); return list; &#125; // 2ã€é€»è¾‘åˆ é™¤è®²å¸ˆ @ApiOperation(value = &quot;æ ¹æ®idé€»è¾‘åˆ é™¤è®²å¸ˆ&quot;) @DeleteMapping(&quot;&#123;id&#125;&quot;) public boolean removeTeacher(@ApiParam(name = &quot;id&quot;, value = &quot;è®²å¸ˆID&quot;, required = true) @PathVariable(&quot;id&quot;) String id) &#123; boolean flag = teacherService.removeById(id); return flag; &#125;&#125; 12345678910111213141516171819202122232425262728// ä½¿ç”¨ç»Ÿä¸€ç»“æœæ ¼å¼@Api(tags = &#123;&quot;è®²å¸ˆç®¡ç†&quot;&#125;)@RestController@RequestMapping(&quot;/eduservice/edu-teacher&quot;)public class EduTeacherController &#123; @Autowired private EduTeacherService teacherService; // RESTé£æ ¼ // 1ã€æŸ¥è¯¢è®²å¸ˆè¡¨çš„æ‰€æœ‰æ•°æ® // åœ°å€ï¼šlocalhost:8001//eduservice/edu-teacher/findAll @ApiOperation(value = &quot;æ‰€æœ‰è®²å¸ˆåˆ—è¡¨&quot;) @GetMapping(&quot;findAll&quot;) public R findAllTeacher() &#123; // è°ƒç”¨Serviceçš„æ–¹æ³• List&lt;EduTeacher&gt; list = teacherService.list(null); return R.ok().data(&quot;teacherList&quot;, list); &#125; // 2ã€é€»è¾‘åˆ é™¤è®²å¸ˆ @ApiOperation(value = &quot;æ ¹æ®idé€»è¾‘åˆ é™¤è®²å¸ˆ&quot;) @DeleteMapping(&quot;&#123;id&#125;&quot;) public R removeTeacher(@ApiParam(name = &quot;id&quot;, value = &quot;è®²å¸ˆID&quot;, required = true) @PathVariable(&quot;id&quot;) String id) &#123; boolean flag = teacherService.removeById(id); return flag ? R.ok() : R.error(); &#125;&#125; å½“å‰é¡¹ç›®ç»“æ„ ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±» åœ¨commonæ¨¡å—ä¸­çš„service_baseä¸­æ·»åŠ å³å¯ 123456789101112131415/** * ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±» */@ControllerAdvice // å¢å¼ºçš„controllerï¼Œå¯ä»¥ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†public class GlobalExceptionHandler &#123; // å…¨å±€å¼‚å¸¸å¤„ç† @ExceptionHandler(Exception.class) // æŒ‡å®šå‡ºç°ä»€ä¹ˆå¼‚å¸¸æ‰ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³• @ResponseBody // ç”¨äºè¿”å›æ•°æ® public R error(Exception e) &#123; e.printStackTrace(); return R.error().message(&quot;äº§ç”Ÿäº†å¼‚å¸¸!&quot;); &#125;&#125; è¿™é‡Œæœ‰ä¸€ä¸ªä¾èµ–çš„é—®é¢˜ï¼Œéœ€è¦æ³¨æ„ ç‰¹å®šå¼‚å¸¸å¤„ç†1234567891011121314151617181920212223/** * ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±» */@ControllerAdvice // å¢å¼ºçš„controllerï¼Œå¯ä»¥ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†public class GlobalExceptionHandler &#123; // å…¨å±€å¼‚å¸¸å¤„ç† @ExceptionHandler(Exception.class) // æŒ‡å®šå‡ºç°ä»€ä¹ˆå¼‚å¸¸æ‰ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³• @ResponseBody // ç”¨äºè¿”å›æ•°æ® public R error(Exception e) &#123; e.printStackTrace(); return R.error().message(&quot;äº§ç”Ÿäº†å¼‚å¸¸!&quot;); &#125; // ç‰¹å®šå¼‚å¸¸å¤„ç† @ExceptionHandler(ArithmeticException.class) @ResponseBody public R error(ArithmeticException e) &#123; e.printStackTrace(); return R.error().message(&quot;äº§ç”Ÿäº†ArithmeticExceptionå¼‚å¸¸!&quot;); &#125;&#125; è‡ªå®šä¹‰å¼‚å¸¸å¤„ç† åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±» 1234567891011@Data@NoArgsConstructor@AllArgsConstructorpublic class GuliException extends RuntimeException &#123; private Integer code; // çŠ¶æ€ç  private String msg; // å¼‚å¸¸ä¿¡æ¯ //â€¦â€¦&#125; åœ¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»ä¸­åˆ›å»ºæ–¹æ³• 1234567// è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†@ExceptionHandler(GuliException.class)@ResponseBodypublic R error(GuliException e) &#123; e.printStackTrace(); return R.error().code(e.getCode()).message(e.getMsg());&#125; æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ 12345try &#123; int i = 1 / 0;&#125; catch (Exception e) &#123; throw new GuliException(20001, &quot;zzzzz&quot;);&#125; å½“å‰é¡¹ç›®ç»“æ„ ç»Ÿä¸€æ—¥å¿—å¤„ç†é…ç½®æ—¥å¿—çº§åˆ« application.propertiesæ–‡ä»¶ä¸­é…ç½®å³å¯ 1logging.level.root=INFO logbackæ—¥å¿—å·¥å…· log4jï¼Œlogbackç­‰å¯ä»¥å°†æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ æ³¨æ„ï¼šéœ€è¦å…ˆå°†application.propertiesä¸­çš„æœ‰å…³æ—¥å¿—çš„é…ç½®æ³¨é‡Šæ‰ é…ç½®å·¥å…·çš„é…ç½®æ–‡ä»¶ åœ¨resourceæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºlogback-spring.xmlé…ç½®æ–‡ä»¶ æ³¨æ„ çš„è·¯å¾„å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;configuration scan=&quot;true&quot; scanPeriod=&quot;10 seconds&quot;&gt; &lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½äºWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡º --&gt; &lt;!-- scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue --&gt; &lt;!-- scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ --&gt; &lt;!-- debug:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ --&gt; &lt;contextName&gt;logback&lt;/contextName&gt; &lt;!-- nameçš„å€¼æ˜¯å˜é‡çš„åç§°ï¼Œvalueçš„å€¼æ—¶å˜é‡å®šä¹‰çš„å€¼ã€‚é€šè¿‡å®šä¹‰çš„å€¼ä¼šè¢«æ’å…¥åˆ°loggerä¸Šä¸‹æ–‡ä¸­ã€‚å®šä¹‰å˜é‡åï¼Œå¯ä»¥ä½¿â€œ$&#123;&#125;â€æ¥ä½¿ç”¨å˜é‡ã€‚ --&gt; &lt;property name=&quot;log.path&quot; value=&quot;D:/MyProject/log/guli_edu&quot; /&gt; &lt;!-- å½©è‰²æ—¥å¿— --&gt; &lt;!-- é…ç½®æ ¼å¼å˜é‡ï¼šCONSOLE_LOG_PATTERN å½©è‰²æ—¥å¿—æ ¼å¼ --&gt; &lt;!-- magenta:æ´‹çº¢ --&gt; &lt;!-- boldMagenta:ç²—çº¢--&gt; &lt;!-- cyan:é’è‰² --&gt; &lt;!-- white:ç™½è‰² --&gt; &lt;!-- magenta:æ´‹çº¢ --&gt; &lt;property name=&quot;CONSOLE_LOG_PATTERN&quot; value=&quot;%yellow(%date&#123;yyyy-MM-dd HH:mm:ss&#125;) |%highlight(%-5level) |%blue(%thread) |%blue(%file:%line) |%green(%logger) |%cyan(%msg%n)&quot; /&gt; &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt; &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;!--æ­¤æ—¥å¿—appenderæ˜¯ä¸ºå¼€å‘ä½¿ç”¨ï¼Œåªé…ç½®æœ€åº•çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯--&gt; &lt;!-- ä¾‹å¦‚ï¼šå¦‚æœæ­¤å¤„é…ç½®äº†INFOçº§åˆ«ï¼Œåˆ™åé¢å…¶ä»–ä½ç½®å³ä½¿é…ç½®äº†DEBUGçº§åˆ«çš„æ—¥å¿—ï¼Œä¹Ÿä¸ä¼šè¢«è¾“å‡º --&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt; &lt;level&gt;INFO&lt;/level&gt; &lt;/filter&gt; &lt;encoder&gt; &lt;Pattern&gt;$&#123;CONSOLE_LOG_PATTERN&#125;&lt;/Pattern&gt; &lt;!-- è®¾ç½®å­—ç¬¦é›† --&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º INFO æ—¥å¿— --&gt; &lt;appender name=&quot;INFO_FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;$&#123;log.path&#125;/log_info.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --&gt; &lt;fileNamePattern&gt;$&#123;log.path&#125;/info/log-info-%d&#123;yyyy-MM-dd&#125;.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt; &lt;maxFileSize&gt;100MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;15&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•infoçº§åˆ«çš„ --&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt; &lt;level&gt;INFO&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º WARN æ—¥å¿— --&gt; &lt;appender name=&quot;WARN_FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;$&#123;log.path&#125;/log_warn.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;$&#123;log.path&#125;/warn/log-warn-%d&#123;yyyy-MM-dd&#125;.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt; &lt;maxFileSize&gt;100MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;15&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•warnçº§åˆ«çš„ --&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt; &lt;level&gt;warn&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º ERROR æ—¥å¿— --&gt; &lt;appender name=&quot;ERROR_FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;$&#123;log.path&#125;/log_error.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;$&#123;log.path&#125;/error/log-error-%d&#123;yyyy-MM-dd&#125;.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt; &lt;maxFileSize&gt;100MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;15&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --&gt; &lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- &lt;logger&gt;ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®š&lt;appender&gt;ã€‚ &lt;logger&gt;ä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œ ä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§ã€‚ name:ç”¨æ¥æŒ‡å®šå—æ­¤loggerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚ level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œ å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰loggerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚ --&gt; &lt;!-- ä½¿ç”¨mybatisçš„æ—¶å€™ï¼Œsqlè¯­å¥æ˜¯debugä¸‹æ‰ä¼šæ‰“å°ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬åªé…ç½®äº†infoï¼Œæ‰€ä»¥æƒ³è¦æŸ¥çœ‹sqlè¯­å¥çš„è¯ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š ç¬¬ä¸€ç§æŠŠ&lt;root level=&quot;INFO&quot;&gt;æ”¹æˆ&lt;root level=&quot;DEBUG&quot;&gt;è¿™æ ·å°±ä¼šæ‰“å°sqlï¼Œä¸è¿‡è¿™æ ·æ—¥å¿—é‚£è¾¹ä¼šå‡ºç°å¾ˆå¤šå…¶ä»–æ¶ˆæ¯ ç¬¬äºŒç§å°±æ˜¯å•ç‹¬ç»™mapperä¸‹ç›®å½•é…ç½®DEBUGæ¨¡å¼ï¼Œä»£ç å¦‚ä¸‹ï¼Œè¿™æ ·é…ç½®sqlè¯­å¥ä¼šæ‰“å°ï¼Œå…¶ä»–è¿˜æ˜¯æ­£å¸¸DEBUGçº§åˆ«ï¼š --&gt; &lt;!--å¼€å‘ç¯å¢ƒ:æ‰“å°æ§åˆ¶å°--&gt; &lt;springProfile name=&quot;dev&quot;&gt; &lt;!--å¯ä»¥è¾“å‡ºé¡¹ç›®ä¸­çš„debugæ—¥å¿—ï¼ŒåŒ…æ‹¬mybatisçš„sqlæ—¥å¿—--&gt; &lt;logger name=&quot;com.guli&quot; level=&quot;INFO&quot; /&gt; &lt;!-- rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±æ€§ level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œé»˜è®¤æ˜¯DEBUG å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªappenderå…ƒç´ ã€‚ --&gt; &lt;root level=&quot;INFO&quot;&gt; &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt; &lt;appender-ref ref=&quot;INFO_FILE&quot; /&gt; &lt;appender-ref ref=&quot;WARN_FILE&quot; /&gt; &lt;appender-ref ref=&quot;ERROR_FILE&quot; /&gt; &lt;/root&gt; &lt;/springProfile&gt; &lt;!--ç”Ÿäº§ç¯å¢ƒ:è¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;springProfile name=&quot;pro&quot;&gt; &lt;root level=&quot;INFO&quot;&gt; &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt; &lt;appender-ref ref=&quot;DEBUG_FILE&quot; /&gt; &lt;appender-ref ref=&quot;INFO_FILE&quot; /&gt; &lt;appender-ref ref=&quot;ERROR_FILE&quot; /&gt; &lt;appender-ref ref=&quot;WARN_FILE&quot; /&gt; &lt;/root&gt; &lt;/springProfile&gt;&lt;/configuration&gt; è¾“å‡ºé”™è¯¯æ—¥å¿— åœ¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»ä¸Šæ·»åŠ æ³¨é‡Šï¼Œå¹¶ä¸”åœ¨å¼‚å¸¸å¤„ç†çš„æ—¶å€™è°ƒç”¨log.error() 12345678910111213141516/** * ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±» */@ControllerAdvice // å¢å¼ºçš„controllerï¼Œå¯ä»¥ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†@Slf4j // è¾“å‡ºé”™è¯¯æ—¥å¿—public class GlobalExceptionHandler &#123; // ç‰¹å®šå¼‚å¸¸å¤„ç† @ExceptionHandler(ArithmeticException.class) @ResponseBody public R error(ArithmeticException e) &#123; e.printStackTrace(); log.error(e.getMessage()); // å°†é”™è¯¯æ—¥å¿—çš„å†…å®¹è¾“å‡ºåˆ°æ–‡ä»¶å½“ä¸­ return R.error().message(&quot;äº§ç”Ÿäº†ArithmeticExceptionå¼‚å¸¸!&quot;); &#125; // â€¦â€¦&#125; åœ¨é…ç½®çš„è·¯å¾„ä¸­å³å¯çœ‹åˆ°æ—¥å¿—æ–‡ä»¶ å½“å‰ç›®å½•ç»“æ„ service_eduè®²å¸ˆç®¡ç†æ¨¡å—ï¼ˆåç«¯ï¼‰å¿«é€Ÿå‰ç½®é…ç½®é…ç½®æ–‡ä»¶application.properties12345678910111213141516# ç«¯å£å·server.port=8001# æœåŠ¡åspring.application.name=service-edu# ç¯å¢ƒspring.profiles.active=dev# mysqlæ•°æ®åº“ä¿¡æ¯spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driverspring.datasource.url=jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8spring.datasource.username=rootspring.datasource.password=123456789# è¿”å›JSONçš„å…¨å±€æ—¶é—´æ ¼å¼spring.jackson.date-format=yyyy-MM-dd HH:mm:ssspring.jackson.time-zone=GMT+8#mybatisæ—¥å¿—mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl mybatisplusä»£ç ç”Ÿæˆå™¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import com.baomidou.mybatisplus.annotation.DbType;import com.baomidou.mybatisplus.annotation.IdType;import com.baomidou.mybatisplus.generator.AutoGenerator;import com.baomidou.mybatisplus.generator.config.DataSourceConfig;import com.baomidou.mybatisplus.generator.config.GlobalConfig;import com.baomidou.mybatisplus.generator.config.PackageConfig;import com.baomidou.mybatisplus.generator.config.StrategyConfig;import com.baomidou.mybatisplus.generator.config.rules.DateType;import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;import org.junit.Test;public class CodeGenerator &#123; @Test public void run() &#123; // 1ã€åˆ›å»ºä»£ç ç”Ÿæˆå™¨ AutoGenerator mpg = new AutoGenerator(); // 2ã€å…¨å±€é…ç½® GlobalConfig gc = new GlobalConfig(); // String projectPath = System.getProperty(&quot;user.dir&quot;); // gc.setOutputDir(projectPath + &quot;/src/main/java&quot;); // å»ºè®®å†™æˆç»å¯¹è·¯å¾„ gc.setOutputDir(&quot;D:\\\\MyProject\\\\springboot\\\\guli_parent\\\\service\\\\service_edu&quot; + &quot;/src/main/java&quot;); gc.setAuthor(&quot;testjava&quot;); gc.setOpen(false); //ç”Ÿæˆåæ˜¯å¦æ‰“å¼€èµ„æºç®¡ç†å™¨ gc.setFileOverride(false); //é‡æ–°ç”Ÿæˆæ—¶æ–‡ä»¶æ˜¯å¦è¦†ç›– gc.setServiceName(&quot;%sService&quot;); //å»æ‰Serviceæ¥å£çš„é¦–å­—æ¯I // idç±»å‹å¦‚æœæ˜¯Longåˆ™æ”¹ä¸ºID_WORKER gc.setIdType(IdType.ID_WORKER_STR); //ä¸»é”®ç­–ç•¥ gc.setDateType(DateType.ONLY_DATE);//å®šä¹‰ç”Ÿæˆçš„å®ä½“ç±»ä¸­æ—¥æœŸç±»å‹ gc.setSwagger2(true);//å¼€å¯Swagger2æ¨¡å¼ mpg.setGlobalConfig(gc); // 3ã€æ•°æ®æºé…ç½® DataSourceConfig dsc = new DataSourceConfig(); dsc.setUrl(&quot;jdbc:mysql://localhost:3306/guli?serverTimezone=GMT%2B8&quot;); dsc.setDriverName(&quot;com.mysql.cj.jdbc.Driver&quot;); dsc.setUsername(&quot;root&quot;); dsc.setPassword(&quot;123456789&quot;); dsc.setDbType(DbType.MYSQL); mpg.setDataSource(dsc); // 4ã€åŒ…é…ç½® PackageConfig pc = new PackageConfig(); pc.setModuleName(&quot;eduservice&quot;); //æ¨¡å—å pc.setParent(&quot;com.atguigu&quot;); pc.setController(&quot;controller&quot;); pc.setEntity(&quot;entity&quot;); pc.setService(&quot;service&quot;); pc.setMapper(&quot;mapper&quot;); mpg.setPackageInfo(pc); // 5ã€ç­–ç•¥é…ç½® StrategyConfig strategy = new StrategyConfig(); strategy.setInclude(&quot;edu_teacher&quot;); //åŠ è½½è¡¨ strategy.setNaming(NamingStrategy.underline_to_camel);//æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥ strategy.setTablePrefix(pc.getModuleName() + &quot;_&quot;); //ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€ strategy.setColumnNaming(NamingStrategy.underline_to_camel);//æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥ strategy.setEntityLombokModel(true); // lombok æ¨¡å‹ @Accessors(chain = true) setteré“¾å¼æ“ä½œ strategy.setRestControllerStyle(true); //restful apié£æ ¼æ§åˆ¶å™¨ strategy.setControllerMappingHyphenStyle(true); //urlä¸­é©¼å³°è½¬è¿å­—ç¬¦ mpg.setStrategy(strategy); // 6ã€æ‰§è¡Œ mpg.execute(); &#125;&#125; å½“å‰é¡¹ç›®ç»“æ„ åˆ›å»ºé…ç½®ç±» é…ç½®åŒ…æ‰«æç­‰ 123456789package com.atguigu.eduservice.config;import org.mybatis.spring.annotation.MapperScan;import org.springframework.context.annotation.Configuration;@Configuration@MapperScan(&quot;com.atguigu.eduservice.mapper&quot;)public class EduConfig &#123;&#125; åˆ›å»ºå¯åŠ¨ç±» å¯åŠ¨ç±»ä½ç½®è¦æ”¾åœ¨controllerã€entityç­‰packageçš„åŒçº§ï¼Œç„¶årunå³å¯å¯åŠ¨ 12345678910111213package com.atguigu.eduservice;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class EduApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(EduApplication.class, args); &#125;&#125; ç®€å•æŸ¥è¯¢æ‰€æœ‰è®²å¸ˆç¼–å†™controller12345678910111213141516171819202122232425262728293031323334353637package com.atguigu.eduservice.controller;import com.atguigu.eduservice.entity.EduTeacher;import com.atguigu.eduservice.service.EduTeacherService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import java.util.List;/** * &lt;p&gt; * è®²å¸ˆ å‰ç«¯æ§åˆ¶å™¨ * &lt;/p&gt; * * @author testjava * @since 2021-09-20 */@RestController@RequestMapping(&quot;/eduservice/edu-teacher&quot;)public class EduTeacherController &#123; @Autowired private EduTeacherService teacherService; // RESTé£æ ¼ // 1ã€æŸ¥è¯¢è®²å¸ˆè¡¨çš„æ‰€æœ‰æ•°æ® // åœ°å€ï¼šlocalhost:8001//eduservice/edu-teacher/findAll @GetMapping(&quot;findAll&quot;) public List&lt;EduTeacher&gt; findAllTeacher() &#123; // è°ƒç”¨Serviceçš„æ–¹æ³• List&lt;EduTeacher&gt; list = teacherService.list(null); return list; &#125;&#125; æµ‹è¯•localhost:8001//eduservice/edu-teacher/findAll é€»è¾‘åˆ é™¤è®²å¸ˆå®ä½“ç±»å±æ€§æ·»åŠ æ³¨è§£ ä¸ºEduTeacherå®ä½“ç±»æ·»åŠ ç›¸åº”çš„æ³¨é‡Š@TableLogic 123@ApiModelProperty(value = &quot;é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤&quot;)@TableLogicprivate Integer isDeleted; åˆ›å»ºmybatisplusé…ç½®ç±» æ·»åŠ é€»è¾‘åˆ é™¤æ’ä»¶ï¼ˆæ³¨æ„mybatisç‰ˆæœ¬ï¼Œä½ç‰ˆæœ¬æ˜¯éœ€è¦æ·»åŠ çš„ï¼Œé«˜ç‰ˆæœ¬ä¸ç”¨ï¼Œè€Œä¸”TableIdè‡ªåŠ¨è¯†åˆ«Type AutoGeneratorå†™æ³•ä¹Ÿæœ‰åŒºåˆ«ç­‰ï¼‰ 123456789101112131415161718192021package com.atguigu.eduservice.config;import com.baomidou.mybatisplus.core.injector.ISqlInjector;import com.baomidou.mybatisplus.extension.injector.LogicSqlInjector;import org.mybatis.spring.annotation.MapperScan;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configuration@MapperScan(&quot;com.atguigu.eduservice.mapper&quot;)public class EduConfig &#123; /** * é€»è¾‘åˆ é™¤æ’ä»¶ */ @Bean public ISqlInjector sqlInjector() &#123; return new LogicSqlInjector(); &#125;&#125; ç¼–å†™controller æ³¨æ„ä½¿ç”¨RESTé£æ ¼URIï¼ŒpathVariableå¯¹åº”è·¯å¾„å‚æ•° 123456// 2ã€é€»è¾‘åˆ é™¤è®²å¸ˆ@DeleteMapping(&quot;&#123;id&#125;&quot;)public boolean removeTeacher(@PathVariable(&quot;id&quot;) String id) &#123; boolean flag = teacherService.removeById(id); return flag;&#125; æµ‹è¯•ï¼ˆswaggerå·¥å…·ï¼‰ æ•´åˆswaggerå¯ä»¥ç”¨äºæ¥å£æµ‹è¯•ã€ç”Ÿæˆåœ¨çº¿æ¥å£æ–‡æ¡£ç­‰ åˆ†é¡µåŠŸèƒ½é…ç½®ç±»å¯¼å…¥æ’ä»¶123456789101112131415161718192021@Configuration@MapperScan(&quot;com.atguigu.eduservice.mapper&quot;)public class EduConfig &#123; /** * é€»è¾‘åˆ é™¤æ’ä»¶ */ @Bean public ISqlInjector sqlInjector() &#123; return new LogicSqlInjector(); &#125; /** * åˆ†é¡µæ’ä»¶ */ @Bean public PaginationInterceptor paginationInterceptor() &#123; return new PaginationInterceptor(); &#125;&#125; ç¼–å†™controller123456789101112131415161718192021/** * 3ã€åˆ†é¡µåŠŸèƒ½ * * @param current å½“å‰é¡µ * @param limit æ¯é¡µè®°å½•æ•° * @return */@GetMapping(&quot;pageTeacher/&#123;current&#125;/&#123;limit&#125;&quot;)public R pageListTeacher(@PathVariable long current, @PathVariable long limit) &#123; // åˆ›å»ºpageå¯¹è±¡ Page&lt;EduTeacher&gt; pageTeacher = new Page&lt;&gt;(current, limit); // è°ƒç”¨æ–¹æ³•å®ç°åˆ†ç±» teacherService.page(pageTeacher, null); long total = pageTeacher.getTotal(); List&lt;EduTeacher&gt; records = pageTeacher.getRecords(); HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;total&quot;, total); map.put(&quot;records&quot;, records); return R.ok().data(map);&#125; å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢åˆ†é¡µåˆ›å»ºVOå®ä½“å¯¹è±¡ æŠŠæ¡ä»¶å€¼ä¼ é€’åˆ°æ¥å£é‡Œï¼ˆå°†æ¡ä»¶å€¼å°è£…åˆ°VO(ViewObject)å®ä½“å¯¹è±¡å½“ä¸­ï¼Œå†æŠŠå¯¹è±¡voä¼ é€’åˆ°æ¥å£ä¸­ï¼‰æµ…æVOã€DTOã€DOã€POçš„æ¦‚å¿µã€åŒºåˆ«å’Œç”¨å¤„_zjrbianchengçš„ä¸“æ -CSDNåšå®¢å®ä½“ç±»ï¼ˆVOï¼ŒDOï¼ŒDTOï¼‰çš„åˆ’åˆ†_xin.wangçš„åšå®¢-CSDNåšå®¢ 123456789101112131415161718192021222324package com.atguigu.eduservice.entity.vo;import io.swagger.annotations.ApiModelProperty;import lombok.Data;// æ¡ä»¶å°è£…å¯¹è±¡@Datapublic class TeacherQuery &#123; // ä¸€ä¸‹å±æ€§æ˜¯å¯¹åº”çš„å¯è¢«ä¾æ®çš„æŸ¥è¯¢æ¡ä»¶ï¼ˆæ³¨æ„å’Œè¡¨ä¸­å­—æ®µåå¯¹åº”ï¼‰ @ApiModelProperty(value = &quot;æ•™å¸ˆåç§°,æ¨¡ç³ŠæŸ¥è¯¢&quot;) private String name; @ApiModelProperty(value = &quot;å¤´è¡” 1é«˜çº§è®²å¸ˆ 2é¦–å¸­è®²å¸ˆ&quot;) private Integer level; @ApiModelProperty(value = &quot;æŸ¥è¯¢å¼€å§‹æ—¶é—´&quot;, example = &quot;2019-01-01 10:10:10&quot;) private String begin;//æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Stringç±»å‹ï¼Œå‰ç«¯ä¼ è¿‡æ¥çš„æ•°æ®æ— éœ€è¿›è¡Œç±»å‹è½¬æ¢ @ApiModelProperty(value = &quot;æŸ¥è¯¢ç»“æŸæ—¶é—´&quot;, example = &quot;2019-12-01 10:10:10&quot;) private String end; &#125; ç¼–å†™controller123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * 4ã€å¤šæ¡ä»¶ç»„åˆåˆ†é¡µ * å‚æ•°ä¸­å¯ä»¥ä½¿ç”¨@RequestBody TeacherQuery teacherQuery * è¯¥æ³¨é‡Šè¡¨ç¤ºä½¿ç”¨JSONæ ¼å¼å‘åç«¯ä¼ é€’æ•°æ®ï¼Œä¼šè‡ªåŠ¨å°è£…åˆ°å¯¹åº”å¯¹è±¡ä¸­ï¼Œ * ä¸”éœ€è¦ä½¿ç”¨POSTMappingæ‰èƒ½è·å–æ•°æ®ï¼Œä¸”å¦‚æœæ•°æ®æœ‰ç©ºéœ€è¦åŠ ä¸Š(required = false) * * @param current å½“å‰é¡µ * @param limit æ¯é¡µè®°å½•æ•° * @param teacherQuery æ¡ä»¶å€¼ï¼ˆä»¥å¯¹è±¡çš„å½¢å¼ï¼‰ * @return */@ApiOperation(&quot;å¤šæ¡ä»¶ç»„åˆåˆ†é¡µ&quot;)@PostMapping(&quot;pageTeacherCondition/&#123;current&#125;/&#123;limit&#125;&quot;)public R pageListTeacherCondition(@PathVariable long current, @PathVariable long limit, @RequestBody(required = false) TeacherQuery teacherQuery) &#123; // åˆ›å»ºpageå¯¹è±¡ Page&lt;EduTeacher&gt; pageTeacher = new Page&lt;&gt;(current, limit); // åˆ›å»ºwrapperå¯¹è±¡ QueryWrapper&lt;EduTeacher&gt; wrapper = new QueryWrapper&lt;&gt;(); // è®¾å®šæ¡ä»¶ String name = teacherQuery.getName(); Integer level = teacherQuery.getLevel(); String begin = teacherQuery.getBegin(); String end = teacherQuery.getEnd(); if (StringUtils.hasLength(name)) &#123; wrapper.like(&quot;name&quot;, name); &#125; if (level != null) &#123; wrapper.eq(&quot;level&quot;, level); &#125; if (StringUtils.hasLength(begin)) &#123; wrapper.ge(&quot;gmt_create&quot;, begin); &#125; if (StringUtils.hasLength(end)) &#123; wrapper.le(&quot;gmt_create&quot;, end); &#125; // è°ƒç”¨serviceæ–¹æ³•å°†pageå¯¹è±¡æ ¹æ®æ¡ä»¶åˆ†é¡µ teacherService.page(pageTeacher, wrapper); long total = pageTeacher.getTotal(); List&lt;EduTeacher&gt; records = pageTeacher.getRecords(); return R.ok().data(&quot;total&quot;, total).data(&quot;records&quot;, records);&#125; æ·»åŠ è®²å¸ˆå®ä½“ç±»å±æ€§æ·»åŠ æ³¨è§£ @TableFieldï¼ˆfill = FieldFill.xxxï¼‰è‡ªåŠ¨å¡«å……æ³¨è§£ 1234567@ApiModelProperty(value = &quot;åˆ›å»ºæ—¶é—´&quot;)@TableField(fill = FieldFill.INSERT)private Date gmtCreate;@ApiModelProperty(value = &quot;æ›´æ–°æ—¶é—´&quot;)@TableField(fill = FieldFill.INSERT_UPDATE)private Date gmtModified; åˆ›å»ºè‡ªå®šä¹‰handlerç±» å¯ä»¥æ”¾åˆ°service_baseæ¨¡å—ï¼Œç„¶åéœ€è¦ä½¿ç”¨å¯¼å…¥ä¾èµ–å³å¯ å½“å¯¹åº”æ–¹æ³•è¢«ä½¿ç”¨çš„ä½¿ç”¨ä¼šè¢«è°ƒç”¨ 123456789101112131415161718192021package com.atguigu.servicebase.handler;import com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;import org.apache.ibatis.reflection.MetaObject;import org.springframework.stereotype.Component;import java.util.Date;@Componentpublic class MyMetaObjectHandler implements MetaObjectHandler &#123; @Override public void insertFill(MetaObject metaObject) &#123; this.setFieldValByName(&quot;gmtCreate&quot;, new Date(), metaObject); this.setFieldValByName(&quot;gmtModified&quot;, new Date(), metaObject); &#125; @Override public void updateFill(MetaObject metaObject) &#123; this.setFieldValByName(&quot;gmtModified&quot;, new Date(), metaObject); &#125;&#125; æ³¨æ„ç»“æ„ ç¼–å†™controller123456789101112/** * 5ã€æ·»åŠ è®²å¸ˆ * * @param eduTeacher * @return */@ApiOperation(&quot;æ·»åŠ è®²å¸ˆ&quot;)@PostMapping(&quot;addTeacher&quot;)public R addTeacher(@RequestBody EduTeacher eduTeacher) &#123; boolean save = teacherService.save(eduTeacher); return save ? R.ok() : R.error();&#125; ä¿®æ”¹è®²å¸ˆç¼–å†™controller12345678910111213@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢è®²å¸ˆ&quot;)@GetMapping(&quot;getTeacher/&#123;id&#125;&quot;)public R getTeacher(@PathVariable String id) &#123; EduTeacher teacher = teacherService.getById(id); return R.ok().data(&quot;teacher&quot;, teacher);&#125;@ApiOperation(&quot;ä¿®æ”¹è®²å¸ˆ&quot;)@PostMapping(&quot;updateTeacher&quot;)public R updateTeacher(@RequestBody EduTeacher teacher) &#123; boolean flag = teacherService.updateById(teacher); return flag ? R.ok() : R.error();&#125; ä½¿ç”¨@PutMappingå¦‚ä¸‹ 12345678@ApiOperation(&quot;ä¿®æ”¹è®²å¸ˆ&quot;)@PutMapping(&quot;&#123;id&#125;&#125;&quot;)public R updateTeacher(@PathVariable String id, @RequestBody EduTeacher teacher) &#123; teacher.setId(id); boolean flag = teacherService.updateById(teacher); return flag ? R.ok() : R.error();&#125; å¾…ç»­","categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"}]},{"title":"ã€Unityã€‘ä»ç‹¬ç«‹æ¸¸æˆå­¦ä¹ å¼€å‘","slug":"ã€Unity2Dã€‘ä»ç‹¬ç«‹æ¸¸æˆå­¦ä¹ å¼€å‘","date":"2021-08-24T07:54:59.786Z","updated":"2021-08-25T13:10:56.313Z","comments":true,"path":"2021/08/24/unity2d-cong-du-li-you-xi-xue-xi-kai-fa/","link":"","permalink":"http://example.com/2021/08/24/unity2d-cong-du-li-you-xi-xue-xi-kai-fa/","excerpt":"","text":"æ„Ÿè°¢æ„Ÿè°¢bilibiliè§†é¢‘ç½‘ç«™M_Studioéº¦å£è€å¸ˆç³»åˆ—è§†é¢‘æ•™å­¦ï¼ŒUnity2Déƒ½æ˜¯ä»ä»–è¿™å­¦çš„ã€‚ åˆ›å»ºé¡¹ç›®ä¸å¯¼å…¥ç´ æ åˆ›å»ºæ–°é¡¹ç›® å¯¼å…¥ç´ æï¼Œç‚¹å‡»èœå•æ Assets -&gt; ImportPackage å¯¼å…¥å¹¶ç¼–è¾‘Tiles ç‚¹å‡»èœå•æ window -&gt; 2D -&gt; tile palette ï¼Œç‚¹å‡»createNewPaletteåˆ›å»ºpalette å¯¼å…¥Levelæ–‡ä»¶å¤¹ä¸‹Spiritæ–‡ä»¶å¤¹ä¸­çš„ç´ æï¼Œå¹¶ä¸”é€‚å½“ç¼–è¾‘ TileMap åœ¨Hierarchyçª—å£ï¼Œåˆ›å»ºæ‰€éœ€è¦çš„2dObject -&gt; tilemap åœ¨Tile Paletteçª—å£ï¼Œé€‰ä¸­ç›¸åº”Active Tile Mapå¹¶ç»˜åˆ¶ åœ¨Inspectorçª—å£è®¾ç½®Sorting Layerï¼Œå¦‚ä¸‹ â€‹ Sorting Layerä¸­Layerè¶Šé ä¸‹è¶Šæ˜¾ç¤ºåœ¨å‰æ–¹ï¼Œä½äºåŒä¸€Layerä¸­Order in Layeræ•°å€¼è¶Šå¤§è¶Šæ˜¾ç¤ºåœ¨å‰æ–¹ å…¶ä¸­ Background Detailsç”¨äºåœ¨Backgroundä¸­å†æ·»åŠ ç›¸åº”tileï¼ˆåœ¨åŒä¸€ä¸ªTileMapä¸Šç»˜åˆ¶åªèƒ½æ˜¾ç¤ºä¸€ä¸ªtileï¼Œå³ä½¿tileæ˜¯å«æœ‰é€æ˜èƒŒæ™¯ï¼Œä¹Ÿä¼šå®Œå…¨æ›¿æ¢ï¼‰ 2D Extraæ’ä»¶RuleTile åœ¨Tilesæ–‡ä»¶å¤¹ä¸‹å³é”®ç‚¹å‡» Create -&gt; tiles -&gt; rule tileï¼Œå¹¶åœ¨Inspectorçª—å£ä¸­è®¾ç½® Default Spriteé»˜è®¤å›¾ç‰‡ åœ¨Inspectorçª—å£ä¸­ï¼Œè®¾ç½®Tiling Rulesï¼Œå¹¶å°†æ–°tileæ‹–æ‹½è¿›Tile Paletteå¹¶ç»˜åˆ¶ï¼Œå¦‚ä¸‹ â€‹ æ¯ä¸€ä¸ªTiling Rulesä¸­ï¼Œå³ä¾§å›¾ç‰‡ä¸ºç¬¦åˆè¯¥è§„åˆ™å°±æ˜¾ç¤ºçš„tileï¼Œä¹å®«æ ¼ä¸­è®¾ç½®è§„åˆ™ï¼Œç»¿è‰²ç®­å¤´è¡¨ç¤ºåœ¨è¯¥æ–¹å‘ä¸Šæœ‰tileï¼Œçº¢è‰²å‰å·è¡¨ç¤ºä¸èƒ½æœ‰tileï¼ŒåŒæ—¶åˆ—è¡¨ä¸­è¶Šé ä¸Šçš„ruleä¼˜å…ˆçº§è¶Šé«˜â€‹ å¦‚ä¸Šè®¾ç½®å¯å¿«é€Ÿå¡«å……å°é—­å›¾å½¢çš„å¯¹åº”tile å¦‚ä¸‹è§„åˆ™è§£å†³å†…è§’é—®é¢˜ï¼Œæ³¨æ„è¿™å››ä¸ªè§’çš„é¢å¤–ruleè¦æ”¾åœ¨æ¨ªç«–ä¸¤ä¸ªtileçš„ä¸Šæ–¹ Brush æƒ³è¦æ·»åŠ è´´åˆæ ¼å­çš„ç‰©ä»¶prefabï¼Œå¯ä»¥ä½¿ç”¨åˆ›å»ºbrushçš„æ–¹å¼ åˆ›å»ºbrushï¼Œå³é”®ç‚¹å‡» create -&gt; Brush -&gt; prefab Brush æ·»åŠ Element åœ¨ Tile Palette çª—å£ä¸­å·¦ä¸‹è§’ä½¿ç”¨è‡ªå®šä¹‰brushå³å¯ æ·»åŠ çš„å¯¹è±¡åˆ«å¿˜äº†è®¾ç½®Layerä»¥åˆ¤æ–­ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨Overrideä½¿å¾—åŒä¸€ç‰©å“ç›¸åŒè®¾ç½® Colliderå’ŒRigidbodyPlatformè®¾ç½®Colliderå’ŒRigidbody é€‰ä¸­Platformå¯¹è±¡ï¼Œåœ¨Inspectorçª—å£ä¸‹æ–¹ç‚¹å‡» add component -&gt; Tilemap Collider 2D å‹¾é€‰colliderä¸­çš„ user By Compositeï¼Œå³ä½¿ç”¨å¤åˆç¢°æ’ä½“ï¼ŒæŒ‰ç…§æç¤ºæ·»åŠ  Composite Collider 2Dï¼Œåˆ™æ•´ä¸ªPlatformä¸ºä¸€ä¸ªæ•´ä½“ç¢°æ’ä½“ å°†éšä¹‹æ·»åŠ çš„ rigidbody -&gt; bodytypeè®¾ç½®ä¸ºstaticï¼Œå³å¯ä¿æŒPlatformå›ºå®šï¼Œè€Œä¸ä¼šå› ä¸ºgravityé‡åŠ›ä¸‹è½ åŒæ—¶ä¹Ÿå¯ä»¥å°†Platformæœ¬èº«è®¾ç½®ä¸ºstatic Playerè®¾ç½®Colliderå’ŒRigidbody é€‰ä¸­Playerå¯¹è±¡ï¼Œç‚¹å‡» add component -&gt; rigidbody 2Dï¼Œå¹¶è®¾ç½®å‚æ•°å¦‚ä¸‹ â€‹ æ³¨æ„Colllision Detection ç¢°æ’æ–¹å¼è®¾ç½®ä¸ºContinuousï¼Œå³å¯æŒç»­åˆ¤æ–­æ˜¯å¦äº§ç”Ÿç¢°æ’ï¼› Interpolateå·®å€¼è®¾ç½®ä¸ºInterpolateï¼Œå³å¯å½“ä¸‹è½ç¢°æ’æ—¶å¯¹ç¢°æ’ä½“äº§ç”Ÿä¸€å®šæ•ˆæœï¼ˆåŸºäºä¸Šä¸€å¸§ç‰©ä½“ä½ç½®æ¥æ’å€¼æ¨¡æ‹Ÿï¼‰ ç‚¹å‡» add component -&gt; Box Collider 2Dï¼Œå¹¶ç‚¹å‡»Editè®¾ç½®ç¢°æ’ä½“èŒƒå›´ åŒæ—¶åœ¨ Constraintsé™åˆ¶é€‰é¡¹ä¸­é€‰æ‹©Freeze Rotation Zï¼Œå³å¯é˜²æ­¢å½“è§’è‰²å¤„äºPlatformè§’ä¸Šæ—¶ä¼šç»•ç€Zè½´æ—‹è½¬æ‰è½ åŒæ—¶ä¸ºCollideræ·»åŠ Materail Layerä¸ºPlatformå’ŒPlayeræ·»åŠ ä¸åŒçš„Layerï¼Œç”¨äºæ—¥ååˆ¤æ–­ Playerå·¦å³ç§»åŠ¨å’Œå½¢è±¡ç¿»è½¬12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerMovement : MonoBehaviour&#123; // é€šè¿‡ â€œHeaderâ€, â€œTooltipâ€ and â€œSpaceâ€ å±æ€§æ¥ç»„ç»‡Inspectorä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå³åœ¨Inspectorçª—å£ä¸Šæœ‰å°æ ‡é¢˜åˆ†åŒºæ˜¾ç¤º // åˆ›å»ºrigidbody private Rigidbody2D rb; [Header(&quot;ç§»åŠ¨å‚æ•°&quot;)] public float speed = 8f; // public float crouchSpeedDivisor = 3f; // è¹²ä¸‹é€Ÿåº¦å‡ç¼“é‡ [Header(&quot;çŠ¶æ€&quot;)] public bool isCrouch; // æ˜¯å¦ä¸‹è¹² float xVelocity; // è½´é€Ÿåº¦ void Start() &#123; // è·å–rigidbody rb = GetComponent&lt;Rigidbody2D&gt;(); &#125; void Update() &#123; &#125; // å›ºå®šå¸§é€Ÿç‡ä¸‹æ¯å¸§éƒ½è°ƒç”¨è¯¥å‡½æ•° private void FixedUpdate() &#123; GroundMovement(); &#125; // æ§åˆ¶è§’è‰²å·¦å³ç§»åŠ¨ void GroundMovement() &#123; // è·å–é”®ç›˜è¾“å…¥å¹¶è®¾ç½®ç§»åŠ¨ xVelocity = Input.GetAxis(&quot;Horizontal&quot;); // è¿”å›å€¼-1f ~ 1fï¼Œå½“ä¸æŒ‰ä¸‹æ–¹å‘é”®æ—¶ä¸º0 rb.velocity = new Vector2(xVelocity * speed, rb.velocity.y); // æ§åˆ¶æœå‘ FlipDiraction(); &#125; // æ§åˆ¶è§’è‰²é¢å‘æ–¹å‘ void FlipDiraction() &#123; if(xVelocity &lt; 0) &#123; transform.localScale = new Vector2(-1, 1); &#125;else if(xVelocity &gt; 0) &#123; transform.localScale = new Vector2(1, 1); &#125; &#125;&#125; Playerä¸‹è¹²ç‚¹å‡» Edit -&gt; Project Setting -&gt; Input Manager -&gt; å¤åˆ¶JumpElementå¹¶ä¿®æ”¹ä¸ºCrouch 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerMovement : MonoBehaviour&#123; // é€šè¿‡ â€œHeaderâ€, â€œTooltipâ€ and â€œSpaceâ€ å±æ€§æ¥ç»„ç»‡Inspectorä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå³åœ¨Inspectorçª—å£ä¸Šæœ‰å°æ ‡é¢˜åˆ†åŒºæ˜¾ç¤º // rigidbody,collider private Rigidbody2D rb; private BoxCollider2D coll; // ä½¿ç”¨BoxColliderå¯ä»¥ç›´æ¥è·å¾—å…¶ä¸­çš„sizeã€offsetå‚æ•° [Header(&quot;ç§»åŠ¨å‚æ•°&quot;)] public float speed = 8f; // public float crouchSpeedDivisor = 3f; // è¹²ä¸‹æ—¶çš„é€Ÿåº¦å‡ç¼“é‡ [Header(&quot;çŠ¶æ€&quot;)] public bool isCrouch; // æ˜¯å¦ä¸‹è¹² float xVelocity; // è½´é€Ÿåº¦ // ç¢°æ’ä½“å°ºå¯¸ (ç«™ç«‹ã€ä¸‹è¹²æ—¶çš„å¤§å°ã€ä½ç½®) Vector2 colliderStandSize, colliderStandOffset,colliderCrouchSize, colliderCrouchOffset; // åˆå§‹åŒ–å‚æ•° void Start() &#123; // rigidbody,collider rb = GetComponent&lt;Rigidbody2D&gt;(); coll = GetComponent&lt;BoxCollider2D&gt;(); // ç¢°æ’ä½“å°ºå¯¸ colliderStandSize = coll.size; colliderStandOffset = coll.offset; colliderCrouchSize = new Vector2(coll.size.x, coll.size.y / 2f); colliderCrouchOffset = new Vector2(coll.offset.x, coll.offset.y / 2f); &#125; // Update is called once per frame void Update() &#123; &#125; // å›ºå®šå¸§é€Ÿç‡ä¸‹æ¯å¸§éƒ½è°ƒç”¨è¯¥å‡½æ•° private void FixedUpdate() &#123; GroundMovement(); &#125; // æ§åˆ¶è§’è‰²å·¦å³ç§»åŠ¨ void GroundMovement() &#123; // è·å–é”®ç›˜è¾“å…¥ xVelocity = Input.GetAxis(&quot;Horizontal&quot;); // è¿”å›å€¼-1f ~ 1fï¼Œå½“ä¸æŒ‰ä¸‹æ–¹å‘é”®æ—¶ä¸º0 // åˆ¤æ–­æ˜¯å¦æŒ‰ä¸‹ä¸‹è¹²æŒ‰é’®ã€æ˜¯å¦æœªæŒ‰ä¸‹æŒ‰é’®å¹¶å¤„äºä¸‹è¹²çŠ¶æ€ if (Input.GetButton(&quot;Crouch&quot;)) &#123; // æ§åˆ¶è§’è‰²ä¸‹è¹² Crouch(); &#125;else if(isCrouch) &#123; // æ§åˆ¶è§’è‰²èµ·èº« StandUp(); &#125; // æ§åˆ¶è§’è‰²é€Ÿåº¦ä»¥ç§»åŠ¨ rb.velocity = new Vector2(xVelocity * speed, rb.velocity.y); // æ§åˆ¶æœå‘ FlipDiraction(); &#125; // æ§åˆ¶è§’è‰²é¢å‘æ–¹å‘ void FlipDiraction() &#123; if(xVelocity &lt; 0) &#123; transform.localScale = new Vector2(-1, 1); &#125;else if(xVelocity &gt; 0) &#123; transform.localScale = new Vector2(1, 1); &#125; &#125; // æ§åˆ¶è§’è‰²ä¸‹è¹² void Crouch() &#123; isCrouch = true; // ä¸‹è¹²æ—¶é€Ÿåº¦å‡ç¼“ xVelocity /= crouchSpeedDivisor; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderCrouchSize; coll.offset = colliderCrouchOffset; &#125; // æ§åˆ¶è§’è‰²èµ·ç«‹ void StandUp() &#123; isCrouch = false; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderStandSize; coll.offset = colliderStandOffset; &#125;&#125; Playerè·³è·ƒ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerMovement : MonoBehaviour&#123; // é€šè¿‡ â€œHeaderâ€, â€œTooltipâ€ and â€œSpaceâ€ å±æ€§æ¥ç»„ç»‡Inspectorä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå³åœ¨Inspectorçª—å£ä¸Šæœ‰å°æ ‡é¢˜åˆ†åŒºæ˜¾ç¤º // rigidbody,collider private Rigidbody2D rb; private BoxCollider2D coll; // ä½¿ç”¨BoxColliderå¯ä»¥ç›´æ¥è·å¾—å…¶ä¸­çš„sizeã€offsetå‚æ•° [Header(&quot;ç§»åŠ¨å‚æ•°&quot;)] public float speed = 8f; public float crouchSpeedDivisor = 3f; // è¹²ä¸‹æ—¶çš„é€Ÿåº¦å‡ç¼“é‡ [Header(&quot;è·³è·ƒå‚æ•°&quot;)] public float jumpForce = 6.3f; // è·³è·ƒåŠ› public float jumpHoldForce = 1.9f; // é•¿æŒ‰è·³è·ƒçš„åŠ› public float jumpHoldDuration = 0.1f; // é•¿æŒ‰è·³è·ƒåŠ æˆ public float crouchJumpBoost = 2.5f; // ä¸‹è¹²è·³è·ƒçš„åŠ æˆ [Header(&quot;çŠ¶æ€&quot;)] public bool isCrouch; // æ˜¯å¦ä¸‹è¹² public bool isOnGround; // æ˜¯å¦æ¥è§¦åœ°é¢ public bool isJump; // æ˜¯å¦è·³è·ƒ [Header(&quot;ç¯å¢ƒæ£€æµ‹&quot;)] public LayerMask groundLayer; // åœ°é¢å±‚ float xVelocity; // è½´é€Ÿåº¦ float jumpTime; // è·³è·ƒæ—¶é—´ï¼Œä¸durationç›¸å…³ // æŒ‰é”® bool jumpPressed, jumpHeld, crouchHeld; // ç¢°æ’ä½“å°ºå¯¸ (ç«™ç«‹ã€ä¸‹è¹²æ—¶çš„å¤§å°ã€ä½ç½®) Vector2 colliderStandSize, colliderStandOffset,colliderCrouchSize, colliderCrouchOffset; // åˆå§‹åŒ–å‚æ•° void Start() &#123; // rigidbody,collider rb = GetComponent&lt;Rigidbody2D&gt;(); coll = GetComponent&lt;BoxCollider2D&gt;(); // ç¢°æ’ä½“å°ºå¯¸ colliderStandSize = coll.size; colliderStandOffset = coll.offset; colliderCrouchSize = new Vector2(coll.size.x, coll.size.y / 2f); colliderCrouchOffset = new Vector2(coll.offset.x, coll.offset.y / 2f); &#125; // è·å–GetButtonæœ€å¥½æ”¾åœ¨æ­¤å‡½æ•°ä¸­ void Update() &#123; // GetButtonå‚æ•°å¯¹åº”Project Setting -&gt; Input Managerçš„è®¾ç½® jumpPressed = Input.GetButtonDown(&quot;Jump&quot;); jumpHeld = Input.GetButton(&quot;Jump&quot;); crouchHeld = Input.GetButton(&quot;Crouch&quot;); &#125; // å›ºå®šå¸§é€Ÿç‡ä¸‹æ¯å¸§éƒ½è°ƒç”¨è¯¥å‡½æ•° private void FixedUpdate() &#123; // ç›¸å…³ç‰©ç†æ§åˆ¶ GroundMovement(); PhysicsCheck(); MidAirMovement(); &#125; // ç¯å¢ƒæ£€æµ‹ void PhysicsCheck() &#123; // æ˜¯å¦æ¥è§¦åœ°é¢å±‚ if (coll.IsTouchingLayers(groundLayer)) &#123; isOnGround = true; &#125; else &#123; isOnGround = false; &#125; &#125; // æ§åˆ¶è§’è‰²å·¦å³ç§»åŠ¨ void GroundMovement() &#123; // è·å–é”®ç›˜è¾“å…¥ xVelocity = Input.GetAxis(&quot;Horizontal&quot;); // è¿”å›å€¼-1f ~ 1fï¼Œå½“ä¸æŒ‰ä¸‹æ–¹å‘é”®æ—¶ä¸º0 // åˆ¤æ–­æ˜¯å¦ if (crouchHeld &amp;&amp; !isCrouch &amp;&amp; isOnGround) &#123; // æŒ‰ä¸‹ä¸‹è¹²æŒ‰é’®ï¼Œä¸å¤„äºä¸‹è¹²çŠ¶æ€ï¼Œæ¥è§¦åœ°é¢ --ã€‹ è§’è‰²ä¸‹è¹² Crouch(); &#125; else if(!crouchHeld &amp;&amp; isCrouch) &#123; // æœªæŒ‰ä¸‹æŒ‰é’®å¹¶å¤„äºä¸‹è¹²çŠ¶æ€ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; else if(!isOnGround &amp;&amp; isCrouch) &#123; // ä¸æ¥è§¦åœ°é¢ä½†æ˜¯å¤„äºä¸‹è¹²çŠ¶æ€ â€”â€”ã€‹ å¤„äºç©ºä¸­ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; // æ§åˆ¶è§’è‰²é€Ÿåº¦ä»¥ç§»åŠ¨ rb.velocity = new Vector2(xVelocity * speed, rb.velocity.y); // æ§åˆ¶æœå‘ FlipDiraction(); &#125; // æ§åˆ¶è§’è‰²è·³è·ƒ void MidAirMovement() &#123; if(jumpPressed &amp;&amp; isOnGround &amp;&amp; !isJump) &#123; // isOnGround &amp;&amp; !isJump é˜²æ­¢è¹­å¢™æ— é™è·³ // æŒ‰ä¸‹äº†è·³è·ƒï¼Œæ¥è§¦åœ°é¢ï¼Œæœªå¤„äºè·³è·ƒçŠ¶æ€ â€”â€”ã€‹ æ§åˆ¶è·³è·ƒ // ä¸‹è¹²çŠ¶æ€è·³è·ƒï¼Œæœ‰é¢å¤–åŠ›çš„åŠ æˆ if (isCrouch) &#123; // æ§åˆ¶èµ·èº« StandUp(); // æ·»åŠ é¢å¤–åŠ› rb.AddForce(new Vector2(0f, crouchJumpBoost), ForceMode2D.Impulse); &#125; isJump = true; isOnGround = false; // è®¡ç®—è·³è·ƒæ—¶çš„æ—¶é—´ï¼ŒTime.timeè·å–æ¸¸æˆçœŸå®æŒç»­æ—¶é—´(ä¸æ–­å¢é•¿) jumpTime = Time.time + jumpHoldDuration; // ä¿®æ”¹rb.velocityä¹Ÿå¯ä»¥å®ç° rb.AddForce(new Vector2(0f, jumpForce), ForceMode2D.Impulse); &#125; else if (isJump) &#123; // é•¿æŒ‰è·³è·ƒï¼Œè·å¾—é¢å¤–çš„åŠ›jumpHoldForceåŠ æˆ if (jumpHeld) &#123; rb.AddForce(new Vector2(0f, jumpHoldForce), ForceMode2D.Impulse); &#125; // å½“Time.timeè·å–çš„æ—¶é—´æ¯”jumpTimeå¤§ï¼Œå³ä¹‹é—´çš„æ—¶é—´å·®å·²ç»å¤§äºjumpHoldDurationçš„å€¼æ—¶ï¼Œå³å¯æ¢å¤isJump if (jumpTime &lt; Time.time) &#123; isJump = false; &#125; &#125; &#125; // æ§åˆ¶è§’è‰²é¢å‘æ–¹å‘ void FlipDiraction() &#123; if(xVelocity &lt; 0) &#123; transform.localScale = new Vector2(-1, 1); &#125;else if(xVelocity &gt; 0) &#123; transform.localScale = new Vector2(1, 1); &#125; &#125; // æ§åˆ¶è§’è‰²ä¸‹è¹² void Crouch() &#123; isCrouch = true; // ä¸‹è¹²æ—¶é€Ÿåº¦å‡ç¼“ xVelocity /= crouchSpeedDivisor; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderCrouchSize; coll.offset = colliderCrouchOffset; &#125; // æ§åˆ¶è§’è‰²èµ·ç«‹ void StandUp() &#123; isCrouch = false; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderStandSize; coll.offset = colliderStandOffset; &#125;&#125; Raycastå°„çº¿æ£€æµ‹å®ç°ç§»åŠ¨è·³è·ƒä¸‹è¹²æ£€æµ‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerMovement : MonoBehaviour&#123; // é€šè¿‡ â€œHeaderâ€, â€œTooltipâ€ and â€œSpaceâ€ å±æ€§æ¥ç»„ç»‡Inspectorä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå³åœ¨Inspectorçª—å£ä¸Šæœ‰å°æ ‡é¢˜åˆ†åŒºæ˜¾ç¤º // rigidbody,collider private Rigidbody2D rb; private BoxCollider2D coll; // ä½¿ç”¨BoxColliderå¯ä»¥ç›´æ¥è·å¾—å…¶ä¸­çš„sizeã€offsetå‚æ•° [Header(&quot;ç§»åŠ¨å‚æ•°&quot;)] public float speed = 8f; public float crouchSpeedDivisor = 3f; // è¹²ä¸‹æ—¶çš„é€Ÿåº¦å‡ç¼“é‡ [Header(&quot;è·³è·ƒå‚æ•°&quot;)] public float jumpForce = 6.3f; // è·³è·ƒåŠ› public float jumpHoldForce = 1.9f; // é•¿æŒ‰è·³è·ƒçš„åŠ› public float jumpHoldDuration = 0.1f; // é•¿æŒ‰è·³è·ƒåŠ æˆ public float crouchJumpBoost = 2.5f; // ä¸‹è¹²è·³è·ƒçš„åŠ æˆ [Header(&quot;çŠ¶æ€&quot;)] public bool isCrouch; // æ˜¯å¦ä¸‹è¹² public bool isOnGround; // æ˜¯å¦æ¥è§¦åœ°é¢ public bool isHeadBlocked; // æ˜¯å¦å¤´é¡¶é®æŒ¡ public bool isJump; // æ˜¯å¦è·³è·ƒ [Header(&quot;ç¯å¢ƒæ£€æµ‹&quot;)] public float footOffset = 0.35f; // å•è„šçš„åç§»å€¼ï¼Œå³æ•´ä½“xoffsetçš„ä¸€åŠ public float headClearance = 0.5f; public float groundDistance = 0.2f; public LayerMask groundLayer; // åœ°é¢å±‚ float xVelocity; // è½´é€Ÿåº¦ float jumpTime; // è·³è·ƒæ—¶é—´ï¼Œä¸durationç›¸å…³ // æŒ‰é”® bool jumpPressed, jumpHeld, crouchHeld; // ç¢°æ’ä½“å°ºå¯¸ (ç«™ç«‹ã€ä¸‹è¹²æ—¶çš„å¤§å°ã€ä½ç½®) Vector2 colliderStandSize, colliderStandOffset,colliderCrouchSize, colliderCrouchOffset; // åˆå§‹åŒ–å‚æ•° void Start() &#123; // rigidbody,collider rb = GetComponent&lt;Rigidbody2D&gt;(); coll = GetComponent&lt;BoxCollider2D&gt;(); // ç¢°æ’ä½“å°ºå¯¸ colliderStandSize = coll.size; colliderStandOffset = coll.offset; colliderCrouchSize = new Vector2(coll.size.x, coll.size.y / 2f); colliderCrouchOffset = new Vector2(coll.offset.x, coll.offset.y / 2f); &#125; // è·å–GetButtonæœ€å¥½æ”¾åœ¨æ­¤å‡½æ•°ä¸­ void Update() &#123; // GetButtonå‚æ•°å¯¹åº”Project Setting -&gt; Input Managerçš„è®¾ç½® jumpPressed = Input.GetButtonDown(&quot;Jump&quot;); jumpHeld = Input.GetButton(&quot;Jump&quot;); crouchHeld = Input.GetButton(&quot;Crouch&quot;); &#125; // å›ºå®šå¸§é€Ÿç‡ä¸‹æ¯å¸§éƒ½è°ƒç”¨è¯¥å‡½æ•° private void FixedUpdate() &#123; // ç›¸å…³ç‰©ç†æ§åˆ¶ GroundMovement(); PhysicsCheck(); MidAirMovement(); &#125; // ç¯å¢ƒæ£€æµ‹ void PhysicsCheck() &#123; /* // å½“å‰è§’è‰²çš„ä½ç½®å’Œå•è„šå·¦å³ç‚¹çš„offset Vector2 pos = transform.position; Vector2 offset = new Vector2(-footOffset, 0f); // leftCheck/rightCheckå³å•è„šå·¦å³ç‚¹æ£€æµ‹ RaycastHit2D leftCheck = Physics2D.Raycast(pos+offset,Vector2.down,groundDistance,groundLayer); // æ˜¾ç¤ºå°„çº¿ Debug.DrawRay(pos + offset, Vector2.down, Color.red, 0.2f); */ // 1ã€å·¦å³è„šæ£€æµ‹æ˜¯å¦æ¥è§¦åœ°é¢ // è·å¾—å°„çº¿æ£€æµ‹ RaycastHit2D leftCheck = Raycast(new Vector2(-footOffset, 0f), Vector2.down, groundDistance, groundLayer); RaycastHit2D rightCheck = Raycast(new Vector2(footOffset, 0f), Vector2.down, groundDistance, groundLayer); // æ˜¯å¦æ¥è§¦åœ°é¢å±‚ //if (coll.IsTouchingLayers(groundLayer)) if (leftCheck || rightCheck) &#123; isOnGround = true; &#125; else &#123; isOnGround = false; &#125; // 2ã€å¤´é¡¶æ£€æµ‹æ˜¯å¦æœ‰é˜»æŒ¡ RaycastHit2D headCheck = Raycast(new Vector2(0f, coll.size.y), Vector2.up, headClearance, groundLayer); if (headCheck) &#123; isHeadBlocked = true; &#125; else &#123; isHeadBlocked = false; &#125; &#125; // æ§åˆ¶è§’è‰²å·¦å³ç§»åŠ¨ void GroundMovement() &#123; // è·å–é”®ç›˜è¾“å…¥ xVelocity = Input.GetAxis(&quot;Horizontal&quot;); // è¿”å›å€¼-1f ~ 1fï¼Œå½“ä¸æŒ‰ä¸‹æ–¹å‘é”®æ—¶ä¸º0 // åˆ¤æ–­æ˜¯å¦ if (crouchHeld &amp;&amp; !isCrouch &amp;&amp; isOnGround) &#123; // æŒ‰ä¸‹ä¸‹è¹²æŒ‰é’®ï¼Œä¸å¤„äºä¸‹è¹²çŠ¶æ€ï¼Œæ¥è§¦åœ°é¢ --ã€‹ è§’è‰²ä¸‹è¹² Crouch(); &#125; else if(!crouchHeld &amp;&amp; isCrouch &amp;&amp; !isHeadBlocked) &#123; // æœªæŒ‰ä¸‹æŒ‰é’®,å¤„äºä¸‹è¹²çŠ¶æ€,å¤´é¡¶æ— é®æŒ¡ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; else if(!isOnGround &amp;&amp; isCrouch) &#123; // ä¸æ¥è§¦åœ°é¢ä½†æ˜¯å¤„äºä¸‹è¹²çŠ¶æ€ â€”â€”ã€‹ å¤„äºç©ºä¸­ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; // æ§åˆ¶è§’è‰²é€Ÿåº¦ä»¥ç§»åŠ¨ rb.velocity = new Vector2(xVelocity * speed, rb.velocity.y); // æ§åˆ¶æœå‘ FlipDiraction(); &#125; // æ§åˆ¶è§’è‰²è·³è·ƒ void MidAirMovement() &#123; if(jumpPressed &amp;&amp; isOnGround &amp;&amp; !isJump) &#123; // isOnGround &amp;&amp; !isJump é˜²æ­¢è¹­å¢™æ— é™è·³ // æŒ‰ä¸‹äº†è·³è·ƒï¼Œæ¥è§¦åœ°é¢ï¼Œæœªå¤„äºè·³è·ƒçŠ¶æ€ â€”â€”ã€‹ æ§åˆ¶è·³è·ƒ // ä¸‹è¹²çŠ¶æ€è·³è·ƒï¼Œæœ‰é¢å¤–åŠ›çš„åŠ æˆ if (isCrouch) &#123; // æ§åˆ¶èµ·èº« StandUp(); // æ·»åŠ é¢å¤–åŠ› rb.AddForce(new Vector2(0f, crouchJumpBoost), ForceMode2D.Impulse); &#125; isJump = true; isOnGround = false; // è®¡ç®—è·³è·ƒæ—¶çš„æ—¶é—´ï¼ŒTime.timeè·å–æ¸¸æˆçœŸå®æŒç»­æ—¶é—´(ä¸æ–­å¢é•¿) jumpTime = Time.time + jumpHoldDuration; // ä¿®æ”¹rb.velocityä¹Ÿå¯ä»¥å®ç° rb.AddForce(new Vector2(0f, jumpForce), ForceMode2D.Impulse); &#125; else if (isJump) &#123; // é•¿æŒ‰è·³è·ƒï¼Œè·å¾—é¢å¤–çš„åŠ›jumpHoldForceåŠ æˆ if (jumpHeld) &#123; rb.AddForce(new Vector2(0f, jumpHoldForce), ForceMode2D.Impulse); &#125; // å½“Time.timeè·å–çš„æ—¶é—´æ¯”jumpTimeå¤§ï¼Œå³ä¹‹é—´çš„æ—¶é—´å·®å·²ç»å¤§äºjumpHoldDurationçš„å€¼æ—¶ï¼Œå³å¯æ¢å¤isJump if (jumpTime &lt; Time.time) &#123; isJump = false; &#125; &#125; &#125; // æ§åˆ¶è§’è‰²é¢å‘æ–¹å‘ void FlipDiraction() &#123; if(xVelocity &lt; 0) &#123; transform.localScale = new Vector2(-1, 1); &#125;else if(xVelocity &gt; 0) &#123; transform.localScale = new Vector2(1, 1); &#125; &#125; // æ§åˆ¶è§’è‰²ä¸‹è¹² void Crouch() &#123; isCrouch = true; // ä¸‹è¹²æ—¶é€Ÿåº¦å‡ç¼“ xVelocity /= crouchSpeedDivisor; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderCrouchSize; coll.offset = colliderCrouchOffset; &#125; // æ§åˆ¶è§’è‰²èµ·ç«‹ void StandUp() &#123; isCrouch = false; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderStandSize; coll.offset = colliderStandOffset; &#125; // å¢å¼ºRaycastå‡½æ•° RaycastHit2D Raycast(Vector2 offset, Vector2 rayDirection, float length, LayerMask layer) &#123; // å½“å‰è§’è‰²çš„ä½ç½® Vector2 pos = transform.position; // åˆ›å»ºå°„çº¿ RaycastHit2D hit = Physics2D.Raycast(pos + offset, rayDirection, length, layer); // æ˜¾ç¤ºå°„çº¿,hitè¿”å›æ˜¯å¦ç¢°æ’å¸ƒå°”å€¼ Color color = hit ? Color.red : Color.green; Debug.DrawRay(pos + offset, rayDirection, color); return hit; &#125;&#125; å®ç°æ‚¬æŒ‚åŠŸèƒ½ä»¥åŠä¸‹è¹²è·³è·ƒçš„ä¼˜åŒ– åˆ¤æ–­Raycastå°„çº¿æ˜¯å¦ä¸ºTRUEçš„æ¡ä»¶ï¼šä¸ºå°„çº¿ä¸­æœ‰æ¥è§¦ç¢°æ’ä½“ï¼Œä½†æ˜¯å°„çº¿èµ·ç‚¹æ²¡æœ‰æ¥è§¦ç¢°æ’ä½“ï¼› 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerMovement : MonoBehaviour&#123; // é€šè¿‡ â€œHeaderâ€, â€œTooltipâ€ and â€œSpaceâ€ å±æ€§æ¥ç»„ç»‡Inspectorä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå³åœ¨Inspectorçª—å£ä¸Šæœ‰å°æ ‡é¢˜åˆ†åŒºæ˜¾ç¤º // rigidbody,collider private Rigidbody2D rb; private BoxCollider2D coll; // ä½¿ç”¨BoxColliderå¯ä»¥ç›´æ¥è·å¾—å…¶ä¸­çš„sizeã€offsetå‚æ•° [Header(&quot;ç§»åŠ¨å‚æ•°&quot;)] public float speed = 8f; public float crouchSpeedDivisor = 3f; // è¹²ä¸‹æ—¶çš„é€Ÿåº¦å‡ç¼“é‡ [Header(&quot;è·³è·ƒå‚æ•°&quot;)] public float jumpForce = 6.3f; // è·³è·ƒåŠ› public float jumpHoldForce = 1.9f; // é•¿æŒ‰è·³è·ƒçš„åŠ› public float jumpHoldDuration = 0.1f; // é•¿æŒ‰è·³è·ƒåŠ æˆ public float crouchJumpBoost = 2.5f; // ä¸‹è¹²è·³è·ƒçš„åŠ æˆ public float hangingJumpForce = 15f; // æ‚¬æŒ‚æ—¶è·³è·ƒçš„åŠ› [Header(&quot;çŠ¶æ€&quot;)] public bool isCrouch; // æ˜¯å¦ä¸‹è¹² public bool isOnGround; // æ˜¯å¦æ¥è§¦åœ°é¢ public bool isHeadBlocked; // æ˜¯å¦å¤´é¡¶é®æŒ¡ public bool isJump; // æ˜¯å¦è·³è·ƒ public bool isHanging; // æ˜¯å¦æ‚¬æŒ‚ [Header(&quot;ç¯å¢ƒæ£€æµ‹&quot;)] public LayerMask groundLayer; // åœ°é¢å±‚ public float headClearance = 0.25f; public float groundDistance = 0.2f; public float grabDistance = 0.4f; // æŠ“å–è·ç¦» public float reachOffset = 0.7f; // æ¥è§¦åç§»å€¼ float footOffset; // å•è„šçš„åç§»å€¼ï¼Œå³æ•´ä½“xsizeçš„ä¸€åŠ float xVelocity; // è½´åŠ é€Ÿåº¦ float jumpTime; // è·³è·ƒæ—¶é—´ï¼Œä¸durationç›¸å…³ float playerHeight; // è§’è‰²é«˜åº¦ float eyeHeight; // è§’è‰²çœ¼ç›é«˜åº¦ // æŒ‰é”® bool jumpPressed, jumpHeld, crouchHeld, crouchPressed; // ç¢°æ’ä½“å°ºå¯¸ (ç«™ç«‹ã€ä¸‹è¹²æ—¶çš„å¤§å°ã€ä½ç½®) Vector2 colliderStandSize, colliderStandOffset,colliderCrouchSize, colliderCrouchOffset; // åˆå§‹åŒ–å‚æ•° void Start() &#123; // rigidbody,collider rb = GetComponent&lt;Rigidbody2D&gt;(); coll = GetComponent&lt;BoxCollider2D&gt;(); footOffset = coll.size.x / 2; playerHeight = coll.size.y; eyeHeight = playerHeight - 0.4f; // ç¢°æ’ä½“å°ºå¯¸ colliderStandSize = coll.size; colliderStandOffset = coll.offset; colliderCrouchSize = new Vector2(coll.size.x, coll.size.y / 2f); colliderCrouchOffset = new Vector2(coll.offset.x, coll.offset.y / 2f); &#125; // è·å–GetButtonæœ€å¥½æ”¾åœ¨æ­¤å‡½æ•°ä¸­ void Update() &#123; // GetButtonå‚æ•°å¯¹åº”Project Setting -&gt; Input Managerçš„è®¾ç½® jumpPressed = Input.GetButtonDown(&quot;Jump&quot;); jumpHeld = Input.GetButton(&quot;Jump&quot;); crouchHeld = Input.GetButton(&quot;Crouch&quot;); crouchPressed = Input.GetButtonDown(&quot;Crouch&quot;); playerHeight = coll.size.y; eyeHeight = playerHeight - 0.4f; &#125; // å›ºå®šå¸§é€Ÿç‡ä¸‹æ¯å¸§éƒ½è°ƒç”¨è¯¥å‡½æ•° private void FixedUpdate() &#123; // ç›¸å…³ç‰©ç†æ§åˆ¶ GroundMovement(); PhysicsCheck(); MidAirMovement(); CrouchMovement(); HangdingMovement(); &#125; // ç¯å¢ƒæ£€æµ‹ void PhysicsCheck() &#123; /* // å½“å‰è§’è‰²çš„ä½ç½®å’Œå•è„šå·¦å³ç‚¹çš„offset Vector2 pos = transform.position; Vector2 offset = new Vector2(-footOffset, 0f); // leftCheck/rightCheckå³å•è„šå·¦å³ç‚¹æ£€æµ‹ RaycastHit2D leftCheck = Physics2D.Raycast(pos+offset,Vector2.down,groundDistance,groundLayer); // æ˜¾ç¤ºå°„çº¿ Debug.DrawRay(pos + offset, Vector2.down, Color.red, 0.2f); */ // 1ã€å·¦å³è„šå°„çº¿æ£€æµ‹ æ˜¯å¦æ¥è§¦åœ°é¢ // è·å¾—å°„çº¿æ£€æµ‹ RaycastHit2D leftCheck = Raycast(new Vector2(-footOffset, 0f), Vector2.down, groundDistance, groundLayer); RaycastHit2D rightCheck = Raycast(new Vector2(footOffset, 0f), Vector2.down, groundDistance, groundLayer); // æ˜¯å¦æ¥è§¦åœ°é¢å±‚ //if (coll.IsTouchingLayers(groundLayer)) if (leftCheck || rightCheck) isOnGround = true; else isOnGround = false; // 2ã€å¤´é¡¶å°„çº¿æ£€æµ‹ æ˜¯å¦æœ‰é˜»æŒ¡ RaycastHit2D headCheck = Raycast(new Vector2(0f, playerHeight), Vector2.up, headClearance, groundLayer); if (headCheck) isHeadBlocked = true; else isHeadBlocked = false; // 3ã€å¤´å‰æ–¹åŒºåŸŸå°„çº¿æ£€æµ‹ æ˜¯å¦æ‚¬æŒ‚ float diraction = transform.localScale.x; RaycastHit2D blockedCheck = Raycast(new Vector2(footOffset * diraction, playerHeight), new Vector2(diraction,0f), grabDistance, groundLayer); RaycastHit2D wallCheck = Raycast(new Vector2(footOffset * diraction, eyeHeight), new Vector2(diraction, 0f), grabDistance, groundLayer); RaycastHit2D ledgeCheck = Raycast(new Vector2(reachOffset * diraction, playerHeight), Vector2.down, grabDistance, groundLayer); if (!isOnGround &amp;&amp; rb.velocity.y &lt; 0f &amp;&amp; ledgeCheck &amp;&amp; wallCheck &amp;&amp; !blockedCheck) &#123; // å°†playerå›ºå®šåœ¨ä¸€ä¸ªä½ç½® Vector3 pos = transform.position; pos.x += (wallCheck.distance - 0.05f) * diraction; // RaycastHit2Dä¸‹çš„distanceä¸ºèµ·å§‹ç‚¹åˆ°æ¥è§¦ç‚¹çš„è·ç¦» pos.y -= ledgeCheck.distance; transform.position = pos; rb.bodyType = RigidbodyType2D.Static; // è®©è§’è‰²é™æ­¢ isHanging = true; &#125; &#125; // æ§åˆ¶è§’è‰²å·¦å³ç§»åŠ¨ void GroundMovement() &#123; // æ‚¬æŒ‚æ—¶ä¸å…è®¸ç§»åŠ¨ if (isHanging) return; // è·å–é”®ç›˜è¾“å…¥ xVelocity = Input.GetAxis(&quot;Horizontal&quot;); // è¿”å›å€¼-1f ~ 1fï¼Œå½“ä¸æŒ‰ä¸‹æ–¹å‘é”®æ—¶ä¸º0 // æ§åˆ¶è§’è‰²é€Ÿåº¦ä»¥ç§»åŠ¨ rb.velocity = new Vector2(xVelocity * speed, rb.velocity.y); // æ§åˆ¶æœå‘ FlipDiraction(); &#125; // æ§åˆ¶è§’è‰²ä¸‹è¹²èµ·ç«‹ void CrouchMovement() &#123; if (crouchHeld &amp;&amp; !isCrouch &amp;&amp; isOnGround) &#123; // æŒ‰ä¸‹ä¸‹è¹²æŒ‰é’®ï¼Œä¸å¤„äºä¸‹è¹²çŠ¶æ€ï¼Œæ¥è§¦åœ°é¢ --ã€‹ è§’è‰²ä¸‹è¹² Crouch(); &#125; else if (!crouchHeld &amp;&amp; isCrouch &amp;&amp; !isHeadBlocked) &#123; // æœªæŒ‰ä¸‹æŒ‰é’®,å¤„äºä¸‹è¹²çŠ¶æ€,å¤´é¡¶æ— é®æŒ¡ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; else if (!isOnGround &amp;&amp; isCrouch) &#123; // ä¸æ¥è§¦åœ°é¢ä½†æ˜¯å¤„äºä¸‹è¹²çŠ¶æ€ â€”â€”ã€‹ å¤„äºç©ºä¸­ --ã€‹ è§’è‰²èµ·èº« StandUp(); &#125; &#125; // æ§åˆ¶è§’è‰²è·³è·ƒ void MidAirMovement() &#123; // è·³è·ƒæ£€æµ‹ if(jumpPressed &amp;&amp; isOnGround &amp;&amp; !isJump &amp;&amp; !isHeadBlocked) &#123; // isOnGround &amp;&amp; !isJump é˜²æ­¢è¹­å¢™æ— é™è·³ // æŒ‰ä¸‹äº†è·³è·ƒï¼Œæ¥è§¦åœ°é¢ï¼Œæœªå¤„äºè·³è·ƒçŠ¶æ€ â€”â€”ã€‹ æ§åˆ¶è·³è·ƒ // ä¸‹è¹²çŠ¶æ€è·³è·ƒï¼Œæœ‰é¢å¤–åŠ›çš„åŠ æˆ if (isCrouch &amp;&amp; !isHeadBlocked) &#123; // æ§åˆ¶èµ·èº« StandUp(); // æ·»åŠ é¢å¤–åŠ› rb.AddForce(new Vector2(0f, crouchJumpBoost), ForceMode2D.Impulse); &#125; isJump = true; isOnGround = false; // è®¡ç®—è·³è·ƒæ—¶çš„æ—¶é—´ï¼ŒTime.timeè·å–æ¸¸æˆçœŸå®æŒç»­æ—¶é—´(ä¸æ–­å¢é•¿) jumpTime = Time.time + jumpHoldDuration; // ä¿®æ”¹rb.velocityä¹Ÿå¯ä»¥å®ç° rb.AddForce(new Vector2(0f, jumpForce), ForceMode2D.Impulse); &#125; else if (isJump) &#123; // é•¿æŒ‰è·³è·ƒï¼Œè·å¾—é¢å¤–çš„åŠ›jumpHoldForceåŠ æˆ if (jumpHeld) &#123; rb.AddForce(new Vector2(0f, jumpHoldForce), ForceMode2D.Impulse); &#125; // å½“Time.timeè·å–çš„æ—¶é—´æ¯”jumpTimeå¤§ï¼Œå³ä¹‹é—´çš„æ—¶é—´å·®å·²ç»å¤§äºjumpHoldDurationçš„å€¼æ—¶ï¼Œå³å¯æ¢å¤isJump if (jumpTime &lt; Time.time) &#123; isJump = false; &#125; &#125; &#125; // æ§åˆ¶è§’è‰²æ‚¬æŒ‚æ—¶è·³è·ƒä¸ä¸‹è¹² void HangdingMovement() &#123; // æ‚¬æŒ‚æ—¶æ£€æµ‹ if (isHanging) &#123; if (jumpPressed) &#123; rb.bodyType = RigidbodyType2D.Dynamic; rb.AddForce(new Vector2(0f, hangingJumpForce), ForceMode2D.Impulse); isHanging = false; &#125; else if (crouchPressed) &#123; rb.bodyType = RigidbodyType2D.Dynamic; isHanging = false; &#125; &#125; &#125; // æ§åˆ¶è§’è‰²é¢å‘æ–¹å‘ void FlipDiraction() &#123; if(xVelocity &lt; 0) &#123; transform.localScale = new Vector2(-1, 1); &#125;else if(xVelocity &gt; 0) &#123; transform.localScale = new Vector2(1, 1); &#125; &#125; // æ§åˆ¶è§’è‰²ä¸‹è¹² void Crouch() &#123; isCrouch = true; // ä¸‹è¹²æ—¶é€Ÿåº¦å‡ç¼“ xVelocity /= crouchSpeedDivisor; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderCrouchSize; coll.offset = colliderCrouchOffset; &#125; // æ§åˆ¶è§’è‰²èµ·ç«‹ void StandUp() &#123; isCrouch = false; // æ”¹å˜colliderçš„å°ºå¯¸ coll.size = colliderStandSize; coll.offset = colliderStandOffset; &#125; // å¢å¼ºRaycastå‡½æ•° RaycastHit2D Raycast(Vector2 offset, Vector2 rayDirection, float length, LayerMask layer) &#123; // å½“å‰è§’è‰²çš„ä½ç½® Vector2 pos = transform.position; // åˆ›å»ºå°„çº¿ RaycastHit2D hit = Physics2D.Raycast(pos + offset, rayDirection, length, layer); // æ˜¾ç¤ºå°„çº¿,hitè¿”å›æ˜¯å¦ç¢°æ’å¸ƒå°”å€¼ Color color = hit ? Color.red : Color.green; Debug.DrawRay(pos + offset, rayDirection, color); return hit; &#125;&#125; 2Dé€è§†æ•ˆæœä¸æ‘„åƒæœº PackageManager -&gt; CineMachinesæ’ä»¶å¯¼å…¥ï¼Œæ·»åŠ Followé€‰é¡¹ body -&gt; dead zoneé”æ­»èŒƒå›´ï¼Œåœ¨è¯¥èŒƒå›´å†…ç§»åŠ¨ä¸ä¼šè·Ÿç€ç§»åŠ¨æ‘„åƒæœº body -&gt; Screen è®¾ç½®followè§’è‰²åœ¨æ‘„åƒæœºçš„å“ªä¸ªä½ç½® body -&gt; CameraDistance è®¾ç½®æ‘„åƒæœºåŒ…æ‹¬èŒƒå›´ Main Camera -&gt; Projection -&gt; Perspectiveï¼Œå³å¯æ¨¡æ‹Ÿæ­£å¸¸æ‘„åƒæœºæ•ˆæœï¼ˆåˆ‡æ¢Scene 2Då³å¯æŸ¥çœ‹ï¼‰ Extension -&gt; Confineræ·»åŠ æ‘„åƒæœºç§»åŠ¨è¾¹ç•Œï¼Œä¸ºBackgroundæ·»åŠ Colliderï¼Œæ³¨æ„ä¸€å®šè¦ç‚¹é€‰is triggeré€‰é¡¹ ç¯å…‰ å¯¹Objectå³é”®light -&gt; point light æ·»åŠ ç‚¹å…‰æº ä¸ºPlateformã€Backgroundæ·»åŠ materail Window -&gt; Rendering -&gt;light -&gt;Enviroment -&gt; Ambient Colorï¼Œè®¾ç½®ä¸»åœºæ™¯ç¯å…‰ åŠ¨ç”» Window -&gt; Animator/Animationï¼Œæ‰“å¼€çª—å£ æ·»åŠ scriptï¼šPlayerAnimationå¦‚ä¸‹ 12345678910111213141516171819202122232425262728using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerAnimation : MonoBehaviour&#123; Animator animator; PlayerMovement movement; int groundID; void Start() &#123; animator = GetComponent&lt;Animator&gt;(); groundID = Animator.StringToHash(&quot;isOnGround&quot;); // è·å–çˆ¶ç»„ä»¶çš„è„šæœ¬ movement = GetComponentInParent&lt;PlayerMovement&gt;(); &#125; void Update() &#123; // è®¾ç½®animatiorçš„çŠ¶æ€å€¼ animator.SetFloat(&quot;speed&quot;, Mathf.Abs(movement.xVelocity)); // ä½¿ç”¨ç¼–å·å¯¹åº”èµ‹å€¼ã€å­—ç¬¦ä¸²å¯¹åº”èµ‹å€¼ animator.SetBool(groundID, movement.isOnGround); animator.SetBool(&quot;isJumping&quot;, movement.isJump); animator.SetBool(&quot;isCrouching&quot;, movement.isCrouch); animator.SetBool(&quot;isHanging&quot;, movement.isHanging); &#125;&#125; ä½¿ç”¨BlendTree åœ¨Animatorçš„BaseLayerä¸­å³é”® Create State -&gt; From New Blend Tree ç‚¹å‡»æ–°çš„BlendTreeStateï¼Œåœ¨Inspector -&gt; Motion æ·»åŠ Motionï¼Œæ·»åŠ æ¯ä¸€ä¸ªmotionå¯¹åº”çš„animationï¼Œä¸”å°†Parameterè®¾ç½®ä¸ºè‡ªå®šä¹‰çš„state Thresholdä¸´ç•Œå€¼é€‰é¡¹ï¼Œå½“å¯¹åº”parameterå€¼å¤åˆæŸä¸€thresholdå€¼æ—¶ä¼šæ’­æ”¾è¯¥animationï¼Œæ³¨æ„å‚ç›´å‘ä¸Šæ°´å¹³å‘å³ä¸ºæ­£ â€‹ ä¸Šå›¾ä¸­MidAir1~7ä¸ºèµ·è·³åˆ°ä¸‹è½çš„åŠ¨ç”» ä¿®æ”¹åŠ¨ç”»è„šæœ¬å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerAnimation : MonoBehaviour&#123; Animator animator; PlayerMovement movement; Rigidbody2D rb; int speedID, groundID, jumpingID, crouchingID, hangingID, fallId; void Start() &#123; animator = GetComponent&lt;Animator&gt;(); // animatior parameterå¯¹åº”ç¼–å· speedID = Animator.StringToHash(&quot;speed&quot;); groundID = Animator.StringToHash(&quot;isOnGround&quot;); jumpingID = Animator.StringToHash(&quot;isJumping&quot;); crouchingID = Animator.StringToHash(&quot;isCrouching&quot;); hangingID = Animator.StringToHash(&quot;isHanging&quot;); fallId = Animator.StringToHash(&quot;verticalVelocity&quot;); // è·å–çˆ¶ç»„ä»¶çš„è„šæœ¬ movement = GetComponentInParent&lt;PlayerMovement&gt;(); rb = GetComponentInParent&lt;Rigidbody2D&gt;(); &#125; void Update() &#123; // è®¾ç½®animatiorçš„çŠ¶æ€å€¼ï¼Œä¸¤ç§æ–¹æ³•ï¼ˆä½¿ç”¨ç¼–å·å¯¹åº”èµ‹å€¼ã€å­—ç¬¦ä¸²å¯¹åº”èµ‹å€¼ï¼‰ // animator.SetFloat(&quot;speed&quot;, Mathf.Abs(movement.xVelocity)); animator.SetFloat(speedID, Mathf.Abs(movement.xVelocity)); animator.SetBool(groundID, movement.isOnGround); animator.SetBool(jumpingID, movement.isJump); animator.SetBool(crouchingID, movement.isCrouch); animator.SetBool(hangingID, movement.isHanging); animator.SetFloat(fallId, rb.velocity.y); &#125;&#125; éŸ³æ•ˆ æ³¨æ„Animationçª—å£ä¸­å¯¹åº”åŠ¨ç”»ï¼Œå«æœ‰ç‰¹å®šçš„animation eventéœ€è¦æ·»åŠ  æ·»åŠ AudioManager(Prefab)ï¼Œå¹¶ä¸ºå…¶æ·»åŠ scriptå¦‚ä¸‹ 12345678910111213141516171819202122232425using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.Audio;public class AudioManager : MonoBehaviour&#123; static AudioManager current; [Header(&quot;ç¯å¢ƒå£°éŸ³&quot;)] public AudioClip ambientCilip; public AudioClip musicClip; [Header(&quot;è§’è‰²éŸ³æ•ˆ&quot;)] public AudioClip[] walkStepClips; public AudioClip[] crouchStepClips; public AudioClip jumpClip; public AudioClip jumpVoiceClip; public void Awake() &#123; current = this; &#125;&#125; â€‹ åŒæ—¶åœ¨AudioManager(Prefab)ä¸­é€‰æ‹©ç›¸åº”çš„éŸ³æ•ˆ æ·»åŠ AudioSource 12345678910111213141516171819202122232425262728293031323334353637383940414243using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.Audio;public class AudioManager : MonoBehaviour&#123; // ... AudioSource ambientSource, musicSource, fxSource, playerSource, voiceSource; public void Awake() &#123; // å•ä¾‹æ¨¡å¼ if(current != null) &#123; Destroy(gameObject); return; &#125; // æ–¹ä¾¿åœ¨staticæ–¹æ³•ä¸­ä½¿ç”¨this current = this; // é˜²æ­¢åœºæ™¯åŠ è½½æ—¶è¢«é”€æ¯ DontDestroyOnLoad(gameObject); // ä½¿ç”¨ä»£ç æ·»åŠ AudioSourceç»„ä»¶ ambientSource = gameObject.AddComponent&lt;AudioSource&gt;(); musicSource = gameObject.AddComponent&lt;AudioSource&gt;(); fxSource = gameObject.AddComponent&lt;AudioSource&gt;(); playerSource = gameObject.AddComponent&lt;AudioSource&gt;(); voiceSource = gameObject.AddComponent&lt;AudioSource&gt;(); &#125; public static void PlayFootstepAudio() &#123; // è·å¾—éšæœºæ•° int index = Random.Range(0, current.walkStepClips.Length); // æŒ‡å®šsourceçš„clipå£°éŸ³ç‰‡æ®µ current.playerSource.clip = current.walkStepClips[index]; // æ’­æ”¾ current.playerSource.Play(); &#125;&#125; åœ¨PlayerAnimationä¸­è°ƒç”¨æ–¹æ³• 1234public void StepAudio()&#123; AudioManager.PlayFootstepAudio();&#125; å…¶ä»–éŸ³æ•ˆåŒç†ï¼Œå®Œæ•´å¦‚ä¸‹ AudioManager 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.Audio;public class AudioManager : MonoBehaviour&#123; static AudioManager current; [Header(&quot;ç¯å¢ƒå£°éŸ³&quot;)] public AudioClip ambientClip; public AudioClip musicClip; [Header(&quot;è§’è‰²éŸ³æ•ˆ&quot;)] public AudioClip[] walkStepClips; public AudioClip[] crouchStepClips; public AudioClip jumpClip; public AudioClip jumpVoiceClip; // clipå£°éŸ³ç‰‡æ®µï¼Œsourceå£°éŸ³æº AudioSource ambientSource, musicSource, fxSource, playerSource, voiceSource; public void Awake() &#123; // å•ä¾‹æ¨¡å¼ if(current != null) &#123; Destroy(gameObject); return; &#125; // æ–¹ä¾¿åœ¨staticæ–¹æ³•ä¸­ä½¿ç”¨this current = this; // é˜²æ­¢åœºæ™¯åŠ è½½æ—¶è¢«é”€æ¯ DontDestroyOnLoad(gameObject); // ä½¿ç”¨ä»£ç æ·»åŠ AudioSourceç»„ä»¶ ambientSource = gameObject.AddComponent&lt;AudioSource&gt;(); musicSource = gameObject.AddComponent&lt;AudioSource&gt;(); fxSource = gameObject.AddComponent&lt;AudioSource&gt;(); playerSource = gameObject.AddComponent&lt;AudioSource&gt;(); voiceSource = gameObject.AddComponent&lt;AudioSource&gt;(); // èƒŒæ™¯éŸ³ä¹ä¸éœ€è¦è§¦å‘ï¼Œç›´æ¥æ’­æ”¾ StartLevelAudio(); &#125; // èƒŒæ™¯éŸ³ä¹ void StartLevelAudio() &#123; // æ‰“å¼€å¾ªç¯ current.ambientSource.clip = current.ambientClip; current.ambientSource.loop = true; current.ambientSource.Play(); current.musicSource.clip = current.musicClip; current.musicSource.loop = true; current.musicSource.Play(); &#125; // è§’è‰²èµ°åŠ¨éŸ³æ•ˆ public static void PlayFootstepAudio() &#123; // è·å¾—éšæœºæ•° int index = Random.Range(0, current.walkStepClips.Length); // æŒ‡å®šsourceçš„clipå£°éŸ³ç‰‡æ®µ current.playerSource.clip = current.walkStepClips[index]; // æ’­æ”¾ current.playerSource.Play(); &#125; // è§’è‰²ä¸‹è¹²éŸ³æ•ˆ public static void PlayCrouchFootstepAudio() &#123; int index = Random.Range(0, current.crouchStepClips.Length); current.playerSource.clip = current.crouchStepClips[index]; current.playerSource.Play(); &#125; // è§’è‰²è·³è·ƒéŸ³æ•ˆ public static void PlayJumpAudio() &#123; current.playerSource.clip = current.jumpClip; current.playerSource.Play(); current.voiceSource.clip = current.jumpVoiceClip; current.voiceSource.Play(); &#125;&#125; PlayerAnimation 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerAnimation : MonoBehaviour&#123; Animator animator; PlayerMovement movement; Rigidbody2D rb; int speedID, groundID, jumpingID, crouchingID, hangingID, fallId; void Start() &#123; animator = GetComponent&lt;Animator&gt;(); // animatior parameterå¯¹åº”ç¼–å· speedID = Animator.StringToHash(&quot;speed&quot;); groundID = Animator.StringToHash(&quot;isOnGround&quot;); jumpingID = Animator.StringToHash(&quot;isJumping&quot;); crouchingID = Animator.StringToHash(&quot;isCrouching&quot;); hangingID = Animator.StringToHash(&quot;isHanging&quot;); fallId = Animator.StringToHash(&quot;verticalVelocity&quot;); // è·å–çˆ¶ç»„ä»¶çš„è„šæœ¬ movement = GetComponentInParent&lt;PlayerMovement&gt;(); rb = GetComponentInParent&lt;Rigidbody2D&gt;(); &#125; void Update() &#123; // è®¾ç½®animatiorçš„çŠ¶æ€å€¼ï¼Œä¸¤ç§æ–¹æ³•ï¼ˆä½¿ç”¨ç¼–å·å¯¹åº”èµ‹å€¼ã€å­—ç¬¦ä¸²å¯¹åº”èµ‹å€¼ï¼‰ // animator.SetFloat(&quot;speed&quot;, Mathf.Abs(movement.xVelocity)); animator.SetFloat(speedID, Mathf.Abs(movement.xVelocity)); animator.SetBool(groundID, movement.isOnGround); animator.SetBool(jumpingID, movement.isJump); animator.SetBool(crouchingID, movement.isCrouch); animator.SetBool(hangingID, movement.isHanging); animator.SetFloat(fallId, rb.velocity.y); &#125; public void StepAudio() &#123; AudioManager.PlayFootstepAudio(); &#125; public void CrouchStepAudio() &#123; AudioManager.PlayCrouchFootstepAudio(); &#125;&#125; â€‹ ç”±äºAnimationä¸­æ²¡æœ‰æ·»åŠ jumpçš„eventï¼Œæ‰€ä»¥ç›´æ¥åœ¨playerMovementä¸­è°ƒç”¨éŸ³æ•ˆå³å¯ æ­»äº¡æœºåˆ¶ æ·»åŠ æ–°çš„csä»£ç å¦‚ä¸‹ï¼Œåº”ç”¨äºè§’è‰²ï¼Œç”¨äºæ­»äº¡æ¡ä»¶åˆ¤æ–­ 1234567891011121314151617181920212223242526272829303132using System.Collections;using System.Collections.Generic;using UnityEngine;public class PlayerHealth : MonoBehaviour&#123; // é¢„åˆ¶æ­»äº¡ç‰¹æ•ˆ public GameObject deathVFXPrefab; int trapsLayer; void Start() &#123; // è·å¾—å¯¹åº”Layerçš„ç¼–å· trapsLayer = LayerMask.NameToLayer(&quot;Traps&quot;); &#125; // å¦‚æœä¸€ä¸ªç¢°æ’ä½“è¿›å…¥äº†è§¦å‘å™¨ï¼ˆå½“å‰è§’è‰²å·²ç»è¢«è®¾å®šä¸ºisTriggerï¼‰åˆ™è°ƒç”¨ private void OnTriggerEnter2D(Collider2D collision) &#123; if (collision.gameObject.layer == trapsLayer) &#123; // Instantiateå®ä¾‹åŒ–ï¼Œæ­¤å¤„è®©ç‰¹æ•ˆæ˜¾ç¤º Instantiate(deathVFXPrefab,transform.position,transform.rotation); // è®©è§’è‰²æ¶ˆå¤± gameObject.SetActive(false); // æ’­æ”¾æ­»äº¡éŸ³æ•ˆ AudioManager.PlayDeathAudio(); &#125; &#125;&#125; æ·»åŠ æ­»äº¡éŸ³æ•ˆï¼Œæ³¨æ„åœ¨Inspectorçª—å£ä¸­é€‰æ‹©å¯¹åº”ç‰‡æ®µ 1234567891011121314151617181920212223 [Header(&quot;è§’è‰²éŸ³æ•ˆ&quot;)] public AudioClip[] walkStepClips; public AudioClip[] crouchStepClips; public AudioClip jumpClip; public AudioClip jumpVoiceClip; public AudioClip deathClip; public AudioClip deathVoiceClip; [Header(&quot;ç‰¹æ•ˆéŸ³æ•ˆ&quot;)] public AudioClip deathFXClip;// æ­»äº¡éŸ³æ•ˆpublic static void PlayDeathAudio()&#123; current.playerSource.clip = current.deathClip; current.playerSource.Play(); current.voiceSource.clip = current.deathVoiceClip; current.voiceSource.Play(); current.fxSource.clip = current.deathFXClip; current.fxSource.Play();&#125; è®¾ç½®åœºæ™¯é‡ç½®ï¼Œåœ¨file -&gt; build settings ä¸­è®¾ç½®scene 123456using UnityEngine.SceneManagement;private void OnTriggerEnter2D(Collider2D collision)&#123; // é‡ç½®åœºæ™¯ä¸ºå½“å‰åœºæ™¯ SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex);&#125; è§†è§‰æ•ˆæœä¸ç›¸æœºæŠ–åŠ¨Post Processing Window -&gt; PackageManager -&gt; æœç´¢æ’ä»¶Post Processing ä¸º Main Camera æ·»åŠ Component -&gt; Post-process Layerï¼Œåˆ›å»ºä¸€ä¸ªä¸“é—¨çš„Layerå¹¶æ·»åŠ  åˆ›å»ºä¸€ä¸ªEmpty Objectï¼Œå‘½åä¸ºGlobal Post ProcessingåŒæ—¶æ·»åŠ ä¸Šä¸€æ­¥éª¤ä¸­çš„Layerï¼Œç”¨äºæ‰¿è½½è§†è§‰æ•ˆæœï¼ˆå¦‚æœæ˜¯å•ç‹¬ç‰©ä»¶æ·»åŠ ç‰¹æ•ˆç›´æ¥æ·»åŠ å³å¯ï¼‰ ä¸ºè¯¥å¯¹è±¡æ·»åŠ ç»„ä»¶ Post-process Volumeï¼Œå…¶ä¸­is Global ç”¨äºå½±å“å…¨å±€ï¼Œå¦åˆ™æ·»åŠ colliderè®¾ç½®å½±å“èŒƒå›´å³å¯ ä¸ºè¯¥å¯¹è±¡æ·»åŠ Profileï¼ŒåŒæ—¶Add effect Camera Shake åœ¨ä¹‹å‰æ·»åŠ çš„Cinemachineä¸­ï¼Œ Inspector -&gt; Extension -&gt;Cinemachine Impulse Listener åœ¨è§¦å‘ç›¸æœºæŠ–åŠ¨æ•ˆæœçš„ç‰©ä»¶ä¸Šæ·»åŠ ç»„ä»¶ Cinemachine Collision Impulse Source(æ­¤ä¸ºç¢°æ’è§¦å‘ï¼Œå¯é€‰å…¶ä»–source)ï¼Œ ä¸ºè¯¥ç»„ä»¶æ·»åŠ Raw Signalå³è§¦å‘æŠ–åŠ¨æ—¶çš„æ•ˆæœï¼Œå¯ä»¥è‡ªè¡Œè®¾ç½®ï¼Œé€‰æ‹©TriggerObjectFilterä¸­çš„LayerMaskï¼Œå³ç¢°æ’å½“å‰å¯¹è±¡çš„Layer å…¶ä½™å¦‚SignalShapeä¸­çš„FrequencyGainè¶Šå¤§é€Ÿåº¦è¶Šå¿«â€¦â€¦ GameManageræ­»äº¡è¿‡æ¸¡ä»¥åŠç›¸å…³è®¡æ•° æ·»åŠ Scriptï¼Œä¸€å®šå‘½åä¸ºGameManagerï¼Œå¦‚ä¸‹ç¼–å†™ 1234567891011121314151617181920212223242526272829303132using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.SceneManagement;public class GameManager : MonoBehaviour&#123; static GameManager gm; private void Awake() &#123; if(gm != null) &#123; Destroy(gameObject); return; &#125; gm = this; DontDestroyOnLoad(this); &#125; public static void PlayerDied() &#123; // ç»è¿‡ä¸€æ®µæ—¶é—´åè°ƒç”¨æ–¹æ³• gm.Invoke(&quot;RestartScene&quot;, 1.5f); &#125; // é‡å¯åœºæ™¯ void RestartScene() &#123; SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex); &#125;&#125; æ·»åŠ Empty Objectå¹¶åº”ç”¨GameManager Script æ·»åŠ SceneFader Scriptï¼Œç¼–å†™å¦‚ä¸‹ï¼Œåº”ç”¨äºFader(UI -&gt; Imageå¯¹è±¡ï¼Œå«æœ‰è¿‡æ¸¡åŠ¨ç”»ï¼Œå…¶ä¸­Animatorä¸­æœ‰Fadeå‚æ•°) 12345678910111213141516171819using System.Collections;using System.Collections.Generic;using UnityEngine;public class SceneFader : MonoBehaviour&#123; Animator anim; int faderID; private void Start() &#123; anim = GetComponent&lt;Animator&gt;(); faderID = Animator.StringToHash(&quot;Fade&quot;); &#125; public void fadeOut() &#123; anim.SetTrigger(faderID); &#125;&#125; åœ¨GameManagerä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œè¿™é‡Œmarkä¸€ä¸‹ï¼Œä¸Šç½‘æœäº†å…¶ä»–çš„æ¨¡å¼å’Œæ–¹æ³•ï¼Œéƒ½å¯ä»¥å®ç°ï¼Œè§†é¢‘é‡Œè®²çš„æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.SceneManagement;public class GameManager : MonoBehaviour&#123; static GameManager gm; SceneFader sceneFader; private void Awake() &#123; if(gm != null) &#123; Destroy(gameObject); return; &#125; gm = this; DontDestroyOnLoad(this); &#125; // ç”¨äºé€šçŸ¥GameManageræ¥æ”¶ä¸€ä¸ªSceneFaderå®ä¾‹ //public static void RegisterSceneFader(SceneFader fader) //&#123; // gm.sceneFader = fader; //&#125; public static void PlayerDied() &#123; //SceneFader.sf.fadeOut(); SceneFader.sf.fadeOut(); // ä»¥ä¸‹ä¸ºå¦ä¸€ç§è°ƒç”¨å…¶ä»–ç±»çš„æ–¹æ³•å®ç°æ–¹æ³•ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•æˆ–æ¨¡å¼å¯ä»¥å®ç° //GameObject.Find(&quot;Fader&quot;).SendMessage(&quot;fadeOut&quot;); // ç»è¿‡ä¸€æ®µæ—¶é—´åè°ƒç”¨æ–¹æ³• gm.Invoke(&quot;RestartScene&quot;, 1.2f); &#125; // é‡å¯åœºæ™¯ void RestartScene() &#123; SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex); &#125;&#125; 123456789101112131415161718192021222324252627282930313233using System.Collections;using System.Collections.Generic;using UnityEngine;public class SceneFader : MonoBehaviour&#123; // è¿™é‡Œä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œèƒ½è®©å…¶ä»–ç±»è°ƒç”¨ public static SceneFader sf; Animator anim; int faderID; private void Awake() &#123; if (sf != null) &#123; return; &#125; sf = this; &#125; private void Start() &#123; anim = GetComponent&lt;Animator&gt;(); faderID = Animator.StringToHash(&quot;Fade&quot;); //GameManager.RegisterSceneFader(this); &#125; public void fadeOut() &#123; anim.SetTrigger(faderID); &#125;&#125; æ·»åŠ æ”¶é›†ç‰©çš„ç›¸å…³è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.SceneManagement;public class GameManager : MonoBehaviour&#123; static GameManager gm; //SceneFader sceneFader; List&lt;Orb&gt; orbs; public int orbNum,deathNum; private void Awake() &#123; if(gm != null) &#123; Destroy(gameObject); return; &#125; gm = this; orbs = new List&lt;Orb&gt;(); DontDestroyOnLoad(this); &#125; private void Update() &#123; orbNum = gm.orbs.Count; &#125; // ç”¨äºé€šçŸ¥GameManageræ¥æ”¶ä¸€ä¸ªSceneFaderå®ä¾‹ //public static void RegisterSceneFader(SceneFader fader) //&#123; // gm.sceneFader = fader; //&#125; public static void RegisterOrb(Orb orb) &#123; if (!gm.orbs.Contains(orb)) &#123; gm.orbs.Add(orb); &#125; &#125; public static void PlayerDied() &#123; //SceneFader.sf.fadeOut(); SceneFader.sf.fadeOut(); // ä»¥ä¸‹ä¸ºå¦ä¸€ç§è°ƒç”¨å…¶ä»–ç±»çš„æ–¹æ³•å®ç°æ–¹æ³•ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•æˆ–æ¨¡å¼å¯ä»¥å®ç° //GameObject.Find(&quot;Fader&quot;).SendMessage(&quot;fadeOut&quot;); // ç»è¿‡ä¸€æ®µæ—¶é—´åè°ƒç”¨æ–¹æ³• gm.Invoke(&quot;RestartScene&quot;, 1.2f); gm.deathNum++; &#125; public static void PlayerGetOrb(Orb orb) &#123; if (gm.orbs.Count == 0 || !gm.orbs.Contains(orb)) return; gm.orbs.Remove(orb); &#125; // é‡å¯åœºæ™¯ void RestartScene() &#123; gm.orbs.Clear(); SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex); &#125;&#125; 12345678910111213141516171819202122232425262728using System.Collections;using System.Collections.Generic;using UnityEngine;public class Orb : MonoBehaviour&#123; int playerLayer; public GameObject explosionVFXPrefab; void Start() &#123; playerLayer = LayerMask.NameToLayer(&quot;Player&quot;); GameManager.RegisterOrb(this); &#125; private void OnTriggerEnter2D(Collider2D collision) &#123; if(collision.gameObject.layer == playerLayer) &#123; GameManager.PlayerGetOrb(this); Instantiate(explosionVFXPrefab, transform.position, transform.rotation); gameObject.SetActive(false); AudioManager.PlayOrbAudio(); &#125; &#125;&#125; Dooræœºå…³æ”¶é›†ç‰©å“åˆ°ä¸€å®šæ•°é‡åæ‰“å¼€æœºå…³ ç¼–å†™Door Script 123456789101112131415161718192021222324using System.Collections;using System.Collections.Generic;using UnityEngine;public class Door : MonoBehaviour&#123; Animator anim; int openID; void Start() &#123; anim = GetComponent&lt;Animator&gt;(); openID = Animator.StringToHash(&quot;Open&quot;); GameManager.RegisterDoor(this); &#125; public void Open() &#123; anim.SetTrigger(openID); AudioManager.PlayOpenDoorAudio(); &#125;&#125; ç¼–å†™AudioManager 123456// æ‰“å¼€é—¨éŸ³æ•ˆ public static void PlayOpenDoorAudio() &#123; current.fxSource.clip = current.doorFXClip; current.fxSource.PlayDelayed(1f); &#125; UI Manageræ˜¾ç¤ºtext ç¼–å†™ä¸€ä¸ªUI Manager Objectï¼Œæ·»åŠ scriptå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132using System.Collections;using System.Collections.Generic;using UnityEngine;using TMPro;public class UIManager : MonoBehaviour&#123; static UIManager instance; // è·å¾—Textæ–‡æœ¬æ¡†,è®°å¾—åœ¨Inspectorä¸­é€‰æ‹©ç›¸åº”çš„text public TextMeshProUGUI orbText, timeText, deathText, gameOverText; private void Awake() &#123; if(instance != null) &#123; Destroy(gameObject); return; &#125; instance = this; DontDestroyOnLoad(this); &#125; // æ›´æ–°Orbæ•°é‡ public static void UpdateOrbUI(int orbCount) &#123; // è®¾ç½®text instance.orbText.text = orbCount.ToString(); &#125; // å…¶ä½™textç±»ä¼¼&#125; åœ¨GameManagerä¸­é€‚å½“ä½ç½®è°ƒç”¨UIManagerç›¸åº”æ–¹æ³•å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748using System.Collections;using System.Collections.Generic;using UnityEngine;using TMPro;public class UIManager : MonoBehaviour&#123; static UIManager instance; // è·å¾—Textæ–‡æœ¬æ¡†,è®°å¾—åœ¨Inspectorä¸­é€‰æ‹©ç›¸åº”çš„text public TextMeshProUGUI orbText, timeText, deathText, gameOverText; private void Awake() &#123; if(instance != null) &#123; Destroy(gameObject); return; &#125; instance = this; DontDestroyOnLoad(this); &#125; // æ›´æ–°Orbæ•°é‡ public static void UpdateOrbUI(int orbCount) &#123; // è®¾ç½®text instance.orbText.text = orbCount.ToString(); &#125; // æ›´æ–°Deathæ•°é‡ public static void UpdateDeathUI(int deathNum) &#123; // è®¾ç½®text instance.deathText.text = deathNum.ToString(); &#125; // æ›´æ–°Time public static void UpdateTimeUI(int time) &#123; int minutes = time / 60; int seconds = time % 60; // è®¾ç½®text instance.timeText.text = minutes.ToString(&quot;00&quot;)+&quot;:&quot;+seconds.ToString(&quot;00&quot;); &#125;&#125;","categories":[{"name":"Unity","slug":"Unity","permalink":"http://example.com/categories/Unity/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"Unity2D","slug":"Unity2D","permalink":"http://example.com/tags/Unity2D/"},{"name":"æ¸¸æˆå¼€å‘","slug":"æ¸¸æˆå¼€å‘","permalink":"http://example.com/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘Vue","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘Vue","date":"2021-08-04T03:44:20.728Z","updated":"2021-08-24T07:55:46.470Z","comments":true,"path":"2021/08/04/xue-xi-bi-ji-vue/","link":"","permalink":"http://example.com/2021/08/04/xue-xi-bi-ji-vue/","excerpt":"","text":"æ„Ÿè°¢ã€å°šç¡…è°·ã€‘2021æœ€æ–°Vueè¿…é€Ÿä¸Šæ‰‹æ•™ç¨‹ä¸¨vue3.0å…¥é—¨åˆ°ç²¾é€š_å¼ å¤©ç¦¹è€å¸ˆ å‰è¨€â€‹ æ˜¨å¤©çœ‹å®Œspringboot2çš„æ•™å­¦è§†é¢‘ï¼Œè®¡åˆ’ç€æ¥ä¸‹æ¥è¦å­¦ä»€ä¹ˆï¼Œæ¯•ç«Ÿä¼‘æ¯ä¸€å¤©ï¼Œå°±ä¼šä¸€ç›´å·æ‡’ä¸‹å»ã€‚æ—©ä¸Šåˆšçœ‹åˆ°ç¾¤é‡Œå‘ä¼ä¸šé¡¹ç›®è¦æ‰¾ä¸ªä¼švueï¼Œå†ç»“åˆç»“åˆvueçš„çƒ­åº¦ï¼Œè™½ç„¶è‡ªå·±å¹¶ä¸åƒå’Œå‰ç«¯æœ‰å¤ªå¤šçº è‘›ï¼ˆå› ä¸ºå¼ºè¿«ç—‡ï¼‰ï¼Œä½†æ˜¯å¤§åŠ¿æ‰€è¶‹ï¼Œéƒ½å‘ç€å…¨æ ˆé å‘¢ï¼Œè€Œä¸”ä¸ªäººé¡¹ç›®è‚¯å®šä¹Ÿå¾—è‡ªå·±åšï¼Œæ‰€ä»¥å­¦äº†éƒ½æ˜¯å¥½å¤„æ²¡åå¤„ã€‚ å…¶å®ä¸ƒæœˆåˆçš„æ—¶å€™çœ‹è¿‡ä¸¤å¤©çš„vueè¯­æ³•è§†é¢‘ï¼ˆä¸ºäº†æš‘å‡é›†è®­æ•™å­¦ï¼Œå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè¿˜å¿˜å…‰äº†ï¼‰ï¼Œä¹Ÿæ²¡æœ‰è®°ç¬”è®°ï¼Œç°åœ¨æ­£å¼çš„çœ‹ï¼Œå¥½å¥½å­¦ï¼Œå¥½å¥½è®°ï¼Œç›®æµ‹ä¸¤ä¸ªæ˜ŸæœŸçœ‹å®Œï¼Ÿï¼ˆæ¯•ç«Ÿä¹Ÿæ˜¯å­¦äº†ç‚¹vueå’Œå¾®ä¿¡å°ç¨‹åºçš„ï¼Œä¸Šæ‰‹åº”è¯¥å¿«ï¼‰çœ‹å®Œä¹‹åå¾—åšä¸ªé¡¹ç›®äº†ï¼Œvue+springbootï¼Œä¸è¿‡å­¦æœŸå¼€å­¦ä¹Ÿè¦åšä¸ªäººé¡¹ç›®ï¼Œåˆ°æ—¶å€™åšä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ Vueç®€ä»‹ä»€ä¹ˆæ˜¯Vue ä¸€å¥—ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼JavaScriptæ¡†æ¶ã€‚ Vueç‰¹ç‚¹ é‡‡ç”¨ç»„ä»¶åŒ–æ¨¡å¼, æé«˜ä»£ç å¤ç”¨ç‡ã€ä¸”è®©ä»£ç æ›´å¥½ç»´æŠ¤ã€‚ å£°æ˜å¼ç¼–ç ,è®©ç¼–ç äººå‘˜æ— éœ€ç›´æ¥æ“ä½œDOM, æé«˜å¼€å‘æ•ˆç‡ã€‚ ä½¿ç”¨è™›æ‹ŸDOM+ä¼˜ç§€çš„Diffç®—æ³•, å°½é‡å¤ç”¨DOMèŠ‚ç‚¹ã€‚ basicå®¹å™¨ä¸Vueå®ä¾‹ å…¶å®æ„Ÿè§‰ä¸ç”¨å†™ä»€ä¹ˆï¼Œç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£æˆ–è€…çœ‹ä»£ç ğŸ‘Œ 12345678910111213141516171819202122232425262728293031323334353637&lt;!-- åˆè¯†Vueï¼š 1.æƒ³è®©Vueå·¥ä½œï¼Œå°±å¿…é¡»åˆ›å»ºä¸€ä¸ªVueå®ä¾‹ï¼Œä¸”è¦ä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼› 2.rootå®¹å™¨é‡Œçš„ä»£ç ä¾ç„¶ç¬¦åˆhtmlè§„èŒƒï¼Œåªä¸è¿‡æ··å…¥äº†ä¸€äº›ç‰¹æ®Šçš„Vueè¯­æ³•ï¼› 3.rootå®¹å™¨é‡Œçš„ä»£ç è¢«ç§°ä¸ºã€Vueæ¨¡æ¿ã€‘ï¼› 4.Vueå®ä¾‹å’Œå®¹å™¨æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼› 5.çœŸå®å¼€å‘ä¸­åªæœ‰ä¸€ä¸ªVueå®ä¾‹ï¼Œå¹¶ä¸”ä¼šé…åˆç€ç»„ä»¶ä¸€èµ·ä½¿ç”¨ï¼› 6.&#123;&#123;xxx&#125;&#125;ä¸­çš„xxxè¦å†™jsè¡¨è¾¾å¼ï¼Œä¸”xxxå¯ä»¥è‡ªåŠ¨è¯»å–åˆ°dataä¸­çš„æ‰€æœ‰å±æ€§ï¼› 7.ä¸€æ—¦dataä¸­çš„æ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆé¡µé¢ä¸­ç”¨åˆ°è¯¥æ•°æ®çš„åœ°æ–¹ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ï¼› æ³¨æ„åŒºåˆ†ï¼šjsè¡¨è¾¾å¼ å’Œ jsä»£ç (è¯­å¥) 1.è¡¨è¾¾å¼ï¼šä¸€ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥æ”¾åœ¨ä»»ä½•ä¸€ä¸ªéœ€è¦å€¼çš„åœ°æ–¹ï¼š (1). a (2). a+b (3). demo(1) (4). x === y ? &#x27;a&#x27; : &#x27;b&#x27; 2.jsä»£ç (è¯­å¥) (1). if()&#123;&#125; (2). for()&#123;&#125;--&gt;&lt;!-- å‡†å¤‡å¥½ä¸€ä¸ªå®¹å™¨ --&gt;&lt;div id=&quot;demo&quot;&gt; &lt;h1&gt;Helloï¼Œ&#123;&#123;name.toUpperCase()&#125;&#125;ï¼Œ&#123;&#123;address&#125;&#125;&lt;/h1&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; &gt; Vue.config.productionTip = false //é˜»æ­¢ vue åœ¨å¯åŠ¨æ—¶ç”Ÿæˆç”Ÿäº§æç¤ºã€‚ //åˆ›å»ºVueå®ä¾‹ new Vue(&#123; el:&#x27;#demo&#x27;, //elç”¨äºæŒ‡å®šå½“å‰Vueå®ä¾‹ä¸ºå“ªä¸ªå®¹å™¨æœåŠ¡ï¼Œå€¼é€šå¸¸ä¸ºcssé€‰æ‹©å™¨å­—ç¬¦ä¸²ã€‚ data:&#123; //dataä¸­ç”¨äºå­˜å‚¨æ•°æ®ï¼Œæ•°æ®ä¾›elæ‰€æŒ‡å®šçš„å®¹å™¨å»ä½¿ç”¨ï¼Œå€¼æˆ‘ä»¬æš‚æ—¶å…ˆå†™æˆä¸€ä¸ªå¯¹è±¡ã€‚ name:&#x27;atguigu&#x27;, address:&#x27;åŒ—äº¬&#x27; &#125; &#125;)&lt;/script&gt; å•å‘åŒå‘ç»‘å®š1234567891011121314151617181920212223242526272829303132333435&lt;!-- Vueæ¨¡æ¿è¯­æ³•æœ‰2å¤§ç±»ï¼š 1.æ’å€¼è¯­æ³•ï¼š åŠŸèƒ½ï¼šç”¨äºè§£ææ ‡ç­¾ä½“å†…å®¹ã€‚ å†™æ³•ï¼š&#123;&#123;xxx&#125;&#125;ï¼Œxxxæ˜¯jsè¡¨è¾¾å¼ï¼Œä¸”å¯ä»¥ç›´æ¥è¯»å–åˆ°dataä¸­çš„æ‰€æœ‰å±æ€§ã€‚ 2.æŒ‡ä»¤è¯­æ³•ï¼š åŠŸèƒ½ï¼šç”¨äºè§£ææ ‡ç­¾ï¼ˆåŒ…æ‹¬ï¼šæ ‡ç­¾å±æ€§ã€æ ‡ç­¾ä½“å†…å®¹ã€ç»‘å®šäº‹ä»¶.....ï¼‰ã€‚ ä¸¾ä¾‹ï¼šv-bind:href=&quot;xxx&quot; æˆ– ç®€å†™ä¸º :href=&quot;xxx&quot;ï¼ŒxxxåŒæ ·è¦å†™jsè¡¨è¾¾å¼ï¼Œ ä¸”å¯ä»¥ç›´æ¥è¯»å–åˆ°dataä¸­çš„æ‰€æœ‰å±æ€§ã€‚ å¤‡æ³¨ï¼šVueä¸­æœ‰å¾ˆå¤šçš„æŒ‡ä»¤ï¼Œä¸”å½¢å¼éƒ½æ˜¯ï¼šv-????ï¼Œæ­¤å¤„æˆ‘ä»¬åªæ˜¯æ‹¿v-bindä¸¾ä¸ªä¾‹å­ã€‚ --&gt;&lt;!-- å‡†å¤‡å¥½ä¸€ä¸ªå®¹å™¨--&gt;&lt;div id=&quot;root&quot;&gt; &lt;h1&gt;æ’å€¼è¯­æ³•&lt;/h1&gt; &lt;h3&gt;ä½ å¥½ï¼Œ&#123;&#123;name&#125;&#125;&lt;/h3&gt; &lt;hr/&gt; &lt;h1&gt;æŒ‡ä»¤è¯­æ³•&lt;/h1&gt; &lt;a v-bind:href=&quot;school.url.toUpperCase()&quot; x=&quot;hello&quot;&gt;ç‚¹æˆ‘å»&#123;&#123;school.name&#125;&#125;å­¦ä¹ 1&lt;/a&gt; &lt;a :href=&quot;school.url&quot; x=&quot;hello&quot;&gt;ç‚¹æˆ‘å»&#123;&#123;school.name&#125;&#125;å­¦ä¹ 2&lt;/a&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt; Vue.config.productionTip = false //é˜»æ­¢ vue åœ¨å¯åŠ¨æ—¶ç”Ÿæˆç”Ÿäº§æç¤ºã€‚ new Vue(&#123; el:&#x27;#root&#x27;, data:&#123; name:&#x27;jack&#x27;, school:&#123; name:&#x27;å°šç¡…è°·&#x27;, url:&#x27;http://www.atguigu.com&#x27;, &#125; &#125; &#125;)&lt;/script&gt; MVVM åé¢å†™ä»£ç å»äº†æ²¡å†™ç¬”è®°ï¼Œç¬”è®°éƒ½åœ¨ä»£ç ä¸Š","categories":[{"name":"Vue","slug":"Vue","permalink":"http://example.com/categories/Vue/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://example.com/tags/%E5%89%8D%E7%AB%AF/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"}]},{"title":"ã€é›†è®­ã€‘å¾®ä¿¡å°ç¨‹åº(äºŒ)","slug":"ã€é›†è®­ã€‘å¾®ä¿¡å°ç¨‹åº(äºŒ)","date":"2021-07-22T01:00:03.480Z","updated":"2021-07-23T05:35:01.858Z","comments":true,"path":"2021/07/22/ji-xun-wei-xin-xiao-cheng-xu-er/","link":"","permalink":"http://example.com/2021/07/22/ji-xun-wei-xin-xiao-cheng-xu-er/","excerpt":"","text":"APIç³»ç»Ÿä¿¡æ¯Object wx.getSystemInfoSync() | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) 1234567// è·å–ç³»ç»Ÿä¿¡æ¯wx.getSystemInfo(&#123; success: (result) =&gt; &#123; console.log(result); console.log(result.model); &#125;,&#125;) äº¤äº’wx.showToast(Object object) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) 12345678910111213141516// loadingæç¤ºæ¡†wx.showLoading(&#123; title: &#x27;æ•°æ®åŠ è½½ä¸­&#x27;,&#125;)setTimeout(res =&gt; &#123; wx.hideLoading(&#123; success: (res) =&gt; &#123; console.log(&quot;åŠ è½½å®Œæˆ&quot;); &#125;, &#125;)&#125;, 2000)// æ¶ˆæ¯æç¤ºwx.showToast(&#123; title: &#x27;æç¤ºä¿¡æ¯&#x27;,&#125;) è·¯ç”±è·³è½¬é¡µé¢wx.navigateTo(Object object) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) 1&lt;button type=&quot;primary&quot; bindtap=&quot;clickBtn&quot;&gt;è·³è½¬åˆ°demo01&lt;/button&gt; 123456789clickBtn() &#123; // å¯å¸¦å‚æ•°,è°ƒç”¨ navigateTo è·³è½¬æ—¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„é¡µé¢ä¼šè¢«åŠ å…¥å †æ ˆï¼Œè€Œ redirectTo æ–¹æ³•åˆ™ä¸ä¼š wx.navigateTo(&#123; url: &#x27;/pages/demo05/demo05?id=111&#x27;, success: (res) =&gt; &#123; console.log(res); &#125; &#125;) &#125; è¿”å›é¡µé¢wx.navigateBack(Object object) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) 1&lt;button bindtap=&quot;clickBack&quot; type=&quot;primary&quot;&gt;è¿”å›ä¸Šä¸€é¡µ&lt;/button&gt; 12345clickBack() &#123; wx.navigateBack(&#123; delta: 1, &#125;) &#125; äº‹ä»¶ä¼ å€¼EventChannel | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) demo04.js 1234567891011121314151617clickBtn() &#123; // å¯å¸¦å‚æ•°,è°ƒç”¨ navigateTo è·³è½¬æ—¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„é¡µé¢ä¼šè¢«åŠ å…¥å †æ ˆï¼Œè€Œ redirectTo æ–¹æ³•åˆ™ä¸ä¼š wx.navigateTo(&#123; url: &#x27;/pages/demo05/demo05?id=111&#x27;, events: &#123; // ä¸ºæŒ‡å®šäº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ myBackData(data) &#123; console.log(data); &#125; &#125;, // æˆåŠŸçš„å›è°ƒå‡½æ•° success: (res) =&gt; &#123; // è§¦å‘ä¸€ä¸ªäº‹ä»¶ res.eventChannel.emit(&quot;myGetData&quot;, &#123; data: &quot;ä¼ é€’çš„æ•°æ®&quot; &#125;) &#125; &#125;) &#125; demo05.js 1234567891011121314151617181920onLoad() &#123; // è·å–æ‰€æœ‰æ‰“å¼€çš„EventChanneläº‹ä»¶ const eventChannel = this.getOpenerEventChannel(); // ç›‘å¬indexé¡µé¢çš„myGetDataäº‹ä»¶ eventChannel.on(&quot;myGetData&quot;, (res) =&gt; &#123; // è¢«è§¦å‘åçš„æ“ä½œ console.log(res); &#125;); eventChannel.emit(&quot;myBackData&quot;, &#123; data: &quot;è¿”å›çš„æ•°æ®&quot; &#125;)&#125;,clickBack() &#123; //const eventChannel = this.getOpenerEventChannel(); //eventChannel.emit(&quot;myBackData&quot;, &#123; data: &quot;è¿”å›çš„æ•°æ®&quot; &#125;) // é€šè¿‡ getCurrentPages è·å–å½“å‰çš„é¡µé¢æ ˆï¼Œå†³å®šéœ€è¦è¿”å›å‡ å±‚ã€‚ wx.navigateBack(&#123; delta: 1, &#125;)&#125; ç½‘ç»œä¸´æ—¶æ•°æ®demo06.wxml 123456789101112&lt;!--pages/demo06/demo06.wxml--&gt;&lt;view class=&quot;out&quot;&gt; &lt;view class=&quot;row&quot; wx:for=&quot;&#123;&#123;dataList&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt; &lt;view class=&quot;pic&quot;&gt; &lt;image src=&quot;&#123;&#123;item.url&#125;&#125;&quot; /&gt; &lt;/view&gt; &lt;view class=&quot;text&quot;&gt; &lt;view class=&quot;title&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/view&gt; &lt;view class=&quot;time&quot;&gt;&#123;&#123;item.time&#125;&#125;&lt;/view&gt; &lt;/view&gt; &lt;/view&gt;&lt;/view&gt; demo06.js 12345678910111213141516171819data: &#123; dataList: [ &#123; title: &quot;æ ‡é¢˜1&quot;, time: &quot;2020-01-01&quot;, url: &quot;/images/image1.png&quot; &#125;, &#123; title: &quot;æ ‡é¢˜2&quot;, time: &quot;2020-01-02&quot;, url: &quot;/images/image1.png&quot; &#125;, &#123; title: &quot;æ ‡é¢˜3&quot;, time: &quot;2020-01-03&quot;, url: &quot;/images/image1.png&quot; &#125; ]&#125;, è¯·æ±‚æ•°æ®RequestTask | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) ä½¿ç”¨wx.requestè·å–æ•°æ® 1234567891011121314151617181920onLoad: function (options) &#123; wx.request(&#123; // æ¥å£åœ°å€ url: &#x27;http://edu.newsight.cn/wxList.php&#x27;, // è¯·æ±‚çš„å‚æ•° data: &#123; num: 5, page: 1 &#125;, // æ¥å£è°ƒç”¨æˆåŠŸçš„å›è°ƒå‡½æ•° success: (res) =&gt; &#123; console.log(res); console.log(res.data); // è®¾ç½®æ•°æ® this.setData(&#123; reqData: res.data &#125;) &#125;, &#125;)&#125;, ä¿®æ”¹ä¹‹å‰çš„ä»£ç  demo06.wxml 123456789101112&lt;!--pages/demo06/demo06.wxml--&gt;&lt;view class=&quot;out&quot;&gt; &lt;view class=&quot;row&quot; wx:for=&quot;&#123;&#123;reqData&#125;&#125;&quot; wx:key=&quot;id&quot;&gt; &lt;view class=&quot;pic&quot;&gt; &lt;image src=&quot;&#123;&#123;item.picurl&#125;&#125;&quot; /&gt; &lt;/view&gt; &lt;view class=&quot;text&quot;&gt; &lt;view class=&quot;title&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/view&gt; &lt;view class=&quot;time&quot;&gt;&#123;&#123;item.posttime&#125;&#125; - &#123;&#123;item.author&#125;&#125;&lt;/view&gt; &lt;/view&gt; &lt;/view&gt;&lt;/view&gt; å¦‚æœåŸŸåæ£€éªŒä¸åˆæ³•ï¼Œå¯ä»¥åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°çš„å¼€å‘ä¸­ç®¡ç†æ·»åŠ æ‰€éœ€è¦ä½¿ç”¨çš„åŸŸåï¼Œæˆ–è€…å¼€å‘è€…å·¥å…·åœ¨è®¾ç½®ä¸æ£€æµ‹åˆæ³•ã€‚ äº‹ä»¶ç»‘å®šåˆ·æ–°æ•°æ®demo06.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// pages/demo06/demo06.jsPage(&#123; /** * é¡µé¢çš„åˆå§‹æ•°æ® */ data: &#123; reqData: [], scrollTop: 0 &#125;, reqParam: &#123; page: 1 &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½ */ onLoad: function (options) &#123; this.getReqData(1); &#125;, // ä¸‹ä¸€é¡µ clickToNextPage() &#123; this.reqParam.page++; this.getReqData(this.reqParam.page) &#125;, getReqData(page) &#123; wx.request(&#123; // æ¥å£åœ°å€ url: &#x27;http://edu.newsight.cn/wxList.php&#x27;, // è¯·æ±‚çš„å‚æ•° data: &#123; num: 4, page: page &#125;, // æ¥å£è°ƒç”¨æˆåŠŸçš„å›è°ƒå‡½æ•° success: (res) =&gt; &#123; console.log(res); console.log(res.data); // è®¾ç½®æ•°æ® this.setData(&#123; reqData: res.data &#125;) &#125;, &#125;) &#125;&#125;) demo06.wxml 1&lt;button bindtap=&quot;clickToNextPage&quot; type=&quot;primary&quot;&gt;ä¸‹ä¸€é¡µ&lt;/button&gt; ç”¨æˆ·ä¿¡æ¯wx.getUserProfile(Object object) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) demo07.wxml 123&lt;button bindtap=&quot;login&quot; type=&quot;primary&quot;&gt;æˆæƒç™»å½•&lt;/button&gt;&lt;view&gt;&#123;&#123;nickName&#125;&#125;&lt;/view&gt;&lt;image src=&quot;&#123;&#123;avatar&#125;&#125;&quot;&gt;&lt;/image&gt; demo07.js 12345678910111213141516171819202122data: &#123; nickName: &quot;&quot;, avatar: &quot;&quot;,&#125;,// æˆæƒç™»å½•login() &#123; wx.getUserProfile(&#123; // å£°æ˜è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯åçš„ç”¨é€”ï¼Œä¸è¶…è¿‡30ä¸ªå­—ç¬¦ desc: &#x27;å£°æ˜è·å–ç”¨æˆ·ä¿¡æ¯åçš„ç”¨é€”&#x27;, success: (res) =&gt; &#123; console.log(res); this.setData(&#123; nickName: res.userInfo.nickName, avatar: res.userInfo.avatarUrl &#125;) &#125;, fail: (res) =&gt; &#123; console.log(res); &#125; &#125;)&#125; ç¼“å­˜wx.setStorageSync(string key, any data) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) å­˜123456789101112131415161718login() &#123; wx.getUserProfile(&#123; // å£°æ˜è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯åçš„ç”¨é€”ï¼Œä¸è¶…è¿‡30ä¸ªå­—ç¬¦ desc: &#x27;å£°æ˜è·å–ç”¨æˆ·ä¿¡æ¯åçš„ç”¨é€”&#x27;, success: (res) =&gt; &#123; console.log(res); this.setData(&#123; nickName: res.userInfo.nickName, avatar: res.userInfo.avatarUrl &#125;); // å­˜ä¿¡æ¯ wx.setStorageSync(&#x27;userInfo&#x27;, res.userInfo); &#125;, fail: (res) =&gt; &#123; console.log(res); &#125; &#125;)&#125; å–123&lt;button bindtap=&quot;login&quot; type=&quot;primary&quot; wx:if=&quot;&#123;&#123;!nickName&#125;&#125;&quot;&gt;æˆæƒç™»å½•&lt;/button&gt;&lt;view&gt;&#123;&#123;nickName&#125;&#125;&lt;/view&gt;&lt;image src=&quot;&#123;&#123;avatar&#125;&#125;&quot;&gt;&lt;/image&gt; 123456789onLoad: function (options) &#123; // å–ç¼“å­˜ let userInfo = wx.getStorageSync(&#x27;userInfo&#x27;); console.log(userInfo); this.setData(&#123; nickName: userInfo.nickName, avatar: userInfo.avatarUrl &#125;)&#125;, æ¨¡å—åŒ–Object module | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) public.js 123456789101112var myPublic = &#123; fun1() &#123; console.log(&quot;æ‰§è¡Œfun1&quot;); &#125;, fun2(p) &#123; console.log(&quot;æ‰§è¡Œfun2,å‚æ•°ï¼š&quot; + p); &#125;&#125;module.exports = myPublic demo08.js 123456const myPublic = require(&#x27;../../utils/public.js&#x27;)onLoad: function (options) &#123; myPublic.fun1(); myPublic.fun2(&quot;param&quot;);&#125;, å°ç¨‹åºä¸Šçº¿ ä¿®æ”¹æµ‹è¯•å·ä¸ºAppID å°ç¨‹åº (qq.com)ç®¡ç†æœåŠ¡å™¨åŸŸåï¼Œå–æ¶ˆä¸æ£€éªŒåˆæ³•åŸŸå ä¸Šä¼ ä»£ç  å°ç¨‹åº (qq.com)æäº¤å®¡æ ¸","categories":[{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"é›†è®­","slug":"é›†è®­","permalink":"http://example.com/tags/%E9%9B%86%E8%AE%AD/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"ã€é›†è®­ã€‘å¾®ä¿¡å°ç¨‹åº(ä¸€)","slug":"ã€é›†è®­ã€‘å¾®ä¿¡å°ç¨‹åº(ä¸€)","date":"2021-07-22T01:00:03.478Z","updated":"2021-07-23T05:50:01.078Z","comments":true,"path":"2021/07/22/ji-xun-wei-xin-xiao-cheng-xu-yi/","link":"","permalink":"http://example.com/2021/07/22/ji-xun-wei-xin-xiao-cheng-xu-yi/","excerpt":"","text":"è‡ªå®šä¹‰ç»„ä»¶Component(Object object) | å¾®ä¿¡å¼€æ”¾æ–‡æ¡£ (qq.com) å°†éƒ¨åˆ†é‡å¤ä»£ç æŠ½å–å‡ºæ¥ å•†å“åˆ†ç±» (taobao.com) åˆ›å»ºè‡ªå®šä¹‰ç»„ä»¶ ç±»ä¼¼äºé¡µé¢ï¼Œä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶ç”±jsonã€wxmlã€wxssã€js 4ä¸ªæ–‡ä»¶ç»„æˆ å¯ä»¥åœ¨å¾®ä¿¡å¼€å‘è€…â¼¯å…·ä¸­å¿«é€Ÿåˆ›å»ºç»„ä»¶çš„â½‚ä»¶ç»“æ„ å£°æ˜ç»„ä»¶ã€å¼•å…¥ç»„ä»¶tabs.json 123&#123; &quot;component&quot;: true&#125; demo01.json 12345&#123; &quot;usingComponents&quot;: &#123; &quot;Tabs&quot;: &quot;/components/Tabs/Tabs&quot; &#125;&#125; ç®€å•ç¼–è¾‘ç»„ä»¶Tabs.wxml 123456789101112&lt;!--components/Tabs/Tabs.wxml--&gt;&lt;view class=&quot;tabs&quot;&gt; &lt;view class=&quot;tabs_title&quot;&gt; &lt;view class=&quot;title_item active&quot;&gt;é¦–é¡µ&lt;/view&gt; &lt;view class=&quot;title_item&quot;&gt;åŸåˆ›&lt;/view&gt; &lt;view class=&quot;title_item&quot;&gt;åˆ†ç±»&lt;/view&gt; &lt;view class=&quot;title_item&quot;&gt;å…³äº&lt;/view&gt; &lt;/view&gt; &lt;view class=&quot;tabs_content&quot;&gt; &lt;/view&gt;&lt;/view&gt; Tabs.wxss 12345678910111213141516171819202122/* components/Tabs/Tabs.wxss */.tabs &#123;&#125;.tabs_title &#123; display: flex; padding: 10rpx 0;&#125;.title_item &#123; flex: 1; display: flex; justify-content: center; align-items: center;&#125;/* é€‰ä¸­æ—¶çš„æ ·å¼ */.active &#123; color: #b81d24; border-bottom: 5rpx solid currentColor;&#125;.tabs_content &#123;&#125; ä»¥ä¸Šæ•°æ®éƒ½å†™åœ¨ç»„ä»¶çš„wxmlä¸­ï¼Œæ¥ä¸‹æ¥æ¥å®ç°jsåŠ¨æ€æ•°æ® å¡«å…¥åˆå§‹æ•°æ®Tabs.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445// components/Tabs/Tabs.jsComponent(&#123; /** * ç»„ä»¶çš„å±æ€§åˆ—è¡¨ */ properties: &#123; &#125;, /** * ç»„ä»¶çš„åˆå§‹æ•°æ® */ data: &#123; tabs: [ &#123; id: 0, name: &quot;é¦–é¡µ&quot;, isActive: true &#125;, &#123; id: 1, name: &quot;åŸåˆ›&quot;, isActive: false &#125; , &#123; id: 2, name: &quot;åˆ†ç±»&quot;, isActive: false &#125; , &#123; id: 3, name: &quot;å…³äº&quot;, isActive: false &#125; ] &#125;, /** * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨ */ methods: &#123; &#125;&#125;) Tab.wxml 12345678910111213&lt;view class=&quot;tabs&quot;&gt; &lt;view class=&quot;tabs_title&quot;&gt; &lt;!-- åˆ—è¡¨æ¸²æŸ“ --&gt; &lt;!-- classä¸­ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œæ ¹æ®itemçš„isActiveå±æ€§åˆ¤æ–­æ˜¯å¦é€‰ä¸­ï¼Œé€‰ä¸­åˆ™æ·»åŠ ç±»åä»¥æ˜¾ç¤ºæ ·å¼ --&gt; &lt;view wx:for=&quot;&#123;&#123;tabs&#125;&#125;&quot; wx:key=&quot;id&quot; class=&quot;title_item &#123;&#123;item.isActive?&#x27;active&#x27;:&#x27;&#x27;&#125;&#125;&quot;&gt; &#123;&#123;item.name&#125;&#125; &lt;/view&gt; &lt;/view&gt; &lt;view class=&quot;tabs_content&quot;&gt;&lt;/view&gt; &lt;/view&gt; ç»‘å®šç‚¹å‡»äº‹ä»¶Tab.wxml 123456789&lt;view class=&quot;tabs_title&quot;&gt; &lt;!-- åˆ—è¡¨æ¸²æŸ“ --&gt; &lt;!-- classä¸­ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œæ ¹æ®itemçš„isActiveå±æ€§åˆ¤æ–­æ˜¯å¦é€‰ä¸­ï¼Œé€‰ä¸­åˆ™æ·»åŠ ç±»åä»¥æ˜¾ç¤ºæ ·å¼ --&gt; &lt;!-- data-indexè‡ªå®šä¹‰å±æ€§ï¼Œç”¨äºä¼ é€’å½“å‰çš„ç´¢å¼•å€¼ --&gt; &lt;view wx:for=&quot;&#123;&#123;tabs&#125;&#125;&quot; wx:key=&quot;id&quot; class=&quot;title_item &#123;&#123;item.isActive?&#x27;active&#x27;:&#x27;&#x27;&#125;&#125;&quot; bindtap=&quot;handleItemTap&quot; data-index=&quot;&#123;&#123;index&#125;&#125;&quot;&gt; &#123;&#123;item.name&#125;&#125; &lt;/view&gt;&lt;/view&gt; æ³¨æ„è‡ªå®šä¹‰ç»„ä»¶çš„æ–¹æ³•å†™åœ¨methodsä¸­ Tabs.js 123456789101112131415161718192021222324252627methods: &#123; handleItemTap(e) &#123; // æŸ¥çœ‹ç´¢å¼•æ‰€åœ¨çš„ä½ç½® console.log(e); // 1.è·å–è¢«ç‚¹å‡»çš„ç´¢å¼• // ES6å¸¸é‡const,åªè¯»ä¸å¯æ”¹ // ES6è§£æ„èµ‹å€¼:const &#123; index &#125; = e.currentTarget.dataset; const index = e.currentTarget.dataset.index; // 2.è·å–åŸæ•°ç»„ // ES6å˜é‡let,å—çº§ä½œç”¨åŸŸ // ES6è§£æ„èµ‹å€¼:let &#123; tabs &#125; = this.data; let tabs = this.data.tabs; // 3.å¾ªç¯æ•°ç»„ï¼šä¸ºå½“å‰ç´¢å¼•é¡¹è®¾ç½®isActiveï¼štrue,å…¶ä½™false // ES6ç®­å¤´å‡½æ•° tabs.forEach((v, i) =&gt; &#123; i === index ? v.isActive = true : v.isActive = false &#125;); // ä¿®æ”¹æ•°æ® this.setData(&#123; tabs &#125;) &#125;&#125; ä»¥ä¸Šæ•°æ®éƒ½å†™åœ¨ç»„ä»¶ä¸­ï¼Œæ¥ä¸‹æ¥æ¥å®ç°çˆ¶å‘å­ä¼ é€’æ•°æ® çˆ¶å‘å­ä¼ é€’æ•°æ®demo01.wxml 123456&lt;!-- çˆ¶ç»„ä»¶demo01ï¼Œå­ç»„ä»¶Tabs çˆ¶ç»„ä»¶é€šè¿‡æ ‡ç­¾å±æ€§ä¼ é€’æ•°æ® å­ç»„ä»¶åœ¨propertiesä¸­æ¥æ”¶--&gt;&lt;Tabs abc=&quot;è¦ä¼ é€’çš„æ•°æ®&quot;&gt;&lt;/Tabs&gt; Tabs.js 123456789properties: &#123; // å±æ€§å abc: &#123; // æ¥æ”¶çš„æ•°æ®çš„ç±»å‹ type: String, // é»˜è®¤å€¼ value: &quot;&quot; &#125;&#125;, Tabs.wxml 12&lt;!-- ç›¸å½“äºdataä¸­çš„æ•°æ®ä½¿ï¼Œç”¨&#123;&#123;&#125;&#125;æ¸²æŸ“ --&gt;&lt;view&gt;&#123;&#123;abc&#125;&#125;&lt;/view&gt; æ¥ä¸‹æ¥ä¿®æ”¹æ¡ˆä¾‹ä»£ç  å°†è¦ä¼ é€’çš„æ•°æ®æ”¾åœ¨çˆ¶ç»„ä»¶çš„dataä¸­ï¼Œå³åŸå…ˆå†™åœ¨Tabs.jsçš„dataä¸­çš„æ•°æ®æ”¾åœ¨demo01.jsçš„dataä¸­ 1234567891011121314151617181920212223242526data: &#123; tabs: [ &#123; id: 0, name: &quot;é¦–é¡µ&quot;, isActive: true &#125;, &#123; id: 1, name: &quot;åŸåˆ›&quot;, isActive: false &#125; , &#123; id: 2, name: &quot;åˆ†ç±»&quot;, isActive: false &#125; , &#123; id: 3, name: &quot;å…³äº&quot;, isActive: false &#125; ]&#125;, çˆ¶ç»„ä»¶é€šè¿‡æ ‡ç­¾å±æ€§ä¼ é€’æ•°æ® demo01.wxml 1&lt;Tabs tabs=&quot;&#123;&#123;tabs&#125;&#125;&quot;&gt;&lt;/Tabs&gt; å­ç»„ä»¶åœ¨propertiesä¸­æ¥æ”¶ï¼Œæœ€åæ•ˆæœä¸ä¹‹å‰ç›¸åŒ Tabs.js 123456properties: &#123; tabs: &#123; type: Array, value: [] &#125;&#125;, æ­¤æ—¶Tabs.jsä¸­ä»£ç ä»ç„¶æ˜¯åœ¨å­ç»„ä»¶å½“ä¸­ä¿®æ”¹tabæ•°ç»„ï¼Œè€Œä¸æ˜¯åœ¨çˆ¶ç»„ä»¶çš„dataä¸­ä¿®æ”¹tabï¼ˆå¯ä»¥åœ¨AppDataçª—å£æŸ¥çœ‹ï¼‰ 123456// this.dataä¸­æ‰¾ä¸åˆ°æ•°æ®ï¼Œåˆ™åœ¨propertiesä¸­å¯»æ‰¾let tabs = this.data.tabs;// å°†tabsæ”¾å…¥dataå½“ä¸­this.setData(&#123; tabs&#125;) æ‰€ä»¥éœ€è¦å°†å¤„ç†æ•°æ®æ”¾åœ¨çˆ¶ç»„ä»¶å½“ä¸­ï¼Œè€Œæ‰€éœ€è¦çš„ç´¢å¼•å€¼åˆ™ç”±å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼ˆå­å‘çˆ¶ä¼ é€’æ•°æ®ï¼‰ å­å‘çˆ¶ä¼ é€’æ•°æ®Tabs.js 12345678methods: &#123; handleItemTap(e) &#123; // 1.è·å–è¢«ç‚¹å‡»çš„ç´¢å¼• const index = e.currentTarget.dataset.index; // 2.è§¦å‘çˆ¶ç»„ä»¶ä¸­çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¼ é€’æ•°æ® this.triggerEvent(&quot;itemChange&quot;, &#123; index &#125;); //triggerEvent(&quot;è‡ªå®šä¹‰äº‹ä»¶å&quot;, è¦ä¼ é€’çš„æ•°æ®) &#125;&#125; demo01.wxml 123456&lt;!-- å­ç»„ä»¶Tabs -&gt; çˆ¶ç»„ä»¶demo01 åœ¨å­ç»„ä»¶çš„æ ‡ç­¾ä¸­æ·»åŠ è‡ªå®šä¹‰äº‹ä»¶ ç¼–å†™çˆ¶ç»„ä»¶jsäº‹ä»¶æ–¹æ³•--&gt;&lt;Tabs tabs=&quot;&#123;&#123;tabs&#125;&#125;&quot; binditemChange=&quot;handleItemChange&quot;&gt;&lt;/Tabs&gt; demo01.js 1234567891011121314// è‡ªå®šä¹‰äº‹ä»¶æ–¹æ³•handleItemChange(e) &#123; console.log(e); // æ¥æ”¶ä¼ é€’çš„æ•°æ® const index = e.detail.index; // ä»¥ä¸‹ä»£ç ç›¸åŒ let tabs = this.data.tabs; tabs.forEach((v, i) =&gt; &#123; i === index ? v.isActive = true : v.isActive = false &#125;); this.setData(&#123; tabs &#125;)&#125;, AppDataçª—å£æŸ¥çœ‹å³å¯ slotæ ‡ç­¾ slotå ä½ç¬¦ï¼ˆæ’æ§½ï¼‰ï¼Œçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶ä¼ é€’ä¸€äº›æ ‡ç­¾æ¥æ›¿æ¢slotçš„ä½ç½® Tabs.wxml 123&lt;view class=&quot;tabs_content&quot;&gt; &lt;slot&gt;&lt;/slot&gt;&lt;/view&gt; demo01.wxml 123456&lt;Tabs tabs=&quot;&#123;&#123;tabs&#125;&#125;&quot; binditemChange=&quot;handleItemChange&quot;&gt; &lt;block wx:if=&quot;&#123;&#123;tabs[0].isActive&#125;&#125;&quot;&gt;å†…å®¹1&lt;/block&gt; &lt;block wx:elif=&quot;&#123;&#123;tabs[1].isActive&#125;&#125;&quot;&gt;å†…å®¹2&lt;/block&gt; &lt;block wx:elif=&quot;&#123;&#123;tabs[2].isActive&#125;&#125;&quot;&gt;å†…å®¹3&lt;/block&gt; &lt;block wx:else&gt;å†…å®¹4&lt;/block&gt;&lt;/Tabs&gt; ç”Ÿå‘½å‘¨æœŸåº”ç”¨ 12345678910111213141516171819202122232425262728293031323334// app.jsApp(&#123; // åº”ç”¨ ç¬¬ä¸€æ¬¡å¯åŠ¨ çš„æ—¶å€™è§¦å‘ï¼Œå¯ç”¨äºæœ€å¼€å§‹è·å–ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ç­‰ onLaunch() &#123; console.log(&quot;onLaunch&quot;); &#125;, // åº”ç”¨ æ˜¾ç¤º çš„æ—¶å€™è§¦å‘ï¼Œå¯ç”¨äºå¯¹é¡µé¢æ•°æ®ã€é¡µé¢æ•ˆæœè¿›è¡Œé‡ç½® onShow() &#123; console.log(&quot;onShow&quot;); // å¯è°ƒç”¨å¤šæ¬¡ &#125;, // åº”ç”¨ éšè— çš„æ—¶å€™è§¦å‘ï¼Œå¯ç”¨äºæš‚åœæˆ–æ¸…é™¤å®šæ—¶å™¨ onHide() &#123; console.log(&quot;onHide&quot;); &#125;, // åº”ç”¨ ä»£ç æŠ¥é”™ çš„æ—¶å€™è§¦å‘ï¼Œå¯ç”¨äºæ”¶é›†é”™è¯¯ä¿¡æ¯å¹¶å‘é€åˆ°åå° onError(error) &#123; console.log(&quot;onError&quot;); console.log(error); &#125;, // åº”ç”¨ ç¬¬ä¸€æ¬¡å¯åŠ¨æ‰¾ä¸åˆ°å…¥å£é¡µé¢ çš„æ—¶å€™è§¦å‘ï¼Œå¯ç”¨äºè·³è½¬ onPageNotFound() &#123; console.log(&quot;onPageNotFound&quot;); wx.navigateTo(&#123; url: &#x27;/pages/demo01/demo01&#x27;, &#125;) &#125;&#125;) é¡µé¢ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990// pages/demo02/demo02.jsPage(&#123; /** * é¡µé¢çš„åˆå§‹æ•°æ® */ data: &#123; &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½ * å‘é€å¼‚æ­¥è¯·æ±‚åˆå§‹åŒ–é¡µé¢æ•°æ® */ onLoad: function (options) &#123; console.log(&quot;onLoad&quot;); &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢æ˜¾ç¤º */ onShow: function () &#123; console.log(&quot;onShow&quot;); &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ */ onReady: function () &#123; console.log(&quot;onReady&quot;); &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢éšè— */ onHide: function () &#123; console.log(&quot;onHide&quot;); &#125;, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢å¸è½½ */ onUnload: function () &#123; console.log(&quot;onUnload&quot;); &#125;, /** * é¡µé¢ç›¸å…³äº‹ä»¶å¤„ç†å‡½æ•°--ç›‘å¬ç”¨æˆ·ä¸‹æ‹‰åŠ¨ä½œ * å¯¹é¡µé¢åˆå§‹åŒ– */ onPullDownRefresh: function () &#123; console.log(&quot;onPullDownRefresh&quot;); &#125;, /** * é¡µé¢ä¸Šæ‹‰è§¦åº•äº‹ä»¶çš„å¤„ç†å‡½æ•° * è§¦åº•åŠ è½½æ›´å¤šæ•°æ® */ onReachBottom: function () &#123; console.log(&quot;onReachBottom&quot;); &#125;, /** * ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº« */ onShareAppMessage: function () &#123; console.log(&quot;onShareAppMessage&quot;); &#125;, /** * é¡µé¢æ»šåŠ¨ */ onPageScroll() &#123; console.log(&quot;onPageScroll&quot;); &#125;, /** * é¡µé¢å°ºå¯¸æ”¹å˜ */ onResize() &#123; console.log(&quot;onResize&quot;); &#125;, /** * å½“å‰æ˜¯tabé¡µï¼Œç‚¹å‡»å½“å‰é¡µçš„tabæ—¶è§¦å‘ */ onTabItemTap() &#123; console.log(&quot;onTabItemTap&quot;); &#125;&#125;)","categories":[{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"é›†è®­","slug":"é›†è®­","permalink":"http://example.com/tags/%E9%9B%86%E8%AE%AD/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘SpringBoot2","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘SpringBoot2","date":"2021-07-20T10:31:35.005Z","updated":"2021-08-18T04:48:58.808Z","comments":true,"path":"2021/07/20/xue-xi-bi-ji-springboot2/","link":"","permalink":"http://example.com/2021/07/20/xue-xi-bi-ji-springboot2/","excerpt":"","text":"æ•™ç¨‹ä¸æ–‡æ¡£SpringBoot2æ ¸å¿ƒæŠ€æœ¯ä¸å“åº”å¼ç¼–ç¨‹ Â· è¯­é›€ (yuque.com) Springä¸SpringBoot201ã€Springä¸SpringBoot Â· è¯­é›€ (yuque.com) HelloWorld å¯¼å…¥ä¾èµ– pom.xml 1234567891011121314&lt;!-- çˆ¶é¡¹ç›®é…ç½® --&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.3.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- webåœºæ™¯å¯åŠ¨å™¨ --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ç¼–å†™controller HelloController.java 12345678910// @Controller // æ³¨æ˜controller// @ResponseBody // æ³¨æ˜å°†javaå¯¹è±¡è½¬ä¸ºjsonæ ¼å¼çš„æ•°æ®@RestController // ä»£æ›¿ä»¥ä¸Šä¸¤è€…public class HelloController &#123; // æ˜ å°„è¯·æ±‚çš„åœ°å€ @RequestMapping(&quot;/hello&quot;) public String handle1() &#123; return &quot;Hello,SpringBoot2&quot;; &#125;&#125; ç¼–å†™ä¸»ç¨‹åºç±»å¹¶æµ‹è¯• MainApplication.java 1234567891011/** * ä¸»ç¨‹åºç±» */// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªSpringBootåº”ç”¨@SpringBootApplicationpublic class MainApplication &#123; public static void main(String[] args) &#123; // runå£°æ˜ä¸»ç¨‹åºç±»ï¼Œè¿”å›ä¸€ä¸ªIoCå®¹å™¨ SpringApplication.run(MainApplication.class, args); &#125;&#125; resourcesæ–‡ä»¶å¤¹ä¸‹application.propertiesï¼Œå¯æ ¹æ®æ–‡æ¡£è‡ªå®šä¹‰é…ç½® Common Application properties (spring.io) åˆ›å»ºå¯æ‰§è¡ŒjaråŒ…ï¼Œæ·»åŠ buildä¾èµ–ï¼Œç„¶åç‚¹å‡»mavenä¸­çš„lifecycleä¸­çš„cleanä¸packageå¹¶æ‰§è¡Œ pom.xml 123456789&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2.4.RELEASE&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; æ‰§è¡ŒjaråŒ…ï¼Œåœ¨targetç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ java -jar åŒ…å.jar ä¾èµ–ç®¡ç†ä¸è‡ªåŠ¨é…ç½®ç‰¹æ€§é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili åº•å±‚æ³¨è§£@Configurationã€@Bean é…ç½®å¯¹è±¡åŸåŸSpringä½¿ç”¨xmlé…ç½®æ–‡ä»¶é…ç½®beanå¯¹è±¡å¦‚ä¸‹ bean.xml 123456789101112131415&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;bean id=&quot;user01&quot; class=&quot;com.myspringboot2.bean.User&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;zhangsan&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;cat&quot; class=&quot;com.myspringboot2.bean.Pet&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;mimi&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; ç°ç¼–å†™é…ç½®MyConfig.java 1234567891011121314151617/** * 1ã€é…ç½®ç±»é‡Œé¢ä½¿ç”¨@Beanæ·»åŠ å¯¹è±¡ï¼Œé»˜è®¤æ˜¯å•å®ä¾‹ * 2ã€é…ç½®ç±»æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ * 3ã€proxyBeanMethods: ä»£ç†beançš„æ–¹æ³•ã€‚é»˜è®¤ä¸ºtrue(fullæ¨¡å¼)ï¼Œä½¿ç”¨ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•ï¼Œä¿è¯å¯¹è±¡æ˜¯å•å®ä¾‹ï¼›å¦åˆ™(liteæ¨¡å¼)éå•å®ä¾‹ */@Configuration(proxyBeanMethods = true) //å£°æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆå³æ›¿æ¢æ‰é…ç½®æ–‡ä»¶public class MyConfig &#123; // æ— è®ºå¤–éƒ¨å¯¹è¿™ä¸ªé…ç½®ç±»ä¸­çš„æ–¹æ³•è°ƒç”¨å¤šå°‘æ¬¡ï¼Œè·å¾—çš„éƒ½æ˜¯å®¹å™¨ä¸­çš„å•å®ä¾‹å¯¹è±¡ @Bean //å‘å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œidä¸ºæ–¹æ³•å(å¯ä»¥è‡ªå®šä¹‰)ï¼Œç»„ä»¶ç±»å‹ä¸ºè¿”å›ç±»å‹ï¼Œç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å®ä¾‹ä¸ºè¿”å›åœ°å€¼ public User user01() &#123; return new User(&quot;zhangsan&quot;, 18); &#125; @Bean(&quot;pet01&quot;) //è‡ªå®šä¹‰id public Pet cat() &#123; return new Pet(&quot;mimi&quot;); &#125;&#125; æµ‹è¯•ç±»MainApplication.java 123456789101112131415/** * ä¸»ç¨‹åºç±» */// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªSpringBootåº”ç”¨@SpringBootApplicationpublic class MainApplication &#123; public static void main(String[] args) &#123; // è·å–IoCå®¹å™¨,runå£°æ˜ä¸»ç¨‹åºç±»,è¿”å›ä¸€ä¸ªIoCå®¹å™¨ ConfigurableApplicationContext run = SpringApplication.run(MainApplication.class, args); // ä»å®¹å™¨ä¸­è·å–bean,é»˜è®¤æ˜¯å•å®ä¾‹ User user01 = run.getBean(&quot;user01&quot;, User.class); Pet pet01 = run.getBean(&quot;pet01&quot;, Pet.class); MyConfig myConfig = run.getBean(MyConfig.class); &#125;&#125; Fullæ¨¡å¼ä¸Liteæ¨¡å¼ é…ç½®ç±»ç»„ä»¶ä¹‹é—´æ— ä¾èµ–å…³ç³»ç”¨Liteæ¨¡å¼åŠ é€Ÿå®¢å™¨å¯åŠ¨è¿‡ç¨‹,å‡å°‘åˆ¤æ–­ é…ç½®ç±»ç»„ä»¶ä¹‹é—´æœ‰ä¾èµ–å…³ç³»,æ–¹æ³•ä¼šè¢«è°ƒç”¨å¾—åˆ°ä¹‹å‰å•å®ä¾‹ç»„ä»¶,ç”¨Fullæ¨¡å¼ @ComponentScan åŒ…æ‰«æ1234// ä¸€ä¸‹ä¸‰è€…ç›¸å½“äº@SpringBootApplication@ComponentScan(&quot;com.myspringboot2&quot;) //åŒ…æ‰«æåœ°å€@EnableAutoConfiguration@SpringBootConfiguration @Import æ³¨å…¥å¯¹è±¡1@Import(&#123;User.class, DBHelper.class&#125;) //å‘å®¹å™¨ä¸­æ·»åŠ å¯¹åº”ç±»å‹çš„å¯¹è±¡,é»˜è®¤å¯¹è±¡åä¸ºå¯¹åº”ç±»çš„å…¨ç±»å @Conditional æ¡ä»¶è£…é…ä½¿ç”¨ MyConfig.java 12345678@Configuration(proxyBeanMethods = false) //å£°æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆå³æ›¿æ¢æ‰é…ç½®æ–‡ä»¶public class MyConfig &#123; @ConditionalOnBean(name = &quot;pet02&quot;) // æŒ‰æ¡ä»¶æ‰§è¡Œå‘å®¹å™¨ä¸­æ³¨å…¥å¯¹è±¡,å¯æ”¾åœ¨ç±»ä¸Š(åˆ™æŒ‰æ¡ä»¶æ‰§è¡Œæ˜¯å¦æ³¨å…¥ç±»ä¸­æ‰€æœ‰çš„å¯¹è±¡) @Bean //å‘å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œidä¸ºæ–¹æ³•å(å¯ä»¥è‡ªå®šä¹‰)ï¼Œç»„ä»¶ç±»å‹ä¸ºè¿”å›ç±»å‹ï¼Œç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å®ä¾‹ä¸ºè¿”å›åœ°å€¼ public User user01() &#123; return new User(&quot;zhangsan&quot;, 18); &#125;&#125; æµ‹è¯• MainApplication.java 123456789@SpringBootApplicationpublic class MainApplication &#123; public static void main(String[] args) &#123; // è·å–IoCå®¹å™¨,runå£°æ˜ä¸»ç¨‹åºç±»ï¼Œè¿”å›ä¸€ä¸ªIoCå®¹å™¨ ConfigurableApplicationContext run = SpringApplication.run(MainApplication.class, args); // ç”±äºuser01é…ç½®çš„æ˜¯ç”±æ·»åŠ äº†ConditinalOnBean,è€Œå…¶ä¸­çš„æ¡ä»¶pet02å¯¹è±¡å¹¶ä¸åœ¨å®¹å™¨å½“ä¸­ï¼Œæ‰€ä»¥æœªæ³¨å…¥user01 System.out.println(run.containsBean(&quot;user01&quot;)); &#125;&#125; @ImportResource å¯¼å…¥xmlé…ç½®æ–‡ä»¶1234@ImportResource(&quot;classpath:beans.xml&quot;) //å…¼å®¹xmlé…ç½®@Configuration(proxyBeanMethods = false) //å£°æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆå³æ›¿æ¢æ‰é…ç½®æ–‡ä»¶public class MyConfig &#123;&#125; 123456789@SpringBootApplicationpublic class MainApplication &#123; public static void main(String[] args) &#123; // è·å–IoCå®¹å™¨,runå£°æ˜ä¸»ç¨‹åºç±»ï¼Œè¿”å›ä¸€ä¸ªIoCå®¹å™¨ ConfigurableApplicationContext run = SpringApplication.run(MainApplication.class, args); // ä½¿ç”¨@ImportResourceæˆåŠŸæ³¨å…¥beans.xmlä¸­çš„å¯¹è±¡ System.out.println(run.containsBean(&quot;user01&quot;)); &#125;&#125; @ConfigurationProperties é…ç½®ç»‘å®šç¼–å†™å±æ€§ï¼Œ application.propertiesï¼Œæ³¨æ„ä½¿ç”¨å…¨å°å†™ 12mycar.brand=ABCmycar.price=100000 ç¬¬ä¸€ç§æ–¹æ³•ï¼šéœ€è¦åœ¨å®¹å™¨ä¸­çš„ç»„ä»¶ä¸Šä½¿ç”¨ï¼Œ Car.java 1234567@Component //å£°æ˜ä¸ºç»„ä»¶ï¼Œåªæœ‰å®¹å™¨ä¸­çš„ç»„ä»¶æ‰èƒ½ä½¿ç”¨@ConfigurationProperties(prefix = &quot;mycar&quot;) //ç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ï¼ŒprefixæŒ‡å®šå¯¹åº”å‰ç¼€public class Car &#123; String brand; Integer price; // â€¦â€¦&#125; ç¬¬äºŒç§æ–¹æ³•ï¼šä¸ä½¿ç”¨@Componentå£°æ˜Carä¸ºç»„ä»¶ï¼Œè€Œæ˜¯åœ¨é…ç½®ç±»ç§å¼€å¯æŒ‡å®šå¯¹è±¡çš„å±æ€§é…ç½®åŠŸèƒ½ 12345@EnableConfigurationProperties(Car.class) //å¼€å¯æŒ‡å®šå¯¹è±¡çš„å±æ€§é…ç½®åŠŸèƒ½@Configuration(proxyBeanMethods = false) //å£°æ˜è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆå³æ›¿æ¢æ‰é…ç½®æ–‡ä»¶public class MyConfig &#123; // â€¦â€¦&#125; æµ‹è¯•ï¼Œ HelloController.java 123456789@RestControllerpublic class HelloController &#123; @Autowired Car car; @RequestMapping(&quot;/car&quot;) public Car car() &#123; return car; &#125;&#125; è‡ªåŠ¨é…ç½®åŸç†ï¼ˆæºç åˆ†æé›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili @SpringBootApplication å£°æ˜å½“å‰æ˜¯ä¸€ä¸ªé…ç½®ç±» @ComponentScan æŒ‡å®šæ‰«æè·¯å¾„ @EnableAutoConfiguration@AutoConfigurationPackage åˆ©ç”¨Registrarå°†å½“å‰åŒ…ä¸‹çš„æ‰€æœ‰ç»„ä»¶å…¨éƒ¨å¯¼å…¥è¿›å®¹å™¨ @Import å¯¼å…¥é»˜è®¤ç»„ä»¶ ä¾¿æ·ä½¿ç”¨Lombok ç®€åŒ–JavaBeanç¼–å†™ç­‰ å¼•å…¥ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™JavaBean 1234567@NoArgsConstructor //è‡ªåŠ¨ç¼–å†™æ— å‚æ„é€ å™¨@AllArgsConstructor //è‡ªåŠ¨ç¼–å†™å…¨å‚æ„é€ å™¨@Data //è‡ªåŠ¨ç¼–å†™set/get/toStringæ–¹æ³•public class Car &#123; String brand; Integer price;&#125; ç¼–å†™controllerçš„æ—¥å¿—æ‰“å° 12345678910@Slf4j //å¼•å…¥æ—¥å¿—æ¥å£@RestControllerpublic class HelloController &#123; // æ˜ å°„è¯·æ±‚çš„åœ°å€ @RequestMapping(&quot;/hello&quot;) public String handle1() &#123; log.info(&quot;hello&quot;); //æ—¥å¿—æ‰“å°ä¿¡æ¯ return &quot;Hello,SpringBoot2&quot;; &#125;&#125; Dev-toolsã€JRebel è‡ªåŠ¨é‡å¯ã€çƒ­æ›´æ–° å¼•å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; ä½¿ç”¨ Ctrl+F9 æ›´æ–° Spring Initializr å¿«é€Ÿåˆ›å»ºspringbootåº”ç”¨ï¼Œåˆ›å»ºåº”ç”¨æ—¶é€‰æ‹©å³å¯ é…ç½®æ–‡ä»¶propertiesyamlåŸºæœ¬è¯­æ³• key: value #æ³¨æ„ç©ºæ ¼ å¤§å°å†™æ•æ„Ÿ ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³» ç¼©è¿›ä¸å…è®¸ä½¿ç”¨tabï¼Œåªå…è®¸ç©ºæ ¼ ç¼©è¿›ç©ºæ ¼æ•°æ— å½±å“ï¼ŒåŒå±‚çº§çš„å…ƒç´ éœ€è¦å·¦å¯¹é½ #ç¼–å†™æ³¨é‡Š â€œâ€åŒå¼•å·å†…\\nç­‰ä¸è½¬ä¹‰ï¼Œä»ç„¶æ˜¯å›è½¦çš„æœ¬æ„æ˜¾ç¤ºä¸ºå›è½¦ï¼Œâ€™â€™å•å¼•å·å†…è½¬ä¹‰ï¼Œ\\næ˜¾ç¤ºä¸ºå­—ç¬¦ä¸² æ•°æ®ç±»å‹ å­—é¢é‡ 1key: value å¯¹è±¡ 123456k: &#123;k1: v1,k2: v2,k3: v3&#125;# æˆ–k: k1: v1 k2: v2 k3: v3 æ•°ç»„ 123456k: [v1,v2,v3]# æˆ–k: - v1 - v2 - v3 ç¤ºä¾‹é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili configuration-processor é…ç½®å¤„ç†å™¨ æ·»åŠ ä¾èµ– 123456789101112131415161718192021222324&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.2.4.RELEASE&lt;/version&gt; &lt;!-- æ‰“åŒ…çš„æ—¶å€™ä¸å¸¦è¿™ä¸ªåŒ… --&gt; &lt;configuration&gt; &lt;excludes&gt; &lt;exclude&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt; &lt;/exclude&gt; &lt;/excludes&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; webå¼€å‘ç®€å•åŠŸèƒ½é™æ€èµ„æºè®¿é—® é™æ€èµ„æºç›®å½• å­˜æ”¾è·¯å¾„ï¼šç±»è·¯å¾„(resourcesèµ„æºæ ¹ç›®å½•)ä¸‹çš„/static or /public or /resources or /META-INF/resources è®¿é—®è·¯å¾„ï¼šé¡¹ç›®æ ¹è·¯å¾„/é™æ€èµ„æºå åŸç†ï¼š é™æ€æ˜ å°„/**ã€‚è¯·æ±‚è¿›æ¥ï¼Œå…ˆå»æ‰¾Controllerçœ‹èƒ½ä¸èƒ½å¤„ç†ã€‚ä¸èƒ½å¤„ç†çš„æ‰€æœ‰è¯·æ±‚åˆéƒ½äº¤ç»™é™æ€èµ„æºå¤„ç†å™¨ã€‚é™æ€èµ„æºä¹Ÿæ‰¾ä¸åˆ°åˆ™å“åº”404é¡µé¢ æ”¹å˜é»˜è®¤çš„é™æ€èµ„æºè®¿é—®è·¯å¾„å’Œå­˜æ”¾è·¯å¾„ï¼Œåœ¨é…ç½®æ–‡ä»¶application.yamlä¸­ç¼–å†™ 12345spring: mvc: static-path-pattern: /res/** #resä¸ºè‡ªå®šä¹‰å‰ç¼€ï¼Œå³è®¿é—®åœ°å€é¡»åœ¨é¡¹ç›®æ ¹è·¯å¾„/res/é™æ€èµ„æºå resources: static-locations: [classpath:/è‡ªå®šä¹‰æ–‡ä»¶å¤¹å/] æ¬¢è¿é¡µå‘½åä¸ºindex.htmlæ”¾åœ¨é™æ€èµ„æºç›®å½•ä¸‹å³å¯ã€‚ è‡ªå®šä¹‰Faviconå‘½åä¸ºfavicon.ico æ”¾åœ¨é™æ€èµ„æºç›®å½•ä¸‹å³å¯ã€‚ æºç åˆ†æé›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili è¯·æ±‚å¤„ç†@xxxMapping è¯·æ±‚æ˜ å°„ Resté£æ ¼æ”¯æŒï¼ˆä½¿ç”¨HTTPè¯·æ±‚æ–¹å¼åŠ¨è¯æ¥è¡¨ç¤ºå¯¹èµ„æºçš„æ“ä½œï¼‰ ä»¥å‰ï¼š**/getUser è·å–ç”¨æˆ· /deleteUser åˆ é™¤ç”¨æˆ· /editUser ä¿®æ”¹ç”¨æˆ· /saveUser ä¿å­˜ç”¨æˆ· ç°åœ¨ï¼š /user GET-è·å–ç”¨æˆ· DELETE-åˆ é™¤ç”¨æˆ· PUT-ä¿®æ”¹ç”¨æˆ· POST-ä¿å­˜ç”¨æˆ· ç¼–å†™controllerç±» 1234567891011121314151617181920212223@RestControllerpublic class HelloController &#123; @GetMapping(&quot;/user&quot;) // å³@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.GET) public String getUser() &#123; return &quot;getUser GET&quot;; &#125; @PostMapping(&quot;/user&quot;) // å³@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.POST) public String saveUser() &#123; return &quot;saveUser POST&quot;; &#125; @PutMapping(&quot;/user&quot;) // å³@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.PUT) public String modifiedUser() &#123; return &quot;modifiedUser PUT&quot;; &#125; @DeleteMapping(&quot;/user&quot;) // å³@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.DELETE) public String deleteUser() &#123; return &quot;deleteUser DELETE&quot;; &#125;&#125; ç¼–å†™é¡µé¢ 12345678910111213141516&lt;form action=&quot;/user&quot; method=&quot;get&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;getæäº¤&quot;&gt;&lt;/form&gt;&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;postæäº¤&quot;&gt;&lt;/form&gt;&lt;!-- formè¡¨å•ä¸­methodåªèƒ½å†™get/post --&gt;&lt;!-- ä½¿ç”¨éšè—åŸŸä¼ é€’_methodæ–¹æ³•å‚æ•°çš„å€¼ --&gt;&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;PUT&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;PUTæäº¤&quot;&gt;&lt;/form&gt;&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;DELETE&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;DELETEæäº¤&quot;&gt;&lt;/form&gt; åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯hiddenmethod-filter(é»˜è®¤ä¸ºfalse)ï¼Œå¦‚æœå‰ç«¯ä¸æ˜¯ä½¿ç”¨è¡¨å•å‘é€è¯·æ±‚åˆ™ä¸éœ€è¦å¼€å¯filter 12345spring: mvc: hiddenmethod: filter: enabled: true è‡ªå®šä¹‰HiddenMethodFilterç¼–å†™é…ç½®ç±»ï¼Œè‡ªå®šä¹‰filter 12345678@Configuration(proxyBeanMethods = false)public class MyWebConfig &#123; public HiddenHttpMethodFilter hiddenHttpMethodFilter() &#123; HiddenHttpMethodFilter filter = new HiddenHttpMethodFilter(); filter.setMethodParam(&quot;_m&quot;); //ä¿®æ”¹æ–¹æ³•å‚æ•°åä¸º_m return filter; &#125;&#125; è¯·æ±‚æ˜ å°„åŸç†é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili å‚æ•°æ³¨è§£@PathVariableã€@RequestHeaderã€@RequestParamã€@CookieValueã€@RequestBody12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455@RestControllerpublic class ParamTestController &#123; // æµ‹è¯•url: http://localhost:8080/test1/1/lisi?age=10&amp;inters=%E5%90%83%E9%A5%AD&amp;inters=%E7%9D%A1%E8%A7%89 @GetMapping(&quot;/test1/&#123;id&#125;/&#123;username&#125;&quot;) public Map&lt;String, Object&gt; test1(@PathVariable(&quot;id&quot;) Integer id, @PathVariable(&quot;username&quot;) String name, @PathVariable Map&lt;String, String&gt; variables, @RequestHeader(&quot;User-Agent&quot;) String userAgent, @RequestHeader Map&lt;String, String&gt; headers, @RequestParam(&quot;age&quot;) Integer age, @RequestParam(&quot;inters&quot;) List&lt;String&gt; inters, @RequestParam Map&lt;String,String&gt; params1, @RequestParam MultiValueMap&lt;String, String&gt; params2, @CookieValue(&quot;_xsrf&quot;) String _xsrf, @CookieValue(&quot;_xsrf&quot;) Cookie cookie) &#123; /** * @PathVariable(&quot;&quot;) è·å¾—æŒ‡å®šè·¯å¾„å˜é‡åçš„å€¼ * @PathVariable è·å¾—æ‰€æœ‰è·¯å¾„å˜é‡åä»¥åŠå€¼ï¼Œå­˜æ”¾åˆ°Map&lt;String, String&gt;ä¸­ * æ³¨æ„åè€…é”®å€¼å¯¹å¯¹åº”çš„æ˜¯åœ°å€æ ä¸­çš„usernameå‚æ•°åï¼Œè€Œå‰è€…æ˜¯å½¢å‚åname * * @RequestHeader(&quot;&quot;) è·å¾—è¯·æ±‚å¤´ä¸­æŒ‡å®škeyçš„å€¼ * @RequestHeader è·å¾—è¯·æ±‚å¤´ä¸­æ‰€æœ‰çš„keyåŠå…¶å€¼ * * @RequestParam(&quot;&quot;) è·å¾—æŒ‡å®šè¯·æ±‚å‚æ•°åçš„å€¼ * @RequestParam è·å¾—æ‰€æœ‰è¯·æ±‚å‚æ•°åä»¥åŠå€¼ï¼Œå­˜æ”¾åˆ°Map&lt;String, String&gt;ä¸­ * æ³¨æ„åè€…å­˜æ”¾åœ¨mapä¸­ï¼Œkvåªæœ‰ä¸€å¯¹ï¼Œå¯ä½¿ç”¨MultiValueMapè·å–åˆ°ä¸€å¯¹å¤šçš„é”®å€¼å¯¹ã€‚ */ Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); // ä»¥ä¸‹æ˜¯æµ‹è¯• map.put(&quot;id&quot;, id); map.put(&quot;name&quot;, name); map.put(&quot;pv&quot;, variables); map.put(&quot;userAgent&quot;, userAgent); map.put(&quot;rh&quot;, headers); map.put(&quot;age&quot;,age); map.put(&quot;inters&quot;,inters); map.put(&quot;params1&quot;,params1); map.put(&quot;params2&quot;,params2); map.put(&quot;_xsrf&quot;,_xsrf); System.out.println(cookie.getName()+&quot;===&gt;&quot;+cookie.getValue()); return map; &#125; @PostMapping(&quot;/test2&quot;) public Map&lt;String, Object&gt; test2(@RequestBody String content)&#123; /** * @RequestBody è·å¾—è¯·æ±‚ä½“ä¸­æ‰€æœ‰çš„keyåŠå¯¹åº”å€¼ */ Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); // ä»¥ä¸‹æ˜¯æµ‹è¯• map.put(&quot;content&quot;, content); return map; &#125;&#125; @RequestAttribute è·å–åŸŸå¯¹è±¡å‚æ•°å€¼1234567891011121314151617181920212223@Controller //æ³¨æ„RestControllerå†™return &quot;forward:/success&quot;åªä¼šè§£ææˆå­—ç¬¦ä¸²public class RequestController &#123; @GetMapping(&quot;/goto&quot;) public String gotoPage(HttpServletRequest req) &#123; req.setAttribute(&quot;msg&quot;, &quot;ä¿¡æ¯&quot;); req.setAttribute(&quot;code&quot;, &quot;ä¿¡æ¯123123&quot;); return &quot;forward:/success&quot;; //è½¬å‘åˆ°/successè¯·æ±‚ &#125; @ResponseBody @GetMapping(&quot;/success&quot;) public Map&lt;String, Object&gt; success(@RequestAttribute(&quot;msg&quot;) String msg, @RequestAttribute(&quot;code&quot;) String code) &#123; /** * @RequestAttribute è·å¾—requeståŸŸå¯¹è±¡ä¸­çš„æŒ‡å®šå€¼ */ Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;msg&quot;, msg); map.put(&quot;code&quot;, code); return map; &#125; &#125; @MatrixVariable è·å–çŸ©é˜µå˜é‡12345678910111213141516171819202122232425262728//1ã€çŸ©é˜µå˜é‡è¯­æ³•ï¼š è¯·æ±‚è·¯å¾„ï¼š/cars/sell;low=34;brand=byd,audi,yd //2ã€SpringBooté»˜è®¤æ˜¯ç¦ç”¨äº†çŸ©é˜µå˜é‡çš„åŠŸèƒ½ // æ‰‹åŠ¨å¼€å¯ï¼šåŸç†ã€‚å¯¹äºè·¯å¾„çš„å¤„ç†ã€‚UrlPathHelperè¿›è¡Œè§£æã€‚ // removeSemicolonContentï¼ˆç§»é™¤åˆ†å·å†…å®¹ï¼‰æ”¯æŒçŸ©é˜µå˜é‡çš„ //3ã€çŸ©é˜µå˜é‡å¿…é¡»æœ‰urlè·¯å¾„å˜é‡æ‰èƒ½è¢«è§£æ @GetMapping(&quot;/cars/&#123;path&#125;&quot;) public Map carsSell(@MatrixVariable(&quot;low&quot;) Integer low, @MatrixVariable(&quot;brand&quot;) List&lt;String&gt; brand, @PathVariable(&quot;path&quot;) String path)&#123; Map&lt;String,Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;low&quot;,low); map.put(&quot;brand&quot;,brand); map.put(&quot;path&quot;,path); return map; &#125; // /boss/1;age=20/2;age=10 @GetMapping(&quot;/boss/&#123;bossId&#125;/&#123;empId&#125;&quot;) public Map boss(@MatrixVariable(value = &quot;age&quot;,pathVar = &quot;bossId&quot;) Integer bossAge, @MatrixVariable(value = &quot;age&quot;,pathVar = &quot;empId&quot;) Integer empAge)&#123; Map&lt;String,Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;bossAge&quot;,bossAge); map.put(&quot;empAge&quot;,empAge); return map; &#125; 12345678910111213141516171819202122@Configuration(proxyBeanMethods = false)public class MyWebConfig &#123; public HiddenHttpMethodFilter hiddenHttpMethodFilter() &#123; HiddenHttpMethodFilter filter = new HiddenHttpMethodFilter(); filter.setMethodParam(&quot;_m&quot;); //ä¿®æ”¹_method return filter; &#125; @Bean // è‡ªå®šä¹‰å…¶ä¸­çš„åŠŸèƒ½,æ­¤å¤„æ¼”ç¤ºå¯ç”¨çŸ©é˜µå˜é‡åŠŸèƒ½ public WebMvcConfigurer webMvcConfigurer() &#123; return new WebMvcConfigurer() &#123; @Override public void configurePathMatch(PathMatchConfigurer configurer) &#123; UrlPathHelper urlPathHelper = new UrlPathHelper(); // è®¾ç½®ä¸åˆ é™¤åˆ†å·å†…å®¹ urlPathHelper.setRemoveSemicolonContent(false); configurer.setUrlPathHelper(urlPathHelper); &#125; &#125;; &#125;&#125; ServletAPI WebRequestã€ServletRequestã€MultipartRequestã€ HttpSessionã€javax.servlet.http.PushBuilderã€Principalã€InputStreamã€Readerã€HttpMethodã€Localeã€TimeZoneã€ZoneId å‚æ•°æ³¨è§£æºç åˆ†æé›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili ç›´æ¥çœ‹å›°äº†ï¼Œä»¥åå†çœ‹å§ã€‚ è‡ªå®šä¹‰å‚æ•°ç»‘å®š ç¼–å†™ä¸¤ä¸ªbean 12345678@Datapublic class User &#123; String username; String password; Integer age; Date birthday; Pet pet;&#125; 12345@Datapublic class Pet &#123; String name; Integer age;&#125; ç¼–å†™è¡¨å• 12345678&lt;form action=&quot;/saveuser&quot; method=&quot;post&quot;&gt; å§“åï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; å¹´é¾„ï¼š&lt;input type=&quot;number&quot; name=&quot;age&quot;&gt; ç”Ÿæ—¥ï¼š&lt;input type=&quot;date&quot; name=&quot;birthday&quot;&gt; å® ç‰©åå­—ï¼š&lt;input type=&quot;text&quot; name=&quot;pet.name&quot;&gt; å® ç‰©å¹´é¾„ï¼š&lt;input type=&quot;number&quot; name=&quot;pet.age&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;POSTæäº¤&quot;&gt;&lt;/form&gt; ç¼–å†™controlleræµ‹è¯• 1234@PostMapping(&quot;/saveuser&quot;)public User saveuser(User user) &#123; return user;&#125; è‡ªå®šä¹‰è½¬æ¢å™¨12345678910111213141516171819202122232425@Configuration(proxyBeanMethods = false)public class MyWebConfig &#123; @Bean // è‡ªå®šä¹‰å…¶ä¸­çš„åŠŸèƒ½ public WebMvcConfigurer webMvcConfigurer() &#123; return new WebMvcConfigurer() &#123; @Override public void addFormatters(FormatterRegistry registry) &#123; registry.addConverter(new Converter&lt;String, Date&gt;() &#123; @Override public Date convert(String s) &#123; SimpleDateFormat sf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); Date date = null; try &#123; date = sf.parse(s); &#125; catch (ParseException e) &#123; e.printStackTrace(); &#125; return date; &#125; &#125;); &#125; &#125;; &#125;&#125; æ•°æ®å“åº”ä¸å†…å®¹åå•†å“åº”JSONæ•°æ® å¼•å…¥jackson.jarï¼Œå·²åŒ…å«åœ¨starter-webåœºæ™¯å¯åŠ¨å™¨ä¸­ ä½¿ç”¨æ³¨è§£@ResponseBody å“åº”åŸç†é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili å†…å®¹åå•† æ ¹æ®å®¢æˆ·ç«¯æ¥æ”¶èƒ½åŠ›ä¸åŒï¼Œè¿”å›ä¸åŒåª’ä½“ç±»å‹çš„æ•°æ®ã€‚ ä»¥xmlä¸ºç¤ºä¾‹ï¼Œå¼•å…¥ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt; &lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;&lt;/dependency&gt; è¯·æ±‚å¤´é‡Œacceptå­—æ®µï¼Œè®¾ç½®äº†æ¥æ”¶æ•°æ®ä»¥xmlæ ¼å¼ä¸ºä¼˜å…ˆ å¼€å¯åŸºäºè¯·æ±‚å‚æ•°çš„å†…å®¹åå•†åŸç†ï¼ŒåŒæ—¶urlä¸­æ·»åŠ è¯·æ±‚å‚æ•°format=xxxå³å¯ 1234spring: mvc: contentnegotiation: favor-parameter: true å†…å®¹åå•†åŸç†é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili è‡ªå®šä¹‰MessageConvertoré›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili è§†å›¾è§£æä¸æ¨¡æ¿å¼•æ“thymeleaf javaæ¨¡æ¿å¼•æ“ åŸºæœ¬è¯­æ³• å¼•å…¥ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™æ¨¡æ¿ 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1 th:text=&quot;$&#123;msg&#125;&quot;&gt;é»˜è®¤çš„å€¼&lt;/h1&gt; &lt;h2&gt; &lt;a href=&quot;www.google.com&quot; th:href=&quot;$&#123;link&#125;&quot;&gt;è·³è½¬ç™¾åº¦&lt;/a&gt; &lt;a href=&quot;www.google.com&quot; th:href=&quot;@&#123;link&#125;&quot;&gt;è·³è½¬ç™¾åº¦&lt;/a&gt; &lt;/h2&gt;&lt;/body&gt;&lt;/html&gt; ç¼–å†™controller 1234567891011@Controllerpublic class ViewTestController &#123; @GetMapping(&quot;/testsuccess&quot;) public String test(Model model) &#123; // modelä¸­çš„æ•°æ®ä¼šè¢«æ”¾åœ¨è¯·æ±‚åŸŸä¸­ model.addAttribute(&quot;msg&quot;, &quot;msgTest&quot;); model.addAttribute(&quot;link&quot;, &quot;https://www.baidu.com&quot;); // è·³è½¬é¡µé¢å†™é¡µé¢çš„å‰å return &quot;success&quot;; &#125;&#125; æ‹¦æˆªå™¨é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili ç¼–å†™Interceptor 123456789101112131415161718192021222324252627282930313233343536/** * ç™»é™†æ£€æŸ¥ */@Slf4jpublic class LoginInterceptor implements HandlerInterceptor &#123; /** * ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰ */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; log.info(&quot;Run LoginInterceptor.preHandle&quot;); HttpSession session = request.getSession(); Object loginUser = session.getAttribute(&quot;loginUser&quot;); if (loginUser != null) &#123; return true; &#125; else &#123; session.setAttribute(&quot;msg&quot;, &quot;å½“å‰å°šæœªç™»å½•&quot;); response.sendRedirect(&quot;/&quot;); return false; &#125; &#125; /** * ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å */ @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; log.info(&quot;Run LoginInterceptor.postHandle&quot;,modelAndView); &#125; /** * é¡µé¢æ¸²æŸ“ä»¥å */ @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; log.info(&quot;Run LoginInterceptor.afterCompletion&quot;,ex); &#125;&#125; ç¼–å†™WebConfigç±»ï¼Œæ·»åŠ interceptor 12345678910@Configurationpublic class AdminWebConfig implements WebMvcConfigurer &#123; @Override public void addInterceptors(InterceptorRegistry registry) &#123; // æ·»åŠ æ‹¦æˆªå™¨ï¼Œå¹¶ä¸”è®¾ç½®æ‹¦æˆªåœ°å€ä¸ä¸æ‹¦æˆªåœ°å€ // /**æ‹¦æˆªç›®å½•ä¸‹æ‰€æœ‰èµ„æºï¼Œé™æ€èµ„æºä¹Ÿä¼šè¢«æ‹¦æˆª registry.addInterceptor(new LoginInterceptor()).addPathPatterns(&quot;/**&quot;).excludePathPatterns(&quot;/&quot;,&quot;/login&quot;,&quot;/css/**&quot;,&quot;/js/**&quot;,&quot;/font/**&quot;,&quot;/images/**&quot;); // è®¾ç½®exlucdeä¸æ‹¦æˆªï¼Œæˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­ç¼–å†™static-path-pattern=/static/**ï¼Œæ³¨æ„æ­¤æ—¶éœ€è¦ä¿®æ”¹æ ‡ç­¾ä¸­çš„href &#125;&#125; æ–‡ä»¶ä¸Šä¼ é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili ç¼–å†™controller 1234567891011121314151617181920212223242526272829303132333435/** * æ–‡ä»¶ä¸Šä¼ æµ‹è¯• */@Slf4j@Controllerpublic class FormTestController &#123; @GetMapping(&quot;/form_layouts&quot;) public String formLayouts() &#123; return &quot;form/form_layouts&quot;; &#125; /** * MultipartFileè‡ªåŠ¨å°è£…ä¸Šä¼ è¿‡æ¥çš„æ–‡ä»¶ */ @PostMapping(&quot;/upload&quot;) public String upload(@RequestParam(&quot;email&quot;) String email, @RequestParam(&quot;name&quot;) String name, @RequestPart(&quot;headImg&quot;) MultipartFile headImg, @RequestPart(&quot;photos&quot;) MultipartFile[] photos) throws IOException &#123; // è·å–çš„ä¿¡æ¯ log.info(&quot;ä¸Šä¼ çš„ä¿¡æ¯ï¼šemail=&#123;&#125;,name=&#123;&#125;,headImg=&#123;&#125;,photos=&#123;&#125;&quot;, email, name, headImg.getSize(), photos.length); if (!headImg.isEmpty()) &#123; // è·å–åŸæ–‡ä»¶åã€ä¿å­˜åˆ°æœåŠ¡å™¨ headImg.transferTo(new File(&quot;C:\\\\Users\\\\å¢èŸ\\\\Desktop\\\\test1\\\\&quot;+headImg.getOriginalFilename())); &#125; if (photos.length &gt; 0) &#123; for (MultipartFile photo : photos) &#123; if (!photo.isEmpty()) &#123; photo.transferTo(new File(&quot;C:\\\\Users\\\\å¢èŸ\\\\Desktop\\\\test2\\\\&quot;+photo.getOriginalFilename())); &#125; &#125; &#125; return &quot;index&quot;; &#125;&#125; ç¼–å†™é…ç½®æ–‡ä»¶ 123#ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„æœ€å¤§å¤§å°spring.servlet.multipart.max-file-size=10MBspring.servlet.multipart.max-request-size=100MB å¼‚å¸¸å¤„ç† é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Bootæä¾›/errorå¤„ç†æ‰€æœ‰é”™è¯¯çš„æ˜ å°„ å¯¹äºæœºå™¨å®¢æˆ·ç«¯ï¼Œå®ƒå°†ç”ŸæˆJSONå“åº”ï¼Œå…¶ä¸­åŒ…å«é”™è¯¯ï¼ŒHTTPçŠ¶æ€å’Œå¼‚å¸¸æ¶ˆæ¯çš„è¯¦ç»†ä¿¡æ¯ã€‚ å¯¹äºæµè§ˆå™¨å®¢æˆ·ç«¯ï¼Œå“åº”ä¸€ä¸ªâ€œ whitelabelâ€é”™è¯¯è§†å›¾ï¼Œä»¥HTMLæ ¼å¼å‘ˆç°ç›¸åŒçš„æ•°æ® è‡ªå®šä¹‰é”™è¯¯é¡µåœ¨å°†400.htmlã€500.htmlç­‰é¡µé¢æ”¾åœ¨resources &gt; templates &gt;errorä¸‹å³å¯ è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†@ControllerAdvice+@ExceptionHandler1234567891011121314151617/** * å¤„ç†æ•´ä¸ªweb controllerçš„å¼‚å¸¸ */@Slf4j@ControllerAdvice //æ³¨æ˜è¿™æ˜¯ä¸€ä¸ªå¢å¼ºçš„controllerpublic class GlobalExceptionHandler &#123; /** * å¤„ç†æ•°å­¦å¼‚å¸¸ã€ç©ºæŒ‡é’ˆå¼‚å¸¸ * @param e * @return */ @ExceptionHandler(&#123;ArithmeticException.class, NullPointerException.class&#125;) // è¡¨æ˜ç”¨äºå¤„ç†æŒ‡å®šå¼‚å¸¸ public String handleArithException(Exception e) &#123; log.error(&quot;å¼‚å¸¸æ˜¯ï¼š&#123;&#125;&quot;, e); return &quot;error/404&quot;; // æŒ‡å®šè¿”å›è§†å›¾çš„åœ°å€ &#125;&#125; @ResponseStatus+è‡ªå®šä¹‰Exception123456789@ResponseStatus(value = HttpStatus.FORBIDDEN,reason = &quot;ç”¨æˆ·æ•°é‡å¤ªå¤š&quot;) //æ³¨æ˜å¼‚å¸¸è¿”å›çŠ¶æ€ç å’ŒåŸå› public class UserTooManyException extends RuntimeException &#123; public UserTooManyException() &#123; &#125; public UserTooManyException(String msg) &#123; super(msg); &#125;&#125; è‡ªå®šä¹‰HandlerExceptionResolver123456789101112@Componentpublic class CustomerHandlerExceptionResolver implements HandlerExceptionResolver &#123; @Override public ModelAndView resolveException(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) &#123; try &#123; httpServletResponse.sendError(511, &quot;è‡ªå®šä¹‰é”™è¯¯&quot;); &#125; catch (IOException ex) &#123; ex.printStackTrace(); &#125; return new ModelAndView(); &#125;&#125; åŸç”Ÿç»„ä»¶æ³¨å…¥ServletAPI@ServletComponentScanä¸»åº”ç”¨ç±»ä¸­ä½¿ç”¨@ServletComponentScané…ç½®æ‰«æè·¯å¾„ 1234567@ServletComponentScan(basePackages = &quot;com.spb_adminex.servlet&quot;) //é…ç½®servletã€filterã€listeneræ‰«æåœ°å€@SpringBootApplicationpublic class SpbAdminexApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SpbAdminexApplication.class, args); &#125;&#125; @WebServlet1234567@WebServlet(urlPatterns = &quot;/my&quot;)public class MyServlet extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; resp.getWriter().write(&quot;MyServlet running&quot;); &#125;&#125; @WebFilter1234567891011121314151617@Slf4j@WebFilter(urlPatterns = &#123;&quot;/css/*&quot;,&quot;/images/*&quot;&#125;)public class MyFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; log.info(&quot;MyFilteråˆå§‹åŒ–&quot;); &#125; @Override public void destroy() &#123; log.info(&quot;MyFilteré”€æ¯&quot;); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; log.info(&quot;MyFilter running&quot;); filterChain.doFilter(servletRequest, servletResponse); &#125;&#125; @WebListener123456789101112@Slf4j@WebListenerpublic class MyListener implements ServletContextListener &#123; @Override public void contextInitialized(ServletContextEvent sce) &#123; log.info(&quot;MyListenerç›‘å¬åˆ°é¡¹ç›®åˆå§‹åŒ–å®Œæˆ&quot;); &#125; @Override public void contextDestroyed(ServletContextEvent sce) &#123; log.info(&quot;MyListenerç›‘å¬åˆ°é¡¹ç›®é”€æ¯&quot;); &#125;&#125; RegisterBeanç¼–å†™ä¸€ä¸ªé…ç½®ç±» 1234567891011121314151617@Configurationpublic class MyRegisterConfig &#123; @Bean public ServletRegistrationBean myServlet() &#123; return new ServletRegistrationBean(new MyServlet(), &quot;/my&quot;); &#125; @Bean public FilterRegistrationBean myFilter() &#123; FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(new MyFilter()); filterRegistrationBean.setUrlPatterns(Arrays.asList(&quot;/my&quot;,&quot;/css/*&quot;)); return filterRegistrationBean; &#125; @Bean public ServletListenerRegistrationBean myListener() &#123; return new ServletListenerRegistrationBean(new MyListener()); &#125;&#125; æ•°æ®è®¿é—®SQLä½¿ç”¨é»˜è®¤æ•°æ®æºã€jdbcTemplate å¯¼å…¥starteråœºæ™¯å’Œæ•°æ®åº“é©±åŠ¨ 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™é…ç½®æ–‡ä»¶application.yaml 123456spring: datasource: url: jdbc:mysql://localhost:3306/online_bookstore username: root password: 123456789 driver-class-name: com.mysql.cj.jdbc.Driver ä½¿ç”¨jdbcTemplateæµ‹è¯• 1234567891011@Slf4j@SpringBootTestclass SpbAdminexApplicationTests &#123; @Autowired JdbcTemplate jdbcTemplate; @Test void contextLoads() &#123; Long count = jdbcTemplate.queryForObject(&quot;select count(*) from admin&quot;, Long.class); log.info(&quot;å½“å‰è¡¨çš„è®°å½•æ•°ä¸º&quot; + count); &#125;&#125; ä½¿ç”¨Druidæ•°æ®æº å¼•å…¥æ•°æ®æº 12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.6&lt;/version&gt;&lt;/dependency&gt; ç¼–å†™æ•°æ®æºé…ç½®ç±» 12345678910@Configurationpublic class MyDataSourceConfig &#123; // å¼•å…¥è‡ªå·±çš„æ•°æ®æºä¹‹åï¼Œè‡ªåŠ¨é…ç½®çš„é»˜è®¤DataSourceå¤±æ•ˆ @ConfigurationProperties(&quot;spring.datasource&quot;) //å°†ç»„ä»¶ä¸é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ç»‘å®š @Bean public DataSource dataSource() &#123; DruidDataSource druidDataSource = new DruidDataSource(); return druidDataSource; &#125;&#125; æµ‹è¯• 12345678910@Slf4j@SpringBootTestclass SpbAdminexApplicationTests &#123; @Autowired DataSource dataSource; @Test void contextLoads() &#123; log.info(&quot;å½“å‰æ•°æ®æºç±»å‹ä¸º&#123;&#125;&quot;, dataSource.getClass()); &#125;&#125; å…¶ä»–ğŸ‘‰é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili ä½¿ç”¨xmlé…ç½®æ–‡ä»¶æ•´åˆMyBatis å¯¼å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.2.0&lt;/version&gt;&lt;/dependency&gt; ç¼–å†™application.yamlé…ç½®æ–‡ä»¶ 123mybatis: config-location: classpath:mybatis/mybatis-config.xml #å…¨å±€é…ç½®æ–‡ä»¶ä½ç½® mapper-locations: classpath:mybatis/mapper/*.xml #sqlæ˜ å°„æ–‡ä»¶ä½ç½® ç¼–å†™mybatis-config.xmlå…¨å±€é…ç½®æ–‡ä»¶/æˆ–è€…ç¼–å†™applicationé…ç½®æ–‡ä»¶(æ­¤æ—¶ä¸èƒ½åŒæ—¶é…ç½®å…¨å±€é…ç½®æ–‡ä»¶ä½ç½®) 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt;&lt;settings&gt;&lt;!-- å¼€å¯ä¸‹åˆ’çº¿è½¬é©¼å³°å‘½åæ³• --&gt; &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;&lt;/settings&gt;&lt;/configuration&gt; 1234mybatis: mapper-locations: classpath:mybatis/mapper/*.xml #sqlæ˜ å°„æ–‡ä»¶ä½ç½® configuration: map-underscore-to-camel-case: true #å¼€å¯ä¸‹åˆ’çº¿è½¬é©¼å³°å‘½åæ³• ç¼–å†™beanMapperæ¥å£ 12345@Mapper //æ³¨æ˜è¿™æ˜¯ä¸€ä¸ªmapperæ¥å£public interface AdminMapper &#123; public Admin getAdmin(Integer id); public Boolean insertAdmin(Admin admin);&#125; ç¼–å†™beanMapper.xmlé…ç½®æ–‡ä»¶ 123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.spb_adminex.mapper.AdminMapper&quot;&gt; &lt;select id=&quot;getAdmin&quot; resultType=&quot;com.spb_adminex.bean.Admin&quot; &gt; select * from admin where id=#&#123;id&#125; &lt;/select&gt; &lt;insert id=&quot;insertAdmin&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt; insert into admin(`account`,`password`) values(#&#123;account&#125;,#&#123;password&#125;) &lt;/insert&gt;&lt;/mapper&gt; ç¼–å†™serviceå±‚ 123456789101112@Servicepublic class AdminService &#123; @Autowired AdminMapper adminMapper; public Admin getAdminById(Integer id) &#123; return adminMapper.getAdmin(id); &#125; public Boolean insertAdmin(Admin admin) &#123; return adminMapper.insertAdmin(admin); &#125;&#125; ç¼–å†™controllerå±‚ 1234567891011@Controllerpublic class AdminController &#123; @Autowired AdminService adminService; @ResponseBody @GetMapping(&quot;/getAdmin&quot;) public Admin getAdminById(@RequestParam(&quot;id&quot;) Integer id) &#123; return adminService.getAdminById(id); &#125;&#125; ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis å…¶ä½™æ–‡ä»¶ï¼Œä¸”ä¸éœ€è¦beanMapper.xml ç¼–å†™beanMapperæ¥å£ 12345@Mapper //æ³¨æ˜è¿™æ˜¯ä¸€ä¸ªmapperæ¥å£public interface AdminMapper &#123; @Select(&quot;select * from admin where id=#&#123;id&#125;&quot;) //æ³¨è§£æ›¿æ¢beanMapper.xmlæ–‡ä»¶ public Admin getAdmin(Integer id);&#125; æ•´åˆMyBatis-Pluså¿«é€Ÿå¼€å§‹ | MyBatis-Plus (baomidou.com) è·å–æ•°æ® å¯¼å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.4.3&lt;/version&gt;&lt;/dependency&gt; ä¸ºå¯åŠ¨ç±»æ·»åŠ @MapperScanï¼Œæ³¨æ˜æ‰«æMapperæ–‡ä»¶çš„åœ°å€ 123456789@SpringBootApplication@MapperScan(&quot;com.baomidou.mybatisplus.samples.quickstart.mapper&quot;)public class Application &#123; public static void main(String[] args) &#123; SpringApplication.run(QuickStartApplication.class, args); &#125;&#125; ç¼–å†™å…¨å±€é…ç½®æ–‡ä»¶ 123456spring: datasource: url: jdbc:mysql://localhost:3306/spb_adminex username: root password: 123456789 driver-class-name: com.mysql.cj.jdbc.Driver ç¼–å†™Beanç±» 12345678910111213@NoArgsConstructor@AllArgsConstructor@Data@TableName(&quot;user&quot;) //å¯ä»¥æŒ‡å®šè¡¨åï¼Œä¸çŸ¥é“åˆ™é»˜è®¤ä¸ºç±»åpublic class User &#123; private Long id; private String name; private String age; private String email; @TableField(exist = false) //æ³¨æ˜å½“å‰å­—æ®µåœ¨è¡¨ä¸­ä¸å­˜åœ¨ private String test;&#125; ç¼–å†™BeanMapperæ¥å£ 12public interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; ç¼–å†™BeanServiceæ¥å£ 123public interface UserService extends IService&lt;User&gt; &#123;&#125; ç¼–å†™BeanServiceImplå®ç°ç±» 1234@Servicepublic class UserServiceImpl extends ServiceImpl&lt;UserMapper,User&gt; implements UserService &#123;&#125; ç¼–å†™controller 12345678910111213141516171819@Controllerpublic class TableController &#123; @Autowired UserService userService = new UserServiceImpl(); @GetMapping(&quot;/dynamic_table&quot;) public String dynamicTable(Model model) &#123; List&lt;User&gt; userList = userService.list(); model.addAttribute(&quot;userList&quot;, userList); return &quot;table/dynamic_table&quot;; &#125; @GetMapping(&quot;/responsive_table&quot;) public String responsiveTable() &#123; return &quot;table/responsive_table&quot;; &#125; @GetMapping(&quot;/editable_table&quot;) public String editableTable() &#123; return &quot;table/editable_table&quot;; &#125;&#125; åˆ†é¡µæ“ä½œ ç¼–å†™MybatisPlugConfig 12345678910@Configurationpublic class MybatisPlusConfig &#123; @Bean public MybatisPlusInterceptor mybatisPlusInterceptor() &#123; // åˆ›å»ºMybatisPlusInterceptor MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor(); interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL)); return interceptor; &#125;&#125; ç¼–å†™controller 12345678910111213141516171819202122232425@Controllerpublic class TableController &#123; @Autowired UserService userService = new UserServiceImpl(); // è¿›å…¥dynamic_tableå¹¶å±•ç¤ºåˆ†é¡µæ•°æ® @GetMapping(&quot;/dynamic_table&quot;) public String dynamicTable(@RequestParam(value = &quot;pn&quot;,defaultValue = &quot;1&quot;)Integer pn, Model model) &#123; // è·å¾—åˆ†é¡µç»“æœå¯¹è±¡ï¼Œå¹¶è®¾ç½®åˆ†é¡µ Page&lt;User&gt; page = userService.page(new Page&lt;User&gt;(pn, 2)); model.addAttribute(&quot;page&quot;, page); // page.getRecordsè·å¾—æ‰€æœ‰è®°å½•ï¼Œpage.currentè·å¾—å½“å‰é¡µæ•°ï¼Œpage.pagesè·å¾—æ€»é¡µæ•°ï¼Œpage.getTotalè·å¾—æ€»æ¡æ•°â€¦â€¦ return &quot;table/dynamic_table&quot;; &#125; @GetMapping(&quot;/user/delete/&#123;id&#125;&quot;) // åˆ é™¤ç”¨æˆ·åŠŸèƒ½ public String deleteUser(@PathVariable(&quot;id&quot;) Long id, @RequestParam(value = &quot;pn&quot;,defaultValue = &quot;1&quot;) Integer pn, RedirectAttributes ra) &#123; userService.removeById(id); ra.addAttribute(&quot;pn&quot;, pn); return &quot;redirect:/dynamic_table&quot;; &#125;&#125; ç¼–å†™htmlé¡µé¢ï¼Œthymeleafè¯­æ³•è¯¦è§é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili 123456789101112131415161718192021222324252627282930313233343536373839&lt;table&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt;id&lt;/th&gt; &lt;th&gt;ç”¨æˆ·å&lt;/th&gt; &lt;th&gt;å¹´é¾„&lt;/th&gt; &lt;th&gt;é‚®ç®±&lt;/th&gt; &lt;th&gt;æ“ä½œ&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr class=&quot;gradeX&quot; th:each=&quot;user,status:$&#123;page.getRecords()&#125;&quot;&gt; &lt;td th:text=&quot;$&#123;status.count&#125;&quot;&gt;xxx&lt;/td&gt; &lt;td th:text=&quot;$&#123;user.name&#125;&quot;&gt;xxx&lt;/td&gt; &lt;td th:text=&quot;$&#123;user.age&#125;&quot;&gt;xxx&lt;/td&gt; &lt;td th:text=&quot;$&#123;user.email&#125;&quot;&gt;xxx&lt;/td&gt; &lt;td&gt; &lt;a th:href=&quot;@&#123;/user/delete/&#123;id&#125;(id=$&#123;user.id&#125;,pn=$&#123;page.current&#125;)&#125;&quot; class=&quot;btn btn-primary&quot;&gt;åˆ é™¤&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt;&lt;/table&gt;&lt;div class=&quot;row-fluid&quot;&gt; &lt;div&gt; &lt;div class=&quot;dataTables_info&quot;&gt;å½“å‰ç¬¬[[$&#123;page.current&#125;]]é¡µ æ€»è®¡[[$&#123;page.pages&#125;]]é¡µ æ€»[[$&#123;page.getTotal&#125;]]æ¡è®°å½• &lt;/div&gt; &lt;/div&gt; &lt;div&gt; &lt;div class=&quot;dataTables_paginate paging_bootstrap pagination&quot;&gt; &lt;ul&gt; &lt;li class=&quot;prev disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;â† Previous&lt;/a&gt;&lt;/li&gt; &lt;li th:class=&quot;$&#123;num == page.current?&#x27;active&#x27;:&#x27;&#x27;&#125;&quot; th:each=&quot;num:$&#123;#numbers.sequence(1,page.pages)&#125;&quot;&gt; &lt;a th:href=&quot;@&#123;/dynamic_table(pn=$&#123;num&#125;)&#125;&quot;&gt;[[$&#123;num&#125;]]&lt;/a&gt; &lt;/li&gt; &lt;li class=&quot;next disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;Next â†’ &lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; NoSQL(Redis)ä¸å°è¯•äº†æ²¡é’± å•å…ƒæµ‹è¯•@SpringBootTest123456@SpringBootTestclass MyTest &#123; @Test public void test() &#123; &#125;&#125; å¸¸ç”¨æ³¨è§£ **@Test :**è¡¨ç¤ºæ–¹æ³•æ˜¯æµ‹è¯•æ–¹æ³•ã€‚ä½†æ˜¯ä¸JUnit4çš„@Testä¸åŒï¼Œä»–çš„èŒè´£éå¸¸å•ä¸€ä¸èƒ½å£°æ˜ä»»ä½•å±æ€§ï¼Œæ‹“å±•çš„æµ‹è¯•å°†ä¼šç”±Jupiteræä¾›é¢å¤–æµ‹è¯• **@ParameterizedTest :**è¡¨ç¤ºæ–¹æ³•æ˜¯å‚æ•°åŒ–æµ‹è¯•ï¼Œä¸‹æ–¹ä¼šæœ‰è¯¦ç»†ä»‹ç» **@RepeatedTest :**è¡¨ç¤ºæ–¹æ³•å¯é‡å¤æ‰§è¡Œï¼Œä¸‹æ–¹ä¼šæœ‰è¯¦ç»†ä»‹ç» **@DisplayName :**ä¸ºæµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•è®¾ç½®å±•ç¤ºåç§° **@BeforeEach :**è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹å‰æ‰§è¡Œ **@AfterEach :**è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹åæ‰§è¡Œ **@BeforeAll :**è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹å‰æ‰§è¡Œ **@AfterAll :**è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹åæ‰§è¡Œ **@Tag :**è¡¨ç¤ºå•å…ƒæµ‹è¯•ç±»åˆ«ï¼Œç±»ä¼¼äºJUnit4ä¸­çš„@Categories **@Disabled :**è¡¨ç¤ºæµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•ä¸æ‰§è¡Œï¼Œç±»ä¼¼äºJUnit4ä¸­çš„@Ignore **@Timeout :**è¡¨ç¤ºæµ‹è¯•æ–¹æ³•è¿è¡Œå¦‚æœè¶…è¿‡äº†æŒ‡å®šæ—¶é—´å°†ä¼šè¿”å›é”™è¯¯ **@ExtendWith :**ä¸ºæµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•æä¾›æ‰©å±•ç±»å¼•ç”¨ æ–­è¨€æœºåˆ¶é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili â€¦â€¦æŒ‡æ ‡ç›‘æ§é›·ä¸°é˜³2021ç‰ˆSpringBoot2é›¶åŸºç¡€å…¥é—¨springbootå…¨å¥—å®Œæ•´ç‰ˆï¼ˆspring boot2ï¼‰_å“”å“©å“”å“©_bilibili é«˜çº§ç‰¹æ€§åä¼šæœ‰æœŸæºç å’Œå…¶ä»–éƒ¨åˆ†åˆ°æ—¶å€™(ä¹Ÿä¸çŸ¥é“å•¥æ—¶å€™)ä¼šå†å»çœ‹çš„ï¼Œbut not today","categories":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘MyBatis","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘MyBatis","date":"2021-07-16T11:12:59.990Z","updated":"2021-07-23T05:49:19.787Z","comments":true,"path":"2021/07/16/xue-xi-bi-ji-mybatis/","link":"","permalink":"http://example.com/2021/07/16/xue-xi-bi-ji-mybatis/","excerpt":"","text":"æ¦‚è¿° mybatisæ˜¯ä¸€ä¸ªä¼˜ç§€çš„åŸºäºjavaçš„æŒä¹…å±‚æ¡†æ¶,å®ƒå†…éƒ¨å°è£…äº†jdbc,ä½¿å¼€å‘è€…åªéœ€è¦å…³æ³¨sqè¯­å¥æœ¬èº«,è€Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»º statementç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ mybatisé€šè¿‡xmæˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§ statementé…ç½®èµ·æ¥,å¹¶é€šè¿‡javaå¯¹è±¡å’Œ statementä¸­sqçš„åŠ¨æ€å‚æ•°è¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„sqè¯­å¥ã€‚ æœ€å mybatisæ¡†æ¶æ‰§è¡Œsqlå¹¶å°†ç»“æœæ˜ å°„ä¸ºjavaå¯¹è±¡å¹¶è¿”å›ã€‚é‡‡ç”¨ORMæ€æƒ³è§£å†³äº†å®ä½“å’Œæ•°æ®åº“æ˜ å°„çš„é—®é¢˜,å¯¹jdbcè¿›è¡Œäº†å°è£…,å±è”½äº† jdbc apiåº•å±‚è®¿é—®ç»†èŠ‚,ä½¿æˆ‘ä»¬ä¸ç”¨ä¸ jdbc apiæ‰“äº¤é“,å°±å¯ä»¥å®Œæˆå¯¹æ•°æ®åº“çš„æŒä¹…åŒ–æ“ä½œã€‚ å¼€å‘æ­¥éª¤ æ·»åŠ ä¾èµ– 1234567891011&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.46&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.4.6&lt;/version&gt;&lt;/dependency&gt; ç¼–å†™æ•°æ®è¡¨ä¸Beanç±» åˆ›å»ºå¹¶ç¼–å†™mapper.xml 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;userMapper&quot;&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;com.myspring.bean.User&quot;&gt; select * from user &lt;/select&gt;&lt;/mapper&gt; åˆ›å»ºå¹¶ç¼–å†™sqlMapConfig.xml 12345678910111213141516&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;!-- é…ç½®æ•°æ®æºç¯å¢ƒ --&gt; &lt;environments default=&quot;&quot;&gt; &lt;environment id=&quot;development&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456789&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt;&lt;/configuration&gt; è°ƒç”¨æ“ä½œ 123456789101112// è·å¾—æ ¸å¿ƒé…ç½®æ–‡ä»¶InputStream resourceAsStream = Resources.getResourceAsStream(&quot;mybatis/sqlMapConfig.xml&quot;);// è·å¾—sessionå·¥å‚å¯¹è±¡SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(resourceAsStream);// è·å¾—sessionä¼šè¯å¯¹è±¡SqlSession sqlSession = sqlSessionFactory.openSession();// æ‰§è¡Œæ“ä½œ,å‚æ•°å³mapper.xmlä¸­çš„namespace.idList&lt;User&gt; userList = sqlSession.selectList(&quot;userMapper.findAll&quot;);// æµ‹è¯•System.out.println(userList);// é‡Šæ”¾èµ„æºsqlSession.close(); å¢åˆ æ”¹æŸ¥æ“ä½œä»£ç 123456789101112131415161718192021&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;userMapper&quot;&gt; &lt;!-- æŸ¥è¯¢ --&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;com.myspring.bean.User&quot;&gt; select * from user &lt;/select&gt; &lt;!-- æ’å…¥ --&gt; &lt;insert id=&quot;save&quot; parameterType=&quot;com.myspring.bean.User&quot;&gt; insert into user values (#&#123;name&#125;, #&#123;age&#125;) &lt;/insert&gt; &lt;!-- ä¿®æ”¹ --&gt; &lt;update id=&quot;update&quot; parameterType=&quot;com.myspring.bean.User&quot;&gt; update user set age=#&#123;age&#125; where name = #&#123;name&#125; &lt;/update&gt;&lt;/mapper&gt; 1234567891011121314151617181920// è·å¾—æ ¸å¿ƒé…ç½®æ–‡ä»¶InputStream resourceAsStream = Resources.getResourceAsStream(&quot;mybatis/sqlMapConfig.xml&quot;);// è·å¾—sessionå·¥å‚å¯¹è±¡SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(resourceAsStream);// è·å¾—sessionä¼šè¯å¯¹è±¡SqlSession sqlSession = sqlSessionFactory.openSession();// æŸ¥è¯¢List&lt;User&gt; userList = sqlSession.selectList(&quot;userMapper.findAll&quot;);// æ’å…¥sqlSession.insert(&quot;userMapper.save&quot;, new User(&quot;æ52å››&quot;, 11));// ä¿®æ”¹sqlSession.update(&quot;userMapper.update&quot;, new User(&quot;æ52å››&quot;, 110));// åˆ é™¤sqlSession.delete(&quot;userMapper.delete&quot;, &quot;æ52å››&quot;);// æ‰§è¡Œæ›´æ–°æ“ä½œéœ€è¦æäº¤äº‹åŠ¡sqlSession.commit();// é‡Šæ”¾èµ„æºsqlSession.close(); é…ç½®æ–‡ä»¶å¸¸ç”¨æ ‡ç­¾environmentsæ ‡ç­¾ é…ç½®æ•°æ®åº“ç¯å¢ƒï¼Œæ”¯æŒå¤šç¯å¢ƒ transactionManageräº‹åŠ¡ç®¡ç†å™¨å±æ€§ JDBC: è¿™ä¸ªé…ç½®å°±æ˜¯ç›´æ¥ä½¿ç”¨äº†JDBCçš„æäº¤å’Œå›æ»šè®¾ç½®,å®ƒä¾èµ–äºä»æ•°æ®æºå¾—åˆ°çš„è¿æ¥æ¥ç®¡ç†äº‹åŠ¡ä½œç”¨åŸŸ MANAGED: è¿™ä¸ªé…ç½®å‡ ä¹æ²¡åšä»€ä¹ˆã€‚å®ƒä»æ¥ä¸æäº¤æˆ–å›æ»šä¸€ä¸ªè¿æ¥,è€Œæ˜¯è®©å®¹å™¨æ¥ç®¡ç†äº‹åŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ(æ¯”å¦‚JEEåº”ç”¨æœåŠ¡å™¨çš„ä¸Šä¸‹æ–‡)ã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒä¼šå…³é—­è¿æ¥,ç„¶è€Œä¸€äº›å®¹å™¨å¹¶ä¸å¸Œæœ›è¿™æ ·,å› æ­¤éœ€è¦å°†closeConnectionå±æ€§è®¾ç½®ä¸ºfalseæ¥é˜»æ­¢å®ƒé»˜è®¤çš„å…³é—­è¡Œä¸ºã€‚ daraSourceæ•°æ®æºå±æ€§ UNPOOLED:è¿™ä¸ªæ•°æ®æºçš„å®ç°åªæ˜¯æ¯æ¬¡è¢«è¯·æ±‚æ—¶æ‰“å¼€å’Œå…³é—­è¿æ¥ã€‚ POOLED:è¿™ç§æ•°æ®æºçš„å®ç°åˆ©ç”¨â€œæ± â€çš„æ¦‚å¿µå°†JDBCè¿æ¥å¯¹è±¡ç»„ç»‡èµ·æ¥ã€‚ JNDI:è¿™ä¸ªæ•°æ®æºçš„å®ç°æ˜¯ä¸ºäº†èƒ½åœ¨å¦‚EJBæˆ–åº”ç”¨æœåŠ¡å™¨è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨,å®¹å™¨å¯ä»¥é›†ä¸­æˆ–åœ¨å¤–éƒ¨é…ç½®æ•°æ®æº,ç„¶åæ”¾ç½®ä¸€ä¸ªJNDIä¸Šä¸‹æ–‡çš„å¼•ç”¨ã€‚ Mapperæ ‡ç­¾ åŠ è½½æ˜ å°„ï¼ŒåŠ è½½æ–¹å¼æœ‰å¤šç§ã€‚ ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨,ä¾‹å¦‚:&lt; mapper resource=â€org/ mybatis/ builder/ AuthorMapperxmâ€/&gt; ä½¿ç”¨å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦(URL),ä¾‹å¦‚:&lt; mapper url=â€file//ar/ mappers/ Author Mapper.xmâ€/ ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å,ä¾‹å¦‚:&lt; mapper class=â€ org. mybatis builder. AuthorMapperâ€/&gt; å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨ä¸»å†Œä¸ºæ˜ å°„å™¨,ä¾‹å¦‚:&lt; package name=â€ org. mybatis. builderâ€/&gt; Propertiesæ ‡ç­¾ å®é™…å¼€å‘ä¸­,ä¹ æƒ¯å°†æ•°æ®æºçš„é…ç½®ä¿¡æ¯å•ç‹¬æŠ½å–æˆä¸ª propertiesæ–‡ä»¶,è¯¥æ ‡ç­¾å¯ä»¥åŠ è½½é¢å¤–é…ç½®çš„ propertiesæ–‡ä»¶ 12345678910111213141516171819202122&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;!-- åŠ è½½propertiesæ–‡ä»¶ --&gt; &lt;properties resource=&quot;jdbc.properties&quot;/&gt; &lt;!-- é…ç½®æ•°æ®æºç¯å¢ƒ --&gt; &lt;environments default=&quot;development&quot;&gt; &lt;environment id=&quot;development&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;!-- åŠ è½½æ˜ å°„æ–‡ä»¶ --&gt; &lt;mappers&gt; &lt;mapper resource=&quot;mybatis/UserMapper.xml&quot;/&gt; &lt;/mappers&gt;&lt;/configuration&gt; typeAliasesæ ‡ç­¾ èµ·åˆ«åï¼Œæœ‰å·²ç»è®¾ç½®å¥½çš„å¸¸ç”¨çš„ç±»å‹çš„åˆ«åï¼Œä¹Ÿå¯è‡ªå®šä¹‰ 1234&lt;!-- è‡ªå®šä¹‰åˆ«åï¼Œæ³¨æ„æ ‡ç­¾åœ¨config.xmlä¸­çš„é¡ºåº --&gt;&lt;typeAliases&gt; &lt;typeAlias type=&quot;com.myspring.bean.User&quot; alias=&quot;user&quot;/&gt;&lt;/typeAliases&gt; MyBatisç›¸å…³APISqlSessionå·¥å‚æ„å»ºå™¨SqlSessionFactoryBuilder SqlSessionå·¥å‚å¯¹è±¡SqlSessionFactory SqlSessionä¼šè¯å¯¹è±¡ DAOå±‚å®ç° é‡‡ç”¨ Mybatisçš„ä»£ç†å¼€å‘æ–¹å¼å®ç°DAOå±‚çš„å¼€å‘,è¿™ç§æ–¹å¼æ˜¯æˆ‘ä»¬åé¢è¿›å…¥ä¼ä¸šçš„ä¸»æµã€‚ Mapperæ¥å£å¼€å‘æ–¹æ³•åªéœ€è¦ç¨‹åºå‘˜ç¼–å†™ Mapperæ¥å£(ç›¸å½“äºDaoæ¥å£),ç”± Mybatisæ¡†æ¶æ ¹æ®æ¥å£å®šä¹‰åˆ›å»ºæ¥å£çš„åŠ¨æ€ä»£ç†å¯¹è±¡,ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“åŒä¸Šè¾¹Daoæ¥å£å®ç°ç±»æ–¹æ³•ã€‚ Mapper.xmæ–‡ä»¶ä¸­çš„ namespaceä¸ mapperæ¥å£çš„å…¨é™å®šåç›¸åŒ Mapperæ¥å£æ–¹æ³•åå’Œ Mapper. xmä¸­å®šä¹‰çš„æ¯ä¸ª statementçš„idç›¸åŒ Mapperæ¥å£æ–¹æ³•çš„è¾“å…¥å‚æ•°ç±»å‹å’Œ mapper. xnä¸­å®šä¹‰çš„æ¯ä¸ªsqlçš„ parameter Typeçš„ç±»å‹ç›¸åŒ Mapperæ¥å£æ–¹æ³•çš„è¾…å‡ºå‚æ•°ç±»å‹å’Œ mapper. xmä¸­å®šä¹‰çš„æ¯ä¸ªsqçš„ resultTypeçš„ç±»å‹ç›¸åŒ åˆ›å»ºå¹¶ç¼–å†™Mapper.xmlæ–‡ä»¶ 12345678910111213141516&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.myspring.dao.UserMapper&quot;&gt; &lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;user&quot;&gt; select * from user &lt;/select&gt; &lt;!-- æ ¹æ®nameæŸ¥è¯¢æ‰€æœ‰ --&gt; &lt;select id=&quot;findByName&quot; parameterType=&quot;int&quot; resultType=&quot;user&quot;&gt; select * from user where id = #&#123;id&#125; &lt;/select&gt;&lt;/mapper&gt; åˆ›å»ºå¹¶ç¼–å†™Mapperæ¥å£ 123456public interface UserMapper &#123; // æŸ¥è¯¢æ‰€æœ‰ List&lt;User&gt; findAll() throws Exception; // æ ¹æ®idæŸ¥è¯¢æ‰€æœ‰ User findById(int id);&#125; è°ƒç”¨ 1234567InputStream resourceAsStream = Resources.getResourceAsStream(&quot;myBatis/sqlMapConfig.xml&quot;);SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(resourceAsStream);SqlSession sqlSession = sqlSessionFactory.openSession();UserMapper mapper = sqlSession.getMapper(UserMapper.class);List&lt;User&gt; all = mapper.findAll();User user = mapper.findById(2); æ˜ å°„æ–‡ä»¶ï¼šåŠ¨æ€sqlè¯­å¥123456789101112131415161718192021222324252627282930313233&lt;!-- sqlè¯­å¥æŠ½å– --&gt;&lt;sql id=&quot;selectUser&quot;&gt; select * from user&lt;/sql&gt;&lt;!-- åŠ¨æ€æ¡ä»¶ --&gt;&lt;select id=&quot;findByCondition&quot; parameterType=&quot;user&quot; resultType=&quot;user&quot;&gt; &lt;include refid=&quot;selectUser&quot;/&gt; &lt;where&gt; &lt;if test=&quot;id!=0&quot;&gt; and id=#&#123;id&#125; &lt;/if&gt; &lt;if test=&quot;name!=null&quot;&gt; and name=#&#123;name&#125; &lt;/if&gt; &lt;if test=&quot;age!=0&quot;&gt; and age=#&#123;age&#125; &lt;/if&gt; &lt;/where&gt;&lt;/select&gt;&lt;!-- åŠ¨æ€æ¡ä»¶ --&gt;&lt;select id=&quot;findByIds&quot; parameterType=&quot;list&quot; resultType=&quot;user&quot;&gt; &lt;include refid=&quot;selectUser&quot;/&gt; &lt;where&gt; -- select * from user where id in(?,?) -- collectionå†™listæˆ–arrayç­‰ &lt;foreach collection=&quot;list&quot; open=&quot;id in(&quot; close=&quot;)&quot; item=&quot;id&quot; separator=&quot;,&quot;&gt; #&#123;id&#125; &lt;/foreach&gt; &lt;/where&gt;&lt;/select&gt; é…ç½®æ–‡ä»¶ç±»å‹è½¬æ¢TypeHandleræ ‡ç­¾é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili æ’ä»¶pluginsæ ‡ç­¾ æ·»åŠ ä¾èµ– 12345678910&lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper&lt;/artifactId&gt; &lt;version&gt;5.1.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.github.jsqlparser&lt;/groupId&gt; &lt;artifactId&gt;jsqlparser&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt;&lt;/dependency&gt; åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ ‡ç­¾ 12345&lt;plugins&gt; &lt;plugin interceptor=&quot;com.github.pagehelper.PageHelper&quot;&gt; &lt;property name=&quot;dialect&quot; value=&quot;mysql&quot;/&gt; &lt;/plugin&gt;&lt;/plugins&gt; è°ƒç”¨ 12345678910111213141516171819// åˆ†é¡µåŠ©æ‰‹ï¼Œè®¾ç½®åˆ†é¡µä¿¡æ¯ä»¥åˆ†é¡µï¼ŒstartPage(pageNum,pageSize)PageHelper.startPage(1, 1);// å½“å‰é¡µList&lt;User&gt; userList = mapper.findAll();// åˆ†é¡µä¿¡æ¯PageInfo&lt;User&gt; userPageInfo = new PageInfo&lt;&gt;(userList);for (User user : userList) &#123; System.out.println(user);&#125;System.out.println(&quot;ä¸Šä¸€é¡µï¼š&quot; + userPageInfo.getPrePage());System.out.println(&quot;å½“å‰é¡µï¼š&quot; + userPageInfo.getPageNum());System.out.println(&quot;ä¸‹ä¸€é¡µï¼š&quot; + userPageInfo.getNextPage());System.out.println(&quot;æ€»é¡µæ•°ï¼š&quot; + userPageInfo.getPages());System.out.println(&quot;å½“å‰æ¡æ•°ï¼š&quot; + userPageInfo.getPageSize());System.out.println(&quot;æ€»æ¡æ•°ï¼š&quot; + userPageInfo.getTotal());System.out.println(&quot;æ˜¯å¦ç¬¬ä¸€é¡µï¼š&quot; + userPageInfo.isIsFirstPage());System.out.println(&quot;æ˜¯å¦æœ«é¡µï¼š&quot; + userPageInfo.isIsLastPage()); å¤šè¡¨æ“ä½œé»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili æ³¨è§£å¼€å‘ä½¿ç”¨xmlå¼€å‘crud1234&lt;!-- åŠ è½½æ˜ å°„æ–‡ä»¶ --&gt;&lt;mappers&gt; &lt;mapper resource=&quot;mybatis/UserMapper.xml&quot;/&gt;&lt;/mappers&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.myspring.dao.UserMapper&quot;&gt; &lt;!-- sqlè¯­å¥æŠ½å– --&gt; &lt;sql id=&quot;selectUser&quot;&gt; select * from user &lt;/sql&gt; &lt;!-- æŸ¥è¯¢ --&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;user&quot;&gt; &lt;include refid=&quot;selectUser&quot;/&gt; &lt;/select&gt; &lt;select id=&quot;findById&quot; parameterType=&quot;int&quot; resultType=&quot;user&quot;&gt; select * from user where id = #&#123;id&#125; &lt;/select&gt; &lt;select id=&quot;findByIds&quot; parameterType=&quot;list&quot; resultType=&quot;user&quot;&gt; &lt;include refid=&quot;selectUser&quot;&gt;&lt;/include&gt; &lt;where&gt; -- select * from user where id in(?,?) -- collectionå†™listæˆ–arrayç­‰ &lt;foreach collection=&quot;list&quot; open=&quot;id in(&quot; close=&quot;)&quot; item=&quot;id&quot; separator=&quot;,&quot;&gt; #&#123;id&#125; &lt;/foreach&gt; &lt;/where&gt; &lt;/select&gt; &lt;select id=&quot;findByCondition&quot; parameterType=&quot;user&quot; resultType=&quot;user&quot;&gt; &lt;include refid=&quot;selectUser&quot;&gt;&lt;/include&gt; &lt;where&gt; &lt;if test=&quot;id!=0&quot;&gt; and id=#&#123;id&#125; &lt;/if&gt; &lt;if test=&quot;name!=null&quot;&gt; and name=#&#123;name&#125; &lt;/if&gt; &lt;if test=&quot;age!=0&quot;&gt; and age=#&#123;age&#125; &lt;/if&gt; &lt;/where&gt; &lt;/select&gt; &lt;!-- æ’å…¥ --&gt; &lt;insert id=&quot;save&quot; parameterType=&quot;com.myspring.bean.User&quot;&gt; insert into user (name, age) values (#&#123;name&#125;, #&#123;age&#125;) &lt;/insert&gt; &lt;!-- ä¿®æ”¹ --&gt; &lt;update id=&quot;update&quot; parameterType=&quot;com.myspring.bean.User&quot;&gt; update user set age=#&#123;age&#125;, name=#&#123;name&#125; where id = #&#123;id&#125; &lt;/update&gt; &lt;!-- åˆ é™¤ --&gt; &lt;delete id=&quot;delete&quot; parameterType=&quot;int&quot;&gt; delete from user where id = #&#123;id&#125; &lt;/delete&gt;&lt;/mapper&gt; 123456789101112131415public interface UserMapper &#123; List&lt;User&gt; findAll(); User findById(int id); List&lt;User&gt; findByCondition(User user); List&lt;User&gt; findByIds(List&lt;Integer&gt; ids); void save(User user); void update(User user); void delete(int id);&#125; 123456789101112131415161718192021222324252627282930313233343536373839public class UserMapperTest &#123; private UserMapper userMapper; @Before public void before() throws IOException &#123; InputStream resourceAsStream = Resources.getResourceAsStream(&quot;myBatis/sqlMapConfig.xml&quot;); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(resourceAsStream); SqlSession sqlSession = sqlSessionFactory.openSession(true); userMapper = sqlSession.getMapper(UserMapper.class); &#125; @Test public void testSave() throws Exception &#123; User user = new User(); user.setName(&quot;é’±è€æ¿&quot;); user.setAge(90); userMapper.save(user); &#125; @Test public void testUpdate() throws Exception &#123; User user = userMapper.findById(3); user.setAge(99); userMapper.update(user); &#125; @Test public void testDelete() throws Exception &#123; userMapper.delete(4); &#125; @Test public void testFindById() throws Exception &#123; User user = userMapper.findById(3); System.out.println(user); &#125;&#125; æ³¨è§£å¼€å‘CRUD12345678910111213141516public interface UserMapper &#123; @Select(&quot;select * from user&quot;) List&lt;User&gt; findAll(); @Select(&quot;select * from user where id = #&#123;id&#125;&quot;) User findById(int id); @Insert(&quot;insert into user (name, age) values (#&#123;name&#125;, #&#123;age&#125;)&quot;) void save(User user); @Update(&quot;update user set age=#&#123;age&#125;, name=#&#123;name&#125; where id = #&#123;id&#125;&quot;) void update(User user); @Update(&quot; delete from user where id = #&#123;id&#125;&quot;) void delete(int id);&#125; 12345&lt;!-- åŠ è½½æ˜ å°„å…³ç³» --&gt;&lt;mappers&gt; &lt;!-- æŒ‡å®šæ¥å£æ‰€åœ¨çš„åŒ… --&gt; &lt;package name=&quot;com.myspring.dao&quot;/&gt;&lt;/mappers&gt; è°ƒç”¨ä¸å˜","categories":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"MyBatis","slug":"MyBatis","permalink":"http://example.com/tags/MyBatis/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"}]},{"title":"ã€é¡¹ç›®ç¬”è®°ã€‘ssmæ•´åˆç»ƒä¹ ç®€å•CRUDé¡¹ç›®","slug":"ã€é¡¹ç›®ç¬”è®°ã€‘ssmæ•´åˆç»ƒä¹ ","date":"2021-07-16T07:09:38.168Z","updated":"2021-09-19T12:40:33.243Z","comments":true,"path":"2021/07/16/xiang-mu-bi-ji-ssm-zheng-he-lian-xi/","link":"","permalink":"http://example.com/2021/07/16/xiang-mu-bi-ji-ssm-zheng-he-lian-xi/","excerpt":"","text":"é¡¹ç›®ç®€ä»‹åŠŸèƒ½ç‚¹ åˆ†é¡µ æ•°æ®æ ¡éªŒ jQueryå‰ç«¯æ ¡éªŒ JSR303åç«¯æ ¡éªŒ AJAX RESTé£æ ¼ æŠ€æœ¯ç‚¹ åŸºç¡€æ¡†æ¶ssm æ•°æ®åº“MySQL è¯·é˜¿ä¸¹æ¡†æ¶bootstrap é¡¹ç›®ç®¡ç†maven åˆ†é¡µæ’ä»¶pagehelper é€†å‘å·¥ç¨‹mybatis generator åŸºç¡€ç¯å¢ƒæ­å»ºåˆ›å»ºé¡¹ç›®â€‹ åˆ›å»ºmavené¡¹ç›®ï¼Œæ·»åŠ javaee-web application framework support å¼•å…¥mavenç›¸å…³ä¾èµ–â€‹ å¼•å…¥spring springmvc mybatisç­‰ç›¸å…³ä¾èµ– 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.example&lt;/groupId&gt; &lt;artifactId&gt;ssm_crud&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;!-- spring springmvc --&gt; &lt;dependencies&gt; &lt;!-- springmvc --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.16.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;!-- spring jdbc --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.16.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;!-- spring aspects aopé¢å‘åˆ‡é¢ç¼–ç¨‹ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt; &lt;version&gt;5.2.16.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mybatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;2.0.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æ•°æ®åº“è¿æ¥æ± ã€é©±åŠ¨ --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.46&lt;/version&gt; &lt;/dependency&gt; &lt;!-- å…¶ä»– --&gt; &lt;dependency&gt; &lt;groupId&gt;jstl&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.13&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; å¼•å…¥å‰ç«¯æ¡†æ¶â€‹ å¼•å…¥jQueryã€Bootstrap 12345678&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;!-- æœ€æ–°ç‰ˆæœ¬çš„ Bootstrap æ ¸å¿ƒ CSS æ–‡ä»¶ --&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css&quot; integrity=&quot;sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;!-- æœ€æ–°çš„ Bootstrap æ ¸å¿ƒ JavaScript æ–‡ä»¶ --&gt;&lt;script src=&quot;https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js&quot; integrity=&quot;sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; ssmæ•´åˆé…ç½®æ–‡ä»¶web.xml123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot; version=&quot;4.0&quot;&gt; &lt;!-- 1ã€å¯åŠ¨springçš„å®¹å™¨ --&gt; &lt;!-- è®¾ç½®å…¨å±€å‚æ•° --&gt; &lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/context-param&gt; &lt;!-- é…ç½®ç›‘å¬å™¨ --&gt; &lt;listener&gt; &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt; &lt;/listener&gt; &lt;!-- 2ã€springmvcå‰ç«¯æ§åˆ¶å™¨ --&gt; &lt;servlet&gt; &lt;servlet-name&gt;DispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!-- é…ç½®xmlåœ°å€ --&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:spring-mvc.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;DispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;!-- 3ã€å…¨å±€å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼Œæ³¨æ„è¿™ä¸ªè¿‡æ»¤å™¨ä¸€å®šè¦æ”¾åœ¨æ‰€æœ‰è¿‡æ»¤å™¨ä¹‹å‰ --&gt; &lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;utf-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceRequestEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceResponseEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; &lt;!-- 4ã€è¿‡æ»¤å™¨ï¼šä½¿ç”¨RESTé£æ ¼çš„URI å°†é¡µé¢æ™®é€šçš„POSTè¯·æ±‚è½¬ä¸ºæŒ‡å®šçš„deleteæˆ–è€…putè¯·æ±‚ --&gt; &lt;filter&gt; &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt;&lt;/web-app&gt; spring-mvc.xml123456789101112131415161718192021222324252627&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; &lt;!-- springMVCçš„é…ç½®æ–‡ä»¶ --&gt; &lt;!-- é…ç½®ç»„ä»¶æ‰«æè·¯å¾„ --&gt; &lt;context:component-scan base-package=&quot;com.sss_crud&quot; use-default-filters=&quot;false&quot;&gt; &lt;!-- åªæ‰«æcontroller(å³æ‰€æœ‰æ³¨é‡Šcontrollerçš„ç±») --&gt; &lt;context:include-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot; /&gt; &lt;/context:component-scan&gt; &lt;!-- é…ç½®è§†å›¾è§£æå™¨ --&gt; &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt; &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views&quot; /&gt; &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt; &lt;/bean&gt; &lt;!-- è¿‡æ»¤é™æ€èµ„æº ï¼ˆå°†springmvcä¸èƒ½å¤„ç†çš„è¯·æ±‚äº¤ç»™Tomcatï¼Œè¯¥æ ‡ç­¾è¡¨ç¤ºå½“springæ‰¾ä¸åˆ°èµ„æºæ—¶äº¤ç”±åŸå§‹å®¹å™¨(tomcat)å¯»æ‰¾ï¼‰ --&gt; &lt;mvc:default-servlet-handler /&gt; &lt;!-- mvcæ³¨è§£é©±åŠ¨ ä»¥åŠå…¶ä»–ä¸€äº›åŠŸèƒ½æ”¯æŒ --&gt; &lt;mvc:annotation-driven /&gt;&lt;/beans&gt; applicationContext.xml12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;!-- springé…ç½®æ–‡ä»¶ --&gt; &lt;!-- é…ç½®ç»„ä»¶æ‰«æè·¯å¾„ --&gt; &lt;context:component-scan base-package=&quot;com.sss_crud&quot; use-default-filters=&quot;false&quot;&gt; &lt;!-- ä¸æ‰«æcontroller(å³æ‰€æœ‰æ³¨é‡Šcontrollerçš„ç±») --&gt; &lt;context:exclude-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot; /&gt; &lt;/context:component-scan&gt; &lt;!-- åŠ è½½å¤–éƒ¨çš„propertiesæ–‡ä»¶ --&gt; &lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot; /&gt; &lt;!-- é…ç½®æ•°æ®æºï¼Œäº‹åŠ¡æ§åˆ¶ --&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt; &lt;/bean&gt; &lt;!-- mybatisæ•´åˆ --&gt; &lt;!-- sqlSessionFactory --&gt; &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt; &lt;!-- mybatiså…¨å±€é…ç½®æ–‡ä»¶ã€æ•°æ®æºã€mapperé…ç½®æ–‡ä»¶ --&gt; &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot; /&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt; &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:mapper/*.xml&quot; /&gt; &lt;/bean&gt; &lt;!-- é…ç½®æ‰«æå™¨ï¼Œå°†mybatisæ¥å£çš„å®ç°åŠ å…¥åˆ°IOCå®¹å™¨ä¸­ --&gt; &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt; &lt;property name=&quot;basePackage&quot; value=&quot;com.sss_crud.mapper&quot; /&gt; &lt;/bean&gt; &lt;!-- äº‹åŠ¡æ§åˆ¶ --&gt; &lt;!-- äº‹åŠ¡ç®¡ç†å™¨ --&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt; &lt;/bean&gt; &lt;!-- å¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ --&gt; &lt;aop:config&gt; &lt;!-- åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ --&gt; &lt;aop:pointcut id=&quot;txPoint&quot; expression=&quot;execution(* com.sss_crud.service..*(..))&quot; /&gt; &lt;!-- é…ç½®äº‹åŠ¡å¢å¼º --&gt; &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;txPoint&quot; /&gt; &lt;/aop:config&gt; &lt;!-- é…ç½®äº‹åŠ¡å¢å¼ºï¼Œäº‹åŠ¡å¦‚ä½•åˆ‡å…¥ --&gt; &lt;tx:advice id=&quot;txAdvice&quot;&gt; &lt;tx:attributes&gt; &lt;!-- åˆ‡å…¥ç‚¹åˆ‡å…¥çš„æ‰€æœ‰æ–¹æ³•ï¼ˆè¿æ¥ç‚¹ï¼‰éƒ½æ˜¯äº‹åŠ¡æ–¹æ³• --&gt; &lt;tx:method name=&quot;*&quot; /&gt; &lt;tx:method name=&quot;get*&quot; read-only=&quot;true&quot; /&gt; &lt;/tx:attributes&gt; &lt;/tx:advice&gt;&lt;/beans&gt; jdbc.properties1234jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/ssmjdbc.username=rootjdbc.password=123456789 mybatis-config.xml123456789101112131415&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;!-- å¼€å¯é©¼å³°å‘½å --&gt; &lt;settings&gt; &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot; /&gt; &lt;/settings&gt; &lt;!-- é…ç½®åˆ«å --&gt; &lt;typeAliases&gt; &lt;!-- è‡ªåŠ¨æ‰«æè·¯å¾„ä¸‹çš„ç±»å¹¶ä¸”èµ·åˆ«å --&gt; &lt;package name=&quot;com.sss_crud.bean&quot; /&gt; &lt;/typeAliases&gt;&lt;/configuration&gt; æ•°æ®åº“æ„å»ºssm_crud.sql1234567891011121314151617181920212223242526272829SET NAMES utf8mb4;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for tbl_dept-- ----------------------------DROP TABLE IF EXISTS `tbl_dept`;CREATE TABLE `tbl_dept` ( `dept_id` int NOT NULL AUTO_INCREMENT COMMENT &#x27;éƒ¨é—¨id&#x27;, `dept_name` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL, PRIMARY KEY (`dept_id`) USING BTREE) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;-- ------------------------------ Table structure for tbl_emp-- ----------------------------DROP TABLE IF EXISTS `tbl_emp`;CREATE TABLE `tbl_emp` ( `emp_id` int NOT NULL AUTO_INCREMENT COMMENT &#x27;å‘˜å·¥id&#x27;, `emp_name` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL, `gender` char(1) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, `email` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, `d_id` int NULL DEFAULT NULL, PRIMARY KEY (`emp_id`) USING BTREE, INDEX `fk_emp_dept`(`d_id`) USING BTREE, CONSTRAINT `fk_emp_dept` FOREIGN KEY (`d_id`) REFERENCES `tbl_dept` (`dept_id`) ON DELETE RESTRICT ON UPDATE RESTRICT) ENGINE = InnoDB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;SET FOREIGN_KEY_CHECKS = 1; åŸºç¡€æ¨¡å—mybatisé€†å‘å·¥ç¨‹ç”Ÿæˆbeanã€mappergeneratorConfig.xml mybatis generatorçš„é…ç½®æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE generatorConfiguration PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;&lt;generatorConfiguration&gt; &lt;!--æ³¨æ„targetProjectä¸­ä½¿ç”¨åæ–œæ ï¼ŒconnectionURLéœ€è¦æ·»åŠ useSSL=true--&gt; &lt;!--é…ç½®è¦é“¾æ¥çš„æ•°æ®åº“çš„æ•°æ®æº--&gt; &lt;!-- &lt;classPathEntry location=&quot;E:/GARBAGE_TEMP_SPACE/mysql-connector-java-5.1.46.jar&quot; /&gt;--&gt; &lt;!---Mybatisä¸Šä¸‹æ–‡--&gt; &lt;context id=&quot;MySqlContext&quot; targetRuntime=&quot;MyBatis3&quot;&gt; &lt;!-- å–æ¶ˆç”Ÿæˆçš„æ–‡ä»¶çš„å…¨éƒ¨è‡ªåŠ¨æ³¨é‡Š --&gt; &lt;commentGenerator&gt; &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot; /&gt; &lt;/commentGenerator&gt; &lt;!--é…ç½®æ•°æ®åº“çš„é“¾æ¥ä¿¡æ¯--&gt; &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot; connectionURL=&quot;jdbc:mysql://localhost:3306/ssm_crud?useSSL=false&quot; userId=&quot;root&quot; password=&quot;123456789&quot; /&gt; &lt;!--æ•°æ®åº“BigDecimalså­—æ®µåœ¨javaä¸­å®šä¹‰--&gt; &lt;javaTypeResolver&gt; &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot; /&gt; &lt;/javaTypeResolver&gt; &lt;!--å®ä½“ç±»ç”Ÿæˆä¿¡æ¯ æŒ‡å®šjavabeanç”Ÿæˆä½ç½®--&gt; &lt;javaModelGenerator targetPackage=&quot;com.sss_crud.bean&quot; targetProject=&quot;src\\main\\java&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt; &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot; /&gt; &lt;/javaModelGenerator&gt; &lt;!--æŒ‡å®šmybatisçš„mapper.xmlæ˜ å°„æ–‡ä»¶åœ°å€--&gt; &lt;sqlMapGenerator targetPackage=&quot;mapper&quot; targetProject=&quot;src\\main\\resources&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt; &lt;/sqlMapGenerator&gt; &lt;!--æŒ‡å®šmybatisçš„mapperæ¥å£ç”Ÿæˆåœ°å€--&gt; &lt;javaClientGenerator targetPackage=&quot;com.sss_crud.mapper&quot; targetProject=&quot;src\\main\\java&quot; type=&quot;XMLMAPPER&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt; &lt;/javaClientGenerator&gt; &lt;!--è¦ç”Ÿæˆçš„è¡¨ç»“æ„--&gt; &lt;table tableName=&quot;tbl_emp&quot; domainObjectName=&quot;Employee&quot; /&gt; &lt;table tableName=&quot;tbl_dept&quot; domainObjectName=&quot;Department&quot; /&gt; &lt;/context&gt;&lt;/generatorConfiguration&gt; MBGTest.class è¿è¡Œmybatis generatorä»¥è‡ªåŠ¨ç”Ÿæˆbeanå’Œmapperï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨æ·»åŠ æ„é€ å™¨ 123456789101112131415161718192021import org.mybatis.generator.api.MyBatisGenerator;import org.mybatis.generator.config.Configuration;import org.mybatis.generator.config.xml.ConfigurationParser;import org.mybatis.generator.internal.DefaultShellCallback;import java.io.File;import java.util.ArrayList;import java.util.List;public class MBGTest &#123; public static void main(String[] args) throws Exception &#123; List&lt;String&gt; warnings = new ArrayList&lt;String&gt;(); boolean overwrite = true; File configFile = new File(&quot;generatorConfig.xml&quot;); ConfigurationParser cp = new ConfigurationParser(warnings); Configuration config = cp.parseConfiguration(configFile); DefaultShellCallback callback = new DefaultShellCallback(overwrite); MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config, callback, warnings); myBatisGenerator.generate(null); &#125;&#125; å½“å‰é¡¹ç›®ç»“æ„ MapperTestå•å…ƒæµ‹è¯•å¼•å…¥maven123456&lt;!-- spring test --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.16.RELEASE&lt;/version&gt;&lt;/dependency&gt; æ·»åŠ å¯ä»¥æ‰¹é‡æ“ä½œçš„sqlSession æ³¨æ„åœ¨applicationContext.xmlæ–‡ä»¶ä¸­æ·»åŠ å¯ä»¥æ‰¹é‡æ“ä½œçš„sqlSession 12345&lt;!-- ä¸€ä¸ªå¯ä»¥æ‰§è¡Œæ‰¹é‡æ“ä½œçš„SQLSession --&gt;&lt;bean id=&quot;sqlSessionTemplate&quot; class=&quot;org.mybatis.spring.SqlSessionTemplate&quot;&gt; &lt;constructor-arg name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot; /&gt; &lt;constructor-arg name=&quot;executorType&quot; value=&quot;BATCH&quot; /&gt;&lt;/bean&gt; MapperTestç±»ç¼–å†™123456789101112131415161718192021222324252627282930313233343536373839import com.sss_crud.bean.Employee;import com.sss_crud.mapper.DepartmentMapper;import com.sss_crud.mapper.EmployeeMapper;import org.apache.ibatis.session.SqlSession;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import java.util.UUID;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations = &#123;&quot;classpath:applicationContext.xml&quot;&#125;)public class MapperTest &#123; @Autowired DepartmentMapper departmentMapper; @Autowired EmployeeMapper employeeMapper; @Autowired SqlSession session; @Test public void test() &#123; // departmentMapper.insertSelective(new Department(null, &quot;å¼€å‘&quot;)); // departmentMapper.insertSelective(new Department(null, &quot;æµ‹è¯•&quot;)); // employeeMapper.insertSelective(new Employee(null, &quot;Jerry&quot;, &quot;M&quot;, &quot;Jerry@qq.com&quot;, 1)); // employeeMapper.insertSelective(new Employee(null, &quot;Cat&quot;, &quot;W&quot;, &quot;Cat@qq.com&quot;, 2)); // ä½¿ç”¨å¯ä»¥æ‰¹é‡æ“ä½œçš„sessionè·å¾—mapper,ä»è€Œè¿›è¡Œæ‰¹é‡æ“ä½œ EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); for (int i = 0; i &lt; 1000; i++) &#123; String uid = UUID.randomUUID().toString().substring(0, 5) + i; mapper.insertSelective(new Employee(null, uid, &quot;M&quot;, uid + &quot;@qq.com&quot;, 1)); &#125; &#125;&#125; æŸ¥è¯¢åŠŸèƒ½ æ­¤åŠŸèƒ½éœ€è¦ä½¿ç”¨åˆ†é¡µæ’ä»¶pageHelper pagehelperåˆ†é¡µæ’ä»¶å¼•å…¥mavenä¾èµ–12345&lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper&lt;/artifactId&gt; &lt;version&gt;5.0.0&lt;/version&gt;&lt;/dependency&gt; é…ç½®mybatis-config.xmlä»¥ä½¿ç”¨æ’ä»¶1234567891011&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;!-- ...... --&gt; &lt;!-- æ’ä»¶ --&gt; &lt;plugins&gt; &lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;&lt;/plugin&gt; &lt;/plugins&gt;&lt;/configuration&gt; viewsindex.jsp12345678910111213141516171819&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;$Title$&lt;/title&gt; &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;!-- æœ€æ–°ç‰ˆæœ¬çš„ Bootstrap æ ¸å¿ƒ CSS æ–‡ä»¶ --&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css&quot; integrity=&quot;sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;!-- æœ€æ–°çš„ Bootstrap æ ¸å¿ƒ JavaScript æ–‡ä»¶ --&gt; &lt;script src=&quot;https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js&quot; integrity=&quot;sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;%-- è·³è½¬è‡³å±•ç¤ºæ‰€æœ‰å‘˜å·¥ä¿¡æ¯ --%&gt; &lt;jsp:forward page=&quot;/emps&quot;&gt;&lt;/jsp:forward&gt;&lt;/body&gt;&lt;/html&gt; serviceEmployeeServiceImpl.java123456789101112131415161718192021package com.sss_crud.service.impl;import com.sss_crud.bean.Employee;import com.sss_crud.mapper.EmployeeMapper;import com.sss_crud.service.EmployeeService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.util.List;@Servicepublic class EmployeeServiceImpl implements EmployeeService &#123; @Autowired EmployeeMapper employeeMapper; public List&lt;Employee&gt; getAll() &#123; return employeeMapper.selectByExampleWithDept(null); &#125;&#125; controllerEmployeeController.java1234567891011121314151617181920212223242526272829303132333435363738394041424344package com.sss_crud.controller;import com.github.pagehelper.PageHelper;import com.github.pagehelper.PageInfo;import com.sss_crud.bean.Employee;import com.sss_crud.service.EmployeeService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.servlet.ModelAndView;import java.util.List;/** * å¤„ç†å‘˜å·¥CRUDè¯·æ±‚ */@Controllerpublic class EmployeeController &#123; @Autowired EmployeeService employeeService; /** * æŸ¥è¯¢å‘˜å·¥æ•°æ®ï¼ˆåˆ†é¡µï¼‰ * urlè¯·æ±‚å‚æ•°â€œpnâ€ä¸ºè¯·æ±‚é¡µæ•° * * @return */ @RequestMapping(&quot;/emps&quot;) public ModelAndView getEmps(@RequestParam(value = &quot;pn&quot;, defaultValue = &quot;1&quot;) Integer pn) &#123; ModelAndView mav = new ModelAndView(); // ä½¿ç”¨pageHelperå®ç°åˆ†é¡µåŠŸèƒ½ PageHelper.startPage(pn, 5); // æŸ¥è¯¢ï¼ˆæ­¤æ—¶çš„æ•°æ®å·²ç»æ˜¯åˆ†é¡µåçš„æ•°æ®ï¼‰ List&lt;Employee&gt; emps = employeeService.getAll(); // ä½¿ç”¨pageInfoåŒ…è£…ï¼ˆåŠ å…¥å…¶ä»–æ›´å¤šçš„ä¿¡æ¯ï¼Œæ‰€æœ‰é¡µï¼Œå½“å‰é¡µç­‰ç­‰ï¼‰ PageInfo pageInfo = new PageInfo(emps, 5); mav.addObject(&quot;pageInfo&quot;, pageInfo); mav.setViewName(&quot;list&quot;); return mav; &#125;&#125; Testå•å…ƒæµ‹è¯•12345678910111213141516171819202122232425262728293031323334353637383940import com.github.pagehelper.PageInfo;import org.junit.Before;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.mock.web.MockHttpServletRequest;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import org.springframework.test.context.web.WebAppConfiguration;import org.springframework.test.web.servlet.MockMvc;import org.springframework.test.web.servlet.MvcResult;import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;import org.springframework.test.web.servlet.setup.MockMvcBuilders;import org.springframework.web.context.WebApplicationContext;@WebAppConfiguration(value = &quot;src/main/web&quot;)@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations = &#123;&quot;classpath:applicationContext.xml&quot;, &quot;classpath:spring-mvc.xml&quot;&#125;)public class MvcTest &#123; //ä¼ å…¥springmvcçš„ioc @Autowired WebApplicationContext context; // è™šæ‹ŸMVCè¯·æ±‚ è·å¾—è¯·æ±‚ç»“æœ MockMvc mockMvc; @Before public void initMockMvc() &#123; mockMvc = MockMvcBuilders.webAppContextSetup(context).build(); &#125; @Test public void test() throws Exception &#123; MvcResult result = mockMvc.perform(MockMvcRequestBuilders.get(&quot;/emps&quot;).param(&quot;pn&quot;, &quot;1&quot;)).andReturn(); MockHttpServletRequest request = result.getRequest(); PageInfo pageInfo = (PageInfo) request.getAttribute(&quot;pageInfo&quot;); System.out.println(pageInfo); &#125;&#125; æ²¡æœ‰æˆåŠŸï¼Œè¿”å›ä¸ºnullï¼Œæˆ‘ä¸ç†è§£ï¼Œéƒ½springäº†è¿˜ç”¨nmçš„jspå‘¢ï¼Œä¸å¼„äº†ï¼åæ­£ç»“æ„éƒ½å·®ä¸å¤šäº†å®ç°é€»è¾‘ä¹Ÿå°±é‚£æ ·ï¼Œæ‹œæ‹œäº†æ‚¨å˜ï¼","categories":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"}],"tags":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘SpringMVC","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘SpringMVC","date":"2021-07-15T05:37:42.134Z","updated":"2021-09-19T12:45:12.814Z","comments":true,"path":"2021/07/15/xue-xi-bi-ji-springmvc/","link":"","permalink":"http://example.com/2021/07/15/xue-xi-bi-ji-springmvc/","excerpt":"","text":"SpringMVCæ¦‚è¿° SpringMVCæ˜¯ç§åŸºäºJavaçš„å®ç°MVcè®¾è®¡æ¨¡å‹çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§Webæ¡†æ¶,å±äºSpring FrameWorkçš„åç»­äº§å“,å·²ç»èåˆåœ¨ Spring Web Flowä¸­ã€‚ SpringMvCå·²ç»æˆä¸ºç›®å‰æœ€ä¸»æµçš„MVCæ¡†æ¶ä¹‹ä¸€,å¹¶ä¸”éšç€ Spring30çš„å‘å¸ƒ,å…¨é¢è¶…è¶Š Struts2,æˆä¸ºæœ€ä¼˜ç§€çš„MVCæ¡†æ¶ã€‚å®ƒé€šè¿‡ä¸€å¥—æ³¨è§£,è®©ä¸€ä¸ªç®€å•çš„Javaç±»æˆä¸ºå¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨,è€Œæ— é¡»å®ç°ä»»ä½•æ¥å£ã€‚åŒæ—¶å®ƒè¿˜æ”¯æŒRESTfulç¼–ç¨‹é£æ ¼çš„è¯·æ±‚ã€‚ SpringMVCå¿«é€Ÿå¼€å‘æ­¥éª¤ å¯¼å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.8.RELEASE&lt;/version&gt;&lt;/dependency&gt; é…ç½®web.xml 123456789101112131415&lt;!-- springMVCå‰ç«¯æ§åˆ¶å™¨ --&gt;&lt;servlet&gt; &lt;servlet-name&gt;DispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!-- é…ç½®xmlåœ°å€ --&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:spring-mvc.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;DispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; ç¼–å†™controller 12345678910@Controllerpublic class UserController &#123; // ä½¿ç”¨RequestMappingæ˜ å°„controlleråœ°å€ @RequestMapping(&quot;/myController&quot;) public String save() &#123; System.out.println(&quot;Controller save running&quot;); // returnè¦è·³è½¬çš„è§†å›¾é¡µé¢ return &quot;success.jsp&quot;; &#125;&#125; åœ¨resourcesä¸‹æ–°å¢spring-mvc.xmldçš„spring configæ–‡ä»¶ 12345xmlns:context=&quot;http://www.springframework.org/schema/context&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;&lt;!-- controllerçš„ç»„ä»¶æ‰«æ --&gt;&lt;context:component-scan base-package=&quot;com.myspring.controller&quot;/&gt; SpringMVCç»„ä»¶è§£æ@RequestMappingç”¨äºå»ºç«‹è¯·æ±‚URLå’Œå¤„ç†è¯·æ±‚æ–¹æ³•ä¹‹é—´çš„å¯¹åº”å…³ç³» ä½ç½® ç±»ä¸Š,è¯·æ±‚URLçš„ç¬¬ä¸€çº§è®¿é—®ç›®å½•ã€‚æ­¤å¤„ä¸å†™çš„è¯,å°±ç›¸å½“äºåº”ç”¨çš„æ ¹ç›®å½• æ–¹æ³•ä¸Š,è¯·æ±‚URLçš„ç¬¬äºŒçº§è®¿é—®ç›®å½•,ä¸ç±»ä¸Šçš„ä½¿ç”¨@ ReqquestMappingæ ‡ä¸»çš„çº§ç›®å½•èµ·ç»„æˆè®¿é—®è™šæ‹Ÿè·¯å¾„ return åè·Ÿçš„è·¯å¾„ï¼šä¸åŠ â€/â€œï¼Œåˆ™ä»ç›¸å¯¹è·¯å¾„æŸ¥è¯¢ï¼Œå¦åˆ™ä»webè·¯å¾„ä¸‹æŸ¥è¯¢ã€‚ å±æ€§ valueï¼šç”¨äºæŒ‡å®šè¯·æ±‚çš„URLã€‚å®ƒå’Œpathå±æ€§çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ methodï¼šç”¨äºæŒ‡å®šè¯·æ±‚çš„æ–¹å¼ paramsï¼šç”¨äºæŒ‡å®šé™åˆ¶è¯·æ±‚å‚æ•°çš„æ¡ä»¶ã€‚å®ƒæ”¯æŒç®€å•çš„è¡¨è¾¾å¼ã€‚è¦æ±‚è¯·æ±‚å‚æ•°çš„keyå’Œvaueå¿…é¡»å’Œé…ç½®çš„ä¸€æ¨¡ä¸€æ · MVCå‘½åç©ºé—´å¼•å…¥12345&lt;!-- å‘½åç©ºé—´ --&gt;xmlns:context=&quot;http://www.springframework.org/schema/context&quot;xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;&lt;!-- çº¦æŸåœ°å€ --&gt;http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; ç»„ä»¶æ‰«æ1&lt;context:component-scan base-package=&quot;com.myspring.controller&quot;/&gt; XMLé…ç½®returné‡å®šä¹‰ä¸è¯·æ±‚è½¬å‘12return &quot;forward:/success.jsp&quot;;return &quot;redirect:/success.jsp&quot;; å†…éƒ¨èµ„æºï¼ˆè§†å›¾ï¼‰è§£æå™¨ åœ¨spring-mvc.xmlä¸­é…ç½®å¦‚ä¸‹ 12345678910111213&lt;!-- å†…éƒ¨èµ„æºè§£æå™¨ --&gt;&lt;bean id=&quot;viewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt; &lt;!-- é…ç½®å‰ç¼€ --&gt; &lt;property name=&quot;prefix&quot; value=&quot;/jsp/&quot;/&gt; &lt;!-- é…ç½®åç¼€ --&gt; &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;&lt;/bean&gt;2. ç¼–å†™controller ```java // return &quot;/jsp/success.jsp&quot;; return &quot;success&quot; //æ•ˆæœä¸ä¸Šè¿°ç›¸åŒ SpringMVCæ•°æ®å“åº”é¡µé¢è·³è½¬è¿”å›å­—ç¬¦ä¸²1return &quot;/jsp/success.jsp&quot;; è¿”å›ModelAndviewå¯¹è±¡åœ¨controllerä¸­ç¼–å†™å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829// ç¬¬ä¸€ç§@RequestMapping(&quot;/myController1&quot;)public ModelAndView save2() &#123; ModelAndView modelAndView = new ModelAndView(); // è®¾ç½®è§†å›¾ modelAndView.setViewName(&quot;success&quot;); // è®¾ç½®æ¨¡å‹ modelAndView.addObject(&quot;username&quot;, &quot;qqq&quot;); return modelAndView;&#125;// ç¬¬äºŒç§@RequestMapping(&quot;/myController2&quot;)public ModelAndView save3(ModelAndView modelAndView) &#123; modelAndView.setViewName(&quot;success&quot;); modelAndView.addObject(&quot;username&quot;, &quot;qqq&quot;); return modelAndView;&#125;// ç¬¬ä¸‰ç§@RequestMapping(&quot;/myController3&quot;)public ModelAndView save4(Model model) &#123; model.setAttribute(&quot;username&quot;, &quot;qqq&quot;); return &quot;success&quot;;&#125;// ç¬¬å››ç§@RequestMapping(&quot;/myController4&quot;)public String save4(HttpServletRequest request) &#123; request.setAttribute(&quot;username&quot;, &quot;qqq&quot;); return &quot;success&quot;;&#125; å›å†™æ•°æ®è¿”å›å­—ç¬¦ä¸²ï¼ˆ@ResponseBodyï¼‰1234567891011// ç¬¬ä¸€ç§@RequestMapping(&quot;/myController1&quot;)public void save1(HttpServletResponse resp) throws IOException &#123; resp.getWriter().print(&quot;hello!!!&quot;);&#125;// ç¬¬äºŒç§,ä½¿ç”¨ResponseBodyï¼Œç”¨äºåŒºåˆ†é¡µé¢è·³è½¬@RequestMapping(&quot;/myController2&quot;)@ResponseBodypublic String save2() &#123; return &quot;hello!!!&quot;;&#125; è¿”å›JSONæ ¼å¼å­—ç¬¦ä¸² æ·»åŠ ä¾èµ– 1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-core&lt;/artifactId&gt; &lt;version&gt;2.11.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;2.11.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt; &lt;version&gt;2.11.2&lt;/version&gt;&lt;/dependency&gt; è½¬æ¢ä¸ºJSON 1234567891011@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic String save() throws Exception &#123; // è·å¾—bean User user = new User(); user.setName(&quot;å¼ ä¸‰&quot;); user.setAge(18); // è½¬æ¢ä¸ºJSON String userJson = new ObjectMapper().writeValueAsString(user); return userJson;&#125; è¿”å›Springè‡ªåŠ¨è½¬æ¢Bean-&gt;JSON é…ç½®spring-mvc.xml 12345678&lt;!-- å¤„ç†å™¨æ˜ å°„å™¨ --&gt;&lt;bean class=&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;&gt; &lt;property name=&quot;messageConverters&quot;&gt; &lt;list&gt; &lt;bean class=&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;/&gt; &lt;/list&gt; &lt;/property&gt;&lt;/bean&gt; æˆ–è€…ä½¿ç”¨mvcæ³¨è§£é©±åŠ¨å¦‚ä¸‹é…ç½®ï¼š 123456xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&lt;!-- mvcæ³¨è§£é©±åŠ¨ --&gt;&lt;mvc:annotation-driven/&gt; ç¼–å†™controller 123456789// ç¬¬äºŒç§,ä½¿ç”¨ResponseBodyï¼Œç”¨äºåŒºåˆ†é¡µé¢è·³è½¬@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic User save() throws Exception &#123; User user = new User(); user.setName(&quot;å¼ ä¸‰&quot;); user.setAge(18); return user;&#125; SpringMVCè¯·æ±‚è·å–è¯·æ±‚å‚æ•°è·å–åŸºæœ¬ç±»å‹å‚æ•°1234567@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(String username, int age) &#123; // ä½¿ç”¨å½¢å‚æ¥æ”¶æ•°æ®ï¼Œæ³¨æ„æ­¤å¤„å‚æ•°åä¸è¡¨å•ä¸­inputçš„nameå€¼å¯¹åº” System.out.println(username); System.out.println(age);&#125; è·å–Beanç±»å‹å‚æ•°123456@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(User user) &#123; // å®é™…ä¸Šæ˜¯ä½¿ç”¨äº†Beanå¯¹è±¡é‡Œçš„setæ–¹æ³•ï¼Œæ‰€ä»¥è¦è®©å‚æ•°çš„åå­—ä¸setæ–¹æ³•åå¯¹åº”ï¼Œå¦åˆ™æ¥æ”¶ä¸åˆ° System.out.println(user);&#125; è·å–æ•°æ®ç±»å‹å‚æ•°12345@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(String[] strs) &#123; System.out.println(Arrays.toString(strs));&#125; è·å–é›†åˆç±»å‹å‚æ•° å‰ç«¯ä¼ è¾“æ•°æ® 123456789101112&lt;script src=&quot;$&#123;pageContext.request.contextPath&#125;/js/jquery-1.7.2.min.js&quot;&gt;&lt;/script&gt;&lt;script&gt; var userList = new Array(); userList.push(&#123;name: &quot;å¼ ä¸‰&quot;, age: 10&#125;); userList.push(&#123;name: &quot;æå››&quot;, age: 20&#125;); $.ajax(&#123; type: &quot;POST&quot;, url: &quot;$&#123;pageContext.request.contextPath&#125;/test/myController&quot;, data: JSON.stringify(userList), contentType: &quot;application/json;charset=utf-8&quot; &#125;)&lt;/script&gt; controllerè·å¾—æ•°æ® 123456@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(@RequestBody List&lt;User&gt; userList) &#123; // æ³¨æ„ @RequestBody List&lt;User&gt; userList System.out.println(userList);&#125; é™æ€èµ„æºè®¿é—®æƒé™å¼€æ”¾spring-mvc.xmlä¸­é…ç½®å¦‚ä¸‹ 1234&lt;!-- å¼€æ”¾èµ„æºè®¿é—®ï¼Œè®¾ç½®å¯è®¿é—®åœ°å€ --&gt;&lt;mvc:resources mapping=&quot;/js/**&quot; location=&quot;/js/&quot;/&gt;&lt;!-- è¯¥æ ‡ç­¾è¡¨ç¤ºå½“springæ‰¾ä¸åˆ°æ—¶äº¤ç”±åŸå§‹å®¹å™¨(tomcat)å¯»æ‰¾ --&gt;&lt;mvc:default-servlet-handler/&gt; å…¨å±€ç¼–ç è¿‡æ»¤ï¼ˆé˜²æ­¢ä¸­æ–‡ä¹±ç ï¼‰12345678910111213&lt;!-- å…¨å±€ç¼–ç è¿‡æ»¤ --&gt;&lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;utf-8&lt;/param-value&gt; &lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt; å‚æ•°ç»‘å®šæ³¨è§£@RequestParam value: ä¸è¯·æ±‚å‚æ•°åç§° required: æ­¤åœ¨æŒ‡å®šçš„è¯·æ±‚å‚æ•°æ˜¯å¦å¿…é¡»åŒ…æ‹¬,é»˜è®¤æ˜¯true,æäº¤æ—¶å¦‚æœæ²¡æœ‰æ­¤å‚æ•°åˆ™æŠ¥é”™ defaultvalue: å½“æ²¡æœ‰æŒ‡å®šè¯·æ±‚å‚æ•°æ—¶,åˆ™ä½¿ç”¨æŒ‡å®šçš„é»˜è®¤å€¼èµ‹å€¼ 123456@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(@RequestParam(value=&quot;name&quot;, required=falseï¼Œdefaultvalue=&quot;000&quot;) String username) &#123; // å°†è·å¾—çš„å‚æ•°nameæ˜ å°„ä¸ºæ‰€éœ€è¦çš„username System.out.println(username);&#125; è·å¾—Restfilé£æ ¼å‚æ•° Restfulæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ã€è®¾è®¡é£æ ¼,è€Œä¸æ˜¯æ ‡å‡†,åªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚ä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’ç±»çš„è½¯ä»¶,åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´,æ›´æœ‰å±‚æ¬¡,æ›´æ˜“äºå®ç°ç¼“å­˜æœºåˆ¶ç­‰ã€‚ Restfulé£æ ¼çš„è¯·æ±‚æ˜¯ä½¿ç”¨â€œâ€ur+è¯·æ±‚æ–¹å¼â€è¡¨ç¤ºæ¬¡è¯·æ±‚ç›®çš„çš„,HTPåè®®é‡Œé¢å››ä¸ªè¡¨ç¤ºæ“ä½œæ–¹å¼çš„åŠ¨è¯å¦‚ä¸‹ï¼š GET: ç”¨äºè·å–èµ„æº POST: ç”¨äºæ–°å»ºèµ„æº PUT: ç”¨äºæ›´æ–°èµ„æº DELETE: ç”¨äºåˆ é™¤èµ„æº 123456@RequestMapping(&quot;/myController/&#123;name&#125;&quot;)// ä½¿ç”¨å ä½ç¬¦&#123;&#125;@ResponseBodypublic void save(@PathVariable(&quot;name&quot;) String username) &#123; System.out.println(username);&#125; è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili è·å¾—è¯·æ±‚å¤´@RequestHeader æ–‡ä»¶ä¸Šä¼  å¯¼å…¥ä¾èµ– 1234567891011dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;2.6&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;version&gt;1.4&lt;/version&gt;&lt;/dependency&gt; åœ¨spring-mvc.xmlä¸­é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨ 12345678&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt; &lt;!-- ä¸Šä¼ æ–‡ä»¶çš„ç¼–ç ç±»å‹ --&gt; &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot;/&gt; &lt;!-- ä¸Šä¼ æ–‡ä»¶æ€»å¤§å° --&gt; &lt;property name=&quot;maxUploadSize&quot; value=&quot;5242800&quot;/&gt; &lt;!-- ä¸Šä¼ å•ä¸ªæ–‡ä»¶çš„å¤§å° --&gt; &lt;property name=&quot;maxUploadSizePerFile&quot; value=&quot;5242800&quot;/&gt;&lt;/bean&gt; ç¼–å†™controller 12345@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(MultipartFile uploadedFile) throws Exception &#123; uploadedFile.transferTo(new File(&quot;C:\\\\Users\\\\å¢èŸ\\\\Desktop\\\\&quot; + uploadedFile.getOriginalFilename()));&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@RequestMapping(&quot;/myController&quot;)@ResponseBodypublic void save(MultipartFile[] files) throws Exception &#123; for (MultipartFile file : files) &#123; file.transferTo(new File(&quot;C:\\\\Users\\\\å¢èŸ\\\\Desktop\\\\&quot; + file.getOriginalFilename())); &#125;&#125;## SpringMVCæ‹¦æˆªå™¨interceptor&gt; Spring Mvcçš„æ‹¦æˆªå™¨ç±»ä¼¼äº Servletå¼€å‘ä¸­çš„è¿‡æ»¤å™¨ Filter,ç”¨äºå¯¹å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†å’Œåå¤„ç†ã€‚&gt;&gt; å°†æ‹¦æˆªå™¨æŒ‰ä¸€å®šçš„é¡ºåºè”ç»“æˆæ¡é“¾,è¿™æ¡é“¾ç§°ä¸ºæ‹¦æˆªå™¨é“¾( interceptor Chain)ã€‚åœ¨è®¿é—®è¢«æ‹¦æˆªçš„æ–¹æ³•æˆ–å­—æ®µæ—¶,æ‹¦æˆªå™¨é“¾ä¸­çš„æ‹¦æˆªå™¨å°±ä¼šæŒ‰å…¶ä¹‹å‰å®šä¹‰çš„é¡ºåºè¢«è°ƒç”¨ã€‚æ‹¦æˆªå™¨ä¹Ÿæ˜¯AOPæ€æƒ³çš„å…·ä½“å®ç°ã€‚### å¼€å‘æ­¥éª¤1. ç¼–å†™interceptor ```java public class MyInterceptor implements HandlerInterceptor &#123; // åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle&quot;); String param = request.getParameter(&quot;param&quot;); if (&quot;yes&quot;.equals(param)) &#123; return true; &#125; else &#123; request.getRequestDispatcher(&quot;/index.jsp&quot;).forward(request, response); return false; &#125; &#125; // åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åï¼Œè¯•å›¾è¿”å›ä¹‹å‰æ‰§è¡Œ @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle&quot;); // å¯ä»¥å¯¹modelè¿›è¡Œä¿®æ”¹ modelAndView.addObject(&quot;name&quot;, &quot;newName&quot;); &#125; // åœ¨æµç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰§è¡Œ @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion&quot;); &#125; &#125; åœ¨spring-mvc.xmlä¸­é…ç½®interceptor 123456789101112131415&lt;mvc:interceptors&gt; &lt;!-- å¯¹åº”æ‰§è¡Œé¡ºåº --&gt; &lt;mvc:interceptor&gt; &lt;!-- å¯¹å“ªäº›èµ„æºæ‰§è¡Œæ‹¦æˆªæ“ä½œ --&gt; &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;!-- å¯¹åº”interceptor --&gt; &lt;bean class=&quot;com.myspring.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;mvc:interceptor&gt; &lt;!-- å¯¹å“ªäº›èµ„æºæ‰§è¡Œæ‹¦æˆªæ“ä½œ --&gt; &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;!-- å¯¹åº”interceptor --&gt; &lt;bean class=&quot;com.myspring.interceptor.MyInterceptor2&quot;/&gt; &lt;/mvc:interceptor&gt;&lt;/mvc:interceptors&gt; æ–¹æ³•è¯´æ˜ SpringMVCå¼‚å¸¸å¤„ç†ç®€å•å¼‚å¸¸å¤„ç†å™¨1234567891011&lt;bean class=&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;&gt; &lt;!-- é»˜è®¤é”™è¯¯è§†å›¾ --&gt; &lt;property name=&quot;defaultErrorView&quot; value=&quot;error1&quot;/&gt; &lt;property name=&quot;exceptionMappings&quot;&gt; &lt;map&gt; &lt;!-- key:å¼‚å¸¸ç±»å‹ value:é”™è¯¯è§†å›¾ --&gt; &lt;entry key=&quot;java.lang.ClassCastException&quot; value=&quot;error2&quot;/&gt; &lt;entry key=&quot;java.io.IOException&quot; value=&quot;error3&quot;/&gt; &lt;/map&gt; &lt;/property&gt;&lt;/bean&gt; è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨ é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili 1listener","categories":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"},{"name":"SpringMVC","slug":"SpringMVC","permalink":"http://example.com/tags/SpringMVC/"}]},{"title":"ã€å­¦ä¹ ç¬”è®°ã€‘Spring","slug":"ã€å­¦ä¹ ç¬”è®°ã€‘Spring","date":"2021-07-13T12:59:14.495Z","updated":"2021-09-19T07:07:36.261Z","comments":true,"path":"2021/07/13/xue-xi-bi-ji-spring/","link":"","permalink":"http://example.com/2021/07/13/xue-xi-bi-ji-spring/","excerpt":"","text":"ä»€ä¹ˆæ˜¯SpringSpringç”¨æ¥å¹²ä»€ä¹ˆ Springæ˜¯ä¸€ä¸ªæ”¯æŒå¿«é€Ÿå¼€å‘Java EEåº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—åº•å±‚å®¹å™¨å’ŒåŸºç¡€è®¾æ–½ï¼Œå¹¶å¯ä»¥å’Œå¤§é‡å¸¸ç”¨çš„å¼€æºæ¡†æ¶æ— ç¼é›†æˆã€‚ Springæ˜¯åˆ†å±‚çš„ Java SE/EEåº”ç”¨ full-stackè½»é‡çº§å¼€æºæ¡†æ¶,ä»¥loC(Inverse of Control:åè½¬æ§åˆ¶)å’ŒAop(Aspect Oriented Programming:é¢å‘åˆ‡é¢ç¼–ç¨‹)ä¸ºå†…æ ¸ã€‚ æä¾›äº†å±•ç°å±‚ Spring MVCå’ŒæŒä¹…å±‚ Spring JDBCTemplateä»¥åŠä¸šåŠ¡å±‚äº‹åŠ¡ç®¡ç†ç­‰ä¼—å¤šçš„ä¼ä¸šçº§åº”ç”¨æŠ€æœ¯ï¼Œè¿˜èƒ½æ•´åˆå¼€æºä¸–ç•Œä¼—å¤šè‘—åçš„ç¬¬ä¸‰æ–¹æ¡†æ¶å’Œç±»åº“,é€æ¸æˆä¸ºä½¿ç”¨æœ€å¤šçš„ Java EEä¼ä¸šåº”ç”¨å¼€æºæ¡†æ¶ã€‚ Springå‘å±•å†ç¨‹ 1997å¹´,BMæå‡ºäº†EBçš„æ€æƒ³1998å¹´,SUNåˆ¶å®šå¼€å‘æ ‡å‡†è§„èŒƒEä¸¿B1.01999å¹´,EB1.1å‘å¸ƒ2001å¹´,EB2.0å‘å¸ƒ2003å¹´,EB2.1å‘å¸ƒ2006å¹´,EB3.0å‘å¸ƒ Springä¹‹çˆ¶ Rod Johnson( Springä¹‹çˆ¶) ã€ŠExpert One-to-One J2EE Design and development(2002)ã€‹é˜è¿°äº†J2EEä½¿ç”¨EBå¼€å‘è®¾è®¡çš„ä¼˜ç‚¹åŠè§£å†³æ–¹æ¡ˆã€ŠExpert One-to-One J2EE Development without EJB(2004)ã€‹é˜è¿°äº†2Eå¼€å‘ä¸ä½¿ç”¨EBçš„è§£å†³æ–¹å¼( Springç»´å½¢) Springçš„ä¼˜åŠ¿ æ–¹ä¾¿è§£è€¦,ç®€åŒ–å¼€å‘ é€šè¿‡ Springæä¾›çš„loCå®¹å™¨,å¯ä»¥å°†å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»äº¤ç”± Springè¿›è¡Œæ§åˆ¶,é¿å…ç¡¬ç¼–ç æ‰€é€ æˆçš„è¿‡åº¦è€¦åˆã€‚ ç”¨æˆ·ä¹Ÿä¸å¿…å†ä¸ºå•ä¾‹æ¨¡å¼ç±»ã€å±æ€§æ–‡ä»¶è§£æç­‰è¿™äº›å¾ˆåº•å±‚çš„éœ€æ±‚ç¼–å†™ä»£ç ,å¯ä»¥æ›´ä¸“æ³¨äºä¸Šå±‚çš„åº”ç”¨ã€‚ AOPç¼–ç¨‹çš„æ”¯æŒ é€šè¿‡ Springçš„AOPåŠŸèƒ½,æ–¹ä¾¿è¿›è¡Œé¢å‘åˆ‡é¢ç¼–ç¨‹,è®¸å¤šä¸å®¹æ˜“ç”¨ä¼ ç»ŸOOPå®ç°çš„åŠŸèƒ½å¯ä»¥é€šè¿‡AOPè½»æ¾å®ç°ã€‚ å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ å¯ä»¥å°†æˆ‘ä»¬ä»å•è°ƒçƒ¦é—·çš„äº‹åŠ¡ç®¡ç†ä»£ç ä¸­è§£è„±å‡ºæ¥,é€šè¿‡å£°æ˜å¼æ–¹å¼çµæ´»çš„è¿›è¡Œäº‹åŠ¡ç®¡ç†,æé«˜å‘æ•ˆç‡å’Œè´¨é‡ã€‚ æ–¹ä¾¿ç¨‹åºçš„æµ‹è¯• å¯ä»¥ç”¨éå®¹å™¨ä¾èµ–çš„ç¼–ç¨‹æ–¹å¼è¿›è¡Œå‡ ä¹æ‰€æœ‰çš„æµ‹è¯•å·¥ä½œ,æµ‹è¯•ä¸å†æ˜¯æ˜‚è´µçš„æ“ä½œ,è€Œæ˜¯éšæ‰‹å¯åšçš„äº‹æƒ…ã€‚ æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ Springå¯¹å„ç§ä¼˜ç§€æ¡†æ¶( Strutsã€ Hibernateã€ Hessianã€Quartzç­‰)çš„æ”¯æŒã€‚ é™ä½ JavaEE APçš„ä½¿ç”¨éš¾åº¦ Springå¯¹ JavaEE API(å¦‚JDBCã€ JavaMailã€è¿œç¨‹è°ƒç”¨ç­‰)è¿›è¡Œäº†è–„è–„çš„å°è£…å±‚,ä½¿è¿™äº›APlçš„ä½¿ç”¨éš¾åº¦å¤§ä¸ºé™ä½ã€‚ Springä½“ç³»ç»“æ„ Springå¿«é€Ÿå¼€å‘æ­¥éª¤ å¯¼å…¥mavenä¾èµ– 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.2.8.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºSpring confé…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸å‘½åä¸ºapplicationContextï¼‰ é…ç½®å¦‚ä¸‹ 1&lt;bean id=&quot;userDao&quot; class=&quot;com.myspring.dao.impl.UserDaoImpl&quot;&gt;&lt;/bean&gt; å®ç° 1234567public class UserDaoDemo &#123; public static void main(String[] args) &#123; ApplicationContext app = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); UserDao userDao = (UserDao) app.getBean(&quot;userDao&quot;); userDao.save(); &#125;&#125; Springé…ç½®æ–‡ä»¶Beanæ ‡ç­¾ ç”¨äºé…ç½®å¯¹è±¡äº¤ç”± Springæ¥åˆ›å»ºã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒè°ƒç”¨çš„æ˜¯ç±»ä¸­çš„**æ— å‚æ„é€ å‡½æ•°,**å¦‚æœæ²¡æœ‰æ— å‚æ„é€ å‡½æ•°åˆ™ä¸èƒ½åˆ›å»ºæˆåŠŸã€‚ åŸºæœ¬å±æ€§ id: Beanå®ä¾‹åœ¨ Springå®¹å™¨ä¸­çš„å”¯ä¸€æ ‡è¯† class: Beançš„å…¨é™å®šåç§° scopeï¼šæŒ‡å¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼Œå–å€¼å¦‚ä¸‹ singletonã€prototypeä¸‹beanå¯¹è±¡çš„ä¸åŒåˆ›å»ºæ—¶é—´singletonã€prototypeä¸‹beanå¯¹è±¡çš„ä¸åŒåˆ›å»ºæ—¶é—´ Beanå®ä¾‹åŒ–ä¸‰ç§æ–¹æ³• æ— å‚æ„é€ æ–¹æ³•å®ä¾‹åŒ– 1234// åˆ›å»ºå®¹å™¨ApplicationContext app = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);// ä»å®¹å™¨ä¸­è·å¾—å¯¹è±¡UserDao userDao = (UserDao) app.getBean(&quot;userDao&quot;); å·¥å‚é™æ€æ–¹æ³•å®ä¾‹åŒ– å·¥å‚å®ä¾‹æ–¹æ³•å®ä¾‹åŒ– æ¼”ç¤ºè§†é¢‘ Beançš„ä¾èµ–æ³¨å…¥ ä¾èµ–æ³¨å…¥( Dependency Injection)ï¼šå®ƒæ˜¯ Springæ¡†æ¶æ ¸å¿ƒ|OCçš„å…·ä½“å®ç°åœ¨ç¼–å†™ç¨‹åºæ—¶,é€šè¿‡æ§åˆ¶åè½¬,æŠŠå¯¹è±¡çš„åˆ›å¥å»ºäº¤ç»™äº† Spring,ä½†æ˜¯ä»£ç ä¸­ä¸å¯èƒ½å‡ºç°æ²¡æœ‰ä¾èµ–çš„æƒ…å†µã€‚OCè§£è€¦åªæ˜¯é™ä½ä»–ä»¬çš„ä¾èµ–å…³ç³»,ä½†ä¸ä¼šæ¶ˆé™¤ã€‚ä¾‹å¦‚:ä¸šåŠ¡å±‚ä»ä¼šè°ƒç”¨æŒä¹…å±‚çš„æ–¹æ³•ã€‚é‚£è¿™ç§ä¸šåŠ¡å±‚å’ŒæŒä¹…å±‚çš„ä¾èµ–å…³ç³»,åœ¨ä½¿ç”¨ Springä¹‹å,å°±è®© Springæ¥ç»´æŠ¤äº†ç®€å•çš„è¯´,å°±æ˜¯åç­‰æ¡†æ¶æŠŠæŒä¹…å±‚å¯¹è±¡ä¼ å…¥ä¸šåŠ¡å±‚,è€Œä¸ç”¨æˆ‘ä»¬è‡ªå·±å»è·å–ã€‚ setæ–¹æ³•ï¼ˆpropertyæ ‡ç­¾ï¼‰12345678&lt;!-- ç¬¬ä¸€ç§ --&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.myspring.service.impl.UserServiceImpl&quot; &gt; &lt;!-- nameå±æ€§å€¼å¯¹åº”setæ–¹æ³•å --&gt; &lt;property name=&quot;userDao&quot; ref=&quot;userDao&quot;&gt; &lt;/property&gt;&lt;/bean&gt;&lt;!-- ç¬¬äºŒç§ --&gt;xmlns:p=&quot;http://www.springframework.org/schema/p&quot;&lt;bean id=&quot;userService&quot; class=&quot;com.myspring.service.impl.UserServiceImpl&quot; p:userDao-ref=&quot;userDao&quot; /&gt; 123456// UserServiceImplä¸­ä¾èµ–æ³¨å…¥ï¼Œè·å¾—userDaoå¯¹è±¡private UserDao userDao;// setæ–¹æ³•public void setUserDao(UserDao userDao) &#123; this.userDao = userDao;&#125; æ„é€ ï¼ˆæœ‰å‚ï¼‰æ–¹æ³•ï¼ˆconstructor-argæ ‡ç­¾ï¼‰1234&lt;bean id=&quot;userService&quot; class=&quot;com.myspring.service.impl.UserServiceImpl&quot; &gt; &lt;!-- nameå±æ€§å€¼å¯¹åº”userServiceImplå†…UserDaoçš„å±æ€§å --&gt; &lt;constructor-arg name=&quot;userDao&quot; ref=&quot;userDao&quot;&gt;&lt;/constructor-arg&gt;&lt;/bean&gt; 123456// ä¾èµ–æ³¨å…¥ï¼Œè·å¾—userDaoå¯¹è±¡private UserDao userDao;// æ„é€ æ–¹æ³•public UserServiceImpl(UserDao userDao) &#123; this.userDao = userDao;&#125; æ³¨å…¥æ•°æ®çš„æ•°æ®ç±»å‹ æ™®é€šæ•°æ®ç±»å‹ å¼•ç”¨æ•°æ®ç±»å‹ é›†åˆæ•°æ®ç±»å‹ æ¼”ç¤ºè§†é¢‘ åˆ†æ¨¡å—å¼€å‘ï¼ˆimportæ ‡ç­¾ï¼‰ å®é™…å¼€å‘ä¸­, Springçš„é…ç½®å†…å®¹éå¸¸å¤š,è¿™å°±å¯¼è‡´ Springé…ç½®å¾ˆç¹æ‚ä¸”ä½“ç§¯å¾ˆå¤§,æ‰€ä»¥,å¯ä»¥å°†éƒ¨åˆ†é…ç½®æ‹†è§£åˆ°å…¶ä»–é…ç½®æ–‡ä»¶ä¸­,è€Œåœ¨ Springä¸»é…ç½®æ–‡ä»¶é€šè¿‡imporæ ‡ç­¾è¿›è¡ŒåŠ è½½ã€‚ 1&lt;import resource=&quot;applicationContext-user.xml&quot;&gt;&lt;/import&gt; Springç›¸å…³APIApplicationContext application Contextï¼šæ¥å£ç±»å‹,ä»£è¡¨åº”ç”¨ä¸Šä¸‹æ–‡,å¯ä»¥é€šè¿‡å…¶å®ä¾‹è·å¾— Springå®¹å™¨ä¸­çš„Beanå¯¹è±¡ ä¸‰ç§å®ç°ç±» ClassPathXmlApplicationContextå®ƒæ˜¯ä»ç±»çš„æ ¹è·¯å¾„ä¸‹åŠ è½½é…ç½®æ–‡ä»¶æ¨èä½¿ç”¨è¿™ç§ FileSystemXmlApplicationContextå®ƒæ˜¯ä»ç£ç›˜è·¯å¾„ä¸ŠåŠ è½½é…ç½®æ–‡ä»¶,é…ç½®æ–‡ä»¶å¯ä»¥åœ¨ç£ç›˜çš„ä»»æ„ä½ç½®ã€‚ AnnotationConfigApplicationContextå½“ä½¿ç”¨æ³¨è§£é…ç½®å®¹å™¨å¯¹è±¡æ—¶,éœ€è¦ä½¿ç”¨æ­¤ç±»æ¥åˆ›å»º springå®¹å™¨ã€‚å®ƒç”¨æ¥è¯»å–æ³¨è§£ã€‚ getBean()æ–¹æ³• 12UserService userService1 = (UserService) app.getBean(&quot;userService&quot;);UserService userService2 = app.getBean(UserService.class); Springé…ç½®æ•°æ®æºæ•°æ®æºï¼ˆè¿æ¥æ± ï¼‰çš„ä½œç”¨ æ•°æ®æº(è¿æ¥æ± )æ˜¯æé«˜ç¨‹åºæ€§èƒ½å¦‚å‡ºç°çš„ äº‹å…ˆå®ä¾‹åŒ–æ•°æ®æº,åˆå§‹åŒ–éƒ¨åˆ†è¿æ¥èµ„æº ä½¿ç”¨è¿æ¥èµ„æºæ—¶ä»æ•°æ®æºä¸­è·å– ä½¿ç”¨å®Œæ¯•åå°†è¿æ¥èµ„æºå½’è¿˜ç»™æ•°æ®æº æ‰‹åŠ¨åˆ›å»ºæ•°æ®æºçš„å¼€å‘æ­¥éª¤ å¯¼å…¥Mavenä¾èµ– 1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.46&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;c3p0&lt;/groupId&gt; &lt;artifactId&gt;c3p0&lt;/artifactId&gt; &lt;version&gt;0.9.1.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.6&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºjdbc.properties 1234jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/æ•°æ®åº“åjdbc.username=rootjdbc.password=123456789 åŠ è½½propertiesé…ç½®æ–‡ä»¶ 12345ResourceBundle rb = ResourceBundle.getBundle(&quot;jdbc&quot;);String driver = rb.getString(&quot;jdbc.driver&quot;);String url = rb.getString(&quot;jdbc.url&quot;);String username = rb.getString(&quot;jdbc.username&quot;);String password = rb.getString(&quot;jdbc.password&quot;); åˆ›å»ºæ•°æ®æº 1234567// åˆ›å»ºc3p0æ•°æ®æºComboPooledDataSource dataSource = new ComboPooledDataSource();dataSource.setDriverClass(driver);dataSource.setJdbcUrl(url);dataSource.setUser(username);dataSource.setPassword(password);Connection connection = dataSource.getConnection(); 1234567// åˆ›å»ºDruidæ•°æ®æºDruidDataSource dataSource = new DruidDataSource();dataSource.setDriverClassName(driver);dataSource.setUrl(url);dataSource.setUsername(username);dataSource.setPassword(password);DruidPooledConnection connection = dataSource.getConnection(); ä½¿ç”¨Springåˆ›å»ºæ•°æ®æºçš„å¼€å‘æ­¥éª¤ å¯¼å…¥ç›¸å…³ä¾èµ– åœ¨applicationContextä¸­é…ç½®æ•°æ®æºbean 12345678910111213141516171819202122&lt;!-- å¼•å…¥contextå‘½åç©ºé—´å’Œçº¦æŸè·¯å¾„ --&gt;xmlns:context=&quot;http://www.springframework.org/schema/context&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;&lt;!-- åŠ è½½å¤–éƒ¨çš„propertiesæ–‡ä»¶ --&gt;&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot; /&gt;&lt;!-- c3p0 --&gt;&lt;bean id=&quot;dataSource1&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt; &lt;property name=&quot;driverClass&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;jdbcUrl&quot; value=&quot;$&#123;jdbc.url&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;user&quot; value=&quot;$&#123;jdbc.username&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;&gt; &lt;/property&gt;&lt;/bean&gt;&lt;!-- Driud --&gt;&lt;bean id=&quot;dataSource2&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;&gt; &lt;/property&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;&gt; &lt;/property&gt;&lt;/bean&gt; åˆ›å»ºæ•°æ®æºå¯¹è±¡ 123ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);DataSource dataSource = applicationContext.getBean(DataSource.class);Connection connection = dataSource.getConnection(); Springæ³¨è§£å¼€å‘ SpringåŸå§‹æ³¨è§£ä¸»è¦æ˜¯æ›¿ä»£çš„é…ç½® åŸå§‹æ³¨è§£ ç»„ä»¶æ‰«æä½¿ç”¨æ³¨è§£è¿›è¡Œå¼€å‘æ—¶,éœ€è¦åœ¨ applicationContext. xmä¸­é…ç½®ç»„ä»¶æ‰«æ,ä½œç”¨æ˜¯æŒ‡å®šå“ªä¸ªåŒ…åŠå…¶å­åŒ…ä¸‹çš„Beanï¼Œéœ€è¦è¿›è¡Œæ‰«æä»¥ä¾¿è¯†åˆ«ä½¿ç”¨æ³¨è§£é…ç½®çš„ç±»ã€å­—æ®µå’Œæ–¹æ³•ã€‚ 12&lt;!-- é…ç½®ç»„ä»¶æ‰«æ --&gt;&lt;context:component-scan base-package=&quot;com.myspring&quot;/&gt; Daoç±»12&lt;!-- é…ç½®æ–‡ä»¶ --&gt;&lt;bean id=&quot;userDao&quot; class=&quot;com.myspring.dao.impl.UserDaoImpl&quot; scope=&quot;prototype&quot;&gt; &lt;/bean&gt; 1234// æ³¨è§£é…ç½®ï¼Œå†™åœ¨ç±»åä¹‹ä¸Š@Component(&quot;userDao&quot;)// ç¬¬äºŒç§å¯è¯»æ€§æ›´å¼º@Repository(&quot;userDao&quot;) Serviceç±»1234&lt;!-- é…ç½®æ–‡ä»¶ --&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.myspring.service.impl.UserServiceImpl&quot; &gt; &lt;property name=&quot;userDao&quot; ref=&quot;userDao&quot; /&gt;&lt;/bean&gt; 1234// æ³¨è§£é…ç½®ï¼Œå†™åœ¨ç±»åä¹‹ä¸Š@Component(&quot;userService&quot;)// ç¬¬äºŒç§å¯è¯»æ€§æ›´å¼º@Service(&quot;userService&quot;) 1234567891011// æ³¨è§£é…ç½®ï¼Œå†™åœ¨å­—æ®µä¹‹å‰// Autowiredä»springå®¹å™¨ä¸­æ ¹æ® æ•°æ®ç±»å‹ è¿›è¡ŒåŒ¹é…ï¼Œæ‰€ä»¥åŒä¸€æ•°æ®ç±»å‹åªæœ‰å•ä¸ªbeanå¯ä»¥åªå†™Autowired@Autowired// Qualifierä»springå®¹å™¨ä¸­æ ¹æ® idå€¼ç±»å‹ è¿›è¡ŒåŒ¹é…ï¼Œä½†æ˜¯å¿…é¡»ç»“åˆAutowiredä¸€èµ·ä½¿ç”¨@Qualifier(&quot;userDao&quot;)// @Resource(name = &quot;userDao&quot;) ç›¸å½“äºå‰ä¸¤è€…ç»“åˆprivate UserDao userDao;// æ­¤æ—¶ç±»ä¸­å¯ä»¥ä¸å†™setæ–¹æ³•public void setUserDao(UserDao userDao) &#123; this.userDao = userDao;&#125; æ™®é€šå±æ€§æ³¨å…¥12@Value(&quot;$&#123;jdbc.driver&#125;&quot;)private String driver; æ–°æ³¨è§£ æ•´åˆåœ¨ä¸€èµ·çš„æ ·å­ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223@Configuration // æ ‡å¿—è¯¥ç±»æ˜¯Springçš„æ ¸å¿ƒé…ç½®ç±»@ComponentScan(&quot;com.myspring&quot;) // é…ç½®ç»„ä»¶æ‰«æ,æ›¿æ¢&lt;context:component-scan base-package=&quot;com.myspring&quot;/&gt;@PropertySource(&quot;classpath:jdbc.properties&quot;) // åŠ è½½å¤–éƒ¨çš„propertiesæ–‡ä»¶,æ›¿æ¢&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;public class SpringConfiguration &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String username; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; @Bean(&quot;dataSource&quot;) // springä¼šå°†å½“å‰æ–¹æ³•çš„è¿”å›å€¼ä»¥æŒ‡å®šåç§°å­˜å‚¨åˆ°springå®¹å™¨å½“ä¸­ public DataSource getDataSource() &#123; DruidDataSource dataSource = new DruidDataSource(); dataSource.setDriverClassName(driver); dataSource.setUrl(url); dataSource.setUsername(username); dataSource.setPassword(password); return dataSource; &#125;&#125; åˆ†æ¨¡å—å¦‚ä¸‹ï¼ˆæ¨èï¼‰ï¼š 123456@Configuration // æ ‡å¿—è¯¥ç±»æ˜¯Springçš„æ ¸å¿ƒé…ç½®ç±»@ComponentScan(&quot;com.myspring&quot;) // é…ç½®ç»„ä»¶æ‰«æ,æ›¿æ¢&lt;context:component-scan base-package=&quot;com.myspring&quot;/&gt;@Import(&#123;DataSourceConfiguration.class,&#125;) //æ‹¬å·å†…å†™æ•°ç»„&#123;xxx.class,xxx.class&#125;,æ›¿æ¢&lt;import resource=&quot;&quot;/&gt;public class SpringConfiguration &#123; &#125; 123456789101112131415161718192021@PropertySource(&quot;classpath:jdbc.properties&quot;) // åŠ è½½å¤–éƒ¨çš„propertiesæ–‡ä»¶,æ›¿æ¢&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;public class DataSourceConfiguration &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String username; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; @Bean(&quot;dataSource&quot;) // springä¼šå°†å½“å‰æ–¹æ³•çš„è¿”å›å€¼ä»¥æŒ‡å®šåç§°å­˜å‚¨åˆ°springå®¹å™¨å½“ä¸­ public DataSource getDataSource() &#123; DruidDataSource dataSource = new DruidDataSource(); dataSource.setDriverClassName(driver); dataSource.setUrl(url); dataSource.setUsername(username); dataSource.setPassword(password); return dataSource; &#125;&#125; Springé›†æˆjunit æ·»åŠ ä¾èµ– 1234567891011&lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.13.1&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.3.RELEASE&lt;/version&gt;&lt;/dependency&gt; ç¼–å†™æµ‹è¯•ç±» 123456789101112@RunWith(SpringJUnit4ClassRunner.class)// @ContextConfiguration(&quot;classpath:applicationContext.xml&quot;) // éæ³¨è§£æ–¹å¼æ³¨å…¥é…ç½®@ContextConfiguration(classes = &#123;SpringConfiguration.class&#125;) // æ³¨è§£æ–¹å¼æ³¨å…¥é…ç½®public class SpringJunitTest &#123; @Resource(name = &quot;userService&quot;) private UserService userService; @Test public void test1() &#123; userService.save(); &#125;&#125; Springé›†æˆwebç¯å¢ƒ åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡æ˜¯é€šè¿‡ new ClasspathXmlApplication Context( springé…ç½®æ–‡ä»¶)æ–¹å¼è·å–çš„,ä½†æ˜¯æ¯æ¬¡ä»å®¹å™¨ä¸­è·å¾—Beanæ—¶éƒ½è¦ç¼–å†™ new ClasspathXmlApplication Context( springé…ç½®æ–‡ä»¶),è¿™æ ·çš„å¼Šç«¯æ˜¯é…ç½®æ–‡ä»¶åŠ è½½å¤šæ¬¡,åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡åˆ›å»ºå¤šæ¬¡ã€‚ åœ¨Webé¡¹ç›®ä¸­,å¯ä»¥ä½¿ç”¨ ServletcontextListenerç›‘å¬Webåº”ç”¨çš„å¯åŠ¨,æˆ‘ä»¬å¯ä»¥åœ¨Webåº”ç”¨å¯åŠ¨æ—¶,å°±åŠ è½½ Springçš„é…ç½®æ–‡ä»¶,åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ Application Context,åœ¨å°†å…¶å­˜å‚¨åˆ°æœ€å¤§çš„åŸŸ servletContextåŸŸä¸­,è¿™æ ·å°±å¯ä»¥åœ¨ä»»æ„ä½ç½®ä»åŸŸä¸­è·å¾—åº”ç”¨ä¸Šä¸‹æ–‡ Application Contextå¯¹è±¡äº† æ‰‹åŠ¨ä½¿ç”¨listenerè·å–åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ åˆ›å»ºlistenerç±» 123456789101112131415public class ContextLoaderListener implements ServletContextListener &#123; @Override public void contextInitialized(ServletContextEvent servletContextEvent) &#123; // ApplicationContext app = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //ä½¿ç”¨éæ³¨è§£æ—¶ç”¨è¯¥æ–¹æ³•åˆ›å»º ApplicationContext app = new AnnotationConfigApplicationContext(SpringConfiguration.class); // ä½¿ç”¨æ³¨è§£æ—¶ç”¨è¯¥æ–¹æ³•åˆ›å»º // å°†Springçš„åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡å­˜å‚¨åˆ°ServletContextåŸŸå¯¹è±¡ä¸­ servletContextEvent.getServletContext().setAttribute(&quot;app&quot;, app); System.out.println(&quot;springå®¹å™¨åˆ›å»ºå®Œæ¯•&quot;); &#125; @Override public void contextDestroyed(ServletContextEvent servletContextEvent) &#123; &#125;&#125; åœ¨web.xmlä¸­é…ç½®listener 123&lt;listener&gt; &lt;listener-class&gt;com.myspring.listener.ContextLoaderListener&lt;/listener-class&gt;&lt;/listener&gt; è·å–servletContextåŸŸå¯¹è±¡ä¸­çš„åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ 1ApplicationContext app = (ApplicationContext) this.getServletContext().getAttribute(&quot;app&quot;); ä½¿ç”¨Springè·å–åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ å¯¼å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;5.2.8.RELEASE&lt;/version&gt;&lt;/dependency&gt; é…ç½®web.xml 123456789&lt;!-- è®¾ç½®å…¨å±€å‚æ•° --&gt;&lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;&lt;/context-param&gt;&lt;!-- é…ç½®ç›‘å¬å™¨ --&gt;&lt;listener&gt; &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;&lt;/listener&gt; è·å–åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ 1WebApplicationContext app = WebApplicationContextUtils.getWebApplicationContext(req.getServletContext()); JdbcTemplateæ¦‚è¿° å®ƒæ˜¯ springæ¡†æ¶ä¸­æä¾›çš„ä¸ªå¯¹è±¡,æ˜¯å¯¹åŸå§‹ç¹ççš„ dbc APIå¯¹è±¡çš„ç®€å•å°è£…ã€‚ springæ¡†æ¶ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„æ“ä½œæ¨¡æ¿ç±»ã€‚ä¾‹å¦‚:æ“ä½œå…³ç³»å‹æ•°æ®çš„ dbcTemplateå’Œ bernate Template,æ“ä½œnosqæ•°æ®åº“çš„ RedisTemplate,æ“ä½œæ¶ˆæ¯é˜Ÿåˆ—çš„ UmsTemplateç­‰ç­‰ã€‚ æ‰‹åŠ¨å¼€å‘æ­¥éª¤ æ·»åŠ ä¾èµ– 1234567891011&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.0.4.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;5.0.4.RELEASE&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºæ•°æ®åº“è¡¨å’ŒjavaBean åˆ›å»ºjdbcTemplateå¯¹è±¡ã€æ‰§è¡Œæ•°æ®åº“æ“ä½œ 12345678910111213141516public class JdbcTemplateTest &#123; @Test // æµ‹è¯•dbcTemplateå¼€å‘æ­¥éª¤ public void test() &#123; // åˆ›å»ºDruidæ•°æ®æº DruidDataSource dataSource = new DruidDataSource(); dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); dataSource.setUrl(&quot;jdbc:mysql://localhost:3306/test&quot;); dataSource.setUsername(&quot;root&quot;); dataSource.setPassword(&quot;123456789&quot;); // åˆ›å»ºjdbcTemplateå¯¹è±¡ JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource); // æ•°æ®åº“æ“ä½œ jdbcTemplate.update(&quot;insert into test1 values(?,?)&quot;, &quot;å¼ ä¸‰&quot;, 18); &#125;&#125; Springä½¿ç”¨JdbcTemplateå¼€å‘æ­¥éª¤ æ·»åŠ ä¾èµ– ç¼–å†™jdbc.propertiesæ–‡ä»¶ ç¼–å†™spring-configæ–‡ä»¶applicationContext.xmlï¼Œæ·»åŠ æ•°æ®æºå¯¹è±¡ï¼ŒjdbcTemplateå¯¹è±¡ 12345678910111213141516171819&lt;!-- å¼•å…¥contextå‘½åç©ºé—´å’Œçº¦æŸè·¯å¾„ --&gt;xmlns:context=&quot;http://www.springframework.org/schema/context&quot;xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;&lt;!-- åŠ è½½å¤–éƒ¨çš„propertiesæ–‡ä»¶ --&gt;&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;&lt;!-- Druid DataSource --&gt;&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt;&lt;/bean&gt;&lt;!-- Spring JdbcTemplate --&gt;&lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;&lt;/bean&gt; ç¼–å†™ä»£ç  123456// è·å¾—applicationContextApplicationContext app = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);// ä»å®¹å™¨ä¸­è·å¾—jdbcTemplateå¯¹è±¡JdbcTemplate jdbcTemplate = app.getBean(JdbcTemplate.class);// æ•°æ®åº“æ“ä½œjdbcTemplate.update(&quot;insert into test1 values(?,?)&quot;, &quot;å¼ ä¸‰&quot;, 18); å¸¸ç”¨æ“ä½œ1234jdbcTemplate.update(&quot;update test1 set age=? where name =?&quot;, 10, &quot;å¼ ä¸‰&quot;);List&lt;User&gt; userList = jdbcTemplate.query(&quot;select * from test1&quot;, new BeanPropertyRowMapper&lt;&gt;(User.class));User user = jdbcTemplate.queryForObject(&quot;select * from test1 where age=?&quot;, new BeanPropertyRowMapper&lt;&gt;(User.class), 18);Long count = jdbcTemplate.queryForObject(&quot;select count(*) from test1&quot;, Long.class); AOPæ¦‚è¿° AOPä¸º Aspect Oriented Programmingçš„ç¼©å†™,æ„æ€ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹,æ˜¯é€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†ç°ç¨‹åºåŠŸèƒ½çš„åŒç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚ AOPæ˜¯OOPçš„å»¶ç»­,æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹,ä¹Ÿæ˜¯ Springæ¡†æ¶ä¸­çš„ä¸ªé‡è¦å†…å®¹,æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚ ä½œç”¨ä¸ä¼˜åŠ¿é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili JDKåŠ¨æ€ä»£ç†ã€cglibåŠ¨æ€ä»£ç†é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili æ¦‚å¿µ Target(ç›®æ ‡å¯¹è±¡):ä»£ç†çš„ç›®æ ‡å¯¹è±¡ã€‚ Proxy(ä»£ç†):â€”ä¸ªç±»è¢«AOPç»‡å…¥å¢å¼ºå,å°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»ã€‚ Joinpoint(è¿æ¥ç‚¹):æ‰€è°“è¿æ¥ç‚¹æ˜¯æŒ‡é‚£äº›è¢«æ‹¦æˆªåˆ°çš„ç‚¹ã€‚åœ¨ springä¸­è¿™äº›ç‚¹æŒ‡çš„æ˜¯æ–¹æ³•,å› ä¸º springåªæ”¯æŒæ–¹æ³•ç±»å‹çš„è¿æ¥ç‚¹ã€‚ Pointcut(åˆ‡å…¥ç‚¹):æ‰€è°“åˆ‡å…¥ç‚¹æ˜¯æŒ‡æˆ‘ä»¬è¦å¯¹å“ªäº› Joinpointè¿¸è¡Œæ‹¦æˆªçš„å®šä¹‰ã€‚ Advice(é€šçŸ¥/å¢å¼º):æ‰€è°“é€šçŸ¥æ˜¯æŒ‡æ‹¦æˆªåˆ° Joinpointä¹‹åæ‰€è¦åšçš„äº‹æƒ…å°±æ˜¯é€šçŸ¥ã€‚ Aspect(åˆ‡é¢):æ˜¯åˆ‡å…¥ç‚¹å’Œé€šçŸ¥(å¼•ä»‹ä¸ª)çš„ç»“åˆã€‚ eaving(ç»‡å…¥):æ˜¯æŒ‡æŠŠå¢å¼ºåº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡æ¥åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚springé‡†ç”¨åŠ¨æ€ä»£ç†ç»‡å…¥,è€ŒAspecté‡‡ç”¨ç¼–è¯‘æœŸç»‡å…¥å’Œç±»è£…è½½æœŸç»‡å…¥ã€‚ åŸºäºXMLå¼€å‘AOPæ­¥éª¤ å¯¼å…¥ä¾èµ– 123456789101112131415&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.2.8.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;5.2.8.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.7&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºç›®æ ‡æ¥å£å’Œç›®æ ‡ç±» åˆ›å»ºåˆ‡é¢ç±»ï¼ˆå«å¢å¼ºæ–¹æ³•ï¼‰ 123456789101112public class MyAspect &#123; public void before() &#123; System.out.println(&quot;å‰ç½®å¢å¼ºã€‚ã€‚ã€‚&quot;); &#125; public Object around(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;å‰ç½®å¢å¼ºã€‚ã€‚ã€‚&quot;); Object proceed = pjp.proceed(); System.out.println(&quot;åç½®å¢å¼ºã€‚ã€‚ã€‚&quot;); return proceed; &#125;&#125; é…ç½®applicationContext.xml 12345678910111213141516xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&lt;!-- ç›®æ ‡å¯¹è±¡ --&gt;&lt;bean id=&quot;target&quot; class=&quot;com.myspring.aop.Target&quot;/&gt;&lt;!-- åˆ‡é¢å¯¹è±¡ --&gt;&lt;bean id=&quot;myAspect&quot; class=&quot;com.myspring.aop.MyAspect&quot;/&gt;&lt;!-- é…ç½®ç»‡å…¥ï¼Œå³å“ªäº›æ–¹æ³•éœ€è¦å“ªäº›å¢å¼º(å‰ç½®åç½®å¢å¼ºç­‰) --&gt;&lt;aop:config&gt; &lt;!-- å£°æ˜åˆ‡é¢ --&gt; &lt;aop:aspect ref=&quot;myAspect&quot;&gt; &lt;!-- åˆ‡ç‚¹+é€šçŸ¥(å¢å¼º) --&gt; &lt;aop:before method=&quot;before&quot; pointcut=&quot;execution(* com.myspring.aop.*.*(..))&quot;&gt;&lt;/aop:before&gt; &lt;aop:around method=&quot;around&quot; pointcut=&quot;execution(* com.myspring.aop.*.*(..))&quot;/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt; æµ‹è¯• 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(&quot;classpath:applicationContext.xml&quot;) // éæ³¨è§£æ–¹å¼æ³¨å…¥é…ç½®public class SpringJunitTest &#123; @Autowired private TargetInterface target; @Test public void test1() &#123; target.save(); &#125;&#125; åˆ‡ç‚¹è¡¨è¾¾å¼ 12345678910&lt;aop:config&gt; &lt;!-- å£°æ˜åˆ‡é¢ --&gt; &lt;aop:aspect ref=&quot;myAspect&quot;&gt; &lt;!-- åˆ‡ç‚¹è¡¨è¾¾å¼çš„æŠ½å– --&gt; &lt;aop:pointcut id=&quot;myPointcut&quot; expression=&quot;execution(* com.myspring.aop.*.*(..))&quot;/&gt; &lt;!-- åˆ‡ç‚¹+é€šçŸ¥(å¢å¼º) --&gt; &lt;aop:before method=&quot;before&quot; pointcut-ref=&quot;myPointcut&quot;/&gt; &lt;aop:around method=&quot;around&quot; pointcut-ref=&quot;myPointcut&quot;/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt; é€šçŸ¥ç±»å‹ åŸºäºæ³¨è§£å¼€å‘AOP ç›®æ ‡ç±»ã€åˆ‡é¢ç±» é…ç½®ç›®æ ‡ç±»ã€åˆ‡é¢ç±» 1234@Component(&quot;target&quot;)public class Target implements TargetInterface &#123;&#125; 12345678@Component(&quot;myAspect&quot;)@Aspect //æ ‡æ³¨å½“å‰æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»public class MyAspect &#123; @Before(&quot;execution(* com.myspring.aop.*.*(..))&quot;) public void before() &#123; System.out.println(&quot;å‰ç½®å¢å¼ºã€‚ã€‚ã€‚&quot;); &#125;&#125; é…ç½®applicationContext.xml 1234&lt;!-- æ³¨è§£å¼€å‘ç»„ä»¶æ‰«æ --&gt;&lt;context:component-scan base-package=&quot;com.myspring.aop&quot;/&gt;&lt;!-- aopè‡ªåŠ¨ä»£ç† --&gt;&lt;aop:aspectj-autoproxy/&gt; åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–12345678910111213@Component(&quot;myAspect&quot;)@Aspect //æ ‡æ³¨å½“å‰æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»public class MyAspect &#123; @Before(&quot;pointCut()&quot;) public void before() &#123; System.out.println(&quot;å‰ç½®å¢å¼ºã€‚ã€‚ã€‚&quot;); &#125; // å®šä¹‰åˆ‡ç‚¹è¡¨è¾¾å¼ @Pointcut(&quot;execution(* com.myspring.aop.*.*(..))&quot;) public void pointCut() &#123; &#125;&#125; äº‹åŠ¡æ§åˆ¶é»‘é©¬ç¨‹åºå‘˜æœ€å…¨SSMæ¡†æ¶æ•™ç¨‹|Spring+SpringMVC+MyBatiså…¨è¦†ç›–_SSMæ•´åˆ_å“”å“©å“”å“©_bilibili","categories":[{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"}],"tags":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"},{"name":"Spring","slug":"Spring","permalink":"http://example.com/tags/Spring/"}]},{"title":"ã€é›†è®­ã€‘Servlet","slug":"ã€é›†è®­ã€‘servlet","date":"2021-07-11T11:56:48.738Z","updated":"2021-07-23T05:50:22.649Z","comments":true,"path":"2021/07/11/ji-xun-servlet/","link":"","permalink":"http://example.com/2021/07/11/ji-xun-servlet/","excerpt":"","text":"ä»€ä¹ˆæ˜¯Servletï¼Ÿ Servlet æ˜¯è¿è¡Œåœ¨ Web æœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„javaç¨‹åºï¼Œæ˜¯Java EEè§„èŒƒä¹‹ä¸€ï¼ˆä¸€ç§æ¥å£ï¼‰ã€‚ å®ƒæ˜¯ä½œä¸ºæ¥è‡ª Web æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯çš„è¯·æ±‚å’Œ HTTP æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ï¼Œå³æ¥æ”¶å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚å¹¶ä¸”å“åº”æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚ ä½¿ç”¨ Servletï¼Œæ‚¨å¯ä»¥æ”¶é›†æ¥è‡ªç½‘é¡µè¡¨å•çš„ç”¨æˆ·è¾“å…¥ï¼Œå‘ˆç°æ¥è‡ªæ•°æ®åº“æˆ–è€…å…¶ä»–æºçš„è®°å½•ï¼Œè¿˜å¯ä»¥åŠ¨æ€åˆ›å»ºç½‘é¡µã€‚ ğŸ’¡é…ç½®Servlet åˆ›å»ºä¸€ä¸ªJavaç±»å¹¶å®ç°Servletæ¥å£ï¼ˆä¸€èˆ¬é€šè¿‡ç»§æ‰¿HTTPServletç±»å»å®ç°servletï¼‰ é‡å†™æ–¹æ³•ï¼Œå®ç°é€»è¾‘æ“ä½œ åœ¨web.xmlä¸­é…ç½®è¿™ä¸ªservletçš„è®¿é—®åœ°å€ 1234567891011121314&lt;!-- ç»™tomcaté…ç½®servletç›¸å…³ä¿¡æ¯ --&gt;&lt;servlet&gt; &lt;!-- å†™æ˜servletçš„åå­—ï¼ˆä¸€èˆ¬ä½¿ç”¨ç±»åå³å¯ï¼‰ --&gt; &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt; &lt;!-- å†™æ˜servletçš„å…¨ç±»å --&gt; &lt;servlet-class&gt;servlet.MyServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;!-- ç»™servleté…ç½®è®¿é—®åœ°å€ --&gt;&lt;servlet-mapping&gt; &lt;!-- å†™æ˜éœ€è¦é…ç½®è®¿é—®åœ°å€çš„servlet --&gt; &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt; &lt;!-- å†™æ˜ä¸ºè¯¥servleté…ç½®çš„è®¿é—®åœ°å€ --&gt; &lt;url-pattern&gt;/myServlet&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; &lt;url-pattern&gt;/myServlet&lt;/url-pattern&gt;æ ‡ç­¾ä¸­ / çš„ä½œç”¨ï¼šç›¸å½“äºæ‹¼æ¥åˆ° http://ip:port/å·¥ç¨‹è·¯å¾„åï¼Œå³http://ip:port/å·¥ç¨‹è·¯å¾„/myServlet HTTPåè®®ä»€ä¹ˆæ˜¯HTTPåè®® HTTPåè®®ï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯å› ç‰¹ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸€ç§ç½‘ç»œä¼ è¾“åè®®ï¼Œæ‰€æœ‰çš„WWWæ–‡ä»¶éƒ½å¿…é¡»éµå®ˆè¿™ä¸ªæ ‡å‡†ï¼Œå³å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´é€šä¿¡ã€ä¼ è¾“æ•°æ®éœ€è¦éµå®ˆçš„è§„åˆ™ã€‚ HTTPæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ é€’æ•°æ®ï¼ˆHTML æ–‡ä»¶, å›¾ç‰‡æ–‡ä»¶, æŸ¥è¯¢ç»“æœç­‰ï¼‰ã€‚ è¯·æ±‚ä¸å“åº” å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€æ•°æ®ä¸ºè¯·æ±‚ï¼Œè¯·æ±‚åˆ†ä¸ºGETã€POSTè¯·æ±‚ æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯å›ä¼ æ•°æ®ä¸ºå“åº” ğŸ’¡HTTPåè®®å†…å®¹ è¯·æ±‚/å“åº”è¡Œ è¯·æ±‚/å“åº”å¤´ï¼š å±æ€§åï¼šå±æ€§å€¼ è¯·æ±‚/å“åº”ä½“ï¼š é‡è¦ï¼Œè‡ªè¡Œé˜…è¯»å­¦ä¹  å¸¸è§å“åº”ç  200ï¼šè¡¨ç¤ºè¯·æ±‚æˆåŠŸ 302ï¼šè¡¨ç¤ºè¯·æ±‚é‡å®šå‘ 404ï¼šè¡¨ç¤ºæœåŠ¡å™¨æ‰¾ä¸åˆ°è¯¥è¯·æ±‚åœ°å€ï¼ˆåœ°å€æœ‰é”™ï¼‰ 500ï¼šè¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼ˆä»£ç æœ‰é”™ï¼‰ ğŸ’¡è¡¨å•å¤„ç†ã€å¸¸ç”¨API requestå¯¹è±¡å¸¸ç”¨æ–¹æ³• æ–¹æ³•ä»‹ç» getParameter(String name) è¿”å›nameæŒ‡å®šå‚æ•°çš„å‚æ•°å€¼ getParameterValues(String name) è¿”å›åŒ…å«å‚æ•°nameçš„æ‰€æœ‰å€¼çš„æ•°ç»„ setAttribute(String,Object) å­˜å‚¨æ­¤è¯·æ±‚ä¸­çš„å±æ€§ getAttribute(String name) è¿”å›æŒ‡å®šå±æ€§çš„å±æ€§å€¼ getContextPath() è¿”å›å½“å‰WEBé¡¹ç›®ç›¸å¯¹è·¯å¾„ getMethod() è·å–è¯·æ±‚ç±»å‹ getSession() è·å–Sessionå¯¹è±¡ getCookies() è·å–æ‰€æœ‰Cookie,è¿”å›ä¸€ä¸ªCookieæ•°ç»„ requestå¯¹è±¡å¸¸ç”¨æ–¹æ³• æ–¹æ³•ä»‹ç» setHeader() è®¾ç½®æ¶ˆæ¯å¤´ setStatus() è®¾ç½®çŠ¶æ€ç  addCookie() æ·»åŠ Cookie getWriter() è·å–é€šå‘æµè§ˆå™¨çš„å­—ç¬¦æµ è·å–/å›ä¼ æ•°æ®123456789&lt;form action=&quot;http://localhost:8080/jsp_war_exploded/myServlet&quot; method=&quot;get&quot;&gt; ç”¨æˆ·åï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt; å¯†ç ï¼š&lt;input type=&quot;text&quot; name=&quot;password&quot;&gt;&lt;br&gt; å…´è¶£çˆ±å¥½ï¼š &lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;ç”»ç”»&quot;&gt;ç”»ç”» &lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;æ‰“ç¯®çƒ&quot;&gt;æ‰“ç¯®çƒ &lt;input type=&quot;checkbox&quot; name=&quot;hobby&quot; value=&quot;æ•²ä»£ç &quot;&gt;æ•²ä»£ç  &lt;input type=&quot;submit&quot;&gt;&lt;/form&gt; 12345String username = req.getParameter(&quot;username&quot;);String password = req.getParameter(&quot;password&quot;);String[] hobby = req.getParameterValues(&quot;hobby&quot;);System.out.println(&quot;ç”¨æˆ·åï¼š&quot;+username+&quot;,å¯†ç ï¼š&quot;+password);System.out.println(Arrays.toString(hobby)); 1resp.getWriter().println(&quot;&lt;div&gt;è¿™æ˜¯ä¸€ä¸ªdiv&lt;/div&gt;&quot;); http://localhost:8080/jsp_war_exploded/myServlet?username=111&amp;password=222ä½¿ç”¨?ä¼ é€’å‚æ•° è¯·æ±‚è½¬å‘ä¸é‡å®šå‘ 1234String username = req.getParameter(&quot;username&quot;);req.setAttribute(&quot;key&quot;, &quot;MyServletå¤„ç†çš„ä¿¡æ¯:&quot;);System.out.println(&quot;MyServletä¸­çš„requestè·å¾—çš„æ•°æ®&quot;+username);req.getRequestDispatcher(&quot;/myServlet2&quot;).forward(req, resp); 123String username = req.getParameter(&quot;username&quot;);System.out.println(&quot;MyServlet2ä¸­çš„requestè·å¾—çš„æ•°æ®:&quot;+username);System.out.println(&quot;MyServlet2ä¸­æ˜¾ç¤ºä¹‹å‰å¤„ç†å¹¶ä¿å­˜çš„æ•°æ®:&quot;+req.getAttribute(&quot;key&quot;)); è¯·æ±‚è½¬å‘çš„ç‰¹ç‚¹ï¼š æµè§ˆå™¨åœ°å€æ æ²¡æœ‰å˜åŒ– ä¸€æ¬¡è¯·æ±‚ å…±äº«requestä¸­çš„æ•°æ® å¯ä»¥è½¬å‘åˆ°WEB-INFç›®å½•ä¸‹ï¼ˆå·¥ç¨‹è·¯å¾„ä¸‹ï¼‰ 1234resp.sendRedirect(req.getContextPath()+&quot;/myServlet2&quot;);// req.getContextPath()è·å¾—å½“å‰WEBé¡¹ç›®ç›¸å¯¹è·¯å¾„resp.sendRedirect(&quot;http://www.baidu.com&quot;);// è®¿é—®å¤–éƒ¨èµ„æºå¿…å†™http é‡å®šå‘çš„ç‰¹ç‚¹ï¼š æµè§ˆå™¨åœ°å€æ å‘ç”Ÿå˜åŒ– ä¸¤æ¬¡è¯·æ±‚ ä¸å…±äº«requestä¸­çš„æ•°æ® ä¸èƒ½è®¿é—®WEB-INFç›®å½•ä¸‹èµ„æº å¯ä»¥è®¿é—®å·¥ç¨‹å¤–çš„èµ„æº ğŸ’¡Filterè¿‡æ»¤å™¨è‡ªè¡Œå­¦ä¹  ä¸­æ–‡ä¹±ç é—®é¢˜12req.setCharacterEncoding(&quot;UTF-8&quot;);resp.setContentType(&quot;text/html;charset=UTF-8&quot;); ç›¸å…³é˜…è¯»ææ–™ Webå¼€å‘ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ (liaoxuefeng.com) å°šç¡…è°·æœ€æ–°ç‰ˆJavaWebå…¨å¥—æ•™ç¨‹,java webé›¶åŸºç¡€å…¥é—¨å®Œæ•´ç‰ˆ_å“”å“©å“”å“©_bilibili ä½œä¸š ç†Ÿæ‚‰servletã€jspå¹¶å®ç°ä¸€äº›åŠŸèƒ½ï¼Œå¹¶å†™ä¸€ç¯‡åšæ–‡ã€‚ åšæ–‡å†…å®¹è¦æ±‚ï¼ˆå¿…é¡»è¦æ±‚ï¼‰ï¼š å†™ä¸€ç¯‡åšæ–‡è®°å½•ä½ ä½¿ç”¨servletã€jspå®ç°åŠŸèƒ½æ—¶é‡åˆ°äº†å“ªäº›å›°éš¾ã€ä¸ç†è§£ã€ä¸çŸ¥é“è¯¥å¦‚ä½•å®ç°çš„åœ°æ–¹ï¼Œä»¥åŠå†™ä¸Šè§£å†³çš„è¿‡ç¨‹ä¸ç»“æœï¼ˆæœªè§£å†³çš„ä¹Ÿå¯ä»¥å†™ä¸Šæœ‰å“ªäº›ç–‘æƒ‘ï¼‰ï¼Œæˆ–è€…å­¦ä¹ ç¬”è®°ç­‰ç­‰çš†å¯ã€‚ åŠŸèƒ½å®ä¾‹ï¼ˆä»…å‚è€ƒï¼Œä¸æ˜¯æœ€ä½/æœ€é«˜æ ‡å‡†ï¼‰ï¼š å«æœ‰ç™»é™†/æ³¨å†Œé¡µé¢ã€å…¶ä»–é¡µé¢ã€‚ ç™»å½•åŠŸèƒ½ï¼šæ‰‹åŠ¨è¾“å…¥ä¿¡æ¯ï¼Œç¬¦åˆå·²å­˜åœ¨çš„ç”¨æˆ·ä¿¡æ¯åˆ™æˆåŠŸç™»å½•ã€‚ æ³¨å†ŒåŠŸèƒ½ï¼šæ‰‹åŠ¨è¾“å…¥ä¿¡æ¯ï¼Œä¸èƒ½é‡å¤æ³¨å†Œå·²å­˜åœ¨çš„ç”¨æˆ·åï¼Œå¦åˆ™æ³¨å†Œå¤±è´¥ã€‚ ç”¨æˆ·å±•ç¤ºï¼šåœ¨é¡µé¢ä¸Šå±•ç¤ºæ‰€æœ‰å·²ç»æ³¨å†Œçš„ç”¨æˆ·çš„ä¿¡æ¯ã€‚ ç™»é™†è¿‡æ»¤ï¼šå…¶ä»–é¡µé¢ï¼Œåªæœ‰ç™»é™†æˆåŠŸåæ‰å¯è®¿é—®ï¼Œå¦åˆ™è·³è½¬è‡³ç™»é™†é¡µé¢ã€‚ å…¶ä»–é¡µé¢ï¼šåˆ©ç”¨å¾ªç¯æ§åˆ¶è¯­å¥æˆ–å…¶ä»–å·¥å…·åŠŸèƒ½è¾“å‡ºç”±åå°ä¼ é€’è€Œæ¥çš„æ•°æ®ã€‚ ç­‰ç­‰ æäº¤å†…å®¹ä¸æ—¶é—´ï¼š æäº¤å†…å®¹ï¼šç¨‹åºæºç +åšæ–‡é“¾æ¥ æäº¤æ—¶é—´ï¼š7.27æ—¥æ™šé›¶ç‚¹å‰ï¼Œå°†å‹ç¼©åŒ…å‘½åä¸ºç­çº§+å§“å+å­¦å·å‘é€è‡³&#x37;&#48;&#55;&#56;&#50;&#x33;&#56;&#x31;&#52;&#x40;&#x71;&#113;&#x2e;&#99;&#111;&#x6d; å¯èƒ½æ—¶é—´å¤ªçŸ­æ— æ³•å®ç°å¤ªå¤šåŠŸèƒ½ï¼Œæ²¡æœ‰å…³ç³»ï¼Œç¨‹åºæºç é™„ä¸Šè‡ªå·±å®ç°äº†çš„ä¸œè¥¿å°±è¡Œï¼Œæ²¡æœ‰å®ç°å®Œæ•´ä¹Ÿæ²¡å…³ç³»ï¼Œå®ç°äº†æ›´å¤šåŠŸèƒ½ä¹ŸæŒºå¥½ï¼Œè¿™ä¸ªä½œä¸šæ‰“åˆ†ä¸»è¦çœ‹ä½ çš„åšæ–‡é‡Œé¢å†™çš„è®°å½•å†…å®¹ï¼Œç¨‹åºä¸»è¦æ˜¯ç”¨æ¥ç»ƒä¹ ä»¥ç†Ÿæ‚‰servletå’Œjspçš„ï¼Œæ¯•ç«Ÿå¤§ä½œä¸šä¼šç”¨åˆ°ã€‚","categories":[{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/categories/JavaWeb/"}],"tags":[{"name":"é›†è®­","slug":"é›†è®­","permalink":"http://example.com/tags/%E9%9B%86%E8%AE%AD/"},{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/tags/JavaWeb/"},{"name":"Servlet","slug":"Servlet","permalink":"http://example.com/tags/Servlet/"}]},{"title":"ã€é›†è®­ã€‘jsp","slug":"ã€é›†è®­ã€‘jsp","date":"2021-07-11T07:14:09.093Z","updated":"2021-07-23T05:51:57.089Z","comments":true,"path":"2021/07/11/ji-xun-jsp/","link":"","permalink":"http://example.com/2021/07/11/ji-xun-jsp/","excerpt":"","text":"ä»€ä¹ˆæ˜¯JSP JSP ä¸ PHPã€ASPã€ASP.NET ç­‰è¯­è¨€ç±»ä¼¼ï¼Œè¿è¡Œåœ¨æœåŠ¡ç«¯çš„è¯­è¨€ã€‚ JSPå…¨ç§°Java Server Pagesï¼Œæ˜¯å»ºç«‹åœ¨JAVAåŸºç¡€ä¸Šçš„ä¸€ç§ç½‘ç»œç¼–ç¨‹è¯­è¨€ï¼ŒJSPæ˜¯ä¸€ç§Java servletï¼ˆJSPåœ¨æ‰§è¡Œå‰é¦–å…ˆè¢«ç¼–è¯‘æˆä¸€ä¸ªServletï¼‰ï¼Œä¸»è¦ç”¨äºå®ç°Java webåº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢éƒ¨åˆ†ã€‚ ç½‘é¡µå¼€å‘è€…ä»¬é€šè¿‡ç»“åˆHTMLä»£ç ã€XHTMLä»£ç ã€XMLå…ƒç´ ä»¥åŠåµŒå…¥JSPæ“ä½œå’Œå‘½ä»¤æ¥ç¼–å†™JSPã€‚ jsp &lt;-&gt; java(servlet)C:\\Users\\å¢èŸ\\AppData\\Local\\JetBrains\\IntelliJIdea2021.1\\tomcat\\20e10a3d-4da9-4eee-b7fa-327b2feb3d84\\work\\Catalina\\localhost\\jsp_war_exploded\\org\\apache\\jsp ç±»ä¼¼äºä¸Šè¿°æ–‡ä»¶ç›®å½•ï¼ˆtomcatä¸‹çš„webappç›®å½•ä¸‹å­˜æ”¾å·¥ç¨‹é¡¹ç›®ï¼Œåªä¸è¿‡ç°åœ¨tomcatåœ¨ideaé‡Œç”¨ï¼‰å³æ‰¾åˆ°ç”Ÿæˆçš„javaæ–‡ä»¶ã€‚ å¯è§JSPæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªServletï¼Œåªä¸è¿‡æ— éœ€é…ç½®æ˜ å°„è·¯å¾„ï¼ŒWeb Serverä¼šæ ¹æ®è·¯å¾„æŸ¥æ‰¾å¯¹åº”çš„.jspæ–‡ä»¶ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±è‡ªåŠ¨ç¼–è¯‘æˆServletå†æ‰§è¡Œã€‚ JSPè¯­æ³•JSPæ³¨é‡Š è¯­æ³• æè¿° &lt;%â€“ æ³¨é‡Š â€“%&gt; JSPæ³¨é‡Šï¼Œæ³¨é‡Šå†…å®¹ä¸ä¼šè¢«å‘é€è‡³æµè§ˆå™¨ç”šè‡³ä¸ä¼šè¢«ç¼–è¯‘ HTMLæ³¨é‡Šï¼Œé€šè¿‡æµè§ˆå™¨æŸ¥çœ‹ç½‘é¡µæºä»£ç æ—¶å¯ä»¥çœ‹è§æ³¨é‡Šå†…å®¹ ğŸ’¡è„šæœ¬ï¼ˆåœ¨JSPä¸­ç¼–å†™Javaä»£ç ï¼‰å…ˆå¯¼å…¥jsp-api.jarå’Œservlet-api.jarï¼ˆtomcatè‡ªå¸¦ï¼Œä½†æ˜¯IDEå¹¶æ— æç¤ºä¼šæŠ¥çº¢ï¼‰ è¯­æ³• æè¿° &lt;% ä»£ç ç‰‡æ®µ %&gt; ä¸€èˆ¬å®šä¹‰å˜é‡å’Œç¼–å†™è¯­å¥ã€‚ &lt;%! å£°æ˜ä»£ç  %&gt; å¯ä»¥å£°æ˜å¸¸é‡ï¼Œç¼–å†™æ–¹æ³•ï¼Œç¼–å†™ç±» &lt;%= è¡¨è¾¾å¼ %&gt; è¡¨è¾¾å¼è¢«è½¬åŒ–æˆStringï¼Œç„¶åæ’å…¥åˆ°è¡¨è¾¾å¼å‡ºç°çš„åœ°æ–¹ 123456789101112131415161718192021&lt;%! public class MyMath &#123; int a,b; public MyMath(int a, int b) &#123; this.a = a; this.b = b; &#125; int doMath()&#123; return a+b; &#125; &#125;%&gt;&lt;% out.println(&quot;æ‰“å°è¯­å¥&quot;); MyMath myMath = new MyMath(1, 1); int num = myMath.doMath();%&gt;&lt;h1&gt; å’Œä¸º&lt;%= num %&gt; &lt;/h1&gt;&lt;div&gt; &lt;%= &quot;&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæ ‡ç­¾&lt;/h2&gt;&quot; %&gt; &lt;/div&gt; å¯¹äºæµç¨‹æ§åˆ¶è¯­å¥çš„ç¼–å†™å¯èƒ½ç¨å¾®ç¹ç 123456789101112&lt;% int day = 1 %&gt;&lt;% if (day == 1 || day == 7) &#123; %&gt;&lt;p&gt;ä»Šå¤©æ˜¯å‘¨æœ«&lt;/p&gt;&lt;% &#125; else &#123; %&gt;&lt;p&gt;ä»Šå¤©ä¸æ˜¯å‘¨æœ«&lt;/p&gt;&lt;% &#125; %&gt; &lt;%for ( int fontSize = 1; fontSize &lt;= 3; fontSize++)&#123; %&gt; &lt;font color=&quot;green&quot; size=&quot;&lt;%= fontSize %&gt;&quot;&gt; èœé¸Ÿæ•™ç¨‹ &lt;/font&gt;&lt;br /&gt;&lt;%&#125;%&gt; å½“ç„¶ä¹Ÿå¯ä»¥ç”¨outå¯¹è±¡è¾“å‡º 12345678&lt;% int fontSize; for ( fontSize = 10; fontSize &lt;= 13; fontSize++) &#123; out.write(&quot;&lt;div&gt;&quot;); out.write(fontSize+&quot;&quot;); out.write(&quot;&lt;/div&gt;&lt;br&gt;&quot;); &#125;%&gt; JSPæŒ‡ä»¤JSPæŒ‡ä»¤ç”¨æ¥è®¾ç½®ä¸æ•´ä¸ªJSPé¡µé¢ç›¸å…³çš„å±æ€§ã€‚ JSPæŒ‡ä»¤ æè¿° &lt;%@ page å±æ€§å=â€å±æ€§å€¼â€ %&gt; å®šä¹‰é¡µé¢çš„ä¾èµ–å±æ€§ï¼Œå¯¼åŒ… &lt;%@ include å±æ€§å=â€å±æ€§å€¼â€ %&gt; åŒ…å«å…¶ä»–æ–‡ä»¶ï¼ˆé™æ€åŒ…å«ï¼‰ &lt;%@ taglib å±æ€§å=â€å±æ€§å€¼â€ %&gt; å¼•å…¥æ ‡ç­¾åº“çš„å®šä¹‰ï¼Œå¯ä»¥æ˜¯è‡ªå®šä¹‰æ ‡ç­¾ 123&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;%@ page import=&quot; &quot; %&gt; &lt;%@ include file=&quot; &quot;%&gt; JSPè¡Œä¸ºè‡ªè¡Œå­¦ä¹  1&lt;jsp:è¡Œä¸ºå å±æ€§å=&quot;å±æ€§å€¼&quot; /&gt; ä¸­æ–‡ç¼–ç é—®é¢˜1&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt; ğŸ’¡JSPä¹å¤§å†…ç½®å¯¹è±¡ä¸å››å¤§ä½œç”¨åŸŸå››å¤§åŸŸå¯¹è±¡ å¯¹è±¡ ä½œç”¨åŸŸ å˜åŒ–æ“ä½œ pageContext å½“å‰é¡µé¢æœ‰æ•ˆï¼Œå½“å½“å‰é¡µé¢å…³é—­æˆ–è½¬åˆ°å…¶ä»–é¡µé¢æ—¶ï¼Œpageå¯¹è±¡å°†åœ¨å“åº”å›é¦ˆç»™å®¢æˆ·ç«¯åé‡Šæ”¾ã€‚ è·³è½¬é¡µé¢ request å½“æ¬¡è¯·æ±‚æœ‰æ•ˆï¼Œå¯ä»¥è·¨è¶Šforward()ä¸é‡å®šå‘è·³è½¬å‰åçš„ä¸¤é¡µï¼Œå¯ä»¥é€šè¿‡setAttribute()æ–¹æ³•å®ç°é¡µé¢ä¸­çš„ä¿¡æ¯ä¼ é€’ã€‚ ä¸¤æ¬¡è¯·æ±‚ session å½“å‰ä¼šè¯æœ‰æ•ˆï¼ŒæŒ‡ä»ç”¨æˆ·æ‰“å¼€æµè§ˆå™¨å¼€å§‹ï¼Œåˆ°ç”¨æˆ·å…³é—­æµè§ˆå™¨è¿™ä¸­é—´çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½åŒ…å«å¤šä¸ªè¯·æ±‚å“åº” å…³é—­æµè§ˆå™¨ application æ‰€æœ‰åº”ç”¨ç¨‹åºä¸­æœ‰æ•ˆï¼Œæ•´ä¸ªåº”ç”¨æ˜¯æŒ‡ä»åº”ç”¨å¯åŠ¨ï¼Œåˆ°åº”ç”¨ç»“æŸã€‚æˆ‘ä»¬æ²¡æœ‰è¯´â€œä»æœåŠ¡å™¨å¯åŠ¨ï¼Œåˆ°æœåŠ¡å™¨å…³é—­â€æ˜¯å› ä¸ºä¸€ä¸ªæœåŠ¡å™¨å¯èƒ½éƒ¨ç½²å¤šä¸ªåº”ç”¨ï¼Œå½“ç„¶ä½ å…³é—­äº†æœåŠ¡å™¨ï¼Œå°±ä¼šæŠŠä¸Šé¢æ‰€æœ‰çš„åº”ç”¨éƒ½å…³é—­äº†ã€‚ å…³é—­æœåŠ¡å™¨ 12345678910&lt;% pageContext.setAttribute(&quot;key&quot;, &quot;pageContext&quot;); request.setAttribute(&quot;key&quot;, &quot;request&quot;); session.setAttribute(&quot;key&quot;, &quot;session&quot;); application.setAttribute(&quot;key&quot;, &quot;application&quot;);%&gt;pageContextçš„å€¼ï¼š&lt;%=pageContext.getAttribute(&quot;key&quot;) %&gt;&lt;br&gt;requestçš„å€¼ï¼š&lt;%=request.getAttribute(&quot;key&quot;) %&gt;&lt;br&gt;sessionçš„å€¼ï¼š&lt;%=session.getAttribute(&quot;key&quot;) %&gt;&lt;br&gt;applicationçš„å€¼ï¼š&lt;%=application.getAttribute(&quot;key&quot;) %&gt;&lt;br&gt; ä¹å¤§å†…ç½®å¯¹è±¡åœ¨ç”Ÿæˆçš„javaæ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ° å¯¹è±¡ æè¿° ä½œç”¨åŸŸ request javax.servlet.http.HttpServletRequest ç±»çš„å®ä¾‹ request response javax.servlet.http.HttpServletResponseç±»çš„å®ä¾‹ pageContext out javax.servlet.jsp.JspWriter ç±»çš„å®ä¾‹ï¼Œç”¨æ¥åœ¨responseå¯¹è±¡ä¸­å†™å…¥å†…å®¹ã€‚ pageContext session javax.servlet.http.HttpSession ç±»çš„å®ä¾‹ session application javax.servlet.ServletContext ç±»çš„å®ä¾‹ã€‚ä¸åº”ç”¨ä¸Šä¸‹æ–‡æœ‰å…³ application config javax.servlet.ServletConfig ç±»çš„å®ä¾‹ã€‚è¿™ä¸ªå¯¹è±¡å…è®¸å¼€å‘è€…è®¿é—®Servletæˆ–è€…JSPå¼•æ“çš„åˆå§‹åŒ–å‚æ•°ï¼Œæ¯”å¦‚æ–‡ä»¶è·¯å¾„ç­‰ã€‚ pageContext pageContext javax.servlet.jsp.PageContext ç±»çš„å®ä¾‹ï¼Œæä¾›å¯¹JSPé¡µé¢æ‰€æœ‰å¯¹è±¡ä»¥åŠå‘½åç©ºé—´çš„è®¿é—® pageContext page æŒ‡å‘å½“å‰JSPå¯¹è±¡ pageContext exception exception ç±»çš„å¯¹è±¡ï¼Œä»£è¡¨å‘ç”Ÿé”™è¯¯çš„ JSP é¡µé¢ä¸­å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ï¼Œ&lt;%@ page â€¦â€¦ isErrorPage=â€trueâ€ %&gt; pageContext ELè¡¨è¾¾å¼ä¸JSTLæ ‡å‡†æ ‡ç­¾åº“è‡ªè¡Œå­¦ä¹  ğŸ’¡MVCæ¡†æ¶MVCæ˜¯ä¸‰ä¸ªå•è¯çš„é¦–å­—æ¯ç¼©å†™ï¼Œå®ƒä»¬æ˜¯Modelï¼ˆæ¨¡å‹ï¼‰ã€Viewï¼ˆè§†å›¾ï¼‰å’ŒControllerï¼ˆæ§åˆ¶ï¼‰ã€‚ Modelï¼ˆæ¨¡å‹ï¼‰ï¼šå¦‚ä¸€ä¸ªå­˜å–æ•°æ®çš„å¯¹è±¡æˆ– JavaBean Viewï¼ˆè§†å›¾ï¼‰ï¼šå¦‚jspåŠ¨æ€é¡µé¢ Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼šæ§åˆ¶æ•°æ®æµå‘æ¨¡å‹å¯¹è±¡ï¼Œå¹¶åœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–°è§†å›¾ï¼Œä½¿è§†å›¾ä¸æ¨¡å‹åˆ†ç¦»å¼€ï¼Œå¦‚servlet MVCé‡è¦ç‰¹ç‚¹å°±æ˜¯ä¸¤ç§åˆ†ç¦»ï¼š è§†å›¾å’Œæ•°æ®æ¨¡å‹çš„åˆ†ç¦»ï¼šä½¿ç”¨ä¸åŒçš„è§†å›¾å¯¹ç›¸åŒçš„æ•°æ®è¿›è¡Œå±•ç¤ºï¼›åˆ†ç¦»å¯è§†å’Œä¸å¯è§†çš„ç»„ä»¶ï¼Œèƒ½å¤Ÿå¯¹æ¨¡å‹è¿›è¡Œç‹¬ç«‹æµ‹è¯•ã€‚å› ä¸ºåˆ†ç¦»äº†å¯è§†ç»„ä»¶å‡å°‘äº†å¤–éƒ¨ï¼ˆæ•°æ®åº“ä¹Ÿæ˜¯ä¸€ç§å¤–éƒ¨ç»„ä»¶ï¼‰ä¾èµ–åˆ©äºæµ‹è¯•ã€‚ è§†å›¾å’Œè¡¨ç°é€»è¾‘(Controller)çš„åˆ†ç¦»ï¼šControlleræ˜¯ä¸€ä¸ªè¡¨ç°é€»è¾‘çš„ç»„ä»¶ï¼Œå¹¶éä¸€ä¸ªä¸šåŠ¡é€»è¾‘ç»„ä»¶ã€‚MVCå¯ä»¥ä½œä¸ºè¡¨ç°æ¨¡å¼ä¹Ÿå¯ä»¥ä½œä¸ºå»ºæ„æ¨¡å¼ï¼Œæ„å‘³è¿™Controllerä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡é€»è¾‘ã€‚åˆ†ç¦»é€»è¾‘å’Œå…·ä½“å±•ç¤ºï¼Œèƒ½å¤Ÿå¯¹é€»è¾‘è¿›è¡Œç‹¬ç«‹æµ‹è¯•ã€‚ MVCä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šä½è€¦åˆã€é‡ç”¨æ€§é«˜ã€ç”Ÿå‘½å‘¨æœŸæˆæœ¬ä½ã€éƒ¨ç½²å¿«ã€å¯ç»´æŠ¤æ€§é«˜ ç¼ºç‚¹ï¼šæ²¡æœ‰æ˜ç¡®çš„å®šä¹‰ã€ä¸é€‚åˆå°ã€ä¸­å‹åº”ç”¨ç¨‹åºã€å¢åŠ ç³»ç»Ÿç»“æ„å’Œå®ç°çš„å¤æ‚æ€§ã€è§†å›¾å¯¹æ¨¡å‹æ•°æ®çš„ä½æ•ˆç‡è®¿é—® ä½œä¸šåœ¨ä¸Šä¸€ä¸ªæ–‡æ¡£ä¸­å·²ç»å£°æ˜ï¼Œè¿™ä¸¤èŠ‚è¯¾åªè¦äº¤ä¸€ä¸ªä½œä¸šå°±è¡Œã€‚","categories":[{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/categories/JavaWeb/"}],"tags":[{"name":"é›†è®­","slug":"é›†è®­","permalink":"http://example.com/tags/%E9%9B%86%E8%AE%AD/"},{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/tags/JavaWeb/"},{"name":"jsp","slug":"jsp","permalink":"http://example.com/tags/jsp/"}]}],"categories":[{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/categories/%E9%A1%B9%E7%9B%AE/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/categories/%E5%AD%A6%E4%B9%A0/"},{"name":"Unity","slug":"Unity","permalink":"http://example.com/categories/Unity/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/categories/Vue/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/categories/ssm/"},{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/categories/JavaWeb/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://example.com/tags/SpringBoot/"},{"name":"Vue","slug":"Vue","permalink":"http://example.com/tags/Vue/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"http://example.com/tags/%E9%A1%B9%E7%9B%AE/"},{"name":"SpringCloud","slug":"SpringCloud","permalink":"http://example.com/tags/SpringCloud/"},{"name":"redis","slug":"redis","permalink":"http://example.com/tags/redis/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://example.com/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://example.com/tags/ElasticSearch/"},{"name":"MyBatisPlus","slug":"MyBatisPlus","permalink":"http://example.com/tags/MyBatisPlus/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"ssm","slug":"ssm","permalink":"http://example.com/tags/ssm/"},{"name":"Unity2D","slug":"Unity2D","permalink":"http://example.com/tags/Unity2D/"},{"name":"æ¸¸æˆå¼€å‘","slug":"æ¸¸æˆå¼€å‘","permalink":"http://example.com/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://example.com/tags/%E5%89%8D%E7%AB%AF/"},{"name":"é›†è®­","slug":"é›†è®­","permalink":"http://example.com/tags/%E9%9B%86%E8%AE%AD/"},{"name":"å¾®ä¿¡å°ç¨‹åº","slug":"å¾®ä¿¡å°ç¨‹åº","permalink":"http://example.com/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"javaEE","slug":"javaEE","permalink":"http://example.com/tags/javaEE/"},{"name":"MyBatis","slug":"MyBatis","permalink":"http://example.com/tags/MyBatis/"},{"name":"SpringMVC","slug":"SpringMVC","permalink":"http://example.com/tags/SpringMVC/"},{"name":"Spring","slug":"Spring","permalink":"http://example.com/tags/Spring/"},{"name":"JavaWeb","slug":"JavaWeb","permalink":"http://example.com/tags/JavaWeb/"},{"name":"Servlet","slug":"Servlet","permalink":"http://example.com/tags/Servlet/"},{"name":"jsp","slug":"jsp","permalink":"http://example.com/tags/jsp/"}]}